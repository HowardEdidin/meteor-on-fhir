{"version":3,"sources":["meteor://ðŸ’»app/packages/clinical:hl7-resource-service-request/lib/ServiceRequests.js","meteor://ðŸ’»app/packages/clinical:hl7-resource-service-request/lib/methods.js","meteor://ðŸ’»app/packages/clinical:hl7-resource-service-request/index.jsx","meteor://ðŸ’»app/packages/clinical:hl7-resource-service-request/client/ServiceRequestDetail.jsx","meteor://ðŸ’»app/packages/clinical:hl7-resource-service-request/client/ServiceRequestsDashboard.jsx","meteor://ðŸ’»app/packages/clinical:hl7-resource-service-request/client/ServiceRequestsPage.jsx","meteor://ðŸ’»app/packages/clinical:hl7-resource-service-request/client/ServiceRequestsTable.jsx"],"names":["module","export","ServiceRequest","ServiceRequests","ServiceRequestSchema","ServiceRequestStu3","ServiceRequestDstu2","BaseModel","link","v","Mongo","SimpleSchema","BaseSchema","DomainResourceSchema","HumanNameSchema","IdentifierSchema","ContactPointSchema","AddressSchema","ReferenceSchema","ProvenanceSchema","Package","console","log","extend","prototype","_collection","Collection","connection","_transform","document","Meteor","isClient","subscribe","isServer","publish","argument","userId","find","type","String","defaultValue","optional","Array","Boolean","Code","allowedValues","CodeableConceptSchema","Date","PeriodSchema","TimingSchema","AnnotationSchema","attachSchema","toFhir","EJSON","stringify","name","getPatientId","process","env","TRACE","patientId","get","referenceString","includes","split","fetchBundle","query","parameters","callback","patientArray","map","patient","id","_id","_document","result","Bundle","generate","toMongo","originalServiceRequest","mongoRecord","toStu3","patientJson","birthDate","deceasedBoolean","family","text","given","prepForUpdate","forEach","resourceType","telecom","address","contact","prepForFhirTransfer","moment","format","Random","faker","pad","n","width","z","length","join","methods","number","check","Number","modalities","push","code","DEBUG","agents","display","reference","scenarios","description","bodySite","newOrders","index","newRequest","clinicalScenario","choice","modality","category","identifier","value","supportingInfo","reasonCode","requestor","authoredOn","subtract","toDate","occurenceDateTime","encounter","subject","findName","NODE_ENV","requestId","order","clean","serviceContext","newContext","validate","isValid","validationErrors","insert","serviceRequestId","remove","SidebarElements","PractitionerSidebarElements","DynamicRoutes","ServiceRequestsPage","ServiceRequestsTable","ServiceRequestDetail","ServiceRequestsDashboard","CardActions","CardText","DatePicker","Toggle","RaisedButton","TextField","has","set","Row","Col","React","ReactMeteorData","ReactMixin","PropTypes","Session","styles","block","maxWidth","toggle","marginTop","thumbOff","backgroundColor","trackOff","thumbSwitched","trackSwitched","labelStyle","color","props","state","serviceRequest","prefix","suffix","active","gender","photo","url","use","coding","system","multipleBirthBoolean","maritalStatus","animal","species","communication","language","careProvider","managingOrganization","form","deceased","multipleBirth","dehydrateFhirResource","formData","Object","assign","shouldComponentUpdate","nextProps","shouldUpdate","setState","getMeteorData","data","displayBirthdate","render","changeState","bind","determineButtons","renderDatePicker","displayDatePicker","javascriptDate","momentDate","handleSaveButton","marginRight","handleDeleteButton","updateFormData","field","textValue","updateServiceRequest","serviceRequestData","event","self","fhirServiceRequestData","serviceRequestValidator","update","$set","error","Bert","alert","reason","HipaaLogger","logEvent","eventType","userName","user","fullName","collectionName","recordId","handleCancelButton","animalremove","Component","propTypes","string","fhirVersion","oneOfType","bool","object","exportDefault","Card","CardTitle","Grid","GlassCard","FullPageCanvas","Glass","ServiceRequestTable","Typography","ServicseRequests","Tabs","Tab","withStyles","TabContainer","padding","children","node","isRequired","defaultServiceRequest","username","email","setDefault","handleChange","style","opacity","tab","fontWeight","fontSize","textAlign","paddingTop","tabIndex","serviceRequestSearchFilter","selectedServiceRequestId","selectedServiceRequest","count","findOne","handleTabChange","onNewTab","version","classes","FlatButton","HTTP","Table","browserHistory","GoSync","GoCloudDownload","GoCloudUpload","GoFilePdf","GoFlame","GoPulse","GoLink","GoMail","GoStar","GoTag","GoClippy","GoCommentDiscussion","GoTrashcan","flattenServiceRequest","newOrder","date","defaultIconStyle","verticalAlign","hideOnPhone","visibility","cellHideOnPhone","cell","avatar","userSelect","borderRadius","height","actionIcon","syncIcon","pdfIcon","fhirIcon","pulseIcon","linkIcon","mailIcon","tagIcon","clippyIcon","discussionIcon","trashcanIcon","selected","serviceRequests","options","sort","limit","imgError","avatarId","refs","src","absoluteUrl","renderActionsHeader","hideActions","removeRecord","renderActions","avatarStyle","renderSendButtonHeader","showSendButton","renderSendButton","onSend","i","renderCategoryHeader","hideCategory","renderCategory","selectServiceRequestRow","renderModalityHeader","hideModality","renderModality","httpEndpoint","post","onRowClick","equals","undefined","sortColumn","columnName","fetchData","call","tableRows","footer","importStyle","position","paddingBottom","cursor","minWidth","paddingLeft","paddingRight","noDataMessagePadding","func"],"mappings":"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","file":"/packages/clinical_hl7-resource-service-request.js","sourcesContent":["if(Package['autopublish']){\n  console.log(\"*****************************************************************************\")\n  console.log(\"Your application has the 'autopublish' package installed.  Please uninstall.\");\n  console.log(\"\");  \n  console.log(\"meteor remove autopublish\");  \n  console.log(\"\");  \n}\n\n\nimport { BaseModel } from 'meteor/clinical:base-model';\nimport { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\nimport { BaseSchema, DomainResourceSchema, HumanNameSchema, IdentifierSchema, ContactPointSchema, AddressSchema, ReferenceSchema } from 'meteor/clinical:hl7-resource-datatypes';\nimport { ProvenanceSchema } from 'meteor/clinical:hl7-resource-provenance';\n\n\n\n// create the object using our BaseModel\nServiceRequest = BaseModel.extend();\n\n\n//Assign a collection so the object knows how to perform CRUD operations\nServiceRequest.prototype._collection = ServiceRequests;\n\n\n// // Create a persistent data store for addresses to be stored.\n// // HL7.Resources.ServiceRequests = new Mongo.Collection('HL7.Resources.ServiceRequests');\n\nif(typeof ServiceRequests === 'undefined'){\n  if(Package['autopublish']){\n    ServiceRequests = new Mongo.Collection('ServiceRequests');\n  } else if(Package['clinical:desktop-publish']){\n    ServiceRequests = new Mongo.Collection('ServiceRequests');\n  } else if(Package['clinical:autopublish']){\n    ServiceRequests = new Mongo.Collection('ServiceRequests');\n  } else {\n    ServiceRequests = new Mongo.Collection('ServiceRequests', {connection: null});\n  }\n} \n\n//Add the transform to the collection since Meteor.users is pre-defined by the accounts package\nServiceRequests._transform = function (document) {\n  return new ServiceRequest(document);\n};\n\nif (Meteor.isClient){\n  Meteor.subscribe(\"ServiceRequests\");\n}\n\nif (Meteor.isServer){\n  Meteor.publish(\"ServiceRequests\", function (argument){\n    if (this.userId) {\n      return ServiceRequests.find();\n    } else {\n      return [];\n    }\n  });\n}\n\n\n\n\n//Add the transform to the collection since Meteor.users is pre-defined by the accounts package\nServiceRequests._transform = function (document) {\n  return new ServiceRequest(document);\n};\n\n\nServiceRequestDstu2 = new SimpleSchema({\n  \"resourceType\" : {\n    type: String,\n    defaultValue: \"ServiceRequest\"\n  },\n  \"_id\" : {\n    type: String,\n    optional: true\n    },\n  \"id\" : {\n    optional: true,\n    type: String\n    },\n  \"identifier\" : {\n    optional: true,\n    type:  Array\n    },\n  \"identifier.$\" : {\n    optional: true,\n    type:  IdentifierSchema \n    },\n  \"active\" : {\n    type: Boolean,\n    optional: true,\n    defaultValue: true\n    },\n  \"instantiatesCanonical\" : {\n    optional: true,\n    type: ReferenceSchema\n    },\n  \"instantiatesUri\" : {\n    optional: true,\n    type: String\n    },\n  \"status\" : {\n      type: Code,\n      allowedValues: [ 'draft', 'active', 'suspended', 'completed', 'entered-in-error', 'cancelled' ]\n    },\n  \"intent\" : {\n      type: Code,\n      allowedValues: [ 'proposal', 'plan', 'order' ] // there should be more\n    },\n  \"priority\" : {\n      optional: true,\n      type: Code,\n      allowedValues: [ 'routine', 'urgent', 'asap', 'stat' ] // there should be more\n    },\n  \"doNotPerform\" : {\n      optional: true,\n      type: Boolean\n    },\n  \"category\" : {\n      optional: true,\n      type: Array\n    },\n  \"category.$\" : {\n      optional: true,\n      type: CodeableConceptSchema\n    },\n  \"code\" : {\n      optional: true,\n      type: CodeableConceptSchema\n    },\n  \"subject\" : {\n    optional: true,\n    type: ReferenceSchema\n  },\n  \"encounter\" : {\n    optional: true,\n    type: ReferenceSchema\n  },\n  \"occurenceDateTime\" : {\n    optional: true,\n    type: Date\n  },\n  \"occurencePeriod\" : {\n    optional: true,\n    type: PeriodSchema\n  },\n  \"occurenceTiming\" : {\n    optional: true,\n    type: TimingSchema\n  },\n  \"asNeededBoolean\" : {\n    optional: true,\n    type: Boolean\n  },\n  \"asNeededCodeableConcept\" : {\n    optional: true,\n    type: CodeableConceptSchema\n  },\n  \"authoredOn\" : {\n    optional: true,\n    type: Date\n  },\n  \"requestor\" : {\n    optional: true,\n    type:  ReferenceSchema\n    },\n\"reasonCode\" : {\n    optional: true,\n    type: Array \n  },\n  \"reasonCode.$\" : {\n      optional: true,\n      type: CodeableConceptSchema \n    },\n  \"reasonReference\" : {\n      optional: true,\n      type: Array \n    },\n  \"reasonReference.$\" : {\n      optional: true,\n      type: ReferenceSchema \n    },\n  \"supportingInfo\" : {\n      optional: true,\n      type: Array \n    },\n  \"supportingInfo.$\" : {\n      optional: true,\n      type: ReferenceSchema \n    },\n\n  \"performer\" : {\n    optional: true,\n    type: Array\n  },\n  \"performer.$\" : {\n    optional: true,\n    type: ReferenceSchema \n  },\n\n  \n  \"specimen\" : {\n    optional: true,\n    type: Array\n  },\n  \"specimen.$\" : {\n    optional: true,\n    type: ReferenceSchema \n  },\n\n\n  \"bodySite\" : {\n    optional: true,\n    type: Array\n  },\n  \"bodySite.$\" : {\n    optional: true,\n    type: CodeableConceptSchema \n  },\n  \"note\" : {\n    optional: true,\n    type: Array\n  },\n  \"note.$\" : {\n    optional: true,\n    type: AnnotationSchema \n  },\n  \"relevantHistory\" : {\n    optional: true,\n    type: Array\n  },\n  \"relevantHistory.$\" : {\n    optional: true,\n    type: ProvenanceSchema\n  }\n\n});\n\n\n\n\n\nServiceRequestStu3 = new SimpleSchema({\n  \"resourceType\" : {\n    type: String,\n    defaultValue: \"ServiceRequest\"\n  }\n});\n\n\n\n\nServiceRequestSchema = ServiceRequestDstu2;\n\n// BaseSchema.extend(ServiceRequestSchema);\n// DomainResourceSchema.extend(ServiceRequestSchema);\n\nServiceRequests.attachSchema(ServiceRequestSchema);\n\n\nServiceRequest.prototype.toFhir = function(){\n  console.log('ServiceRequest.toFhir()');\n\n\n\n  return EJSON.stringify(this.name);\n}\n\n/**\n * @summary Search the ServiceRequests collection for a specific Meteor.userId().\n * @memberOf ServiceRequests\n * @name getPatientId\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n *  Session.set('selectedPatientId', selectedServiceRequest.getPatientId());\n * ```\n */\n\nServiceRequests.getPatientId = function (userId) {\n  process.env.TRACE && console.log(\"ServiceRequests.findUserId()\");\n  let patientId = \"\";\n  if(get(this, 'subject.reference')){\n    let referenceString = get(this, 'subject.reference');\n    if(referenceString.includes(\"/\")){\n      patientId = referenceString.split(\"/\")[1];\n    } else {\n      patientId = referenceString;\n    }\n  }\n  return patientId;\n};\n\n\n/**\n * @summary Search the ServiceRequests collection for a specific Meteor.userId().\n * @memberOf ServiceRequests\n * @name fetchBundle\n * @version 1.2.3\n * @returns {Object}\n * @example\n * ```js\n * ```\n */\n\nServiceRequests.fetchBundle = function (query, parameters, callback) {\n  process.env.TRACE && console.log(\"ServiceRequests.fetchBundle()\");  \n  var patientArray = ServiceRequests.find(query, parameters, callback).map(function(patient){\n    patient.id = patient._id;\n    delete patient._document;\n    return patient;\n  });\n\n  // console.log(\"patientArray\", patientArray);\n\n  var result = Bundle.generate(patientArray);\n\n  // console.log(\"result\", result.entry[0]);\n\n  return result;\n};\n\n\n/**\n * @summary This function takes a FHIR resource and prepares it for storage in Mongo.\n * @memberOf ServiceRequests\n * @name toMongo\n * @version 1.6.0\n * @returns { ServiceRequest }\n * @example\n * ```js\n *  let patients = ServiceRequests.toMongo('12345').fetch();\n * ```\n */\n\nServiceRequests.toMongo = function (originalServiceRequest) {\n  var mongoRecord;\n  process.env.TRACE && console.log(\"ServiceRequests.toMongo()\");  \n\n  // if (originalServiceRequest.identifier) {\n  //   originalServiceRequest.identifier.forEach(function(identifier){\n  //     if (identifier.period) {\n  //       if (identifier.period.start) {\n  //         var startArray = identifier.period.start.split('-');\n  //         identifier.period.start = new Date(startArray[0], startArray[1] - 1, startArray[2]);\n  //       }\n  //       if (identifier.period.end) {\n  //         var endArray = identifier.period.end.split('-');\n  //         identifier.period.end = new Date(startArray[0], startArray[1] - 1, startArray[2]);\n  //       }\n  //     }\n  //   });\n  // }\n\n  return originalServiceRequest;\n};\n\n\n\n/**\n * @summary This function takes a DTSU2 resource and returns it as STU3.  i.e. it converts from v1.0.2 to v3.0.0\n * @name toMongo\n * @version 3.0.0\n * @returns { ServiceRequest }\n * @example\n * ```js\n * ```\n */\nServiceRequests.toStu3 = function(patientJson){\n  if(patientJson){\n\n    // quick cast from string to boolean\n    if(typeof patientJson.birthDate === \"string\"){\n      patientJson.birthDate = new Date(patientJson.birthDate);\n    }\n\n    // quick cast from string to boolean\n    if(patientJson.deceasedBoolean){\n      patientJson.deceasedBoolean = (patientJson.deceasedBoolean == \"true\") ? true : false;\n    }\n\n    // STU3 only has a single entry for family name; not an array\n    if(patientJson.name && patientJson.name[0] && patientJson.name[0].family && patientJson.name[0].family[0] ){\n      patientJson.name[0].family = patientJson.name[0].family[0];      \n    }\n\n    // make sure the full name is filled out\n    if(patientJson.name && patientJson.name[0] && patientJson.name[0].family && !patientJson.name[0].text ){\n      patientJson.name[0].text = patientJson.name[0].given[0] + ' ' + patientJson.name[0].family;      \n    }\n  }\n  return patientJson;\n}\n\n\n/**\n * @summary Similar to toMongo(), this function prepares a FHIR record for storage in the Mongo database.  The difference being, that this assumes there is already an existing record.\n * @memberOf ServiceRequests\n * @name prepForUpdate\n * @version 1.6.0\n * @returns { Object }\n * @example\n * ```js\n *  let patients = ServiceRequests.findMrn('12345').fetch();\n * ```\n */\n\nServiceRequests.prepForUpdate = function (patient) {\n  process.env.TRACE && console.log(\"ServiceRequests.prepForUpdate()\");  \n\n  if (patient.name && patient.name[0]) {\n    //console.log(\"patient.name\", patient.name);\n\n    patient.name.forEach(function(name){\n      name.resourceType = \"HumanName\";\n    });\n  }\n\n  if (patient.telecom && patient.telecom[0]) {\n    //console.log(\"patient.telecom\", patient.telecom);\n    patient.telecom.forEach(function(telecom){\n      telecom.resourceType = \"ContactPoint\";\n    });\n  }\n\n  if (patient.address && patient.address[0]) {\n    //console.log(\"patient.address\", patient.address);\n    patient.address.forEach(function(address){\n      address.resourceType = \"Address\";\n    });\n  }\n\n  if (patient.contact && patient.contact[0]) {\n    //console.log(\"patient.contact\", patient.contact);\n\n    patient.contact.forEach(function(contact){\n      if (contact.name) {\n        contact.name.resourceType = \"HumanName\";\n      }\n\n      if (contact.telecom && contact.telecom[0]) {\n        contact.telecom.forEach(function(telecom){\n          telecom.resourceType = \"ContactPoint\";\n        });\n      }\n\n    });\n  }\n\n  return patient;\n};\n\n\n/**\n * @summary Scrubbing the patient; make sure it conforms to v1.6.0\n * @memberOf ServiceRequests\n * @name scrub\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n *  let patients = ServiceRequests.findMrn('12345').fetch();\n * ```\n */\n\nServiceRequests.prepForFhirTransfer = function (patient) {\n  process.env.TRACE && console.log(\"ServiceRequests.prepForFhirTransfer()\");  \n\n\n  // FHIR has complicated and unusual rules about dates in order\n  // to support situations where a family member might report on a patient's\n  // date of birth, but not know the year of birth; and the other way around\n  if (patient.birthDate) {\n    patient.birthDate = moment(patient.birthDate).format(\"YYYY-MM-DD\");\n  }\n\n\n  if (patient.name && patient.name[0]) {\n    //console.log(\"patient.name\", patient.name);\n\n    patient.name.forEach(function(name){\n      delete name.resourceType;\n    });\n  }\n\n  if (patient.telecom && patient.telecom[0]) {\n    //console.log(\"patient.telecom\", patient.telecom);\n    patient.telecom.forEach(function(telecom){\n      delete telecom.resourceType;\n    });\n  }\n\n  if (patient.address && patient.address[0]) {\n    //console.log(\"patient.address\", patient.address);\n    patient.address.forEach(function(address){\n      delete address.resourceType;\n    });\n  }\n\n  if (patient.contact && patient.contact[0]) {\n    //console.log(\"patient.contact\", patient.contact);\n\n    patient.contact.forEach(function(contact){\n\n      console.log(\"contact\", contact);\n\n\n      if (contact.name && contact.name.resourceType) {\n        //console.log(\"patient.contact.name\", contact.name);\n        delete contact.name.resourceType;\n      }\n\n      if (contact.telecom && contact.telecom[0]) {\n        contact.telecom.forEach(function(telecom){\n          delete telecom.resourceType;\n        });\n      }\n\n    });\n  }\n\n  //console.log(\"ServiceRequests.prepForBundle()\", patient);\n\n  return patient;\n};\n\n\n\n\n\nexport { ServiceRequest, ServiceRequests, ServiceRequestSchema, ServiceRequestStu3, ServiceRequestDstu2 };\n","import { Random } from 'meteor/random';\nimport { ServiceRequest, ServiceRequests, ServiceRequestSchema } from './ServiceRequests.js';\nimport faker from 'faker';\n\n\n\nfunction pad(n, width, z) {\n  z = z || '0';\n  n = n + '';\n  return n.length >= width ? n : new Array(width - n.length + 1).join(z) + n;\n}\n\nMeteor.methods({\n  'ServiceRequests/initialize': function(number, type){\n    check(number, Number);\n    check(type, String);\n    \n    // console.log('initServiceRequests');\n\n    let modalities = [];\n\n    if(['Radiology'].includes(type)){\n      modalities.push({\n        code: 'DR',\n        text: 'Digital Radiology'\n      });\n      modalities.push({\n        code: 'MR',\n        text: 'Magnetic Resonance'\n      })\n      modalities.push({\n        code: 'XR',\n        text: 'Computed Tomography'\n      })\n      modalities.push({\n        code: 'XR',\n        text: 'X-Ray'\n      })\n      modalities.push({\n        code: 'US',\n        text: 'Ultrasound'\n      })\n    }\n\n    if(['Lifestyle Medicine'].includes(type)){\n      modalities.push({\n        code: 'GC',\n        text: 'General Checkup'\n      });\n      modalities.push({\n        code: 'SA',\n        text: 'Substance Abuse'\n      })\n      modalities.push({\n        code: 'OE',\n        text: 'Opioid Epidemic'\n      })\n      modalities.push({\n        code: 'OD',\n        text: 'Obesity & Diabetes'\n      })\n      modalities.push({\n        code: 'TR',\n        text: 'International Travel'\n      })\n    }\n\n    process.env.DEBUG && console.log('modalities', modalities)\n\n    let agents = [{\n      display: 'Gregory House, MD',\n      reference: 'Pracitioner/' + Random.id()\n    }, {\n      display: 'Alison Camron, MD',\n      reference: 'Pracitioner/' + Random.id()\n    }, {\n      display: 'Lawrence Kutner, MD',\n      reference: 'Pracitioner/' + Random.id()\n    }, {\n      display: 'Lisa Cuddy, MD',\n      reference: 'Pracitioner/' + Random.id()\n    }]\n\n    // console.log('agents', agents)\n\n\n    // console.log('newRequest', newRequest)\n\n    // https://www.bcbsm.com/content/dam/public/Providers/Documents/help/faqs/icd10-tipsheet-radiology.pdf\n    let scenarios = [{\n        code: 'R07.9',\n        description: 'Chest pain, unspecified',\n        bodySite: 'Chest'\n      }, {\n        code: 'R10.0',\n        description: 'Acute abdomen',\n        bodySite: 'Abdomen'\n      }, {\n        code: 'R10.9',\n        description: 'Unspecified abdominal pain',\n        bodySite: 'Abdomen'\n      }, {\n        code: 'R06.02',\n        description: 'Shortness of breath',\n        bodySite: 'Chest'\n      }, {\n        code: 'N63',\n        description: 'Unspecified lump in breast',\n        bodySite: 'Chest'\n      }, {\n        code: 'M25.569',\n        description: 'Pain in unspecified knee',\n        bodySite: 'Leg'\n      }, {\n        code: 'R06.00 ',\n        description: 'Dyspnea, unspecified',\n        bodySite: 'Chest'\n      }, {\n        code: 'R51',\n        description: 'Headache',\n        bodySite: 'Head'\n      }, {\n        code: 'M54.5',\n        description: 'Low back pain',\n        bodySite: 'Chest'\n      }, {\n        code: 'J98.11',\n        description: 'Atelectasis / pulmonary collapse',\n        bodySite: 'Chest'\n      }\n    ]\n\n    // console.log('scenarios', scenarios)\n\n\n\n    let newOrders = [];\n\n    for (let index = 0; index < number; index++) {\n\n      var newRequest = {\n        \"resourceType\" : \"ServiceRequest\",\n        \"identifier\" : [{\n          \"value\": \"XR-000123\"\n        }],\n        \"instantiatesCanonical\" : {},\n        \"instantiatesUri\" : '',\n        // \"basedOn\" :[],\n        // \"replaces\" : [],\n        \"status\" : \"active\",\n        \"intent\" : \"plan\",\n        \"doNotPerform\" : false,\n        \"category\" : [{\"text\": \"Digital Radioslogy\"}],\n        \"code\" : {\n          \"text\": \"DR\"\n        },\n        \"subject\" : {\n          \"reference\": \"Patient/123\",\n          \"display\": \"Jane Doe\"\n        },\n        \"encounter\" : {\n          \"reference\": \"Encounter/123\"\n        },\n        \"occurenceDateTime\" : null,\n        \"occurencePeriod\" : {\n          \"start\": null,\n          \"end\": null\n        },\n        \"occurenceTiming\" : null,\n        \"asNeededBoolean\" : false,\n        \"authoredOn\" : new Date(),\n        \"requestor\" : {\n          \"reference\": \"Practitioner/444\",\n          \"display\": \"Dr. Gregory House\"\n        },\n        \"performer\" : [],\n        \"reasonCode\" : [{\n          \"text\" : \"Tuburculosis Screening\"\n        }],\n        \"reasonReference\" : [],\n        \"supportingInfo\" : [{\n          \"reference\": \"Observation/222\",\n          \"display\": \"Wheezing Cough\"\n        }],\n        \"specimen\" : [],\n        \"bodySite\" : [{\n          \"text\": \"Chest\"\n        }],\n        \"note\" : [{\n          \"text\": \"Lorem ipsum...\"\n        }],\n        \"relevantHistory\" : []\n      };\n  \n      let clinicalScenario = Random.choice(scenarios);\n      clinicalScenario.modality = Random.choice(modalities);\n\n      // modality type\n      newRequest.code.text = clinicalScenario.modality.code;\n      newRequest.category[0].text = clinicalScenario.modality.text;\n\n      // accession number\n      newRequest.identifier = [{\n        value: clinicalScenario.modality.code + \"-\" + pad(index, 10)\n      }]\n\n      // // body site, observation, reason\n      // newRequest.bodySite[0] = {\n      //   reference: 'BodySite/' + Random.id(),\n      //   display: clinicalScenario.bodySite\n      // }\n      newRequest.supportingInfo[0] = {\n        reference: 'Observation/' + Random.id(),\n        display: clinicalScenario.description\n      }\n      newRequest.reasonCode[0] = {\n        text: clinicalScenario.description\n      }\n\n      // ordering physician\n      newRequest.requestor = Random.choice(agents)\n\n      // date/time\n      newRequest.authoredOn = moment().subtract(index, 'days').toDate()\n      newRequest.occurenceDateTime = moment().subtract(index, 'days').toDate()\n      \n      // encounter\n      newRequest.encounter.reference = 'Encounter/' + Random.id();\n\n      newRequest.subject.reference = 'Patient/' + Random.id();\n      newRequest.subject.display = faker.name.findName();\n \n      process.env.NODE_ENV === \"logging\" && console.log('Assembled a new service request: ', newRequest)\n    \n      newOrders.push(newRequest);      \n    }\n\n    let requestId = ''\n    if(Meteor.isClient){\n\n      newOrders.forEach(function(order){\n        ServiceRequestSchema.clean(order);\n        console.log('Cleaned new service request: ', order);\n  \n        var serviceContext = ServiceRequestSchema.newContext();\n        serviceContext.validate(order)\n        console.log('Order is valid: ', serviceContext.isValid());\n        console.log('Validation Errors: ', serviceContext.validationErrors());\n  \n        // if(serviceContext.isValid()){}\n        if(Package['autopublish']){\n          requestId = ServiceRequests.insert(order)\n        } else {\n          requestId = ServiceRequests._collection.insert(order)\n        }\n        console.log('Added a service request to cursor:  ' + requestId);  \n      })\n    } \n  },\n  'ServiceRequest/removeById': function(serviceRequestId){\n    check(serviceRequestId, String);\n    if (process.env.NODE_ENV === 'test') {\n        console.log('-----------------------------------------');\n        console.log('Removing serviceRequest... ');\n        ServiceRequests.remove({_id: serviceRequestId});\n    } else {\n        console.log('This command can only be run in a test environment.');\n        console.log('Try setting NODE_ENV=test');\n    }\n  },\n  'ServiceRequest/drop': function(){\n    console.log('-----------------------------------------');\n    console.log('Dropping serviceRequests... ');\n    ServiceRequests.remove({});\n  },\n  'ServiceRequest/remove': function(id){\n    console.log('-----------------------------------------');\n    console.log('Dropping serviceRequests... ');\n    ServiceRequests.remove({_id: id});\n  }\n\n\n})\n\n\n","\n\nimport ServiceRequestsPage from './client/ServiceRequestsPage';\nimport ServiceRequestsDashboard from './client/ServiceRequestsDashboard';\nimport ServiceRequestsTable from './client/ServiceRequestsTable';\nimport ServiceRequestDetail from './client/ServiceRequestDetail';\nimport { ServiceRequest, ServiceRequests, ServiceRequestSchema } from './lib/ServiceRequests';\n\nvar DynamicRoutes = [{\n  'name': 'ServiceRequestsPage',\n  'path': '/service-requests',\n  'component': ServiceRequestsDashboard\n}];\n\n// var SidebarElements = [{\n//   'primaryText': 'ServiceRequests',\n//   'to': '/service-requests',\n//   'href': '/service-requests'\n// }];\nvar PractitionerSidebarElements = [{\n  'primaryText': 'ServiceRequests',\n  'to': '/service-requests',\n  'href': '/service-requests'\n}];\n\nexport { \n  SidebarElements, \n  PractitionerSidebarElements,\n  DynamicRoutes, \n\n  ServiceRequestsPage,\n  ServiceRequestsTable,\n  ServiceRequestDetail,\n  ServiceRequestsDashboard,\n\n  ServiceRequest,\n  ServiceRequests,\n  ServiceRequestSchema\n\n};\n\n\n","import { CardActions, CardText, DatePicker, Toggle, RaisedButton, TextField } from 'material-ui';\nimport { get, has, set } from 'lodash';\nimport { Row, Col } from 'react-bootstrap';\nimport moment from 'moment';\n\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\nimport PropTypes from 'prop-types';\n\nimport { Meteor } from 'meteor/meteor';\nimport { Session } from 'meteor/session';\n\n\nconst styles = {\n  block: {\n    maxWidth: 250,\n  },\n  toggle: {\n    marginTop: 16,\n  },\n  thumbOff: {\n    backgroundColor: '#ffcccc',\n  },\n  trackOff: {\n    backgroundColor: '#ff9d9d',\n  },\n  thumbSwitched: {\n    backgroundColor: 'red',\n  },\n  trackSwitched: {\n    backgroundColor: '#ff9d9d',\n  },\n  labelStyle: {\n    color: 'red',\n  },\n};\n\nexport class ServiceRequestDetail extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      serviceRequestId: false,\n      serviceRequest: {\n        resourceType : 'ServiceRequest',\n        name : [{\n          text : '',\n          prefix: [''],\n          family: [''],\n          given: [''],\n          suffix: [''],\n          resourceType : 'HumanName'\n        }],\n        active : true,\n        gender : \"\",\n        birthDate : '',\n        photo : [{\n          url: \"\"\n        }],\n        identifier: [{\n          use: 'usual',\n          type: {\n            coding: [\n              {\n                system: 'http://hl7.org/fhir/v2/0203',\n                code: 'MR'\n              }\n            ]\n          },\n          value: ''\n        }],\n        deceasedBoolean: false,\n        multipleBirthBoolean: false,\n        maritalStatus: {\n          text: ''\n        },\n        contact: [],\n        animal: {\n          species: {\n            text: 'Human'\n          }\n        },\n        communication: [{\n          language: {\n            text: 'English'\n          }\n        }],\n        careProvider: [{\n          display: '',\n          reference: ''\n        }],\n        managingOrganization: {\n          reference: '',\n          display: ''\n        }\n      },\n      form: {\n        prefix: '',\n        family: '',\n        given: '',\n        suffix: '',\n        identifier: '',\n        deceased: false,\n        multipleBirth: false,\n        maritalStatus: '',\n        species: '',\n        language: ''\n      }\n    }\n  }\n  dehydrateFhirResource(serviceRequest) {\n    let formData = Object.assign({}, this.state.form);\n\n    formData.prefix = get(serviceRequest, 'name[0].prefix[0]')\n    formData.family = get(serviceRequest, 'name[0].family[0]')\n    formData.given = get(serviceRequest, 'name[0].given[0]')\n    formData.suffix = get(serviceRequest, 'name[0].suffix[0]')\n    formData.identifier = get(serviceRequest, 'identifier[0].value')\n    formData.deceased = get(serviceRequest, 'deceasedBoolean')\n    formData.gender = get(serviceRequest, 'gender')\n    formData.multipleBirth = get(serviceRequest, 'multipleBirthBoolean')\n    formData.maritalStatus = get(serviceRequest, 'maritalStatus.text')\n    formData.species = get(serviceRequest, 'animal.species.text')\n    formData.language = get(serviceRequest, 'communication[0].language.text')\n    formData.birthDate = moment(serviceRequest.birthDate).format(\"YYYY-MM-DD\")\n\n    return formData;\n  }\n  shouldComponentUpdate(nextProps){\n    process.env.NODE_ENV === \"test\" && console.log('ServiceRequestDetail.shouldComponentUpdate()', nextProps, this.state)\n    let shouldUpdate = true;\n\n    // both false; don't take any more updates\n    if(nextProps.serviceRequest === this.state.serviceRequest){\n      shouldUpdate = false;\n    }\n\n    // received an serviceRequest from the table; okay lets update again\n    if(nextProps.serviceRequestId !== this.state.serviceRequestId){\n      this.setState({serviceRequestId: nextProps.serviceRequestId})\n      \n      if(nextProps.serviceRequest){\n        this.setState({serviceRequest: nextProps.serviceRequest})     \n        this.setState({form: this.dehydrateFhirResource(nextProps.serviceRequest)})       \n      }\n      shouldUpdate = true;\n    }\n \n    return shouldUpdate;\n  }\n  getMeteorData() {\n    let data = {\n      serviceRequestId: this.props.serviceRequestId,\n      serviceRequest: false,\n      form: this.state.form\n    };\n\n    if(this.props.serviceRequest){\n      data.serviceRequest = this.props.serviceRequest;\n    }\n    if(this.props.displayBirthdate){\n      data.displayBirthdate = this.props.displayBirthdate;\n    }\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"ServiceRequestDetail[data]\", data);\n    return data;\n  }\n\n  render() {\n    if(process.env.NODE_ENV === \"test\") console.log('ServiceRequestDetail.render()', this.state)\n    let formData = this.state.form;\n\n    return (\n      <div id={this.props.id} className=\"serviceRequestDetail\">\n        <CardText>\n          <Row>\n            <Col md={4}>\n              <TextField\n                id='mrnInput'\n                ref='identifier'\n                name='identifier'\n                floatingLabelText='Identifier'\n                value={ get(formData, 'identifier', '')}\n                onChange={ this.changeState.bind(this, 'identifier')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={3} mdOffset={5}>\n              <br />\n              <Toggle\n                label=\"True/False\"\n                labelPosition=\"right\"\n                defaultToggled={false}\n                style={styles.toggle}\n              />\n            </Col>\n          </Row>\n          <Row>\n            <Col md={6}>\n              <TextField\n                id='givenInput'\n                ref='given'\n                name='given'\n                floatingLabelText='Title'\n                hintText='Jane'\n                value={ get(formData, 'given', '')}\n                onChange={ this.changeState.bind(this, 'given')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={6}>\n              <TextField\n                id='familyInput'\n                ref='family'\n                name='family'\n                floatingLabelText='Subtitle'\n                hintText='Doe'\n                value={ get(formData, 'family', '')}\n                onChange={ this.changeState.bind(this, 'family')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n\n            </Col>\n          </Row>\n\n        </CardText>\n        <CardActions>\n          { this.determineButtons(this.data.serviceRequestId) }\n        </CardActions>\n      </div>\n    );\n  }\n  renderDatePicker(displayDatePicker, birthDate){\n    if (displayDatePicker) {\n      console.log('renderDatePicker', displayDatePicker, birthDate, typeof birthDate)\n\n      let javascriptDate;\n      let momentDate;\n\n      if(typeof birthDate === \"string\"){\n        momentDate = moment(birthDate).toDate();\n      } else {\n        momentDate = birthDate;\n      }\n    \n      console.log('javascriptDate', javascriptDate)\n      console.log('momentDate', momentDate)\n\n      return (\n        <DatePicker \n          name='birthDate'\n          hintText=\"Birthdate\" \n          container=\"inline\" \n          mode=\"landscape\"\n          value={ momentDate ? momentDate : null}    \n          onChange={ this.changeState.bind(this, 'birthDate')}      \n          floatingLabelFixed={true}\n          fullWidth\n        />\n      );\n    }\n  }\n  determineButtons(serviceRequestId){\n    if (serviceRequestId) {\n      return (\n        <div>\n          <RaisedButton id='updateServiceRequestButton' className='updateServiceRequestButton' label=\"Save\" primary={true} onClick={this.handleSaveButton.bind(this)} style={{marginRight: '20px'}} />\n          <RaisedButton id='deleteServiceRequestButton' label=\"Delete\" onClick={this.handleDeleteButton.bind(this)} />\n        </div>\n      );\n    } else {\n      return(\n        <RaisedButton id='saveServiceRequestButton'  className='saveServiceRequestButton' label=\"Save\" primary={true} onClick={this.handleSaveButton.bind(this)} />\n      );\n    }\n  }\n\n  updateFormData(formData, field, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"ServiceRequestDetail.updateFormData\", formData, field, textValue);\n\n    switch (field) {\n      case \"prefix\":\n        set(formData, 'prefix', textValue)\n        break;\n      case \"family\":\n        set(formData, 'family', textValue)\n        break;\n      case \"given\":\n        set(formData, 'given', textValue)\n        break;        \n      case \"suffix\":\n        set(formData, 'suffix', textValue)\n        break;\n      case \"identifier\":\n        set(formData, 'identifier', textValue)\n        break;\n      case \"gender\":\n        set(formData, 'gender', textValue)\n        break;\n      case \"maritalStatus\":\n        set(formData, 'maritalStatus', textValue)\n        break;\n      case \"deceased\":\n        set(formData, 'deceased', textValue)\n        break;\n      case \"multipleBirth\":\n        set(formData, 'multipleBirth', textValue)\n        break;\n      case \"species\":\n        set(formData, 'species', textValue)\n        break;\n      case \"language\":\n        set(formData, 'language', textValue)\n        break;\n      case \"photo\":\n        set(formData, 'photo', textValue)\n        break;\n      case \"birthDate\":\n        set(formData, 'birthDate', textValue)\n        break;\n      default:\n    }\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"formData\", formData);\n    return formData;\n  }\n  updateServiceRequest(serviceRequestData, field, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"ServiceRequestDetail.updateServiceRequest\", serviceRequestData, field, textValue);\n\n    switch (field) {\n      case \"prefix\":\n        set(serviceRequestData, 'name[0].prefix[0]', textValue)\n        break;\n      case \"family\":\n        set(serviceRequestData, 'name[0].family[0]', textValue)\n        break;\n      case \"given\":\n        set(serviceRequestData, 'name[0].given[0]', textValue)\n        break;        \n      case \"suffix\":\n        set(serviceRequestData, 'name[0].suffix[0]', textValue)\n        break;\n      case \"identifier\":\n        set(serviceRequestData, 'identifier[0].value', textValue)\n        break;\n      case \"deceased\":\n        set(serviceRequestData, 'deceasedBoolean', textValue)\n        break;\n      case \"multipleBirth\":\n        set(serviceRequestData, 'multipleBirthBoolean', textValue)\n        break;\n      case \"gender\":\n        set(serviceRequestData, 'gender', textValue)\n        break;\n      case \"maritalStatus\":\n        set(serviceRequestData, 'maritalStatus.text', textValue)\n        break;\n      case \"species\":\n        set(serviceRequestData, 'animal.species.text', textValue)\n        break;\n      case \"language\":\n        set(serviceRequestData, 'communication[0].language.text', textValue)\n        break;  \n      case \"photo\":\n        set(serviceRequestData, 'photo[0].url', textValue)\n        break;\n      case \"birthDate\":\n        set(serviceRequestData, 'birthDate', textValue)\n        break;\n    }\n    return serviceRequestData;\n  }\n  changeState(field, event, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"   \");\n    if(process.env.NODE_ENV === \"test\") console.log(\"ServiceRequestDetail.changeState\", field, textValue);\n    if(process.env.NODE_ENV === \"test\") console.log(\"this.state\", this.state);\n\n    let formData = Object.assign({}, this.state.form);\n    let serviceRequestData = Object.assign({}, this.state.serviceRequest);\n\n    formData = this.updateFormData(formData, field, textValue);\n    serviceRequestData = this.updateServiceRequest(serviceRequestData, field, textValue);\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"serviceRequestData\", serviceRequestData);\n    if(process.env.NODE_ENV === \"test\") console.log(\"formData\", formData);\n\n    this.setState({serviceRequest: serviceRequestData})\n    this.setState({form: formData})\n  }\n\n\n  // this could be a mixin\n  handleSaveButton(){\n    if(process.env.NODE_ENV === \"test\") console.log('^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&&')\n    console.log('Saving a new ServiceRequest...', this.state)\n\n    let self = this;\n    let fhirServiceRequestData = Object.assign({}, this.state.serviceRequest);\n\n    if(process.env.NODE_ENV === \"test\") console.log('fhirServiceRequestData', fhirServiceRequestData);\n\n\n    let serviceRequestValidator = ServiceRequestSchema.newContext();\n    console.log('serviceRequestValidator', serviceRequestValidator)\n    serviceRequestValidator.validate(fhirServiceRequestData)\n\n    console.log('IsValid: ', serviceRequestValidator.isValid())\n    // console.log('ValidationErrors: ', serviceRequestValidator.validationErrors());\n\n    if (this.state.serviceRequestId) {\n      if(process.env.NODE_ENV === \"test\") console.log(\"Updating serviceRequest...\");\n\n      delete fhirServiceRequestData._id;\n\n      // not sure why we're having to respecify this; fix for a bug elsewhere\n      fhirServiceRequestData.resourceType = 'ServiceRequest';\n\n      ServiceRequests._collection.update({_id: this.state.serviceRequestId}, {$set: fhirServiceRequestData }, function(error, result){\n        if (error) {\n          if(process.env.NODE_ENV === \"test\") console.log(\"ServiceRequests.insert[error]\", error);\n          Bert.alert(error.reason, 'danger');\n        }\n        if (result) {\n          HipaaLogger.logEvent({eventType: \"update\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"ServiceRequests\", recordId: self.state.serviceRequestId});\n          Session.set('selectedServiceRequestId', false);\n          Session.set('serviceRequestPageTabIndex', 1);\n          Bert.alert('ServiceRequest added!', 'success');\n        }\n      });\n    } else {\n      if(process.env.NODE_ENV === \"test\") console.log(\"Creating a new serviceRequest...\", fhirServiceRequestData);\n\n      ServiceRequests._collection.insert(fhirServiceRequestData, function(error, result) {\n        if (error) {\n          if(process.env.NODE_ENV === \"test\")  console.log('ServiceRequests.insert[error]', error);\n          Bert.alert(error.reason, 'danger');\n        }\n        if (result) {\n          HipaaLogger.logEvent({eventType: \"create\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"ServiceRequests\", recordId: self.state.serviceRequestId});\n          Session.set('serviceRequestPageTabIndex', 1);\n          Session.set('selectedServiceRequestId', false);\n          Bert.alert('ServiceRequest added!', 'success');\n        }\n      });\n    }\n  }\n\n  handleCancelButton(){\n    Session.set('serviceRequestPageTabIndex', 1);\n  }\n\n  handleDeleteButton(){\n    let self = this;\n    ServiceRequests._collection.animalremove({_id: this.state.serviceRequestId}, function(error, result){\n      if (error) {\n        if(process.env.NODE_ENV === \"test\") console.log('ServiceRequests.insert[error]', error);\n        Bert.alert(error.reason, 'danger');\n      }\n      if (result) {\n        HipaaLogger.logEvent({eventType: \"delete\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"ServiceRequests\", recordId: self.state.serviceRequestId});\n        Session.set('serviceRequestPageTabIndex', 1);\n        Session.set('selectedServiceRequestId', false);\n        Bert.alert('ServiceRequest removed!', 'success');\n      }\n    });\n  }\n}\n\nServiceRequestDetail.propTypes = {\n  id: PropTypes.string,\n  fhirVersion: PropTypes.string,\n  serviceRequestId: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  serviceRequest: PropTypes.oneOfType([PropTypes.object, PropTypes.bool])\n};\nReactMixin(ServiceRequestDetail.prototype, ReactMeteorData);\nexport default ServiceRequestDetail;","import { Card, CardText, CardTitle } from 'material-ui';\nimport { Grid, Col, Row } from 'react-bootstrap';\nimport { GlassCard, FullPageCanvas, Glass } from 'meteor/clinical:glass-ui';\n\nimport ServiceRequestDetail from './ServiceRequestDetail';\nimport ServiceRequestTable from './ServiceRequestsTable';\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\nimport PropTypes from 'prop-types';\nimport Typography from '@material-ui/core/Typography';\n\nimport { ServicseRequests } from '../lib/ServiceRequests';\n\nimport { Meteor } from 'meteor/meteor';\nimport { Session } from 'meteor/session';\n\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\n\nimport { withStyles } from '@material-ui/core/styles';\n\nfunction TabContainer(props) {\n  return (\n    <Typography component=\"div\" style={{ padding: 8 * 3 }}>\n      {props.children}\n    </Typography>\n  );\n}\n\nTabContainer.propTypes = {\n  children: PropTypes.node.isRequired,\n};\n\nlet defaultServiceRequest = {\n  index: 0,\n  id: '',\n  username: '',\n  email: '',\n  given: '',\n  family: '',\n  gender: ''\n};\n\nSession.setDefault('serviceRequestFormData', defaultServiceRequest);\nSession.setDefault('serviceRequestSearchFilter', '');\nSession.setDefault('selectedServiceRequestId', false);\nSession.setDefault('fhirVersion', 'v1.0.2');\n\nexport class ServiceRequestsDashboard extends React.Component {\n  state = {\n    value: 0\n  }\n  getMeteorData() {\n    let data = {\n      style: {\n        opacity: Session.get('globalOpacity'),\n        tab: {\n          fontWeight: 100,\n          fontSize: '18px',\n          textAlign: 'left',\n          paddingTop: '8px'\n          //   borderBottom: '1px solid lightgray',\n        //   borderRight: 'none'\n        }\n      },\n      tabIndex: Session.get('serviceRequestPageTabIndex'),\n      serviceRequestSearchFilter: Session.get('serviceRequestSearchFilter'),\n      fhirVersion: Session.get('fhirVersion'),\n      selectedServiceRequestId: Session.get(\"selectedServiceRequestId\"),\n      selectedServiceRequest: false,\n      count: 0\n    };\n\n    data.count = ServiceRequests.find().count();\n    \n    if (Session.get('selectedServiceRequestId')){\n      data.selectedServiceRequest = ServiceRequests.findOne({_id: Session.get('selectedServiceRequestId')});\n    } else {\n      data.selectedServiceRequest = false;\n    }\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"ServiceRequestsDashboard[data]\", data);\n    return data;\n  }\n\n  handleTabChange(index){\n    Session.set('serviceRequestPageTabIndex', index);\n  }\n\n  handleChange = (event, value) => {\n    this.setState({ value });\n  }\n\n  onNewTab(){\n    Session.set('selectedServiceRequestId', false);\n    Session.set('serviceRequestUpsert', false);\n  }\n\n  render() {\n    console.log('React.version: ' + React.version);\n\n    const { classes } = this.props;\n    const { value } = this.state;\n\n    return (\n      <div id=\"ServiceRequestsDashboard\">\n        <FullPageCanvas>\n          <GlassCard height=\"auto\">\n            <CardTitle\n              title={this.data.count + \" Service Requests\"}\n            />\n            <CardText>\n              <Tabs value={value} onChange={this.handleChange}>\n                <Tab label=\"Worklist\" style={this.data.style.tab} />\n                <Tab label=\"New\" style={this.data.style.tab} />\n                <Tab label=\"View\" style={this.data.style.tab} />\n              </Tabs>\n\n              {value === 0 && <TabContainer>\n                <ServiceRequestTable \n                  showBarcodes={true} \n                  showAvatars={true} \n                  limit={50}\n                  noDataMessagePadding={100}\n                  />\n\n              </TabContainer>}\n              {value === 1 && <TabContainer>\n                <ServiceRequestDetail \n                  fhirVersion={ this.data.fhirVersion }\n                  id='newServiceRequest' />\n\n              </TabContainer>}\n              {value === 2 && <TabContainer>\n                <ServiceRequestDetail \n                  id='serviceRequestDetails' \n                  fhirVersion={ this.data.fhirVersion }\n                  serviceRequest={ this.data.selectedServiceRequest }\n                  serviceRequestId={ this.data.selectedServiceRequestId }\n                />\n\n              </TabContainer>}\n            </CardText>\n          </GlassCard>\n\n        </FullPageCanvas>\n      </div>\n    );\n  }\n}\n\n\nServiceRequestsDashboard.propTypes = {};\nReactMixin(ServiceRequestsDashboard.prototype, ReactMeteorData);\nexport default ServiceRequestsDashboard;","import { Card, CardText, CardTitle } from 'material-ui';\nimport { Grid, Col, Row } from 'react-bootstrap';\n\nimport ServiceRequestDetail from './ServiceRequestDetail';\nimport ServiceRequestTable from './ServiceRequestsTable';\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\nimport PropTypes from 'prop-types';\nimport Typography from '@material-ui/core/Typography';\n\nimport { ServiceRequests } from '../lib/ServiceRequests';\n\nimport { Meteor } from 'meteor/meteor';\nimport { Session } from 'meteor/session';\n\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\n\nimport { withStyles } from '@material-ui/core/styles';\n\nfunction TabContainer(props) {\n  return (\n    <Typography component=\"div\" style={{ padding: 8 * 3 }}>\n      {props.children}\n    </Typography>\n  );\n}\n\nTabContainer.propTypes = {\n  children: PropTypes.node.isRequired,\n};\n\nlet defaultServiceRequest = {\n  index: 0,\n  id: '',\n  username: '',\n  email: '',\n  given: '',\n  family: '',\n  gender: ''\n};\n\nSession.setDefault('serviceRequestFormData', defaultServiceRequest);\nSession.setDefault('serviceRequestSearchFilter', '');\nSession.setDefault('selectedServiceRequestId', false);\nSession.setDefault('fhirVersion', 'v1.0.2');\n\nexport class ServiceRequestsPage extends React.Component {\n  state = {\n    value: 0\n  }\n  getMeteorData() {\n    let data = {\n      style: {\n        opacity: Session.get('globalOpacity'),\n        tab: {\n          fontWeight: 100,\n          fontSize: '18px',\n          textAlign: 'left',\n          paddingTop: '8px'\n          //   borderBottom: '1px solid lightgray',\n        //   borderRight: 'none'\n        }\n      },\n      // tabIndex: Session.get('serviceRequestPageTabIndex'),\n      serviceRequestSearchFilter: Session.get('serviceRequestSearchFilter'),\n      fhirVersion: Session.get('fhirVersion'),\n      selectedServiceRequestId: Session.get(\"selectedServiceRequestId\"),\n      selectedServiceRequest: false,\n      count: 0\n    };\n\n    data.count = ServiceRequests.find().count();\n    \n    if (Session.get('selectedServiceRequestId')){\n      data.selectedServiceRequest = ServiceRequests.findOne({_id: Session.get('selectedServiceRequestId')});\n    } else {\n      data.selectedServiceRequest = false;\n    }\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"ServiceRequestsPage[data]\", data);\n    return data;\n  }\n\n  // handleTabChange(index){\n  //   Session.set('serviceRequestPageTabIndex', index);\n  // }\n\n  handleChange = (event, value) => {\n    this.setState({ value });\n  }\n\n  onNewTab(){\n    Session.set('selectedServiceRequestId', false);\n    Session.set('serviceRequestUpsert', false);\n  }\n\n  render() {\n    console.log('React.version: ' + React.version);\n\n    const { classes } = this.props;\n    const { value } = this.state;\n\n    return (\n      <div id=\"ServiceRequestsPage\">\n          <Card height=\"auto\">\n            <CardTitle\n              title={this.data.count + \" Service Requests\"}\n            />\n            <CardText>\n              <Tabs value={value} onChange={this.handleChange}>\n                <Tab label=\"Worklist\" style={this.data.style.tab} />\n                <Tab label=\"New\" style={this.data.style.tab} />\n                <Tab label=\"View\" style={this.data.style.tab} />\n              </Tabs>\n\n              {value === 0 && <TabContainer>\n                <ServiceRequestTable \n                  showBarcodes={true} \n                  showAvatars={true} \n                  limit={50}\n                  noDataMessagePadding={100}\n                  />\n\n              </TabContainer>}\n              {value === 1 && <TabContainer>\n                <ServiceRequestDetail \n                  fhirVersion={ this.data.fhirVersion }\n                  id='newServiceRequest' />\n\n              </TabContainer>}\n              {value === 2 && <TabContainer>\n                <ServiceRequestDetail \n                  id='serviceRequestDetails' \n                  fhirVersion={ this.data.fhirVersion }\n                  serviceRequest={ this.data.selectedServiceRequest }\n                  serviceRequestId={ this.data.selectedServiceRequestId }\n                />\n\n              </TabContainer>}\n\n              {/* <Tabs\n                value={this.state.value}\n                indicatorColor=\"primary\"\n                textColor=\"primary\"\n                onChange={this.handleChange}\n              >\n                <Tab className=\"newServiceRequestTab\" label='New' style={this.data.style.tab} onActive={ this.onNewTab } value={0}>\n                 </Tab>\n                 <Tab className=\"serviceRequestListTab\" label='ServiceRequests' onActive={this.handleActive} style={this.data.style.tab} value={1}>\n                 </Tab>\n                 <Tab className=\"serviceRequestDetailTab\" label='Detail' onActive={this.handleActive} style={this.data.style.tab} value={2}>\n                 </Tab>\n              </Tabs> */}\n\n              {/* <Tabs id='serviceRequestsPageTabs' default value={this.data.tabIndex} onChange={this.handleTabChange} initialSelectedIndex={1}>\n                 <Tab className=\"newServiceRequestTab\" label='New' style={this.data.style.tab} onActive={ this.onNewTab } value={0}>\n                   <ServiceRequestDetail \n                      fhirVersion={ this.data.fhirVersion }\n                      id='newServiceRequest' />\n                 </Tab>\n                 <Tab className=\"serviceRequestListTab\" label='ServiceRequests' onActive={this.handleActive} style={this.data.style.tab} value={1}>\n                   <ServiceRequestTable \n                      showBarcodes={true} \n                      showAvatars={true} \n                      noDataMessagePadding={100}\n                      />\n                 </Tab>\n                 <Tab className=\"serviceRequestDetailTab\" label='Detail' onActive={this.handleActive} style={this.data.style.tab} value={2}>\n                   <ServiceRequestDetail \n                      id='serviceRequestDetails' \n                      fhirVersion={ this.data.fhirVersion }\n                      serviceRequest={ this.data.selectedServiceRequest }\n                      serviceRequestId={ this.data.selectedServiceRequestId }\n                    />\n                 </Tab>\n             </Tabs> */}\n\n\n            </CardText>\n          </Card>\n      </div>\n    );\n  }\n}\n\n\nServiceRequestsPage.propTypes = {};\nReactMixin(ServiceRequestsPage.prototype, ReactMeteorData);\nexport default ServiceRequestsPage;","\n\nimport { FlatButton, RaisedButton } from 'material-ui';\nimport { HTTP } from 'meteor/http';\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\nimport { Table } from 'react-bootstrap';\nimport { Session } from 'meteor/session';\nimport { has, get } from 'lodash';\nimport PropTypes from 'prop-types';\nimport { Grid, Col, Row } from 'react-bootstrap';\nimport { browserHistory } from 'react-router';\n\nimport { GoSync } from 'react-icons/go'\nimport { GoCloudDownload } from 'react-icons/go'\nimport { GoCloudUpload } from 'react-icons/go'\nimport { GoFilePdf } from 'react-icons/go'\nimport { GoFlame } from 'react-icons/go'\nimport { GoPulse } from 'react-icons/go'\n// import { GoGraph } from 'react-icons/go'\nimport { GoLink } from 'react-icons/go'\nimport { GoMail } from 'react-icons/go'\n// import { GoLock } from 'react-icons/go'\nimport { GoStar } from 'react-icons/go'\nimport { GoTag } from 'react-icons/go'\nimport { GoClippy } from 'react-icons/go'\n// import { GoCreditCard } from 'react-icons/go'\n// import { GoComment } from 'react-icons/go'\nimport { GoCommentDiscussion } from 'react-icons/go'\nimport { GoTrashcan } from 'react-icons/go'\n\n\n\n\n\nflattenServiceRequest = function(newOrder){\n  let result = {\n    _id: newOrder._id,\n    id: newOrder.id,\n    identifier: '',\n    modality: '',\n    category: '',\n    subject: '',\n    requestor: '',\n    occurenceDateTime: '',\n    authoredOn: '',\n    date: '',\n    active: true\n  };\n\n  result.identifier = get(newOrder, 'identifier[0].value', '');\n\n  result.modality = get(newOrder, 'code.text', '');\n  result.category = get(newOrder, 'category[0].text', '');\n\n  result.subject = get(newOrder, 'subject.display', '');\n  result.requestor = get(newOrder, 'requestor.display', '');\n  \n  if(newOrder.date){\n    result.date = moment(newOrder.date).format(\"YYYY-MM-DD\")\n  }\n\n  result.occurenceDateTime = moment(newOrder.occurenceDateTime).format(\"YYYY-MM-DD\")\n  result.authoredOn = moment(newOrder.authoredOn).format(\"YYYY-MM-DD\")  \n  \n  return result;\n}\n\n\nSession.setDefault('selectedSortIndex', 'identifier');\nSession.setDefault('sortAscending', true);\n\nexport class ServiceRequestsTable extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n  getMeteorData() {\n    let defaultIconStyle = {\n      marginRight: '5px',\n      fontSize: '150%',\n      verticalAlign: 'middle',\n      color: 'lightgray'\n    }\n\n    let data = {\n      style: {\n        hideOnPhone: {\n          visibility: 'visible',\n          display: 'table'\n        },\n        cellHideOnPhone: {\n          visibility: 'visible',\n          display: 'table',\n          paddingTop: '16px',\n          maxWidth: '120px'\n        },\n        cell: {\n          paddingTop: '16px'\n        },\n        avatar: {\n          // color: rgb(255, 255, 255);\n          backgroundColor: 'rgb(188, 188, 188)',\n          userSelect: 'none',\n          borderRadius: '2px',\n          height: '40px',\n          width: '40px'\n        },\n        actionIcon: {\n          marginRight: '5px',\n          fontSize: '150%',\n          verticalAlign: 'middle'\n        },\n        syncIcon: {\n          marginRight: '5px',\n          fontSize: '150%',\n          verticalAlign: 'middle',\n          color: 'gray'    \n        },\n        pdfIcon: {\n          marginRight: '5px',\n          fontSize: '150%',\n          verticalAlign: 'middle',\n          color: 'gray'    \n        },\n        fhirIcon: {\n          marginRight: '5px',\n          fontSize: '150%',\n          verticalAlign: 'middle',\n          color: 'gray'    \n        },\n        pulseIcon: {\n          marginRight: '5px',\n          fontSize: '150%',\n          verticalAlign: 'middle',\n          color: 'gray'    \n        },\n        linkIcon: {\n          marginRight: '5px',\n          fontSize: '150%',\n          verticalAlign: 'middle',\n          color: 'gray'    \n        },\n        mailIcon: {\n          marginRight: '5px',\n          fontSize: '150%',\n          verticalAlign: 'middle',\n          color: 'gray'    \n        },\n        tagIcon: {\n          marginRight: '5px',\n          fontSize: '150%',\n          verticalAlign: 'middle',\n          color: 'gray'    \n        },\n        clippyIcon: {\n          marginRight: '5px',\n          fontSize: '150%',\n          verticalAlign: 'middle',\n          color: 'gray'    \n        },\n        discussionIcon: {\n          marginRight: '5px',\n          fontSize: '150%',\n          verticalAlign: 'middle',\n          color: 'gray'    \n        },\n        trashcanIcon: {\n          marginRight: '5px',\n          fontSize: '150%',\n          verticalAlign: 'middle',\n          color: 'black'    \n        }\n      },\n      selected: [],\n      serviceRequests: [],\n      count: 0\n    };\n\n    data.style.syncIcon.color = 'lightgray';\n    data.style.pdfIcon.color = 'lightgray';\n    data.style.fhirIcon.color = 'black';\n    data.style.pulseIcon.color = 'lightgray';\n    data.style.linkIcon.color = 'lightgray';\n    data.style.mailIcon.color = 'lightgray';\n    data.style.tagIcon.color = 'lightgray';\n    data.style.clippyIcon.color = 'lightgray';\n    data.style.discussionIcon.color = 'lightgray';\n    data.style.trashcanIcon.color = 'black';\n\n\n\n\n    let query = {};\n    let options = {};\n    let sort = {};\n\n    // number of items in the table should be set globally\n    if (get(Meteor, 'settings.public.defaults.paginationLimit')) {\n      options.limit = get(Meteor, 'settings.public.defaults.paginationLimit');\n    }\n    // but can be over-ridden by props being more explicit\n    if(this.props.limit){\n      options.limit = this.props.limit;      \n    }\n\n\n    if(this.props.sort){\n      if(Session.get('sortAscending')){\n        sort[this.props.sort] = 1;\n      } else {\n        sort[this.props.sort] = -1;\n      }\n      options.sort = sort;\n    } else {\n      if(Session.get('sortAscending')){\n        sort[Session.get('selectedSortIndex')] = 1;\n      } else {\n        sort[Session.get('selectedSortIndex')] = -1;\n      }\n      options.sort = sort;\n    }\n\n    if(this.props.data){\n      if(this.props.data.length > 0){              \n        this.props.data.forEach(function(serviceRequest){\n          data.serviceRequests.push(flattenServiceRequest(serviceRequest));\n        });  \n      }\n    } else {\n      if(this.props.query){\n        query = this.props.query;\n\n        if(Session.get('selectedSortIndex')){\n          query[Session.get('selectedSortIndex')] = -1\n        }\n      }\n      data.serviceRequests = ServiceRequests.find(query, options).map(function(serviceRequest){\n        return flattenServiceRequest(serviceRequest);\n      });\n    }\n\n\n    if (Session.get('appWidth') < 768) {\n      data.style.hideOnPhone.visibility = 'hidden';\n      data.style.hideOnPhone.display = 'none';\n      data.style.cellHideOnPhone.visibility = 'hidden';\n      data.style.cellHideOnPhone.display = 'none';\n    } else {\n      data.style.hideOnPhone.visibility = 'visible';\n      data.style.hideOnPhone.display = 'table-cell';\n      data.style.cellHideOnPhone.visibility = 'visible';\n      data.style.cellHideOnPhone.display = 'table-cell';\n    }\n\n    // console.log(\"ServiceRequestsTable[data]\", data);\n    return data;\n  }\n  imgError(avatarId) {\n    this.refs[avatarId].src = Meteor.absoluteUrl() + 'noAvatar.png';\n  }\n  // rowClick(id){\n  //   Session.set('serviceRequestsUpsert', false);\n  //   Session.set('selectedServiceRequestId', id);\n  //   Session.set('serviceRequestPageTabIndex', 2);\n  // }\n  renderActionsHeader(){\n    if(!this.props.hideActions){\n      return (\n        <th className='actions'>Actions</th>\n      );\n    }\n  }\n  removeRecord(_id){\n    console.log('removeRecord', _id)\n    ServiceRequests._collection.remove({_id: _id})\n  }\n  renderActions(serviceRequest, avatarStyle){\n    if(!this.props.hideActions){\n      return (\n        <td className='actions'>\n          <GoSync style={this.data.style.syncIcon} />\n          <GoFilePdf style={this.data.style.pdfIcon} />\n          <GoFlame style={this.data.style.fhirIcon} />\n          <GoLink style={this.data.style.linkIcon} />\n          <GoMail style={this.data.style.mailIcon} />\n          <GoTag style={this.data.style.tagIcon} />\n          <GoTrashcan style={this.data.style.trashcanIcon} onClick={this.removeRecord.bind(this, serviceRequest._id)} />\n\n          {/* <GoPulse style={this.data.style.pulseIcon} /> */}\n          {/* <GoClippy style={this.data.style.clippyIcon} />\n          <GoCommentDiscussion style={this.data.style.discussionIcon} /> */}\n          {/* <GoCloudDownload style={this.data.style.actionIcon} />\n          <GoCloudUpload style={this.data.style.actionIcon} /> */}\n          {/* <GoGraph style={this.data.style.actionIcon} /> */}\n          {/* <GoLock style={this.data.style.actionIcon} /> */}\n          {/* <GoStar style={this.data.style.actionIcon} /> */}\n          {/* <GoCreditCard style={this.data.style.actionIcon} /> */}\n          {/* <GoComment style={this.data.style.actionIcon} /> */}\n\n          {/* <img src={serviceRequest.photo} ref={serviceRequest._id} onError={ this.imgError.bind(this, serviceRequest._id) } style={avatarStyle}/> */}\n        </td>\n      );\n    }    \n  }\n  renderSendButtonHeader(){\n    if (this.props.showSendButton === true) {\n      return (\n        <th className='sendButton' style={this.data.style.hideOnPhone}></th>\n      );\n    }\n  }\n  renderSendButton(serviceRequest, avatarStyle){\n    if (this.props.showSendButton === true) {\n      return (\n        <td className='sendButton' style={this.data.style.hideOnPhone}>\n          <FlatButton label=\"send\" onClick={this.onSend.bind('this', this.data.serviceRequests[i]._id)}/>\n        </td>\n      );\n    }\n  }\n\n  renderCategoryHeader(){\n    if (!this.props.hideCategory) {\n      return (\n        <th className=\"category\">Category</th>\n      );\n    }\n  }\n  renderCategory(serviceRequest ){\n    if (!this.props.hideCategory) {\n      return (\n      <td className='category' onClick={ this.selectServiceRequestRow.bind('this', serviceRequest._id)} style={this.data.style.cell}>\n        { serviceRequest.category }\n      </td>)\n    }\n  }\n  renderModalityHeader(){\n    if (!this.props.hideModality) {\n      return (\n        <th className=\"modality\">Modality</th>\n      );\n    }\n  }\n  renderModality(serviceRequest ){\n    if (!this.props.hideModality) {\n      return (\n        <td className='modality' onClick={ this.selectServiceRequestRow.bind('this', serviceRequest._id)} style={this.data.style.cell}>\n          { serviceRequest.modality }\n        </td>);\n    }\n  }\n  onSend(id){\n    let serviceRequest = ServiceRequests.findOne({_id: id});\n\n    console.log(\"ServiceRequestsTable.onSend()\", serviceRequest);\n\n    var httpEndpoint = \"http://localhost:8080\";\n    if (get(Meteor, 'settings.public.interfaces.default.channel.endpoint')) {\n      httpEndpoint = get(Meteor, 'settings.public.interfaces.default.channel.endpoint');\n    }\n    HTTP.post(httpEndpoint + '/ServiceRequest', {\n      data: serviceRequest\n    }, function(error, result){\n      if (error) {\n        console.log(\"error\", error);\n      }\n      if (result) {\n        console.log(\"result\", result);\n      }\n    });\n  }\n  selectServiceRequestRow(serviceRequestId){\n    console.log('selectServiceRequestRow', serviceRequestId);\n    Session.set('selectedServiceRequestId', serviceRequestId);\n\n    if(typeof onRowClick === \"function\"){\n      onRowClick(serviceRequestId);\n    } else {\n\n      let selectedServiceRequest = ServiceRequests.findOne(serviceRequestId);\n      console.log('selectedServiceRequest'. selectedServiceRequest)    \n  \n      Session.set('selectedServiceRequest', selectedServiceRequest);\n      if(get(selectedServiceRequest, '_id')){\n        Session.set('selectedServiceRequestId', get(selectedServiceRequest, '_id'));\n      }\n\n      // this basically requires this session variable to set to null or false\n      if(Session.equals('selectedPatientId', null) || Session.equals('selectedPatientId', undefined) || Session.equals('selectedPatientId', false)){\n        Session.set('selectedPatientId', selectedServiceRequest.getPatientId());\n      }\n\n      browserHistory.push(get(Meteor, 'settings.public.modules.fhir.ServiceRequests.defaultRoute', \"/\"));\n    }\n  }\n  sortColumn(columnName){\n    Session.set('selectedSortIndex', columnName)\n    Session.toggle('sortAscending');\n    console.log('sortColumn', columnName);\n  }\n  fetchData(){\n    console.log('Fetching data...')\n    Meteor.call('ServiceRequests/initialize', 50)\n  }\n  render () {\n    let tableRows = [];\n    let footer;\n    let self = this;\n\n    var importStyle = {\n      textAlign: 'center',\n      position: 'relative',\n      paddingTop: '100px',\n      paddingBottom: '100px'\n      // top: ((Session.get('appHeight') - 128 ) * 0.5) - 120 + 'px'\n    }\n\n\n    if(this.data.serviceRequests.length === 0){\n      footer = <div style={{fontSize: '14px'}}>\n        <Row style={importStyle}>\n          <h1 style={{fontWeight: '200', fontSize: '18px'}}>No orders or service requests found.</h1>\n          <RaisedButton label=\"Sync\" onClick={this.fetchData } primary={true} />\n        </Row>\n      </div>\n    } else {\n      for (var i = 0; i < this.data.serviceRequests.length; i++) {\n        tableRows.push(\n          <tr key={i} className=\"serviceRequestRow\" style={{cursor: \"pointer\", fontSize: '14px'}} onClick={this.selectServiceRequestRow.bind(this, this.data.serviceRequests[i].id, self.props.onRowClick )} >\n  \n            { this.renderActions(this.data.serviceRequests[i], this.data.style.avatar) }\n  \n            <td className='identifier' style={this.data.style.cellHideOnPhone}>{this.data.serviceRequests[i].identifier}</td>\n            { this.renderModality(this.data.serviceRequests[i]) }\n            { this.renderCategory(this.data.serviceRequests[i]) }\n\n            {/* <td className='modality' onClick={ this.selectServiceRequestRow.bind('this', this.data.serviceRequests[i]._id)} style={this.data.style.cell}>{this.data.serviceRequests[i].modality }</td>\n            <td className='category' onClick={ this.selectServiceRequestRow.bind('this', this.data.serviceRequests[i]._id)} style={this.data.style.cell}>{this.data.serviceRequests[i].category }</td> */}\n            <td className='subject' onClick={ this.selectServiceRequestRow.bind('this', this.data.serviceRequests[i]._id)} style={this.data.style.cell}>{this.data.serviceRequests[i].subject }</td>\n            <td className='requestor' onClick={ this.selectServiceRequestRow.bind('this', this.data.serviceRequests[i]._id)} style={this.data.style.cell}>{this.data.serviceRequests[i].requestor }</td>\n            <td className='occurenceDateTime' onClick={ this.selectServiceRequestRow.bind('this', this.data.serviceRequests[i]._id)} style={{minWidth: '100px', paddingTop: '16px'}}>{this.data.serviceRequests[i].occurenceDateTime }</td>\n            <td className='authoredOn' onClick={ this.selectServiceRequestRow.bind('this', this.data.serviceRequests[i]._id)} style={{minWidth: '100px', paddingTop: '16px'}}>{this.data.serviceRequests[i].authoredOn }</td>\n\n              { this.renderSendButton(this.data.serviceRequests[i], this.data.style.avatar) }\n          </tr>\n        );\n      }\n    }\n    \n\n\n    return(\n      <div>\n        <Table id='serviceRequestsTable' hover >\n          <thead style={{cursor: 'pointer'}}> \n            <tr style={{paddingLeft: '40px', paddingRight: '40px', fontSize: '14px'}}>\n              { this.renderActionsHeader() }\n\n              <th className='identifier' onClick={this.sortColumn.bind(this, 'identifier')} style={this.data.style.hideOnPhone}>Identifier</th>\n              { this.renderModalityHeader() }\n              { this.renderCategoryHeader() }\n              {/* <th className='modality' onClick={this.sortColumn.bind(this, 'code.text')}>Modality</th>\n              <th className='category' onClick={this.sortColumn.bind(this, 'category')}>Category</th> */}\n              <th className='subject' onClick={this.sortColumn.bind(this, 'subject.display')}>Subject</th>\n              <th className='requestor' onClick={this.sortColumn.bind(this, 'requestor')}>Requestor</th>\n              <th className='occurenceDateTime' onClick={this.sortColumn.bind(this, 'occurenceDateTime')} style={{minWidth: '100px'}}>OccurenceDateTime</th>\n              <th className='authoredOn' onClick={this.sortColumn.bind(this, 'authoredOn')} style={{minWidth: '100px'}}>AuthoredOn</th>\n              \n              { this.renderSendButtonHeader() }\n            </tr>\n          </thead>\n          <tbody>\n            { tableRows }\n          </tbody>\n        </Table>\n        { footer }\n      </div>\n    );\n  }\n}\n\nServiceRequestsTable.propTypes = {\n  id: PropTypes.string,\n  fhirVersion: PropTypes.string,\n  query: PropTypes.object,\n  showSendButton: PropTypes.bool,\n  noDataMessagePadding: PropTypes.number,\n  onRowClick: PropTypes.func\n};\n\nReactMixin(ServiceRequestsTable.prototype, ReactMeteorData);\nexport default ServiceRequestsTable;"]}