{"version":3,"sources":["meteor://💻app/packages/clinical:hl7-resource-consent/lib/Consents.js","meteor://💻app/packages/clinical:hl7-resource-consent/index.jsx","meteor://💻app/packages/clinical:hl7-resource-consent/client/ConsentDetail.jsx","meteor://💻app/packages/clinical:hl7-resource-consent/client/ConsentTable.jsx","meteor://💻app/packages/clinical:hl7-resource-consent/client/ConsentsPage.jsx"],"names":["module","export","Consent","Consents","ConsentSchema","SimpleSchema","link","v","BaseModel","Mongo","get","uniq","uniqBy","extend","prototype","_collection","Package","Collection","connection","_transform","document","type","String","defaultValue","optional","Array","IdentifierSchema","Code","CodeableConceptSchema","ReferenceSchema","blackbox","PeriodSchema","Date","Object","AttachmentSchema","CodingSchema","BaseSchema","DomainResourceSchema","attachSchema","toFhir","console","log","EJSON","stringify","name","fetchBundle","query","parameters","callback","process","env","TRACE","consentArray","find","map","consent","id","_id","_document","result","Bundle","generate","toMongo","originalConsent","mongoRecord","identifier","forEach","period","start","startArray","split","end","endArray","toStu3","consentJson","birthDate","deceasedBoolean","family","text","given","prepForUpdate","resourceType","telecom","address","contact","prepForFhirTransfer","moment","format","readProfile","results","consentsObject","Meteor","user","keys","key","push","readProfileIntoCollection","insert","parseIntoUmaScopeRequest","parseIntoScopeRequest","capitalize","toUpperCase","generateScopeRequest","vendorDialect","urlEncoded","scopeArray","fetch","length","scope","encodeURI","AdminSidebarElements","SidebarElements","DynamicRoutes","ConsentsPage","ConsentTable","ConsentDetail","CardActions","CardText","Checkbox","RaisedButton","SelectField","MenuItem","TextField","Col","Row","Table","React","ReactMeteorData","ReactMixin","PropTypes","Session","set","props","state","consentId","coding","system","code","value","status","category","patient","reference","display","dateTime","consentingParty","organization","except","version","form","patientDisplay","organizationDisplay","periodStart","periodEnd","selectedConsentCategory","dehydrateFhirResource","formData","assign","class","shouldComponentUpdate","nextProps","NODE_ENV","shouldUpdate","setState","getMeteorData","data","changeSelectedCategory","event","render","renderText","textAlign","cursor","width","paddingTop","minWidth","bind","changeState","determineButtons","handleSaveButton","marginRight","handleDeleteButton","updateFormData","field","textValue","updateConsent","consentData","self","fhirConsentData","consentValidator","newContext","validate","isValid","validationErrors","update","$set","filter","removeEmptyStrings","error","Bert","alert","reason","HipaaLogger","logEvent","eventType","userId","userName","fullName","collectionName","recordId","handleCancelButton","remove","Component","propTypes","string","fhirVersion","oneOfType","bool","object","exportDefault","FlatButton","Avatar","Tab","Tabs","HTTP","has","TableNoData","setDefault","style","hideOnPhone","visibility","cellHideOnPhone","cell","selected","consents","options","sort","limit","patientReference","policyRule","exceptType","exceptAction","exceptClass","sourceReference","exceptions","exception","rowClick","handleRevoke","renderSelected","hideSelected","renderSelectedHeader","renderId","hideId","onIdentifierClick","renderIdHeader","renderIdentifier","hideIdentifier","renderIdentifierHeader","identiferClassName","disableBarcodes","renderType","hideType","renderTypeHeader","renderClass","hideClass","renderClassHeader","renderCategory","hideCategory","renderCategoryHeader","renderDate","hideDateTime","renderDateHeader","renderPeriodStart","hidePeriodStart","renderPeriodStartHeader","renderPeriodEnd","hidePeriodEnd","renderPeriodEndHeader","renderSource","hideSourceReference","getDocumentReference","renderSourceHeader","marginLeft","renderRevoke","hideRevoke","renderRevokeHeader","onPatientClick","tableRows","footer","noDataMessage","noDataMessagePadding","i","hideVerify","number","selectedDocumentSource","func","CardTitle","Dialog","GlassCard","Glass","FullPageCanvas","defaultConsent","index","username","email","gender","searchForm","givenName","familyName","searchQuery","componentDidMount","opacity","tab","borderBottom","borderRight","tabIndex","consentSearchFilter","currentConsent","dialogOpen","selectedConsentId","selectedConsent","consentSearchQuery","findOne","blur","appbar","darkroom","handleTabChange","onNewTab","handleClose","handleSearch","actions","handleActive","updateSearch"],"mappings":"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","file":"/packages/clinical_hl7-resource-consent.js","sourcesContent":["import SimpleSchema from 'simpl-schema';\n\nimport { BaseModel } from 'meteor/clinical:base-model';\nimport { Mongo } from 'meteor/mongo';\n\nimport { get, uniq, uniqBy } from 'lodash';\n\n// Create the object using our BaseModel\nConsent = BaseModel.extend();\n\n\n// Assign a collection so the object knows how to perform CRUD operations\nConsent.prototype._collection = Consents;\n\n// We need to create server and client data cursors, based on which type of \n// publication strategy we're using\nif(typeof Consents === 'undefined'){\n  if(Package['clinical:autopublish']){\n    Consents = new Mongo.Collection('Consents');\n  } else if(Package['clinical:desktop-publish']){\n    Consents = new Mongo.Collection('Consents');\n  } else {\n    // A null connection disables DDP\n    Consents = new Mongo.Collection('Consents', {connection: null});\n  }\n}\n\n\n// Add the transform to the collection since Meteor.users is pre-defined by the accounts package\nConsents._transform = function (document) {\n  return new Consent(document);\n};\n\n\nConsentSchema = new SimpleSchema({\n  \"resourceType\" : {\n    type: String,\n    defaultValue: \"Consent\"\n  },\n  \"identifier\" : {\n    optional: true,\n    type:  Array\n    },\n  \"identifier.$\" : {\n    optional: true,\n    type:  IdentifierSchema \n    },\n  \"status\" : {\n    optional: true,\n    type: Code\n  }, \n  \"category\" : {\n    optional: true,\n    type: Array\n  }, \n  \"category.$\" : {\n    optional: true,\n    type: CodeableConceptSchema \n  }, \n  \"patient\" : { \n    optional: true,\n    type: ReferenceSchema\n  }, \n  \"period\" : { \n    optional: true,\n    blackbox: true,\n    type: PeriodSchema \n  }, \n  \"dateTime\" : {\n    optional: true,\n    type: Date\n  }, \n  \"consentingParty\" : {\n    optional: true,\n    type: Array\n  }, \n  \"consentingParty.$\" : {\n    optional: true,\n    type: ReferenceSchema \n  }, \n  \"actor\" : {\n    optional: true,\n    type: Array \n  }, \n  \"actor.$\" : {\n    optional: true,\n    type: Object \n  }, \n\n  \"actor.$.role\" : {\n    optional: true,\n    type: CodeableConceptSchema \n  }, \n  \"actor.$.reference\" : {\n    optional: true,\n    type: ReferenceSchema \n  },\n  \"action\" : {\n    optional: true,\n    type: Array\n  }, \n  \"action.$\" : {\n    optional: true,\n    type: CodeableConceptSchema \n  }, \n  \"organization\" : {\n    optional: true,\n    type: Array\n  },   \n  \"organization.$\" : {\n    optional: true,\n    type: ReferenceSchema\n  },   \n  \"sourceAttachment\" : {\n    optional: true,\n    type: AttachmentSchema \n  },\n  \"sourceIdentifier\" : {\n    optional: true,\n    type: IdentifierSchema \n  },\n  \"sourceReference\" : {\n    optional: true,\n    type: ReferenceSchema \n  },\n\n\n  \"policy\" : {\n    optional: true,\n    type: Array\n  }, \n  \"policy.$\" : {\n    optional: true,\n    type: Object\n  },   \n\n  \"policy.$.authority\" : {\n    optional: true,\n    type: String\n  }, \n  \"policy.$.uri\" : {\n    optional: true,\n    type: String\n  }, \n  \"policyRule\" : {\n    optional: true,\n    type: String\n  }, \n  \"securityLabel\" : {\n    optional: true,\n    type: Array\n  }, \n  \"securityLabel.$\" : {\n    optional: true,\n    type: CodingSchema\n  }, \n  \"purpose\" : {\n    optional: true,\n    type: Array\n  }, \n  \"purpose.$\" : {\n    optional: true,\n    type: CodingSchema\n  }, \n  \"dataPeriod\" : {\n    optional: true,\n    type: PeriodSchema \n  }, \n\n  \"data\" : {\n    optional: true,\n    type: Array\n  }, \n  \"data.$\" : {\n    optional: true,\n    type: Object\n  }, \n\n  \"data.$.meaning\" : {\n    optional: true,\n    type: Code\n  }, \n  \"data.$.reference\" : {\n    optional: true,\n    type: ReferenceSchema \n  },\n\n\n  \"except\" : {\n    optional: true,\n    type: Array\n  }, \n  \"except.$\" : {\n    optional: true,\n    type: Object\n  }, \n\n  \"except.$.type\" : {\n    optional: true,\n    type: Code\n  }, \n  \"except.$.period\" : {\n    optional: true,\n    type: PeriodSchema \n  }, \n\n\n  \"except.$.actor\" : {\n    optional: true,\n    type: Array \n  }, \n  \"except.$.actor.$\" : {\n    optional: true,\n    type: Object \n  }, \n\n  \"except.$.actor.$.role\" : {\n    optional: true,\n    type: CodeableConceptSchema \n  }, \n  \"except.$.actor.$.reference\" : {\n    optional: true,\n    type: ReferenceSchema \n  },\n  \"except.$.action\" : {\n    optional: true,\n    type: Array\n  }, \n  \"except.$.action.$\" : {\n    optional: true,\n    type:  CodeableConceptSchema \n  }, \n  \"except.$.securityLabel\" : {\n    optional: true,\n    type: Array\n  }, \n  \"except.$.securityLabel.$\" : {\n    optional: true,\n    type: CodingSchema\n  }, \n  \"except.$.purpose\" : {\n    optional: true,\n    type: Array\n  }, \n  \"except.$.purpose.$\" : {\n    optional: true,\n    type: CodingSchema\n  }, \n\n  \"except.$.class\" : {\n    optional: true,\n    type: Array\n  }, \n  \"except.$.class.$\" : {\n    optional: true,\n    type: CodingSchema \n  }, \n\n  \"except.$.code\" : {\n    optional: true,\n    type: Array\n  }, \n  \"except.$.code.$\" : {\n    optional: true,\n    type: CodingSchema\n  }, \n  \"except.$.dataPeriod\" : {\n    optional: true,\n    type: PeriodSchema \n  }, \n\n\n  \"except.$.data\" : {\n    optional: true,\n    type: Array\n  }, \n  \"except.$.data.$\" : {\n    optional: true,\n    type: Object\n  }, \n\n  \"except.$.data.$.meaning\" : {\n    optional: true,\n    type: Code\n  }, \n  \"except.$.data.$.reference\" : {\n    optional: true,\n    type: ReferenceSchema \n  }\n});\n\nBaseSchema.extend(ConsentSchema);\nDomainResourceSchema.extend(ConsentSchema);\n\nConsents.attachSchema(ConsentSchema);\n\n\nConsent.prototype.toFhir = function(){\n  console.log('Consent.toFhir()');\n\n\n\n  return EJSON.stringify(this.name);\n}\n\n\n\n/**\n * @summary Search the Consents collection for a specific Meteor.userId().\n * @memberOf Consents\n * @name findMrn\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n *  let consents = Consents.findMrn('12345').fetch();\n * ```\n */\n\nConsents.fetchBundle = function (query, parameters, callback) {\n  process.env.TRACE && console.log(\"Consents.fetchBundle()\");  \n  var consentArray = Consents.find(query, parameters, callback).map(function(consent){\n    consent.id = consent._id;\n    delete consent._document;\n    return consent;\n  });\n\n  // console.log(\"consentArray\", consentArray);\n\n  var result = Bundle.generate(consentArray);\n\n  // console.log(\"result\", result.entry[0]);\n\n  return result;\n};\n\n\n/**\n * @summary This function takes a FHIR resource and prepares it for storage in Mongo.\n * @memberOf Consents\n * @name toMongo\n * @version 1.6.0\n * @returns { Consent }\n * @example\n * ```js\n *  let consents = Consents.toMongo('12345').fetch();\n * ```\n */\n\nConsents.toMongo = function (originalConsent) {\n  var mongoRecord;\n  process.env.TRACE && console.log(\"Consents.toMongo()\");  \n\n  if (originalConsent.identifier) {\n    originalConsent.identifier.forEach(function(identifier){\n      if (identifier.period) {\n        if (identifier.period.start) {\n          var startArray = identifier.period.start.split('-');\n          identifier.period.start = new Date(startArray[0], startArray[1] - 1, startArray[2]);\n        }\n        if (identifier.period.end) {\n          var endArray = identifier.period.end.split('-');\n          identifier.period.end = new Date(startArray[0], startArray[1] - 1, startArray[2]);\n        }\n      }\n    });\n  }\n\n  return originalConsent;\n};\n\n\n\n/**\n * @summary This function takes a DTSU2 resource and returns it as STU3.  i.e. it converts from v1.0.2 to v3.0.0\n * @name toMongo\n * @version 3.0.0\n * @returns { Consent }\n * @example\n * ```js\n * ```\n */\nConsents.toStu3 = function(consentJson){\n  if(consentJson){\n\n    // quick cast from string to boolean\n    if(typeof consentJson.birthDate === \"string\"){\n      consentJson.birthDate = new Date(consentJson.birthDate);\n    }\n\n    // quick cast from string to boolean\n    if(consentJson.deceasedBoolean){\n      consentJson.deceasedBoolean = (consentJson.deceasedBoolean == \"true\") ? true : false;\n    }\n\n    // STU3 only has a single entry for family name; not an array\n    if(consentJson.name && consentJson.name[0] && consentJson.name[0].family && consentJson.name[0].family[0] ){\n      consentJson.name[0].family = consentJson.name[0].family[0];      \n    }\n\n    // make sure the full name is filled out\n    if(consentJson.name && consentJson.name[0] && consentJson.name[0].family && !consentJson.name[0].text ){\n      consentJson.name[0].text = consentJson.name[0].given[0] + ' ' + consentJson.name[0].family;      \n    }\n  }\n  return consentJson;\n}\n\n\n/**\n * @summary Similar to toMongo(), this function prepares a FHIR record for storage in the Mongo database.  The difference being, that this assumes there is already an existing record.\n * @memberOf Consents\n * @name prepForUpdate\n * @version 1.6.0\n * @returns { Object }\n * @example\n * ```js\n *  let consents = Consents.findMrn('12345').fetch();\n * ```\n */\n\nConsents.prepForUpdate = function (consent) {\n  process.env.TRACE && console.log(\"Consents.prepForUpdate()\");  \n\n  if (consent.name && consent.name[0]) {\n    //console.log(\"consent.name\", consent.name);\n\n    consent.name.forEach(function(name){\n      name.resourceType = \"HumanName\";\n    });\n  }\n\n  if (consent.telecom && consent.telecom[0]) {\n    //console.log(\"consent.telecom\", consent.telecom);\n    consent.telecom.forEach(function(telecom){\n      telecom.resourceType = \"ContactPoint\";\n    });\n  }\n\n  if (consent.address && consent.address[0]) {\n    //console.log(\"consent.address\", consent.address);\n    consent.address.forEach(function(address){\n      address.resourceType = \"Address\";\n    });\n  }\n\n  if (consent.contact && consent.contact[0]) {\n    //console.log(\"consent.contact\", consent.contact);\n\n    consent.contact.forEach(function(contact){\n      if (contact.name) {\n        contact.name.resourceType = \"HumanName\";\n      }\n\n      if (contact.telecom && contact.telecom[0]) {\n        contact.telecom.forEach(function(telecom){\n          telecom.resourceType = \"ContactPoint\";\n        });\n      }\n\n    });\n  }\n\n  return consent;\n};\n\n\n/**\n * @summary Scrubbing the consent; make sure it conforms to v1.6.0\n * @memberOf Consents\n * @name scrub\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n *  let consents = Consents.findMrn('12345').fetch();\n * ```\n */\n\nConsents.prepForFhirTransfer = function (consent) {\n  process.env.TRACE && console.log(\"Consents.prepForFhirTransfer()\");  \n\n\n  // FHIR has complicated and unusual rules about dates in order\n  // to support situations where a family member might report on a consent's\n  // date of birth, but not know the year of birth; and the other way around\n  if (consent.birthDate) {\n    consent.birthDate = moment(consent.birthDate).format(\"YYYY-MM-DD\");\n  }\n\n\n  if (consent.name && consent.name[0]) {\n    //console.log(\"consent.name\", consent.name);\n\n    consent.name.forEach(function(name){\n      delete name.resourceType;\n    });\n  }\n\n  if (consent.telecom && consent.telecom[0]) {\n    //console.log(\"consent.telecom\", consent.telecom);\n    consent.telecom.forEach(function(telecom){\n      delete telecom.resourceType;\n    });\n  }\n\n  if (consent.address && consent.address[0]) {\n    //console.log(\"consent.address\", consent.address);\n    consent.address.forEach(function(address){\n      delete address.resourceType;\n    });\n  }\n\n  if (consent.contact && consent.contact[0]) {\n    //console.log(\"consent.contact\", consent.contact);\n\n    consent.contact.forEach(function(contact){\n\n      console.log(\"contact\", contact);\n\n\n      if (contact.name && contact.name.resourceType) {\n        //console.log(\"consent.contact.name\", contact.name);\n        delete contact.name.resourceType;\n      }\n\n      if (contact.telecom && contact.telecom[0]) {\n        contact.telecom.forEach(function(telecom){\n          delete telecom.resourceType;\n        });\n      }\n\n    });\n  }\n\n  //console.log(\"Consents.prepForBundle()\", consent);\n\n  return consent;\n};\n\n\n\nConsents.readProfile = function(){\n  console.log(\"Reading user profile for consents....\")\n\n  let results = [];\n  let consentsObject = get(Meteor.user(), 'profile.consents');\n  Object.keys(consentsObject).forEach(function(key){\n    results.push(consentsObject[key])\n  });\n\n  return results;\n}\n\nConsents.readProfileIntoCollection = function(){\n  console.log(\"Reading user profile for consents....\")\n\n  let results = [];\n  let consentsObject = get(Meteor.user(), 'profile.consents');\n  Object.keys(consentsObject).forEach(function(key){\n    Consents._collection.insert(consentsObject[key])\n  });\n}\n\n// https://medium.com/@jafarim/using-json-to-model-complex-oauth-scopes-fa8a054b2a28\nConsent.prototype.parseIntoUmaScopeRequest = function(){\n  console.log(\"Parsing consent into an UMA scope request....\");\n\n  // UMA formatted scope request\n  return {\n    \"resourceType\" : [get(this, 'except[0].class[0].code')],\n    \"accessType\": [\"read\"],\n    \"purposeOfUse\": [\n      {\n       \"system\": \"http://hl7.org/fhir/ValueSet/v3-PurposeOfUse\",\n       \"code\": \"TREAT\"\n      }\n    ]\n  };\n}\n\n// https://medium.com/@jafarim/using-json-to-model-complex-oauth-scopes-fa8a054b2a28\nConsent.prototype.parseIntoScopeRequest = function(type, capitalize){\n  console.log(\"Parsing consent into an OAuth scope....\");\n\n  var result = '';\n\n  if (type) {\n    result = type + '/';\n  } \n\n  // we're basically just plucking a value out of the Consent resource\n  // and returning it as a string\n  result = result + get(this, 'except[0].class[0].code') + '.read';\n\n  if(capitalize){\n    result = result.toUpperCase();\n  }\n\n  return result;\n}\n\n// https://medium.com/@jafarim/using-json-to-model-complex-oauth-scopes-fa8a054b2a28\nConsents.generateScopeRequest = function(consentArray, vendorDialect, capitalize, urlEncoded){\n  console.log(\"Parsing array of consents into an aggregated OAuth scope request....\");\n\n  var result = '';\n  var scopeArray = [];\n\n  // the following seem to be common to the major EHR vendors\n  // and is referenced in the SMART on FHIR specification\n  result = 'launch/patient '\n            + 'online_access '\n            + 'openid '\n            + 'profile '\n            + 'user/Patient.read';\n\n  // general idea is to use any consents that are passed into the function\n  // otherwise, default to generating across the entire local collection \n  // be careful about running this on the server!\n  if(!consentArray){\n    consentArray = Consents.find().fetch();\n  }\n\n  // for each Consent\n  // we map the big gnarly Consent resource \n  // into a single scope\n  // basically just plucking two key fields out of the object\n  if(consentArray.length > 0){\n    consentArray.forEach(function(consent){\n      scopeArray.push(consent.parseIntoScopeRequest('user', false))\n    })  \n  }\n\n  if(scopeArray.length > 0){\n    // remove duplicates\n    scopeArray = uniq(scopeArray);\n\n    // now parse into the final string\n    scopeArray.forEach(function(scope){\n      result = result + ' ' + scope;\n    })  \n  }\n\n  if(urlEncoded){\n    result = encodeURI(result);\n  }\n\n  if(capitalize){\n    result = result.toUpperCase();\n  }\n\n  return result;\n}\n\nexport { Consent, Consents, ConsentSchema };\n","\nimport ConsentsPage from './client/ConsentsPage';\nimport ConsentTable from './client/ConsentTable';\n// import ProvenancesTable from './client/ProvenancesTable';\n// import DocumentReferencesTable from './client/DocumentReferencesTable';\nimport { Consent, Consents, ConsentSchema } from './lib/Consents';\n\n// let consent = require('../data/consent-example-smartonfhir.json');\n// console.log('consent', consent)\n\nvar DynamicRoutes = [{\n  'name': 'ConsentIdPage',\n  'path': '/Consent/:consentId',\n  'component': ConsentsPage,\n  'requireAuth': true\n}, {\n  'name': 'ConsentPage',\n  'path': '/consents',\n  'component': ConsentsPage,\n  'requireAuth': true\n}];\n\n// var DynamicRoutes = [];\n\nvar SidebarElements = [{\n  'primaryText': 'Consents',\n  'to': '/consents',\n  'href': '/consents'\n}];\n\nvar AdminSidebarElements = [{\n  'primaryText': 'Consents',\n  'to': '/consents',\n  'href': '/consents'\n}];\n\nexport { \n  AdminSidebarElements,\n  SidebarElements, \n  DynamicRoutes, \n\n  ConsentsPage,\n  ConsentTable\n\n  // ProvenancesTable,\n  // DocumentReferencesTable\n};\n\n\n","import { CardActions, CardText, Checkbox, RaisedButton, SelectField, MenuItem, TextField } from 'material-ui';\nimport { Col, Row, Table } from 'react-bootstrap';\n\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\nimport PropTypes from 'prop-types';\n\nimport { Consents } from '../lib/Consents';\nimport { Session } from 'meteor/session';\n\nimport { get, set } from 'lodash';\n\n\nexport class ConsentDetail extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      consentId: false,\n      consent: {\n        resourceType : \"Consent\",\n        identifier: [{\n          type: {\n            coding: [\n              {\n                system: \"\",\n                code: \"\"\n              }\n            ],\n            text: \"Serial Number\"\n          },\n          value: \"\"\n        }],\n        status: 'active',\n        category: {\n          coding: [\n            {\n              system: \"\",\n              code: \"\"\n            }\n          ],\n          text: \"\"\n        },\n        patient: {\n          reference: '',\n          display: ''\n        },\n        dateTime: null,\n        period: {\n          start: null,\n          end: null\n        },\n        consentingParty: [{\n          reference: '',\n          display: ''\n        }],\n        organization: {\n          reference: '',\n          display: ''\n        },\n        except: [{\n          type: 'permit',\n          class: [{\n            version: '',\n            code: '',\n            display: ''\n          }]\n        }]\n      },\n      form: {\n        identifier: '',\n        dateTime: '',\n        status: '',\n        patientDisplay: '',\n        organizationDisplay: '',\n        consentingParty: '',\n        periodStart: '',\n        periodEnd: '',\n        type: '',\n        class: '',\n        category: ''\n      },\n      selectedConsentCategory: 0\n    }\n  }\n  dehydrateFhirResource(consent) {\n    let formData = Object.assign({}, this.state.form);\n\n      formData.identifier = get(consent, 'identifier[0].value')\n      formData.status = get(consent, 'status')\n      formData.dateTime = get(consent, 'dateTime')\n      formData.patientDisplay = get(consent, 'patient.display')    \n      formData.consentingParty = get(consent, 'consentingParty[0].display')\n      formData.organizationDisplay = get(consent, 'organization[0].display')\n      formData.periodStart = get(consent, 'period.start')\n      formData.periodEnd = get(consent, 'period.end')\n      formData.type = get(consent, 'except[0].type')\n      formData.class = get(consent, 'except[0].class')\n      formData.category = get(consent, 'category.text')\n\n    return formData;\n  }\n  shouldComponentUpdate(nextProps){\n    process.env.NODE_ENV === \"test\" && console.log('ConsentDetail.shouldComponentUpdate()', nextProps, this.state)\n    let shouldUpdate = true;\n\n    // both false; don't take any more updates\n    if(nextProps.consent === this.state.consent){\n      shouldUpdate = false;\n    }\n\n    // received an consent from the table; okay lets update again\n    if(nextProps.consentId !== this.state.consentId){\n      this.setState({consentId: nextProps.consentId})\n      \n      if(nextProps.consent){\n        this.setState({consent: nextProps.consent})     \n        this.setState({form: this.dehydrateFhirResource(nextProps.consent)})       \n      }\n      shouldUpdate = true;\n    }\n \n    return shouldUpdate;\n  }\n  getMeteorData() {\n    let data = {\n      consentId: this.props.consentId,\n      consent: false,\n      form: this.state.form\n    };\n\n    if(this.props.consent){\n      data.consent = this.props.consent;\n    }\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"ConsentDetail[data]\", data);\n    return data;\n  }\n  changeSelectedCategory(event, value){\n    console.log('changeSelectedCategory', event, value)\n    this.setState({selectedConsentCategory: value})\n  }\n  render() {\n    if(process.env.NODE_ENV === \"test\") console.log('ConsentDetail.render()', this.state)\n    let formData = this.state.form;\n    let renderText;\n\n    switch (this.state.selectedConsentCategory) {\n      case 0:\n        renderText = <div style={{textAlign: 'justify'}}>\n          <b>Authorization</b>\n          <p>I expressly authorize Duke University, Duke University Health System, Inc., the Private Diagnostic Clinic, PLLC and other members of the Duke Health Enterprise identified in its Notice of Privacy Practices (collectively “DHE”), any DHE member affiliates and subsidiaries, third party service providers, and any and all members faculty or medical staff members, employees, trainees, and students of any of the above (collectively “Duke”) to communicate with me by the methods checked below:</p>\n          <b>Text Messages</b>\n          <p>To text me at the following wireless phone number provided or any other number I may provide in the future.  I understand that message and data rates may apply based on the terms of my service provider contract.  I agree that methods of contact by Duke may include use of auto-generated text messages or an automatic dialing system.</p>\n          <p>I agree to indemnify Duke in full for all claims, expenses, and damages related to or caused in whole or in part by my failure to notify Duke if I change my wireless phone number, including but not limited to all claims, expenses, and damages related to or arising under the Telephone Consumer Protection Act.  I agree to notify Duke promptly by updating my demographic information as part of the appointment registration process if I change my wireless telephone number provided above.  I may revoke my consent to receive text messages by responding to a text message with STOP, notifying clinic front desk staff, selecting the un-enroll option in MyChart account, or in writing to appointmentcommunications@dm.duke.edu.  I understand this authorization cannot be revoked to the extent that action has already been taken in reliance on this authorization prior to the date Duke receives my written request to revoke authorization.  </p>\n          <b>Unencrypted Messages</b>\n          <p>I understand that the text message contents may include my protected health information concerning my health care including but not limited to appointment reminders or availability, payment, medication reminders or notices, wellness checkups, hospital pre-registration instructions, pre-operative instructions, lab results, post-discharge follow-up intended to prevent readmission, healthcare quality assessment surveys, or treatment recommendations.</p>\n          <p>I understand that a text is unencrypted and may be intercepted or visible to be read by third parties.  I understand that this authorization to receive text will apply to all future messages unless I request a change in writing.  I understand that there is no assurance of confidentiality of information communicated by an unencrypted text message.</p>\n          <p>I understand that I may refuse to sign this authorization.  I understand that my refusal to provide the consent described in this form will not affect, directly or indirectly, my right to receive healthcare services from Duke.</p>\n\n        </div>\n      break;\n      case 1:\n        renderText = <Table>\n          <thead>\n            <tr>\n              <th className='selected'>selected</th>\n              <th className='category' >category</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>Allergies</td>          \n            </tr>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>CarePlans</td>          \n            </tr>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>Conditions</td>          \n            </tr>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>Consents</td>          \n            </tr>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>Family Member Histories</td>          \n            </tr>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>Goals</td>          \n            </tr>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>Immunizations</td>          \n            </tr>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>Medication Statements</td>          \n            </tr>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>Observations</td>          \n            </tr>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>Patient Demographics</td>          \n            </tr>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>Procedures</td>          \n            </tr>\n          </tbody>\n        </Table>\n        break;\n      case 2:\n          renderText = <div >\n              <p>I understand DNR means that if my heart stops beating or if I stop breathing, no medical procedure to restart breathing or heart functioning will be instituted.</p>\n              <p>I understand this decision will not prevent me from obtaining other emergency medical care by prehospital emergency medical care personnel and/or medical care directed by a physician prior to my death.</p>\n              <p>I understand I may revoke this directive at any time by destroying this form and removing any “DNR” medallions.</p>\n              <p>I give permission for this information to be given to the prehospital emergency care personnel, doctors, nurses or other health personnel as necessary to implement this directive.</p>\n              <p>I hereby agree to the “Do Not Resuscitate” (DNR) order.</p>\n            </div>\n        break;\n\n      default:\n        break;\n    }\n\n\n    return (\n      <div id={this.props.id} className=\"consentDetail\">\n        <CardText>\n          <Row>\n          <Col md={6}>\n              <SelectField\n                floatingLabelText=\"Category\"\n                value={0}\n                onChange={this.changeSelectedCategory.bind(this)}\n                fullWidth={true}\n              >\n              \n                <MenuItem value={0} primaryText=\"Patient Authorization for Text Communications\" />\n                <MenuItem value={1} primaryText=\"OAuth 2.0\" />\n                <MenuItem value={2} primaryText=\"Do Not Resuscitate\" />\n                <MenuItem value={3} disabled primaryText=\"Illinois Consent by Minors to Medical Procedures\" />\n                <MenuItem value={4} disabled primaryText=\"42 CFR Part 2 Form of Written Consent\" />\n                <MenuItem value={5} disabled primaryText=\"HIPAA Authorization\" />\n                <MenuItem value={6} disabled primaryText=\"HIPAA Notice of Privacy Practices\" />\n                <MenuItem value={7} disabled primaryText=\"HIPAA Restrictions\" />\n                <MenuItem value={8} disabled primaryText=\"HIPAA Research Authorization\" />\n                <MenuItem value={9} disabled primaryText=\"HIPAA Self-Pay Restriction\" />\n                <MenuItem value={10} disabled primaryText=\"Research Information Access\" />\n                <MenuItem value={11} disabled primaryText=\"Authorization to Disclose Information to the Social Security Administration\" />\n                <MenuItem value={12} disabled primaryText=\"Authorization and Consent to Release Information to the Department of Veterans Affairs (VA)\" />\n                <MenuItem value={13} disabled primaryText=\"Common rule informed consent\" />\n              </SelectField>\n              { renderText }\n            </Col>\n            <Col md={6}>\n              <TextField\n                id='identifierInput'\n                ref='identifier'\n                name='identifier'\n                className='barcode'\n                floatingLabelText='Identifier'\n                hintText='kpcykg8lifppmWmth'\n                value={ get(formData, 'identifier', '')}\n                onChange={ this.changeState.bind(this, 'mrn')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n              <TextField\n                id='patientDisplayInput'\n                ref='patientDisplay'\n                name='patientDisplay'\n                floatingLabelText='Patient Name'\n                hintText='Jane Doe'\n                value={ get(formData, 'patientDisplay', '')}\n                onChange={ this.changeState.bind(this, 'patientDisplay')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n              <TextField\n                id='consentingPartyInput'\n                ref='consentingParty'\n                name='consentingParty'\n                floatingLabelText='Consenting Party'\n                hintText='Jane Doe'\n                value={ get(formData, 'consentingParty', '')}\n                onChange={ this.changeState.bind(this, 'consentingParty')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>                \n              <TextField\n                id='organizationDisplayInput'\n                ref='organizationDisplay'\n                name='organizationDisplay'\n                floatingLabelText='Organization'\n                hintText='St. James Infirmiry'\n                value={ get(formData, 'organizationDisplay', '')}\n                onChange={ this.changeState.bind(this, 'organizationDisplay')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n              {/* <TextField\n                id='statusInput'\n                ref='status'\n                name='status'\n                floatingLabelText='status'\n                hintText='draft | proposed | active | rejected | inactive | entered-in-error'\n                value={ get(formData, 'status', '')}\n                onChange={ this.changeState.bind(this, 'status')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/> */}\n              <TextField\n                id='dateTimeInput'\n                ref='dateTime'\n                name='dateTime'\n                type='date'\n                floatingLabelText='Signed On'\n                value={ moment(get(formData, 'dateTime', '')).format('YYYY-MM-DD') }\n                onChange={ this.changeState.bind(this, 'dateTime')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/><br/>\n\n              { this.determineButtons(this.data.consentId) }\n            </Col>\n          </Row>\n        </CardText>\n        <CardActions>\n        </CardActions>\n      </div>\n    );\n  }\n  determineButtons(consentId){\n    if (consentId) {\n      return (\n        <div>\n          <RaisedButton id='updateConsentButton' className='saveConsentButton' label=\"Save\" primary={true} onClick={this.handleSaveButton.bind(this)} style={{marginRight: '20px'}} />\n          <RaisedButton label=\"Delete\" onClick={this.handleDeleteButton.bind(this)} />\n        </div>\n      );\n    } else {\n      return(\n        <RaisedButton id='saveConsentButton'  className='saveConsentButton' label=\"Save\" primary={true} onClick={this.handleSaveButton.bind(this)} />\n      );\n    }\n  }\n  updateFormData(formData, field, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"ConsentDetail.updateFormData\", formData, field, textValue);\n\n    switch (field) {\n      case \"identifier\":\n        set(formData, 'identifier', textValue)\n        break;\n      case \"dateTime\":\n        set(formData, 'dateTime', textValue)\n        break;        \n      case \"status\":\n        set(formData, 'status', textValue)\n        break;\n      case \"patientDisplay\":\n        set(formData, 'patientDisplay', textValue)\n        break;\n      case \"organizationDisplay\":\n        set(formData, 'organizationDisplay', textValue)\n        break;\n      case \"consentingParty\":\n        set(formData, 'consentingParty', textValue)\n        break;\n      case \"periodStart\":\n        set(formData, 'periodStart', textValue)\n        break;\n      case \"periodEnd\":\n        set(formData, 'periodEnd', textValue)\n        break;\n      case \"type\":\n        set(formData, 'type', textValue)\n        break;\n      case \"class\":\n        set(formData, 'class', textValue)\n        break;\n      case \"category\":\n        set(formData, 'category', textValue)\n        break;\n    }\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"formData\", formData);\n    return formData;\n  }\n  updateConsent(consentData, field, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"ConsentDetail.updateConsent\", consentData, field, textValue);\n\n    switch (field) {\n      case \"identifier\":\n        set(consentData, 'identifier[0].value', textValue)\n        break;\n      case \"dateTime\":\n        set(consentData, 'dateTime', textValue)\n        break;        \n      case \"status\":\n        set(consentData, 'status', textValue)\n        break;\n      case \"patientDisplay\":\n        set(consentData, 'patient.display', textValue)\n        break;\n      case \"organizationDisplay\":\n        set(consentData, 'organization.display', textValue)\n        break;\n      case \"consentingParty\":\n        set(consentData, 'consentingParty.display', textValue)\n        break;\n      case \"periodStart\":\n        set(consentData, 'period.start', textValue)\n        break;\n      case \"periodEnd\":\n        set(consentData, 'period.end', textValue)\n        break;\n      case \"type\":\n        set(consentData, 'except[0].type', textValue)\n        break;\n      case \"class\":\n        set(consentData, 'except[0].class', textValue)\n        break;\n      case \"category\":\n        set(consentData, 'category.text', textValue)\n        break;  \n    }\n    return consentData;\n  }\n  changeState(field, event, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"   \");\n    if(process.env.NODE_ENV === \"test\") console.log(\"ConsentDetail.changeState\", field, textValue);\n    if(process.env.NODE_ENV === \"test\") console.log(\"this.state\", this.state);\n\n    let formData = Object.assign({}, this.state.form);\n    let consentData = Object.assign({}, this.state.consent);\n\n    formData = this.updateFormData(formData, field, textValue);\n    consentData = this.updateConsent(consentData, field, textValue);\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"consentData\", consentData);\n    if(process.env.NODE_ENV === \"test\") console.log(\"formData\", formData);\n\n    this.setState({consent: consentData})\n    this.setState({form: formData})\n  }\n\n\n  handleSaveButton(){\n    if(process.env.NODE_ENV === \"test\") console.log('^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&&')\n    console.log('Saving a new Consent...', this.state)\n\n    let self = this;\n    let fhirConsentData = Object.assign({}, this.state.consent);\n\n    if(process.env.NODE_ENV === \"test\") console.log('fhirConsentData', fhirConsentData);\n\n\n    let consentValidator = ConsentSchema.newContext();\n    consentValidator.validate(fhirConsentData)\n\n    console.log('IsValid: ', consentValidator.isValid())\n    console.log('ValidationErrors: ', consentValidator.validationErrors());\n\n    if (this.state.consentId) {\n      if(process.env.NODE_ENV === \"test\") console.log(\"Updating consent...\");\n\n      delete fhirConsentData._id;\n\n      // not sure why we're having to respecify this; fix for a bug elsewhere\n      fhirConsentData.resourceType = 'Consent';\n\n      Consents.update({_id: this.state.consentId}, {$set: fhirConsentData }, {\n        validate: get(Meteor, 'settings.public.defaults.schemas.validate', false), \n        filter: get(Meteor, 'settings.public.defaults.schemas.filter', false), \n        removeEmptyStrings: get(Meteor, 'settings.public.defaults.schemas.removeEmptyStrings', false)\n      }, function(error, result){\n        if (error) {\n          if(process.env.NODE_ENV === \"test\") console.log(\"Consents.insert[error]\", error);\n          Bert.alert(error.reason, 'danger');\n        }\n        if (result) {\n          HipaaLogger.logEvent({eventType: \"update\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"Consents\", recordId: this.state.consentId});\n          Session.set('selectedConsent', false);\n          Session.set('consentPageTabIndex', 1);\n          Bert.alert('Consent added!', 'success');\n        }\n      });\n    } else {\n      if(process.env.NODE_ENV === \"test\") console.log(\"Creating a new consent...\", fhirConsentData);\n\n      Consents.insert(fhirConsentData, {\n        validate: get(Meteor, 'settings.public.defaults.schemas.validate', false), \n        filter: get(Meteor, 'settings.public.defaults.schemas.filter', false), \n        removeEmptyStrings: get(Meteor, 'settings.public.defaults.schemas.removeEmptyStrings', false)\n      }, function(error, result) {\n        if (error) {\n          if(process.env.NODE_ENV === \"test\")  console.log('Consents.insert[error]', error);\n          Bert.alert(error.reason, 'danger');\n        }\n        if (result) {\n          HipaaLogger.logEvent({eventType: \"create\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"Consents\", recordId: result});\n          Session.set('consentPageTabIndex', 1);\n          Session.set('selectedConsent', false);\n          Bert.alert('Consent added!', 'success');\n        }\n      });\n    }\n  }\n\n  handleCancelButton(){\n    Session.set('consentPageTabIndex', 1);\n  }\n\n  handleDeleteButton(){\n    let self = this;\n    Consents.remove({_id: this.state.consentId}, function(error, result){\n      if (error) {\n        if(process.env.NODE_ENV === \"test\") console.log('Consents.insert[error]', error);\n        Bert.alert(error.reason, 'danger');\n      }\n      if (result) {\n        HipaaLogger.logEvent({eventType: \"delete\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"Consents\", recordId: this.state.consentId});\n        Session.set('consentPageTabIndex', 1);\n        Session.set('selectedConsent', false);\n        Bert.alert('Consent removed!', 'success');\n      }\n    });\n  }\n}\nConsentDetail.propTypes = {\n  id: PropTypes.string,\n  fhirVersion: PropTypes.string,\n  consentId: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  consent: PropTypes.oneOfType([PropTypes.object, PropTypes.bool])\n};\n\nReactMixin(ConsentDetail.prototype, ReactMeteorData);\nexport default ConsentDetail;","import { Checkbox, FlatButton, RaisedButton, Avatar, Tab, Tabs  } from 'material-ui';\nimport { HTTP } from 'meteor/http';\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\nimport { Table } from 'react-bootstrap';\nimport { Session } from 'meteor/session';\nimport { has, get } from 'lodash';\nimport { TableNoData } from 'meteor/clinical:glass-ui';\nimport PropTypes from 'prop-types';\n\nSession.setDefault('selectedDocumentSource', '');\n\nexport class ConsentTable extends React.Component {\n  getMeteorData() {\n    let data = {\n      style: {\n        hideOnPhone: {\n          visibility: 'visible',\n          display: 'table'\n        },\n        cellHideOnPhone: {\n          visibility: 'visible',\n          display: 'table',\n          paddingTop: '16px'\n        },\n        cell: {\n          paddingTop: '16px'\n        }\n      },\n      selected: [],\n      consents: []\n    };\n\n    let query = {};\n    if(this.props.patient){\n      query['patient.display'] = this.props.patient;\n    }\n\n    if(this.props.query){\n      query = this.props.query;\n    }\n\n    let options = {};\n\n    if(this.props.sort){\n\n      switch (this.props.sort) {\n        case \"date\":\n          options.sort = { dateTime: -1 }\n          break;\n        case \"periodStart\":\n          options.sort = { 'period.start': -1 }\n          break;      \n        default:\n          break;\n      }\n    }\n\n    // number of items in the table should be set globally\n    if (get(Meteor, 'settings.public.defaults.paginationLimit')) {\n      options.limit = get(Meteor, 'settings.public.defaults.paginationLimit');\n    }\n\n    // but can be over-ridden by props being more explicit\n    if(this.props.limit){\n      options.limit = this.props.limit;      \n    }\n\n    // data.consents = [];\n    data.consents = Consents.find(query, options).map(function(document){\n      let result = {\n        _id: document._id,\n        id: get(document, 'id', ''),\n        dateTime: moment(get(document, 'dateTime', null)).format(\"YYYY-MM-DD hh:mm:ss\"),\n        status: get(document, 'status', ''),\n        patientReference: get(document, 'patient.display', ''),\n        consentingParty: get(document, 'consentingParty[0].display', ''),\n        organization: get(document, 'organization[0].display', ''),\n        policyRule: get(document, 'policyRule', ''),\n        exceptType: get(document, 'except[0].type', ''),\n        exceptAction: get(document, 'except[0].action[0].text', ''),\n        exceptClass: get(document, 'except[0].class', ''),\n        start: moment(get(document, 'period.start', '')).format(\"YYYY-MM-DD hh:mm:ss\"),\n        end: moment(get(document, 'period.end', '')).format(\"YYYY-MM-DD hh:mm:ss\"),\n        sourceReference: get(document, 'sourceReference.reference', ''),\n        category: get(document, 'category[0].text', '')\n      };\n\n      if(result.patientReference === ''){\n        result.patientReference = get(document, 'patient.reference', '');\n      }\n\n      var exceptions;\n      if(get(document, 'except.0.class')){\n        result.exceptClass = \"\";\n        document.except[0].class.forEach(function(exception){   \n          if(result.exceptClass == ''){\n            result.exceptClass = exception.code;\n          }  else {\n            result.exceptClass = result.exceptClass + ' - ' + exception.code;\n          }      \n        });\n      }\n      return result;\n    });\n\n    if (Session.get('appWidth') < 768) {\n      data.style.hideOnPhone.visibility = 'hidden';\n      data.style.hideOnPhone.display = 'none';\n      data.style.cellHideOnPhone.visibility = 'hidden';\n      data.style.cellHideOnPhone.display = 'none';\n    } else {\n      data.style.hideOnPhone.visibility = 'visible';\n      data.style.hideOnPhone.display = 'table-cell';\n      data.style.cellHideOnPhone.visibility = 'visible';\n      data.style.cellHideOnPhone.display = 'table-cell';\n    }\n\n    // console.log(\"ConsentTable[data]\", data);\n    return data;\n  }\n  rowClick(id){\n    Session.set('consentsUpsert', false);\n    Session.set('selectedConsent', id);\n    Session.set('consentPageTabIndex', 2);\n  }\n  handleRevoke(id){\n    console.log('handleRevoke')\n  }\n  // handleVerify(id){\n  //   console.log('handleVerify')\n  //   alert('Verify this Consent... (not implemented yet)')\n  // }\n\n\n  renderSelected(exceptType){\n    if (!this.props.hideSelected) {\n      return (\n        <td className='selected'  style={{minWidth: '100px', paddingTop: '16px'}}><Checkbox /></td>\n      );\n    }\n  }\n  renderSelectedHeader(){\n    if (!this.props.hideSelected) {\n      return (\n        <th className='selected'>Selected</th>\n      );\n    }\n  }\n  renderId(id){\n    if (!this.props.hideId) {\n      return (\n        <td className=\"id hidden-on-phone\" onClick={ this.onIdentifierClick.bind(this, id)} >{ id }</td>\n      );\n    }\n  }\n  renderIdHeader(){\n    if (!this.props.hideId) {\n      return (\n        <th className=\"id\" >Id</th>\n      );\n    }\n  }\n  renderIdentifier(identifier){\n    if (!this.props.hideIdentifier) {\n      return (\n        <td className=\"identifier hidden-on-phone\">{ identifier }</td>\n      );\n    }\n  }\n  renderIdentifierHeader(){\n    if (!this.props.hideIdentifier) {\n      let identiferClassName;\n\n      if(this.props.disableBarcodes){\n        identiferClassName = \"identifier hidden-on-phone\"\n      } else {\n        identiferClassName = \"identifier barcode hidden-on-phone\"\n      }\n      return (\n        <th className={identiferClassName} >Identifier</th>\n      );\n    }\n  }\n\n  renderType(exceptType){\n    if (!this.props.hideType) {\n      return (\n        <td className='exceptType' style={this.data.style.cell} >{ exceptType }</td>\n      );\n    }\n  }\n  renderTypeHeader(){\n    if (!this.props.hideType) {\n      return (\n        <th className='type' >Type</th>\n      );\n    }\n  }\n  renderClass(exceptClass){\n    if (!this.props.hideClass) {\n      return (\n        <td className='exceptClass' style={this.data.style.cell} >{ exceptClass }</td>\n      );\n    }\n  }\n  renderClassHeader(){\n    if (!this.props.hideClass) {\n      return (\n        <th className='class' >Class</th>\n      );\n    }\n  }\n  renderCategory(category){\n    if (!this.props.hideCategory) {\n      return (\n        <td className='category' style={this.data.style.cell} >{ category }</td>\n      );\n    }\n  }\n  renderCategoryHeader(){\n    if (!this.props.hideCategory) {\n      return (\n        <th className='category' >Category</th>\n      );\n    }\n  }\n  renderDate(id, dateTime){\n    if (!this.props.hideDateTime) {\n      return (\n        <td className='date' onClick={ this.rowClick.bind('this', id)} style={{minWidth: '100px', paddingTop: '16px'}}>{ dateTime }</td>\n      );\n    }\n  }\n  renderDateHeader(){\n    if (!this.props.hideDateTime) {\n      return (\n        <th className='date' style={{minWidth: '100px'}}>Date</th>\n      );\n    }\n  }\n\n\n  renderPeriodStart(id, periodStart){\n    if (!this.props.hidePeriodStart) {\n      return (\n        <td className='start' onClick={ this.rowClick.bind('this', id)} style={{minWidth: '100px', paddingTop: '16px'}}>{ periodStart }</td>\n      );\n    }\n  }\n  renderPeriodStartHeader(){\n    if (!this.props.hidePeriodStart) {\n      return (\n        <th className='start' style={{minWidth: '100px'}}>Start</th>\n      );\n    }\n  }\n  renderPeriodEnd(id, periodEnd){\n    if (!this.props.hidePeriodEnd) {\n      return (\n        <td className='end' onClick={ this.rowClick.bind('this', id)} style={{minWidth: '100px', paddingTop: '16px'}}>{ periodEnd }</td>\n      );\n    }\n  }\n  renderPeriodEndHeader(){\n    if (!this.props.hidePeriodEnd) {\n      return (\n        <th className='end' style={{minWidth: '100px'}}>End</th>\n      );\n    }\n  }\n\n\n  renderSource(sourceReference ){\n    console.log('renderSource', sourceReference)\n    if (!this.props.hideSourceReference) {\n      return (\n        <td className='sourceReference' onClick={ this.getDocumentReference.bind(this, sourceReference) } style={{minWidth: '100px', paddingTop: '16px'}}>{ sourceReference }</td>\n      );\n    }\n  }\n  renderSourceHeader(){\n    if (!this.props.hideSourceReference) {\n      return (\n        <th className='sourceReference' style={{minWidth: '100px', marginLeft: '20px'}}> Source </th>\n      );\n    }\n  }\n\n\n\n  // renderVerify(){\n  //   if (!this.props.hideVerify) {\n  //     return (\n  //       <td className='revoke'>\n  //         <FlatButton label=\"Verify\" onClick={this.handleVerify.bind(this)} />\n  //       </td>\n  //     );\n  //   }\n  // }\n  // renderVerifyHeader(){\n  //   if (!this.props.hideVerify) {\n  //     return (\n  //       <th className='end' style={{minWidth: '100px', marginLeft: '20px'}}> Verify </th>\n  //     );\n  //   }\n  // }\n\n\n  renderRevoke(){\n    if (!this.props.hideRevoke) {\n      return (\n        <td className='revoke'>\n          <FlatButton label=\"Revoke\" onClick={this.handleRevoke.bind(this)} />\n        </td>\n      );\n    }\n  }\n  renderRevokeHeader(){\n    if (!this.props.hideRevoke) {\n      return (\n        <th className='end' style={{minWidth: '100px', marginLeft: '20px'}}> Revoke </th>\n      );\n    }\n  }\n  getDocumentReference(sourceReference){\n    console.log('getDocumentReference...', sourceReference)\n\n    Session.set('selectedDocumentSource', sourceReference);\n  }\n  onPatientClick(id){\n    if(this.props.onPatientClick){\n      this.props.onPatientClick(id);\n    } else {\n      Session.set('consentsUpsert', false);\n      Session.set('selectedConsent', id);\n      Session.set('consentPageTabIndex', 2);  \n    }\n  }\n  render () {\n    let tableRows = [];\n    let footer;\n\n    if(this.data.consents.length === 0){\n      // don't try to simplifiy the double negative in this expression\n      // it's handling a boolean property, and also serving up instructions/help/warning\n      // it's klunky to reason through; but it's not hurting anything\n      if(!(this.props.noDataMessage === false)){\n        footer = <TableNoData noDataPadding={ this.props.noDataMessagePadding } />\n      }\n    } else {\n      for (var i = 0; i < this.data.consents.length; i++) {\n        tableRows.push(\n          <tr key={i} className=\"consentRow\" style={{cursor: \"pointer\"}}>\n            {this.renderSelected()}\n            {this.renderId(get(this.data.consents[i], 'id'))}\n            {this.renderIdentifier(get(this.data.consents[i], 'identifier'))}\n            {this.renderDate(get(this.data.consents[i], '_id'), get(this.data.consents[i], 'date'))}\n            {this.renderPeriodStart(get(this.data.consents[i], '_id'), get(this.data.consents[i], 'start'))}\n            {this.renderPeriodEnd(get(this.data.consents[i], '_id'), get(this.data.consents[i], 'end'))}\n\n            <td className='status' onClick={ this.rowClick.bind(this, this.data.consents[i]._id)} style={this.data.style.cell}>{this.data.consents[i].status}</td>\n            <td className='patientReference' onClick={ this.onPatientClick.bind(this, this.data.consents[i]._id)} style={this.data.style.cell} >{this.data.consents[i].patientReference }</td>\n            <td className='organization' style={this.data.style.cell} >{this.data.consents[i].organization}</td>\n\n            {this.renderType( get(this.data.consents[i], 'exceptType')) }\n            {this.renderClass( get(this.data.consents[i], 'exceptClass')) }\n            {this.renderCategory( get(this.data.consents[i], 'category')) }\n            {this.renderSource(get(this.data.consents[i], 'sourceReference')) }\n            {this.renderRevoke() }\n\n          </tr>\n        );\n      }  \n    }\n\n    return(\n      <div>\n        <Table id='consentsTable' hover >\n          <thead>\n            <tr>\n              {this.renderSelectedHeader() }\n              {this.renderIdHeader() }\n              {this.renderIdentifierHeader() }\n              {this.renderDateHeader() }\n              {this.renderPeriodStartHeader() }\n              {this.renderPeriodEndHeader() }\n              <th className='status'>Status</th>\n              <th className='patientReference'>Patient</th>\n              <th className='organization' >Organization</th>\n              {this.renderTypeHeader() }\n              {this.renderClassHeader() }\n              {this.renderCategoryHeader() }\n              {this.renderSourceHeader() }\n              {this.renderRevokeHeader() }\n            </tr>\n          </thead>\n          <tbody>\n            { tableRows }\n          </tbody>\n        </Table>\n      { footer }\n      </div>\n    );\n  }\n  onIdentifierClick(id){\n    if(typeof this.props.onIdentifierClick === \"function\"){\n      this.props.onIdentifierClick(id);\n    } \n  }\n}\n\nConsentTable.propTypes = {\n  id: PropTypes.string,\n  fhirVersion: PropTypes.string,\n  hideIdentifier: PropTypes.bool,\n  hideDateTime: PropTypes.bool,\n  hidePeriodStart: PropTypes.bool,\n  hidePeriodEnd: PropTypes.bool,\n  hideType: PropTypes.bool,\n  hideClass: PropTypes.bool,\n  hideCategory: PropTypes.bool,\n  hideVerify: PropTypes.bool,\n  hideRevoke: PropTypes.bool,\n  sourceReference: PropTypes.bool,\n  disableBarcodes: PropTypes.bool,\n  limit: PropTypes.number,\n  query: PropTypes.object,\n  patient: PropTypes.string,\n  patientDisplay: PropTypes.string,\n  sort: PropTypes.string,\n  selectedDocumentSource: PropTypes.string,\n  onPatientClick: PropTypes.func\n};\n\nReactMixin(ConsentTable.prototype, ReactMeteorData);\nexport default ConsentTable;","import { FlatButton, CardText, CardTitle, Dialog, Tab, Tabs, TextField, SelectField, MenuItem } from 'material-ui';\nimport { GlassCard, Glass, FullPageCanvas } from 'meteor/clinical:glass-ui';\n\nimport ConsentDetail from './ConsentDetail';\nimport ConsentTable from './ConsentTable';\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\nimport { get, set } from 'lodash';\n\nimport { Session } from 'meteor/session';\nimport { Col, Row, Table } from 'react-bootstrap';\n\nlet defaultConsent = {\n  index: 2,\n  id: '',\n  username: '',\n  email: '',\n  given: '',\n  family: '',\n  gender: ''\n};\nSession.setDefault('consentFormData', defaultConsent);\nSession.setDefault('consentSearchFilter', '');\nSession.setDefault('consentSearchQuery', {});\nSession.setDefault('consentDialogOpen', false);\nSession.setDefault('selectedConsentId', false);\nSession.setDefault('fhirVersion', 'v1.0.2');\n\nexport class ConsentsPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      searchForm: {\n        givenName: '',\n        familyName: '',\n        category: 0\n      },\n      searchQuery: {}\n    }\n  }\n  componentDidMount() {\n    if(get(this, 'props.params.consentId')){\n      Session.set('selectedConsentId', get(this, 'props.params.consentId'))\n      Session.set('consentPageTabIndex', 2);\n    }\n  }\n  getMeteorData() {\n    let data = {\n      style: {\n        opacity: Session.get('globalOpacity'),\n        tab: {\n          borderBottom: '1px solid lightgray',\n          borderRight: 'none'\n        }\n      },\n      tabIndex: Session.get('consentPageTabIndex'),\n      consent: defaultConsent,\n      consentSearchFilter: '',\n      currentConsent: null,\n      dialogOpen: Session.get('consentDialogOpen'), \n      selectedConsentId: Session.get('selectedConsentId'),\n      selectedConsent: false\n    };\n\n    if (Session.get('consentFormData')) {\n      data.consent = Session.get('consentFormData');\n    }\n    if (Session.get('consentSearchFilter')) {\n      data.consentSearchFilter = Session.get('consentSearchFilter');\n    }\n    if (Session.get('consentSearchQuery')) {\n      data.consentSearchQuery = Session.get('consentSearchQuery');\n    }\n    if (Session.get(\"selectedConsent\")) {\n      data.currentConsent = Session.get(\"selectedConsent\");\n    }\n\n    if(get(this, 'props.params.consentId')){\n      data.selectedConsent = Consents.findOne({id: get(this, 'props.params.consentId')});\n      Session.set('consentPageTabIndex', 2);\n    } else if (Session.get('selectedConsentId')){\n      data.selectedConsent = Consents.findOne({_id: Session.get('selectedConsentId')});\n    } else {\n      data.selectedConsent = false;\n    }\n\n    data.style = Glass.blur(data.style);\n    data.style.appbar = Glass.darkroom(data.style.appbar);\n    data.style.tab = Glass.darkroom(data.style.tab);\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"ConsentsPage[data]\", data);\n    return data;\n  }\n\n  handleTabChange(index){\n    Session.set('consentPageTabIndex', index);\n  }\n\n  onNewTab(){\n    Session.set('selectedConsent', false);\n    Session.set('consentUpsert', false);\n  }\n  handleClose(){\n    Session.set('consentDialogOpen', false);\n  }\n  handleSearch(){\n    console.log('handleSearch', get(this, 'state.searchForm'));\n\n    Session.set('consentSearchQuery', {\n      \"$and\": [\n        {\"consentingParty.display\": {\"$regex\": get(this, 'state.searchForm.familyName')}}, \n        {\"consentingParty.display\": {\"$regex\": get(this, 'state.searchForm.givenName')}}\n      ]\n    });\n    this.handleClose();\n  }\n  render() {\n    console.log('React.version: ' + React.version);\n    console.log('ConsentsPage.this.props', this.props);\n\n    const actions = [\n      <FlatButton\n        label=\"Cancel\"\n        primary={true}\n        onClick={this.handleClose}\n      />,\n      <FlatButton\n        label=\"Search\"\n        primary={true}\n        keyboardFocused={true}\n        onClick={this.handleSearch.bind(this) }\n      />,\n    ];\n\n    \n    return (\n      <div id=\"consentsPage\">\n        <FullPageCanvas>\n          <GlassCard height=\"auto\">\n            <CardTitle\n              title=\"Consents\"\n            />\n            <CardText>\n              <Tabs id='consentsPageTabs' default value={this.data.tabIndex} onChange={this.handleTabChange} initialSelectedIndex={1}>\n                 <Tab className=\"newConsentTab\" label='New' style={this.data.style.tab} onActive={ this.onNewTab } value={0}>\n                   <ConsentDetail \n                   id='newConsent' \n                   fhirVersion={ this.data.fhirVersion }\n                   consent={ this.data.selectedConsent }\n                   consentId={ this.data.selectedConsentId } />       \n                 </Tab>\n                 <Tab className=\"consentListTab\" label='Consents' onActive={this.handleActive} style={this.data.style.tab} value={1}>\n                   <ConsentTable \n                    showBarcodes={true} \n                    noDataMessagePadding={100}\n                    hideIdentifier={true}\n                    patient={ this.data.consentSearchFilter }\n                    query={ this.data.consentSearchQuery }\n                    sort=\"periodStart\"\n                    />\n                 </Tab>\n                 <Tab className=\"consentDetailTab\" label='Detail' onActive={this.handleActive} style={this.data.style.tab} value={2}>\n                   <ConsentDetail \n                    id='consentDetails' \n                    fhirVersion={ this.data.fhirVersion }\n                    consent={ this.data.selectedConsent }\n                    consentId={ this.data.selectedConsentId } \n                    />   \n                 </Tab>\n             </Tabs>\n\n\n            </CardText>\n          </GlassCard>\n          <Dialog\n            title=\"Search Consent Records\"\n            actions={actions}\n            modal={false}\n            open={this.data.dialogOpen}\n            onRequestClose={this.handleClose}\n          >\n            <Row>\n              <Col md={6}>\n                <TextField\n                  id='givenNameInput'\n                  ref='givenName'\n                  name='givenName'\n                  floatingLabelText='Given Name'\n                  hintText='Jane'\n                  value={ get(this, 'state.searchForm.givenName', '')}\n                  onChange={ this.changeState.bind(this, 'givenName')}\n                  floatingLabelFixed={true}\n                  fullWidth\n                  /><br/>\n              </Col>\n              <Col md={6}>\n                <TextField\n                  id='familyNameInput'\n                  ref='familyName'\n                  name='familyName'\n                  floatingLabelText='Family Name'\n                  hintText='Doe'\n                  value={ get(this, 'state.searchForm.familyName', '')}\n                  onChange={ this.changeState.bind(this, 'familyName')}\n                  floatingLabelFixed={true}\n                  fullWidth\n                  /><br/>\n\n              </Col>\n            </Row>\n            <SelectField\n                floatingLabelText=\"Category\"\n                value={ this.state.searchForm.category }\n                onChange={this.changeSelectedCategory.bind(this)}\n                fullWidth={true}\n              >\n                <MenuItem value={0} primaryText=\"\" />\n                <MenuItem value={1} primaryText=\"Patient Authorization for Text Communications\" />\n                <MenuItem value={2} primaryText=\"OAuth 2.0\" />\n                <MenuItem value={3} primaryText=\"Do Not Resuscitate\" />\n                <MenuItem value={4} disabled primaryText=\"Illinois Consent by Minors to Medical Procedures\" />\n                <MenuItem value={5} disabled primaryText=\"42 CFR Part 2 Form of Written Consent\" />\n                <MenuItem value={6} disabled primaryText=\"Common rule informed consent\" />\n                <MenuItem value={7} disabled primaryText=\"HIPAA Authorization\" />\n                <MenuItem value={8} disabled primaryText=\"HIPAA Notice of Privacy Practices\" />\n                <MenuItem value={9} disabled primaryText=\"HIPAA Restrictions\" />\n                <MenuItem value={10} disabled primaryText=\"HIPAA Research Authorization\" />\n\n                {/* <MenuItem value={10} primaryText=\"HIPAA Self-Pay Restriction\" />\n                <MenuItem value={11} primaryText=\"Research Information Access\" />\n                <MenuItem value={12} primaryText=\"Authorization to Disclose Information to the Social Security Administration\" />\n                <MenuItem value={13} primaryText=\"Authorization and Consent to Release Information to the Department of Veterans Affairs (VA)\" /> */}\n                \n              </SelectField>\n        </Dialog>\n        </FullPageCanvas>\n      </div>\n    );\n  }\n  changeSelectedCategory(event, value){\n    console.log('changeSelectedCategory', event, value)\n\n    let searchForm = this.state.searchForm;\n    searchForm.category = value;\n\n    this.setState({searchForm: searchForm})\n  }\n  updateFormData(formData, field, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"ConsentDetail.updateFormData\", formData, field, textValue);\n\n    switch (field) {\n      case \"givenName\":\n        set(formData, 'givenName', textValue)\n        break;\n      case \"familyName\":\n        set(formData, 'familyName', textValue)\n        break;        \n      case \"category\":\n        set(formData, 'category', textValue)\n        break;\n    }\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"formData\", formData);\n    return formData;\n  }\n  updateSearch(consentData, field, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"ConsentDetail.updateConsent\", consentData, field, textValue);\n\n    // switch (field) {\n    //   case \"givenName\":\n    //     set(consentData, 'givenName', textValue)\n    //     break;\n    //   case \"familyName\":\n    //     set(consentData, 'familyName', textValue)\n    //     break;        \n    //   case \"category\":\n    //     set(consentData, 'category.text', textValue)\n    //     break;  \n    // }\n    return consentData;\n  }\n  changeState(field, event, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"   \");\n    if(process.env.NODE_ENV === \"test\") console.log(\"ConsentDetail.changeState\", field, textValue);\n    if(process.env.NODE_ENV === \"test\") console.log(\"this.state\", this.state);\n\n    let searchForm = Object.assign({}, this.state.searchForm);\n    let searchQuery = Object.assign({}, this.state.searchQuery);\n\n    searchForm = this.updateFormData(searchForm, field, textValue);\n    searchQuery = this.updateSearch(searchQuery, field, textValue);\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"searchQuery\", searchQuery);\n    if(process.env.NODE_ENV === \"test\") console.log(\"searchForm\", searchForm);\n\n    this.setState({searchQuery: searchQuery})\n    this.setState({searchForm: searchForm})\n  }\n\n}\n\n\n\n\n\n\n\nReactMixin(ConsentsPage.prototype, ReactMeteorData);\n\nexport default ConsentsPage;"]}