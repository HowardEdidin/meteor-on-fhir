{"version":3,"sources":["meteor://ðŸ’»app/packages/clinical:hl7-resource-medication/lib/Medications.js","meteor://ðŸ’»app/packages/clinical:hl7-resource-medication/lib/initialize.js","meteor://ðŸ’»app/packages/clinical:hl7-resource-medication/lib/methods.js","meteor://ðŸ’»app/packages/clinical:hl7-resource-medication/index.jsx","meteor://ðŸ’»app/packages/clinical:hl7-resource-medication/client/MedicationDetail.js","meteor://ðŸ’»app/packages/clinical:hl7-resource-medication/client/MedicationsPage.js","meteor://ðŸ’»app/packages/clinical:hl7-resource-medication/client/MedicationsTable.js"],"names":["SimpleSchema","module","link","v","Medication","BaseModel","extend","prototype","_collection","Medications","Package","Mongo","Collection","Substances","connection","_transform","document","MedicationDstu2","type","String","defaultValue","optional","CodeableConceptSchema","Boolean","ReferenceSchema","Object","Array","blackbox","Date","QuantitySchema","MedicationStu3","RatioSchema","AttachmentSchema","MedicationSchema","BaseSchema","DomainResourceSchema","attachSchema","exportDefault","get","Meteor","Match","isServer","publish","find","createSubstance","newSubstance","fhirVersion","process","env","NODE_ENV","console","log","findOne","code","text","collectionConfig","isClient","filter","validate","insert","methods","medicationObject","check","NIGHTWATCH","userId","count","error","result","Loratadine","loratadineId","Ibuprofen","ibuprofenId","Cetinizine","cetinizineId","Camphor","camphorId","Menthol","mentholId","HydrogenPeroxideStabalized","hydrogenPeroxideStabalizedId","Aloe","aloeId","Albuterol","albuterolId","Acetaminophen","acetaminophenId","Dextromethorphan","dextromethorphanId","Doxylamine","doxylamineId","Maybe","medicationList","Claritin","Motrin","Zyrtec","MentholatumOintment","HydrogenPeroxide","TopCare","Ventolin","NyQuill","ingredients","push","newMedication","forEach","medication","manufacturer","display","ingredientId","product","ingredient","medId","remove","_id","export","SidebarElements","DynamicRoutes","MedicationsPage","MedicationsTable","MedicationDetail","CardActions","CardText","RaisedButton","React","ReactMeteorData","ReactMixin","TextField","PropTypes","Col","Grid","Row","set","props","state","medicationId","dstu2","resourceType","coding","system","isBrand","reference","form","item","container","content","amount","value","unit","name","activeIngredient","activeIngredientDescription","shouldComponentUpdate","nextProps","shouldUpdate","setState","dehydrateFhirResource","formData","assign","getMeteorData","data","render","id","changeState","bind","determineButtons","handleSaveButton","marginRight","handleDeleteButton","updateFormData","field","textValue","updateMedication","medicationData","componentDidUpdate","event","self","fhirMedicationData","medicationValidator","newContext","isValid","validationErrors","update","$set","Bert","alert","reason","HipaaLogger","logEvent","eventType","userName","user","fullName","collectionName","recordId","Session","handleCancelButton","Component","propTypes","string","oneOfType","bool","object","Tabs","Tab","CardTitle","GlassCard","VerticalCanvas","Glass","setDefault","style","opacity","tab","borderBottom","borderRight","tabIndex","medicationSearchFilter","selectedMedicationId","selectedMedication","blur","appbar","darkroom","handleTabChange","index","onNewTab","handleActive","Table","Toggle","FaTags","FaCode","FaPuzzlePiece","FaLock","GoTrashcan","block","maxWidth","checkbox","rowText","cursor","selected","medications","map","renderTogglesHeader","hideToggle","renderToggles","patientId","renderIdentifierHeader","hideIdentifier","renderIdentifier","classNames","barcodes","renderActionIconsHeader","hideActionIcons","minWidth","renderActionIcons","iconStyle","marginLeft","marginTop","fontSize","showSecurityDialog","removeRecord","rowClick","tableRows","i","length","array","query","paginationLimit","number","onRowClick","func"],"mappings":"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CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAOA;AACA;AAEA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AA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","file":"/packages/clinical_hl7-resource-medication.js","sourcesContent":["import SimpleSchema from 'simpl-schema';\n\n// create the object using our BaseModel\nMedication = BaseModel.extend();\n\n\n//Assign a collection so the object knows how to perform CRUD operations\nMedication.prototype._collection = Medications;\n\n// // Create a persistent data store for addresses to be stored.\n// // HL7.Resources.Patients = new Mongo.Collection('HL7.Resources.Patients');\n\nif(typeof Medications === 'undefined'){\n  if(Package['autopublish']){\n    Medications = new Mongo.Collection('Medications');\n    Substances = new Mongo.Collection('Substances');\n  } else if(Package['clinical:autopublish']){    \n    Medications = new Mongo.Collection('Medications');\n    Substances = new Mongo.Collection('Substances');\n  } else if(Package['clinical:desktop-publish']){    \n    Medications = new Mongo.Collection('Medications');\n    Substances = new Mongo.Collection('Substances');\n  } else {\n    Medications = new Mongo.Collection('Medications', {connection: null});\n    Substances = new Mongo.Collection('Substances', {connection: null});\n  }\n}\n\n\n//Add the transform to the collection since Meteor.users is pre-defined by the accounts package\nMedications._transform = function (document) {\n  return new Medication(document);\n};\n\n\nMedicationDstu2 = new SimpleSchema({\n  \"resourceType\" : {\n    type: String,\n    defaultValue: \"Medication\"\n  },\n  \"code\" :  {\n    optional: true,\n    type: CodeableConceptSchema\n  }, // Codes that identify this medication\n  \"isBrand\" :  {\n    optional: true,\n    type: Boolean\n  }, // True if a brand\n  \"manufacturer\" :  {\n    optional: true,\n    type: ReferenceSchema\n  },// (Organization) // Manufacturer of the item\n  \"product\" :  {\n    optional: true,\n    type: Object\n  }, \n\n  \"product.form\" :  {\n    optional: true,\n    type: CodeableConceptSchema\n  }, // powder | tablets | carton +\n  \"product.ingredient\" :  {\n    type: Array,\n    optional: true\n  }, \n  \"product.ingredient.$\" :  {\n    type: Object,\n    optional: true,\n    blackbox: true\n  }, \n\n  \"product.batch.$\" :  {\n    optional: true,\n    type: Object\n  },\n\n  \"product.batch\" :  {\n    optional: true,\n    type: Array\n  },\n  \"product.batch.$.lotNumber\" :  {\n    optional: true,\n    type: String\n  },\n  \"product.batch.$.expirationDate\" :  {\n    optional: true,\n    type: Date\n  },\n  \"package\" :  {\n    optional: true,\n    type: Object\n   }, \n\n  \"package.container\" :  {\n    optional: true,\n    type: CodeableConceptSchema\n   }, // E.g. box, vial, blister-pack\n\n   \"package.content\" :  {\n    optional: true,\n    type: Array\n  }, \n   \"package.content.$\" :  {\n    optional: true,\n    type: Object\n  }, \n\n  \"package.content.$.item\" :  {\n    optional: true,\n    type: ReferenceSchema\n  }, //(Medication) }, // R!  A product in the package\n  \"package.content.$.amount\" :  {\n    optional: true,\n    type: QuantitySchema // (SimpleQuantity)\n  }, // Quantity present in the package\n  \"url\": {\n    optional: true,\n    type: String\n  }\n});\n\n\n\nMedicationStu3 = new SimpleSchema({\n  \"resourceType\" : {\n    type: String,\n    defaultValue: \"Medication\"\n  },\n  \"code\" :  {\n    optional: true,\n    type: CodeableConceptSchema\n  }, // Codes that identify this medication\n  \"isBrand\" :  {\n    optional: true,\n    type: Boolean\n  }, // True if a brand\n  \"isOverTheCounter\" :  {\n    optional: true,\n    type: Boolean\n  }, // True if a brand\n  \"manufacturer\" :  {\n    optional: true,\n    type: ReferenceSchema\n  },// (Organization) // Manufacturer of the item\n  \"form\" :  {\n    optional: true,\n    type: CodeableConceptSchema\n  }, // powder | tablets | capsule +\n  \"ingredient\" :  {\n    optional: true,\n    type: Array\n  }, \n  \"ingredient.$\" :  {\n    optional: true,\n    type: Object\n  }, \n  \"ingredient.$.itemCodeableConcept\" :  {\n    optional: true,\n    type: CodeableConceptSchema\n  }, \n  \"ingredient.$.itemReference\" :  {\n    optional: true,\n    type: ReferenceSchema\n  }, \n  \"ingredient.$.isActive\" :  {\n    optional: true,\n    type: Boolean\n  }, \n  \"ingredient.$.amount\" :  {\n    optional: true,\n    type: RatioSchema\n  }, \n\n\n\n\n\n  \"package\" :  {\n    optional: true,\n    type: Object\n   }, \n\n  \"package.container\" :  {\n    optional: true,\n    type: CodeableConceptSchema\n   }, // E.g. box, vial, blister-pack\n\n   \"package.content\" :  {\n    optional: true,\n    type: Array\n  }, \n   \"package.content.$\" :  {\n    optional: true,\n    type: Object\n  }, \n  \"package.content.$.itemCodeableConcept\" :  {\n    optional: true,\n    type: CodeableConceptSchema\n  }, //(Medication) }, // R!  A product in the package\n  \"package.content.$.itemReference\" :  {\n    optional: true,\n    type: ReferenceSchema\n  }, //(Medication) }, // R!  A product in the package\n  \"package.content.$.amount\" :  {\n    optional: true,\n    type: QuantitySchema // (SimpleQuantity)\n  }, // Quantity present in the package\n  \"package.batch\" :  {\n    optional: true,\n    type: Array\n  }, \n  \"package.batch.$\" :  {\n    optional: true,\n    type: Object\n  }, \n  \"package.batch.$.lotNumber\" :  {\n    optional: true,\n    type: String\n  }, \n  \"package.batch.$.expirationDate\" :  {\n    optional: true,\n    type: Date\n  }, \n\n  \"image\": {\n    optional: true,\n    type: Array\n  },\n  \"image.$\": {\n    optional: true,\n    type: AttachmentSchema\n  }\n\n});\n\n\nMedicationSchema = MedicationDstu2;\n\nBaseSchema.extend(MedicationSchema);\nDomainResourceSchema.extend(MedicationSchema);\nMedications.attachSchema(MedicationSchema);\n\nexport default { Medication, Medications, MedicationSchema, MedicationDstu2, MedicationStu3, Substances };","// // if the database is empty on server start, create some sample data.\n// Meteor.startup(function () {\n//   if (process.env.INITIALIZE) {\n//     console.log('INITIALZING');\n//     // if (Medications.find().count() === 0) {\n//     //   console.log('No Medications found.  Creating some...');\n\n//     var pharmaKit = {\n//       inventory: [{\n//         code: {\n//           text: \"NyQuill\"\n//         },\n//         isBrand: true,\n//         manufacturer: {\n//           display: 'VICKS',\n//           reference: ''\n//         },\n//         product: {\n//           form: {\n//             text: 'liquid'\n//           },\n//           ingredient: [{\n//             item: {\n//               resourceType: 'Substance',\n//               code: {\n//                 text: 'Acetaminophen'\n//               },\n//               description: 'Pain reliever/fever reducer.'\n//             },\n//             instance: [{\n//               quantity: '650 mg'\n//             }]\n//           },{\n//             item: {\n//               resourceType: 'Substance',\n//               code: {\n//                 text: 'Dextromethorphan HBr'\n//               },\n//               description: 'Cough suppressant.'\n//             },\n//             instance: [{\n//               quantity: '30 mg'\n//             }]\n//           },{\n//             item: {\n//               resourceType: 'Substance',\n//               code: {\n//                 text: 'Doxylamine succinate'\n//               },\n//               description: 'Antihistamine.'\n//             },\n//             instance: [{\n//               quantity: '12.5 mg'\n//             }]\n//           }]\n//         },\n//         package: {\n//           container: {\n//             text: 'vial'\n//           },\n//           content: [{\n//             amount: {\n//               value: 12,\n//               unit: 'fl oz'\n//             }\n//           }]\n//         }\n//       },\n\n//       {\n//         resourceType: 'Medication',\n//         code: {\n//           text: \"Zyrtec\"\n//         },\n//         isBrand: true,\n//         manufacturer: {\n//           display: '',\n//           reference: ''\n//         },\n//         product: {\n//           form: {\n//             text: 'tablet'\n//           },\n//           ingredient: [{\n//             item: {\n//               resourceType: 'Substance',\n//               code: {\n//                 text: 'Cetinizine HCl'\n//               },\n//               description: 'Antihistamine'\n//             },\n//             instance: [{\n//               quantity: '10 mg'\n//             }]\n//           }]\n//         },\n//         package: {\n//           container: {\n//             text: 'bottle'\n//           },\n//           content: [{\n//             amount: {\n//               value: 70,\n//               unit: 'tablet'\n//             }\n//           }]\n//         }\n//       },\n\n//       {\n//         resourceType: 'Medication',\n//         code: {\n//           text: \"Mentholatum Ointment\"\n//         },\n//         isBrand: true,\n//         manufacturer: {\n//           display: '',\n//           reference: ''\n//         },\n//         product: {\n//           form: {\n//             text: 'salve'\n//           },\n//           ingredient: [{\n//             item: {\n//               resourceType: 'Substance',\n//               code: {\n//                 text: 'Camphor'\n//               },\n//               description: 'Topical analgesic'\n//             },\n//             instance: [{\n//               quantity: '9%'\n//             }]\n//           },{\n//             item: {\n//               resourceType: 'Substance',\n//               code: {\n//                 text: 'Menthol, natural'\n//               },\n//               description: 'Topical analgesic'\n//             },\n//             instance: [{\n//               quantity: '1.3%'\n//             }]\n//           }]\n//         },\n//         package: {\n//           container: {\n//             text: 'bottle'\n//           },\n//           content: [{\n//             amount: {\n//               value: 1,\n//               unit: 'fl oz'\n//             }\n//           }]\n//         }\n//       },\n\n//       {\n//         resourceType: 'Medication',\n//         code: {\n//           text: \"Hydrogen Peroxide\"\n//         },\n//         isBrand: true,\n//         manufacturer: {\n//           display: '',\n//           reference: ''\n//         },\n//         product: {\n//           form: {\n//             text: 'liquid'\n//           },\n//           ingredient: [{\n//             item: {\n//               resourceType: 'Substance',\n//               code: {\n//                 text: 'Hydrogen peroxide (stabilized)'\n//               },\n//               description: 'First aid antiseptic, Oral deriding agent'\n//             },\n//             instance: [{\n//               quantity: '3%'\n//             }]\n//           }]\n//         },\n//         package: {\n//           container: {\n//             text: 'liquid'\n//           },\n//           content: [{\n//             amount: {\n//               value: 16,\n//               unit: 'fl oz'\n//             }\n//           }]\n//         }\n//       },\n//       {\n//         resourceType: 'Medication',\n//         code: {\n//           text: \"TopCare\"\n//         },\n//         isBrand: true,\n//         manufacturer: {\n//           display: '',\n//           reference: ''\n//         },\n//         product: {\n//           form: {\n//             text: 'gel'\n//           },\n//           ingredient: [{\n//             item: {\n//               resourceType: 'Substance',\n//               code: {\n//                 text: 'Aloe barbadensis leaf tract'\n//               },\n//               description: 'analgesic'\n//             },\n//             instance: [{\n//               quantity: '0.5 oz'\n//             }]\n//           }]\n//         },\n//         package: {\n//           container: {\n//             text: 'bottle'\n//           },\n//           content: [{\n//             amount: {\n//               value: 16,\n//               unit: 'fl oz'\n//             }\n//           }]\n//         }\n//       }\n\n\n\n\n\n\n//       ]\n//     };\n\n//     pharmaKit.inventory.forEach(function(medication){\n//       if (Medications.find({'code.text': medication.code.text}).count() === 0) {\n//         Medications.insert(medication);\n//       }\n//     });\n\n\n\n//     //}\n//   }\n// });\n\n\n\n\n\n// var medicationTemplate = {\n//   resourceType: 'Medication',\n//   code: {\n//     text: \"TopCare\"\n//   },\n//   isBrand: true,\n//   manufacturer: {\n//     display: '',\n//     reference: ''\n//   },\n//   product: {\n//     form: {\n//       text: 'gel'\n//     },\n//     ingredient: [{\n//       item: {\n//         resourceType: 'Substance',\n//         code: {\n//           text: ''\n//         },\n//         description: ''\n//       },\n//       instance: [{\n//         quantity: ''\n//       }]\n//     }]\n//   },\n//   package: {\n//     container: {\n//       text: 'bottle'\n//     },\n//     content: [{\n//       amount: {\n//         value: 16,\n//         unit: 'fl oz'\n//       }\n//     }]\n//   }\n// };\n\n\n// var supplies = [{\n//   brandName: 'Ace',\n//   supply: 'Joint Bandage',\n//   generic: false,\n//   count: 1\n// },\n// {\n//   brandName: '',\n//   supply: 'Ice pack',\n//   reusable: true,\n//   generic: true,\n//   count: 1\n// },\n// {\n//   supply: 'Hot water bottle',\n//   reusable: true,\n//   generic: true,\n//   count: 1\n// },\n// {\n//   supply: 'Stethoscope',\n//   reusable: true,\n//   generic: true,\n//   count: 1\n// },\n// {\n//   brandName: 'Johnson & Johnson',\n//   supply: 'conforming bandage',\n//   size: {\n//     width: '10.2 cm',\n//     length: '190.5 cm'\n//   },\n//   sterile: true,\n//   reusable: false,\n//   generic: true,\n//   count: 1\n// }];\n","import { get } from 'lodash';\nimport { Meteor } from 'meteor/meteor';\nimport { Match } from 'meteor/check';\n\nif(Meteor.isServer){\n    Meteor.publish('medications', function(){\n        return Medications.find();\n    });    \n}\n\n\ncreateSubstance = function(newSubstance, fhirVersion){\n    // check(newSubstance, Object);\n    // check(fhirVersion, String);\n\n    process.env.NODE_ENV === \"logging\" && console.log('newSubstance', newSubstance);\n\n    if (!Substances.findOne({'code.text': newSubstance.code.text})) {\n        let collectionConfig = {};\n        if(Meteor.isClient){\n            collectionConfig = { filter: false, validate: false }\n        }\n        return Substances.insert(newSubstance, collectionConfig);\n    }\n}\n\n\nMeteor.methods({\n    'Medication/create':function(medicationObject, fhirVersion){\n        check(medicationObject, Object);\n        check(fhirVersion, String);\n\n        if (process.env.NIGHTWATCH || this.userId) {\n            console.log('medicationObject', medicationObject);\n\n            if (Medications.find({'code.text': medicationObject.code.text}).count() === 0) {\n                return Medications._collection.insert(medicationObject, function(error, result){\n                if (error) {\n                    console.log(error);\n                }\n                if (result) {\n                    console.log('Medication created: ' + result);\n                }\n                });\n            }    \n        } else {\n\n        }\n\n    },\n    'Substances/initialize':function(){\n        console.log('Substances/initialize');\n\n        //==========================================================================\n        //==========================================================================\n        // SUBSTANCES\n\n        var Loratadine = {\n            'resourceType': 'Substance',\n            'meta' : {\n                'profile' : [\"http://hl7.org/fhir/DSTU2/StructureDefinition/Substance\"]\n            },\n            'code': {\n                'text': 'Loratadine'\n            },\n            'description': 'Antihistimine'\n        }\n        let loratadineId = createSubstance(Loratadine, '3.0.1')\n        console.log('Substance created: ', loratadineId);\n\n        var Ibuprofen = {\n            \"resourceType\" : \"Substance\",\n            'meta' : {\n                'profile' : [\"http://hl7.org/fhir/DSTU2/StructureDefinition/Substance\"]\n            },\n            \"code\" : {\n                \"text\" : \"Ibuprofen\"\n            },\n            \"description\" : \"Pain reliever / fever reducer\"\n        }\n        let ibuprofenId = createSubstance(Ibuprofen, '3.0.1');\n        console.log('Substance created: ', ibuprofenId);\n\n        var Cetinizine = {\n            \"resourceType\" : \"Substance\",\n            'meta' : {\n                'profile' : [\"http://hl7.org/fhir/DSTU2/StructureDefinition/Substance\"]\n            },\n            \"code\" : {\n                \"text\" : \"Cetinizine HCl\"\n            },\n            \"description\" : \"Antihistamine\"\n        }\n        let cetinizineId = createSubstance(Cetinizine, '3.0.1');\n        console.log('Substance created: ', cetinizineId);\n\n        var Camphor = {\n            \"resourceType\" : \"Substance\",\n            'meta' : {\n                'profile' : [\"http://hl7.org/fhir/DSTU2/StructureDefinition/Substance\"]\n            },\n            \"code\" : {\n                \"text\" : \"Camphor\"\n            },\n            \"description\" : \"Antihistamine\"\n        }\n        let camphorId = createSubstance(Camphor, '3.0.1');\n        console.log('Substance created: ', camphorId);\n\n        var Menthol = {\n            \"resourceType\" : \"Substance\",\n            'meta' : {\n                'profile' : [\"http://hl7.org/fhir/DSTU2/StructureDefinition/Substance\"]\n            },\n            \"code\" : {\n                \"text\" : \"Menthol, natural\"\n            },\n            \"description\" : \"Topical analgesic\"\n        }\n        let mentholId = createSubstance(Menthol, '3.0.1');\n        console.log('Substance created: ', mentholId);\n\n        var HydrogenPeroxideStabalized = {\n            \"resourceType\" : \"Substance\",\n            'meta' : {\n                'profile' : [\"http://hl7.org/fhir/DSTU2/StructureDefinition/Substance\"]\n            },\n            \"code\" : {\n                \"text\" : \"Hydrogen peroxide (stabilized)\"\n            },\n            \"description\" : \"First aid antiseptic, Oral deriding agent\"\n        }\n        let hydrogenPeroxideStabalizedId = createSubstance(HydrogenPeroxideStabalized, '3.0.1')\n        console.log('Substance created: ', hydrogenPeroxideStabalizedId);\n\n        var Aloe = {\n            \"resourceType\" : \"Substance\",\n            'meta' : {\n                'profile' : [\"http://hl7.org/fhir/DSTU2/StructureDefinition/Substance\"]\n            },\n            \"code\" : {\n                \"text\" : \"Aloe barbadensis leaf tract\"\n            },\n            \"description\" : \"Analgesic\"\n        }\n        let aloeId = createSubstance(Aloe, '3.0.1')\n        console.log('Substance created: ', aloeId);\n\n        var Albuterol = {\n            \"resourceType\" : \"Substance\",\n            'meta' : {\n                'profile' : [\"http://hl7.org/fhir/DSTU2/StructureDefinition/Substance\"]\n            },\n            \"code\" : {\n                \"text\" : \"Albuterol\"\n            },\n            \"description\" : \"Analgesic\"\n        }\n        let albuterolId = createSubstance(Albuterol, '3.0.1');\n        console.log('Substance created: ', albuterolId);\n\n        var Acetaminophen = {\n            \"resourceType\" : \"Substance\",\n            'meta' : {\n                'profile' : [\"http://hl7.org/fhir/DSTU2/StructureDefinition/Substance\"]\n            },\n            \"code\" : {\n                \"text\" : \"Acetaminophen\"\n            },\n            \"description\" : \"Pain reliever/fever reducer.\"\n        }\n        let acetaminophenId = createSubstance(Acetaminophen, '3.0.1')\n        console.log('Substance created: ', acetaminophenId);\n\n        var Dextromethorphan = {\n            \"resourceType\" : \"Substance\",\n            'meta' : {\n                'profile' : [\"http://hl7.org/fhir/DSTU2/StructureDefinition/Substance\"]\n            },\n            \"code\" : {\n                \"text\" : \"Dextromethorphan\"\n            },\n            \"description\" : \"Cough suppressant.\"\n        }\n        let dextromethorphanId = createSubstance(Dextromethorphan, '3.0.1');\n        console.log('Substance created: ', dextromethorphanId);\n\n        var Doxylamine = {\n            \"resourceType\" : \"Substance\",\n            'meta' : {\n                'profile' : [\"http://hl7.org/fhir/DSTU2/StructureDefinition/Substance\"]\n            },\n            \"code\" : {\n                \"text\" : \"Doxylamine\"\n            },\n            \"description\" : \"Antihistamine.\"\n        }\n        let doxylamineId = createSubstance(Doxylamine, '3.0.1');\n        console.log('Substance created: ', doxylamineId);\n    },\n    'Medications/initialize':function(fhirVersion){\n        check(fhirVersion, Match.Maybe(String));\n\n        console.log('Initializing Medications manifest...')\n\n        //==========================================================================\n        //==========================================================================\n        // SHORT LIST\n\n        var medicationList = [];\n        var Claritin = {\n            'code': 'Claritin',\n            'ingredients': [],\n            \"manufacturer\": \"\",\n            'form': 'tablet',\n            'amount': {\n                'value': 30,\n                'unit': 'tablet'\n            }\n        }\n        var Motrin = {\n            'code': 'Motrin',\n            'ingredients': [],\n            \"manufacturer\": \"Johnson & Johnson\",\n            'form': 'softgel',\n            'container': 'bottle',\n            'amount': {\n                'value': 30,\n                'unit': 'tablet'\n            }\n        }\n        var Zyrtec = {\n            'code': 'Zyrtec',\n            'ingredients': [],\n            \"manufacturer\": \"\",\n            'form': 'tablet',\n            'container': 'bottle',\n            'amount': {\n                'value': 70,\n                'unit': 'tablet'\n            }\n        }\n        var MentholatumOintment = {\n            'code': 'Mentholatum Ointment',\n            'ingredients': [],\n            \"manufacturer\": \"\",\n            'form': 'tablet',\n            'container': 'bottle',\n            'amount': {\n                'value': 1,\n                'unit': 'fl oz'\n            }\n        }\n        var HydrogenPeroxide = {\n            'code': \"Hydrogen Peroxide\",\n            'ingredients': [],\n            'form': 'liquid',\n            \"manufacturer\": \"\",\n            'container': 'bottle',\n            'quantity': '3%',\n            'amount': {\n                'value': 16,\n                'unit': 'fl oz'\n            }\n        }\n\n        var TopCare = {\n            'code': \"TopCare\",\n            'ingredients': [],\n            'form': 'liquid',\n            \"manufacturer\": \"\",\n            'container': 'bottle',\n            'quantity': '0.5 oz',\n            'amount': {\n                'value': 16,\n                'unit': 'fl oz'\n            }\n        }\n        var Ventolin = {\n            'code': \"Ventolin\",\n            'ingredients': [],\n            'form': 'inhaler',\n            \"manufacturer\": \"\",\n            'container': 'bottle',\n            'quantity': '2 mg',\n            'amount': {\n                'value': 40,\n                'unit': 'inhalations'\n            }\n        }\n        var NyQuill = {\n            'code': \"Ventolin\",\n            'isBrand': true,\n            'ingredients': [],\n            \"manufacturer\": \"\",\n            'form': 'liquid',\n            'container': 'vial',\n            'quantity': '2 mg',\n            'amount': {\n                'value': 12,\n                'unit': 'fl oz'\n            }\n        }\n\n        //==========================================================================\n        //==========================================================================\n        // SUBSTANCES\n\n        Claritin.ingredients.push(Substances.findOne({'code.text': 'Loratadine'}));\n        process.env.NODE_ENV === \"verbose\" && console.log('Claritin.ingredients', Claritin.ingredients);\n        medicationList.push(Claritin);\n\n        Motrin.ingredients.push(Substances.findOne({'code.text': 'Ibuprofen'}));\n        process.env.NODE_ENV === \"verbose\" && console.log('Motrin.ingredients', Motrin.ingredients)\n        medicationList.push(Motrin);\n\n        Zyrtec.ingredients.push(Substances.findOne({'code.text': 'Cetinizine HCl'}));\n        process.env.NODE_ENV === \"verbose\" && console.log('Zyrtec.ingredients', Zyrtec.ingredients)\n        medicationList.push(Zyrtec);\n\n        MentholatumOintment.ingredients.push(Substances.findOne({'code.text': 'Camphor'}));\n        MentholatumOintment.ingredients.push(Substances.findOne({'code.text': 'Menthol, natural'}));\n        process.env.NODE_ENV === \"verbose\" && console.log('MentholatumOintment.ingredients', MentholatumOintment.ingredients)\n        medicationList.push(MentholatumOintment);\n\n        HydrogenPeroxide.ingredients.push(Substances.findOne({'code.text': 'Hydrogen peroxide (stabilized)'}));\n        process.env.NODE_ENV === \"verbose\" && console.log('HydrogenPeroxide.ingredients', HydrogenPeroxide.ingredients)\n        medicationList.push(HydrogenPeroxide);\n\n        TopCare.ingredients.push(Substances.findOne({'code.text': 'Aloe barbadensis leaf tract'}));\n        process.env.NODE_ENV === \"verbose\" && console.log('TopCare.ingredients', TopCare.ingredients)\n        medicationList.push(TopCare);\n\n        Ventolin.ingredients.push(Substances.findOne({'code.text': 'Albuterol'}));\n        process.env.NODE_ENV === \"verbose\" && console.log('TopCare.ingredients', Ventolin.ingredients)\n        medicationList.push(Ventolin);\n\n        NyQuill.ingredients.push(Substances.findOne({'code.text': 'Acetaminophen'}));\n        NyQuill.ingredients.push(Substances.findOne({'code.text': 'Dextromethorphan'}));\n        NyQuill.ingredients.push(Substances.findOne({'code.text': 'Doxylamine'}));\n\n        process.env.NODE_ENV === \"verbose\" && console.log('TopCare.ingredients', NyQuill.ingredients)\n        medicationList.push(NyQuill);\n\n\n        //==========================================================================\n        //==========================================================================\n        // MEDICATION   \n\n        console.log('Lets make sure our Medication inventory is correct...');\n\n\n        var newMedication = {\n            'meta' : {\n                'profile' : [\"http://hl7.org/fhir/DSTU2/StructureDefinition/Medication\"]\n            },\n            'code': {\n                'text': \"\"\n            },\n            'isBrand': false,\n            'manufacturer': {\n                'display': '',\n                'reference': ''\n            },\n            'product': {\n                'form': {\n                    'text': 'tablet'\n                },\n                'ingredient': []\n            }\n        };\n\n\n        medicationList.forEach(function(medication){\n            switch (fhirVersion) {\n                case 'DSTU2':\n                    newMedication.code.text = get(medication, 'code');\n                    newMedication.manufacturer.display = get(medication, 'manufacturer');\n                    // newMedication.package.container.text = get(medication, 'container');\n                    // newMedication.package.content = [get(medication, 'amount')];\n\n                    if(get(medication, 'ingredients')){\n                        medication.ingredients.forEach(function(ingredientId){\n                            newMedication.product.ingredient.push({\n                                'item': {\n                                    'display': get(medication, 'code'),\n                                    'reference': 'Substance/' + ingredientId\n                                }\n                            });        \n                        })\n                    }\n                    break;\n                case 'STU3':\n    \n                    break;\n                case 'R4':\n                    newMedication.code.text = get(medication, 'ingredientId');\n                    if(get(medication, 'ingredients')){\n                        medication.ingredients.forEach(function(ingredientId){\n                            newMedication.product.ingredient.push({\n                                'item': {\n                                    'display': get(medication, 'code'),\n                                    'reference': 'Substance/' + ingredientId\n                                }\n                            });        \n                        })\n                    }\n                    break;        \n                default:\n                    newMedication.code.text = get(medication, 'ingredientId');\n                    if(get(medication, 'ingredients')){\n                        medication.ingredients.forEach(function(ingredientId){\n                            newMedication.product.ingredient.push({\n                                'item': {\n                                    'display': get(medication, 'code'),\n                                    'reference': 'Substance/' + ingredientId\n                                }\n                            });        \n                        })\n                    }\n                    break;\n            }\n            // Meteor.call('Medication/create', newMedication, '3.0.1');\n\n\n            process.env.NODE_ENV === \"logging\" && console.log('newMedication', newMedication)\n            if (!Medications.findOne({'code.text': newMedication.code.text})) {\n                // console.log(\"Couldn't find \" + newMedication.code.text + \".  Inserting into local collection...\")\n\n                let collectionConfig = {};\n                if(Meteor.isClient){\n                    collectionConfig = {validate: true, filter: true};\n                }\n                let medId = Medications.insert(newMedication, collectionConfig, function(error, result){\n                    //if (error) { console.log(error); }\n                    if (result) { console.log('Medication created: ' + result);}\n                });    \n                if(medId){\n                    console.log(\"Couldn't find \" + newMedication.code.text)\n                }\n            } else {\n                console.log('Found a previous instance of the medication.  Skipping...')\n            }   \n        })\n\n\n\n    },\n    'Medication/drop': function(){\n        if (process.env.NIGHTWATCH || this.userId) {\n            console.log('-----------------------------------------');\n            console.log('Dropping medications... ');\n            Medications.find().forEach(function(medication){\n                Medications.remove({_id: medication._id});\n            });    \n        } else {\n            console.log('Not authorized.  Try logging in or setting NIGHTWATCH=true')\n        }\n    }\n});\n\n","\n\nimport MedicationsPage from './client/MedicationsPage';\nimport MedicationsTable from './client/MedicationsTable';\nimport MedicationDetail from './client/MedicationDetail';\n\nvar DynamicRoutes = [{\n  'name': 'MedicationsPage',\n  'path': '/medications',\n  'component': MedicationsPage,\n  'requireAuth': true\n}];\n\nvar SidebarElements = [{\n  'primaryText': 'Medications',\n  'to': '/medications',\n  'href': '/medications'\n}];\n\nexport { \n  SidebarElements, \n  DynamicRoutes, \n\n  MedicationsPage,\n  MedicationsTable\n};\n\n\n","import { CardActions, CardText } from 'material-ui/Card';\n\nimport RaisedButton from 'material-ui/RaisedButton';\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\nimport TextField from 'material-ui/TextField';\nimport PropTypes from 'prop-types';\nimport { Col, Grid, Row } from 'react-bootstrap';\nimport { get, set } from 'lodash';\n\n\nexport class MedicationDetail extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      medicationId: false,\n      dstu2: {\n        resourceType: 'Medication',\n        code: {\n          coding: [{\n            system: \"http://hl7.org/fhir/sid/ndc\",\n            code: \"\",\n            display: \"\"\n          }]\n        },\n        isBrand: true,\n        manufacturer: {\n          display: '',\n          reference: ''\n        },\n        product: {\n          form: {\n            coding: [{\n              system: \"http://hl7.org/fhir/sid/ndc\",\n              code: \"\",\n              display: \"\"\n            }],\n          },\n          ingredient: [{\n            item: {\n              display: ''\n            }\n          }]\n        },\n        package: {\n          container: {\n            text: 'bottle'\n          },\n          content: [{\n            amount: {\n              value: 30,\n              unit: 'tablet'\n            }\n          }]\n        }\n      },\n      form: {\n        code: '',\n        name: '',\n        form: '',\n        activeIngredient: '',\n        activeIngredientDescription: '',\n        amount: '',\n        manufacturer: ''\n      }\n    }\n  }\n  shouldComponentUpdate(nextProps){\n    process.env.NODE_ENV === \"test\" && console.log('MedicationDetail.shouldComponentUpdate()', nextProps, this.state)\n    let shouldUpdate = true;\n\n    // both false; don't take any more updates\n    if(nextProps.medication === this.state.dstu2){\n      shouldUpdate = false;\n    }\n\n    // received an medication from the table; okay lets update again\n    if(nextProps.medicationId !== this.state.medicationId){\n      this.setState({medicationId: nextProps.medicationId})\n      \n      if(nextProps.medication){\n        this.setState({dstu2: nextProps.medication})     \n        this.setState({form: this.dehydrateFhirResource(nextProps.medication)})       \n      }\n      shouldUpdate = true;\n    }\n \n    return shouldUpdate;\n  }\n  dehydrateFhirResource(medication) {\n    let formData = Object.assign({}, this.state.form);\n\n    // explicitely opt into the latest\n    if(this.props.fhirVersion === '3.0.1'){\n      formData.code = get(medication, 'code.coding[0].code');\n      formData.name = get(medication, 'code.coding[0].display');  \n      formData.form = get(medication, 'form.coding[0].display');\n      formData.amount = get(medication, 'package.content[0].amount.value');\n      formData.activeIngredient = get(medication, 'ingredient[0].coding[0].display');\n      formData.manufacturer = get(medication, 'manufacturer.display');\n    } else {\n      // otherwise default to v1.0.2\n      formData.code = get(medication, 'code.coding[0].code');\n      formData.name = get(medication, 'code.coding[0].display');\n      formData.form = get(medication, 'product.form.coding[0].display');\n      formData.amount = get(medication, 'package.content[0].amount.value');\n      formData.activeIngredient = get(medication, 'product.ingredient[0].item.display');\n      formData.manufacturer = get(medication, 'manufacturer.display');\n    }\n\n    return formData;\n  }\n  getMeteorData() {\n    let data = {\n      medicationId: this.state.medicationId,\n      medication: false,\n      form: this.state.form\n    };\n\n    if(this.props.medication){\n      data.medication = this.props.medication;\n    }\n\n    return data;\n  }\n\n\n  render() {\n    if(process.env.NODE_ENV === \"test\") console.log('MedicationDetail.render()', this.state)\n    let formData = this.state.form;\n\n    return (\n      <div id={this.props.id} className=\"medicationDetail\">\n        <CardText>\n          <Row>\n            <Col md={4}>\n              <TextField\n                id='medicationCodeInput'\n                ref='code'\n                name='code'\n                floatingLabelText='National Drug Code'\n                value={ get(formData, 'code') }\n                onChange={ this.changeState.bind(this, 'code')}\n                hintText='0280-6000'\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n              <a href='https://www.accessdata.fda.gov/scripts/cder/ndc/index.cfm' target=\"_blank\">National Drug Code Directory</a>\n\n            </Col>\n            <Col md={4}>\n              <TextField\n                id='medicationNameInput'\n                ref='name'\n                name='name'\n                floatingLabelText='Medication Name'\n                value={ get(formData, 'name') }\n                onChange={ this.changeState.bind(this, 'name')}\n                hintText='Aleve'\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={4}>\n              <TextField\n                id='manufacturerDisplayInput'\n                ref='manufacturer'\n                name='manufacturer'\n                floatingLabelText='Manufacturer'\n                value={ get(formData, 'manufacturer') }\n                onChange={ this.changeState.bind(this, 'manufacturer')}\n                hintText='Bayer HealthCare LLC.'\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n          </Row>\n          <Row>\n            <Col md={4}>\n              <TextField\n                id='activeIngredientInput'\n                ref='activeIngredient'\n                name='activeIngredient'\n                floatingLabelText='Active Ingredient'\n                value={ get(formData, 'activeIngredient') }\n                onChange={ this.changeState.bind(this, 'activeIngredient')}\n                hintText='NAPROXEN SODIUM'\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={8}>  \n              <TextField\n                id='activeIngredientDescriptionInput'\n                ref='activeIngredientDescription'\n                name='activeIngredientDescription'\n                floatingLabelText='Active Ingredient Description'\n                value={ get(formData, 'activeIngredientDescription') }\n                onChange={ this.changeState.bind(this, 'activeIngredientDescription')}\n                floatingLabelFixed={true}\n                disabled\n                fullWidth\n                /><br/>\n            </Col>\n          </Row>\n          <Row>\n            <Col md={2}>\n              <TextField\n                id='amountInput'\n                ref='amount'\n                name='amount'\n                floatingLabelText='Amount'\n                value={ get(formData, 'amount') }\n                onChange={ this.changeState.bind(this, 'amount')}\n                floatingLabelFixed={true}\n                hintText='40'\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={2}>\n              <TextField\n                id='medicationFormInput'\n                ref='form'\n                name='form'\n                floatingLabelText='Substance Form'\n                value={ get(formData, 'form') }\n                onChange={ this.changeState.bind(this, 'form')}\n                hintText='Capsules'\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n          </Row>\n        </CardText>\n        <CardActions>\n          { this.determineButtons(this.state.medicationId) }\n        </CardActions>\n      </div>\n    );\n  }\n\n\n  determineButtons(medicationId){\n    if (medicationId) {\n      return (\n        <div>\n          <RaisedButton id=\"updateMedicationButton\" label=\"Save\" primary={true} onClick={this.handleSaveButton.bind(this)} style={{marginRight: '20px'}}  />\n          <RaisedButton id=\"deleteMedicationButton\" label=\"Delete\" onClick={this.handleDeleteButton.bind(this)} />\n        </div>\n      );\n    } else {\n      return(\n        <RaisedButton id=\"saveMedicationButton\" label=\"Save\" primary={true} onClick={this.handleSaveButton.bind(this)} />\n      );\n    }\n  }\n\n  updateFormData(formData, field, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"MedicationDetail.updateFormData\", formData, field, textValue);\n\n    switch (field) {\n      case \"code\":\n        set(formData, 'code', textValue)\n        break;\n      case \"name\":\n        set(formData, 'name', textValue)\n        break;\n      case \"form\":\n        set(formData, 'form', textValue)\n        break;        \n      case \"activeIngredient\":\n        set(formData, 'activeIngredient', textValue)\n        break;        \n      case \"activeIngredientDescription\":\n        set(formData, 'activeIngredientDescription', textValue)\n        break;\n      case \"amount\":\n        set(formData, 'amount', textValue)\n        break;\n      case \"manufacturer\":\n        set(formData, 'manufacturer', textValue)\n        break;\n      default:\n    }\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"formData\", formData);\n    return formData;\n  }\n  updateMedication(medicationData, field, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"MedicationDetail.updateMedication\", medicationData, field, textValue);\n\n    switch (field) {\n      case \"code\":\n        set(medicationData, 'code.coding[0].code', textValue)\n        break;\n      case \"name\":\n        set(medicationData, 'code.coding[0].display', textValue)\n        break;\n      case \"form\":\n        set(medicationData, 'product.form.coding[0].display', textValue)\n        break;        \n      case \"activeIngredient\":\n        set(medicationData, 'product.ingredient[0].item.display', textValue)\n        break;        \n      case \"activeIngredientDescription\":\n        // set(medicationData, 'identifier[0].value', textValue)\n        break;\n      case \"amount\":\n        set(medicationData, 'package.content[0].amount.value', textValue)\n        break;\n      case \"manufacturer\":\n        set(medicationData, 'manufacturer.display', textValue)\n        break;\n    }\n    return medicationData;\n  }\n  componentDidUpdate(props){\n    if(process.env.NODE_ENV === \"test\") console.log('MedicationDetail.componentDidUpdate()', props, this.state)\n  }\n\n  changeState(field, event, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"   \");\n    if(process.env.NODE_ENV === \"test\") console.log(\"MedicationDetail.changeState\", field, textValue);\n    if(process.env.NODE_ENV === \"test\") console.log(\"this.state\", this.state);\n\n    let formData = Object.assign({}, this.state.form);\n    let medicationData = Object.assign({}, this.state.dstu2);\n\n    formData = this.updateFormData(formData, field, textValue);\n    medicationData = this.updateMedication(medicationData, field, textValue);\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"medicationData\", medicationData);\n    if(process.env.NODE_ENV === \"test\") console.log(\"formData\", formData);\n\n    this.setState({dstu2: medicationData})\n    this.setState({form: formData})\n  }\n\n\n  handleSaveButton(){\n    if(process.env.NODE_ENV === \"test\") console.log('^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&&')\n    console.log('Saving a new Medication...', this.state)\n\n    let self = this;\n    let fhirMedicationData = Object.assign({}, this.state.dstu2);\n\n    if(process.env.NODE_ENV === \"test\") console.log('fhirMedicationData', fhirMedicationData);\n\n    let medicationValidator = MedicationSchema.newContext();\n    medicationValidator.validate(fhirMedicationData)\n\n    console.log('IsValid: ', medicationValidator.isValid())\n    console.log('ValidationErrors: ', medicationValidator.validationErrors());\n\n    if (this.state.medicationId) {\n      if(process.env.NODE_ENV === \"test\") console.log(\"Update Medication\");\n      delete fhirMedicationData._id;\n\n      Medications._collection.update(\n        {_id: this.state.medicationId}, {$set: fhirMedicationData }, function(error, result) {\n          if (error) {\n            console.log(\"error\", error);\n            Bert.alert(error.reason, 'danger');\n          }\n          if (result) {\n            HipaaLogger.logEvent({eventType: \"update\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"Medications\", recordId: self.state.medicationId});\n            Session.set('medicationPageTabIndex', 1);\n            Session.set('selectedMedication', false);\n            Session.set('medicationUpsert', false);\n            Bert.alert('Medication updated!', 'success');\n          }\n        });\n    } else {\n\n      if(process.env.NODE_ENV === \"test\") console.log(\"create a new medication\", fhirMedicationData);\n\n      Medications._collection.insert(fhirMedicationData, function(error, result) {\n        if (error) {\n          Bert.alert(error.reason, 'danger');\n        }\n        if (result) {\n          HipaaLogger.logEvent({eventType: \"create\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"Medications\", recordId: self.state.medicationId});\n          Session.set('medicationPageTabIndex', 1);\n          Session.set('selectedMedication', false);\n          Bert.alert('Medication added!', 'success');\n        }\n      });\n    }\n  }\n\n  handleCancelButton(){\n    Session.set('medicationPageTabIndex', 1);\n  }\n\n  handleDeleteButton(){\n    let self = this;\n    Medications._collection.remove({_id: this.state.medicationId}, function(error, result){\n      if (error) {\n        Bert.alert(error.reason, 'danger');\n      }\n      if (result) {\n        HipaaLogger.logEvent({eventType: \"delete\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"Medications\", recordId: self.state.medicationId});\n        Session.set('medicationPageTabIndex', 1);\n        Session.set('selectedMedication', false);\n        Bert.alert('Medication deleted!', 'success');\n      }\n    })\n  }\n}\n\n\nMedicationDetail.propTypes = {\n  id: PropTypes.string,\n  medicationId: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  medication: PropTypes.oneOfType([PropTypes.object, PropTypes.bool])\n};\nReactMixin(MedicationDetail.prototype, ReactMeteorData);\nexport default MedicationDetail;","import React  from 'react';\nimport ReactMixin  from 'react-mixin';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\n\nimport { Tabs, Tab } from 'material-ui/Tabs';\nimport { CardTitle, CardText } from 'material-ui/Card';\nimport { GlassCard, VerticalCanvas, Glass } from 'meteor/clinical:glass-ui';\n\nimport MedicationDetail from './MedicationDetail';\nimport MedicationsTable from './MedicationsTable';\n\nimport { Meteor } from 'meteor/meteor';\nimport { Session } from 'meteor/session';\n\nSession.setDefault('fhirVersion', 'v1.0.2');\nSession.setDefault('medicationPageTabIndex', 1);\nSession.setDefault('medicationSearchFilter', ''); \nSession.setDefault('selectedMedicationId', false);\n\nexport class MedicationsPage extends React.Component {\n  getMeteorData() {\n    let data = {\n      style: {\n        opacity: Session.get('globalOpacity'),\n        tab: {\n          borderBottom: '1px solid lightgray',\n          borderRight: 'none'\n        }\n      },\n      tabIndex: Session.get('medicationPageTabIndex'),\n      medicationSearchFilter: Session.get('medicationSearchFilter'),\n      selectedMedicationId: Session.get('selectedMedicationId'),\n      fhirVersion: Session.get('fhirVersion'),\n      selectedMedication: false\n    };\n\n    if (Session.get('selectedMedicationId')){\n      data.selectedMedication = Medications.findOne({_id: Session.get('selectedMedicationId')});\n    } else {\n      data.selectedMedication = false;\n    }\n\n    data.style = Glass.blur(data.style);\n    data.style.appbar = Glass.darkroom(data.style.appbar);\n    data.style.tab = Glass.darkroom(data.style.tab);\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"MedicationsPage[data]\", data);\n    return data;\n  }\n\n  handleTabChange(index){\n    Session.set('medicationPageTabIndex', index);\n  }\n\n  onNewTab(){\n    Session.set('selectedMedicationId', false);\n    Session.set('medicationUpsert', false);\n  }\n\n  render() {\n    return (\n      <div id=\"medicationsPage\">\n      <VerticalCanvas>\n          <GlassCard height='auto'>\n            <CardTitle\n              title=\"Medications\"\n            />\n            <CardText>\n              <Tabs id=\"medicationsPageTabs\" default value={this.data.tabIndex} onChange={this.handleTabChange} initialSelectedIndex={1}>\n                <Tab className=\"newMedicationTab\" label='New' style={this.data.style.tab} onActive={ this.onNewTab } value={0} >\n                  <MedicationDetail \n                    id='newMedication'\n                    fhirVersion={ this.data.fhirVersion }\n                  />  \n                </Tab>\n                <Tab className=\"medicationListTab\" label='Medications' onActive={this.handleActive} style={this.data.style.tab} value={1}>\n                  <MedicationsTable />\n                </Tab>\n                <Tab className=\"medicationDetailsTab\" label='Detail' onActive={this.handleActive} style={this.data.style.tab} value={2}>\n                  <MedicationDetail \n                    id='medicationDetails'\n                    fhirVersion={ this.data.fhirVersion }\n                    medication={ this.data.selectedMedication }\n                    medicationId={ this.data.selectedMedicationId } />  \n                </Tab>\n              </Tabs>\n            </CardText>\n          </GlassCard>\n        </VerticalCanvas>\n      </div>\n    );\n  }\n}\n\nReactMixin(MedicationsPage.prototype, ReactMeteorData);\n\nexport default MedicationsPage;","import React from 'react';\nimport ReactMixin from 'react-mixin';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\n\nimport { Table } from 'react-bootstrap';\nimport Toggle from 'material-ui/Toggle';\nimport { Glass } from 'meteor/clinical:glass-ui';\nimport { get } from 'lodash';\nimport PropTypes from 'prop-types';\n\nimport { FaTags, FaCode, FaPuzzlePiece, FaLock  } from 'react-icons/fa';\nimport { GoTrashcan } from 'react-icons/go'\n\nSession.setDefault('selectedMedications', []);\n\nexport class MedicationsTable extends React.Component {\n  getMeteorData() {\n    let self = this;\n\n    // this should all be handled by props\n    // or a mixin!\n    let data = {\n      style: {\n        opacity: Session.get('globalOpacity'),\n        block: {\n          maxWidth: 250\n        },\n        checkbox: {\n          //marginBottom: 16\n        },\n        rowText: Glass.darkroom({cursor: 'pointer'})\n      },\n      selected: [],\n      medications: Medications.find().map(function(medication){\n        let result = {\n          _id: '',\n          name: '',\n          manufacturer: '',\n          activeIngredient: '',\n          form: '',\n          amount: '',\n          activeIngredient: ''\n        };\n\n        result._id = get(medication, '_id');\n        result.code = get(medication, 'code.coding[0].code');\n        result.code = get(medication, 'code.text');\n        result.name = get(medication, 'code.coding[0].display');\n        result.form = get(medication, 'product.form.coding[0].display');\n        result.activeIngredient = get(medication, 'product.ingredient[0].item.display');\n        result.amount = get(medication, 'package.content[0].amount.value');\n        result.manufacturer = get(medication, 'manufacturer.display');\n\n        // if we get a specific fhirVersion, be explicit about where to get the value\n        switch (self.props.fhirVersion) {\n          case '1.0.2':\n            result.activeIngredient = get(medication, 'product.ingredient[0].item.display');            \n            break;      \n          case '3.0.1':\n            result.activeIngredient = get(medication, 'product.ingredient[0].itemReference.display');            \n            break;      \n          default:\n            // otherwise, walk through the likely steps, if possible\n            // may be worth extracting to Medication.prototype.getPrimaryIngredient()\n            if(get(medication, 'product.ingredient[0].item.display')){\n              result.activeIngredient = get(medication, 'product.ingredient[0].item.display');            \n            } else if(get(medication, 'product.ingredient[0].itemReference.display')){\n              result.activeIngredient = get(medication, 'product.ingredient[0].itemReference.display');\n            }\n            break;\n        }\n\n        return result;\n      })\n    };\n\n\n    return data;\n  }\n  renderTogglesHeader(){\n    if (!this.props.hideToggle) {\n      return (\n        <th className=\"toggle\">Toggle</th>\n      );\n    }\n  }\n  renderToggles(patientId ){\n    if (!this.props.hideToggle) {\n      return (\n        <td className=\"toggle\">\n            <Toggle\n              defaultToggled={true}\n            />\n          </td>\n      );\n    }\n  }\n  renderIdentifierHeader(){\n    if (!this.props.hideIdentifier) {\n      return (\n        <th className=\"identifier\">Identifier</th>\n      );\n    }\n  }\n  renderIdentifier(medication ){\n    if (!this.props.hideIdentifier) {\n      let classNames = 'identifier';\n      if(this.props.barcodes){\n        classNames = 'barcode identifier'\n      }\n      return (\n        <td className={classNames}>{ get(medication, 'identifier[0].value') }</td>       );\n    }\n  }\n  renderActionIconsHeader(){\n    if (!this.props.hideActionIcons) {\n      return (\n        <th className='actionIcons' style={{minWidth: '120px'}}>Actions</th>\n      );\n    }\n  }\n  renderActionIcons( medication ){\n    if (!this.props.hideActionIcons) {\n      let iconStyle = {\n        marginLeft: '4px', \n        marginRight: '4px', \n        marginTop: '4px', \n        fontSize: '120%'\n      }\n\n      return (\n        <td className='actionIcons' style={{minWidth: '120px'}}>\n          <FaTags style={iconStyle} onClick={this.showSecurityDialog.bind(this, medication)} />\n          <GoTrashcan style={iconStyle} onClick={this.removeRecord.bind(this, medication._id)} />  \n        </td>\n      );\n    }\n  } \n  removeRecord(_id){\n    console.log('Remove medication ', _id)\n    Medications._collection.remove({_id: _id})\n  }\n  showSecurityDialog(medication){\n    console.log('showSecurityDialog', medication)\n\n    Session.set('securityDialogResourceJson', Medications.findOne(get(medication, '_id')));\n    Session.set('securityDialogResourceType', 'Medication');\n    Session.set('securityDialogResourceId', get(medication, '_id'));\n    Session.set('securityDialogOpen', true);\n  }\n  rowClick(id){\n    Session.set('medicationUpsert', false);\n    Session.set('selectedMedicationId', id);\n    Session.set('medicationPageTabIndex', 2);\n  }\n  render () {\n    if(process.env.NODE_ENV === \"test\") console.log(\"MedicationTable.render()\");\n\n    let tableRows = [];\n    for (var i = 0; i < this.data.medications.length; i++) {\n      tableRows.push(\n      <tr className='medicationRow' ref='med-{i}' key={i} style={this.data.style.rowText} onClick={ this.rowClick.bind('this', this.data.medications[i]._id) }>\n        { this.renderToggles(this.data.medications[i]) }\n        { this.renderActionIcons(this.data.medications[i]) }\n        <td className=\"code hidden-on-phone\">{this.data.medications[i].code}</td>\n        <td className=\"name hidden-on-phone\">{this.data.medications[i].name}</td>\n        <td className=\"manufacturer hidden-on-phone\">{this.data.medications[i].manufacturer}</td>\n        <td className=\"amount\">{this.data.medications[i].amount}</td>\n        <td className=\"form\">{this.data.medications[i].form}</td>\n        <td className=\"activeIngredient\">{this.data.medications[i].activeIngredient}</td>\n        { this.renderIdentifier(this.data.medications[i]) }\n      </tr>);\n    }\n\n\n    return(\n      <Table id=\"medicationsTable\" ref='medicationsTable' hover >\n        <thead>\n          <tr>\n            { this.renderTogglesHeader() }\n            { this.renderActionIconsHeader() }\n            <th className=\"code hidden-on-phone\">Code</th>\n            <th className=\"name hidden-on-phone\">Name</th>\n            <th className=\"manufacturer hidden-on-phone\">Manufacturer</th>\n            <th className=\"amount\">Amount</th>\n            <th className=\"form\">Form</th>\n            <th className=\"activeIngredient\">Active ingredient</th>\n            { this.renderIdentifierHeader() }\n          </tr>\n        </thead>\n        <tbody>\n          { tableRows }\n        </tbody>\n      </Table>\n    );\n  }\n}\n\n\nMedicationsTable.propTypes = {\n  data: PropTypes.array,\n  fhirVersion: PropTypes.string,\n  query: PropTypes.object,\n  paginationLimit: PropTypes.number,\n  hideIdentifier: PropTypes.bool,\n  hideToggle: PropTypes.bool,\n  hideActionIcons: PropTypes.bool,\n  barcodes: PropTypes.bool,\n  onRowClick: PropTypes.func\n};\nReactMixin(MedicationsTable.prototype, ReactMeteorData);\nexport default MedicationsTable;"]}