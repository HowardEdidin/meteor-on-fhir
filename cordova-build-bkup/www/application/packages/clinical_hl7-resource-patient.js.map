{"version":3,"sources":["meteor://ðŸ’»app/packages/clinical:hl7-resource-patient/lib/Patients.js","meteor://ðŸ’»app/packages/clinical:hl7-resource-patient/index.jsx","meteor://ðŸ’»app/packages/clinical:hl7-resource-patient/client/react/PatientCard.jsx","meteor://ðŸ’»app/packages/clinical:hl7-resource-patient/client/react/PatientDetail.jsx","meteor://ðŸ’»app/packages/clinical:hl7-resource-patient/client/react/PatientTable.jsx","meteor://ðŸ’»app/packages/clinical:hl7-resource-patient/client/react/PatientsPage.jsx"],"names":["module","export","Patient","Patients","PatientSchema","PatientStu3","PatientDstu2","get","link","v","validator","BaseModel","Mongo","SimpleSchema","BaseSchema","DomainResourceSchema","HumanNameSchema","IdentifierSchema","ContactPointSchema","AddressSchema","Package","console","log","extend","prototype","_collection","Collection","connection","_transform","document","type","String","defaultValue","optional","Array","Boolean","allowedValues","Date","autoValue","dateArray","date","value","field","split","CodeableConceptSchema","Number","AttachmentSchema","Object","Code","PeriodSchema","ReferenceSchema","attachSchema","toFhir","EJSON","stringify","name","findUserId","userId","process","env","TRACE","find","findOneUserId","findOne","findMrn","findByMrn","findByReference","input","inputString","patientId","includes","patient","_id","findByPhone","isMobilePhone","fetchBundle","query","parameters","callback","patientArray","map","id","_document","result","Bundle","generate","toMongo","originalPatient","mongoRecord","identifier","forEach","period","start","startArray","end","endArray","toStu3","patientJson","birthDate","deceasedBoolean","family","text","given","prepForUpdate","resourceType","telecom","address","contact","prepForFhirTransfer","moment","format","display","displayName","smartphone","telco","use","reference","extension","url","valueString","removeProtectedInfo","options","anonymizedName","push","anonymize","Anon","secretGiven","anonName","i","length","phone","ssn","SidebarElements","DynamicRoutes","PatientsPage","PatientTable","PatientsTable","PatientDetail","PatientCard","React","ReactMixin","ListItem","GlassCard","Glass","DynamicSpacer","Card","CardActions","CardHeader","CardText","CardTitle","Col","Grid","Row","TextField","PropTypes","style","avatar","position","zIndex","transition","left","top","width","height","photo","title","synopsis","marginLeft","patientCard","props","render","active","familyName","givenName","fullName","email","birthdate","gender","zDepth","overflowY","otherProps","imgError","bind","updateGivenName","updateFamilyName","updateBirthdate","updateGender","updateAvatar","children","refs","avatarImage","src","Meteor","absoluteUrl","Component","propTypes","multiline","bool","string","exportDefault","DatePicker","Toggle","RaisedButton","has","set","ReactMeteorData","Session","styles","block","maxWidth","toggle","marginTop","thumbOff","backgroundColor","trackOff","thumbSwitched","trackSwitched","labelStyle","color","state","prefix","suffix","coding","system","code","multipleBirthBoolean","maritalStatus","animal","species","communication","language","careProvider","managingOrganization","form","deceased","multipleBirth","dehydrateFhirResource","formData","assign","shouldComponentUpdate","nextProps","NODE_ENV","shouldUpdate","setState","getMeteorData","data","displayBirthdate","changeState","determineButtons","renderDatePicker","displayDatePicker","javascriptDate","momentDate","toDate","handleSaveButton","marginRight","handleDeleteButton","updateFormData","textValue","updatePatient","patientData","event","self","fhirPatientData","patientValidator","newContext","validate","isValid","update","$set","error","Bert","alert","reason","HipaaLogger","logEvent","eventType","userName","user","collectionName","recordId","insert","handleCancelButton","animalremove","fhirVersion","oneOfType","object","CardMedia","FlatButton","HTTP","Table","TableNoData","FaTags","FaCode","FaPuzzlePiece","FaLock","GoTrashcan","flattenPatient","person","mrn","initials","toString","nameText","hideOnPhone","visibility","cellHideOnPhone","paddingTop","cell","userSelect","borderRadius","selected","patients","limit","avatarId","rowClick","renderRowAvatarHeader","showAvatars","renderRowAvatar","avatarStyle","renderSpeciesHeader","displaySpecies","renderSpeciesRow","renderSendButtonHeader","showSendButton","renderSendButton","onSend","httpEndpoint","post","selectPatientRow","foo","bar","onRowClick","renderToggleHeader","hideToggle","renderToggle","renderActionIconsHeader","hideActionIcons","minWidth","renderActionIcons","iconStyle","fontSize","showSecurityDialog","removeRecord","renderMaritalStatusHeader","hideMaritalStatus","renderMaritalStatus","renderLanguageHeader","hideLanguage","renderLanguage","remove","tableRows","footer","noDataMessagePadding","rowStyle","cursor","array","func","number","Tab","Tabs","VerticalCanvas","FullPageCanvas","defaultPatient","index","username","setDefault","opacity","tab","borderBottom","borderRight","tabIndex","patientSearchFilter","selectedPatientId","selectedPatient","blur","appbar","darkroom","handleTabChange","onNewTab","version","handleActive"],"mappings":"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","file":"/packages/clinical_hl7-resource-patient.js","sourcesContent":["import { get } from 'lodash';\nimport validator from 'validator';\n\nif(Package['clinical:autopublish']){\n  console.log(\"*****************************************************************************\")\n  console.log(\"HIPAA WARNING:  Your app has the 'clinical-autopublish' package installed.\");\n  console.log(\"Any protected health information (PHI) stored in this app should be audited.\"); \n  console.log(\"Please consider writing secure publish/subscribe functions and uninstalling.\");  \n  console.log(\"\");  \n  console.log(\"meteor remove clinical:autopublish\");  \n  console.log(\"\");  \n}\nif(Package['autopublish']){\n  console.log(\"*****************************************************************************\")\n  console.log(\"HIPAA WARNING:  DO NOT STORE PROTECTED HEALTH INFORMATION IN THIS APP. \");  \n  console.log(\"Your application has the 'autopublish' package installed.  Please uninstall.\");\n  console.log(\"\");  \n  console.log(\"meteor remove autopublish\");  \n  console.log(\"meteor add clinical:autopublish\");  \n  console.log(\"\");  \n}\n\n\nimport { BaseModel } from 'meteor/clinical:base-model';\nimport { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\nimport { BaseSchema, DomainResourceSchema, HumanNameSchema, IdentifierSchema, ContactPointSchema, AddressSchema } from 'meteor/clinical:hl7-resource-datatypes';\n\n\n\n// create the object using our BaseModel\nPatient = BaseModel.extend();\n\n\n//Assign a collection so the object knows how to perform CRUD operations\nPatient.prototype._collection = Patients;\n\n\n// // Create a persistent data store for addresses to be stored.\n// // HL7.Resources.Patients = new Mongo.Collection('HL7.Resources.Patients');\n\nif(typeof Patients === 'undefined'){\n  if(Package['clinical:autopublish']){\n    Patients = new Mongo.Collection('Patients');\n  } else if(Package['clinical:desktop-publish']){\n    Patients = new Mongo.Collection('Patients');\n  } else {\n    Patients = new Mongo.Collection('Patients', {connection: null});\n  }\n}\n\n\n//Add the transform to the collection since Meteor.users is pre-defined by the accounts package\nPatients._transform = function (document) {\n  return new Patient(document);\n};\n\n\n\n\nPatientDstu2 = new SimpleSchema({\n  \"resourceType\" : {\n    type: String,\n    defaultValue: \"Patient\"\n  },\n  \"identifier\" : {\n    optional: true,\n    type:  Array\n    },\n  \"identifier.$\" : {\n    optional: true,\n    type:  IdentifierSchema \n    },\n  \"active\" : {\n    type: Boolean,\n    optional: true,\n    defaultValue: true\n    },\n  \"name\" : {\n    optional: true,\n    type: Array\n    },\n  \"name.$\" : {\n    optional: true,\n    type: HumanNameSchema \n    },\n  \"telecom\" : {\n    optional: true,\n    type: Array\n    },\n  \"telecom.$\" : {\n    optional: true,\n    type: ContactPointSchema\n    },\n  \"gender\" : {\n    optional: true,\n    allowedValues: ['male', 'female', 'other', 'unknown'],\n    type: String\n    },\n  \"birthDate\" : {\n    optional: true,\n    type: String,\n  },\n  \"_birthDate\" : {\n      optional: true,\n      type: Date,\n      autoValue: function() {\n        var dateArray = [];\n        var date;\n        var value = this.field('birthDate').value;\n        if(typeof value === 'string'){\n          dateArray = value.split('-');\n          date = new Date(dateArray[0], dateArray[1] - 1, dateArray[2])\n        }\n        \n        if(date){\n          return date;\n        }\n      }\n    },\n  \"deceasedBoolean\" : {\n    optional: true,\n    type: Boolean\n    },\n  \"deceasedDateTime\" : {\n    optional: true,\n    type: Date\n    },\n  \"address\" : {\n    optional: true,\n    type: Array\n    },\n  \"address.$\" : {\n    optional: true,\n    type: AddressSchema \n    },\n  \"maritalStatus\" : {\n    optional: true,\n    type: CodeableConceptSchema\n    },\n  \"multipleBirthBoolean\" : {\n    optional: true,\n    type: Boolean\n    },\n  \"multipleBirthInteger\" : {\n    optional: true,\n    type: Number\n    },\n  \"photo\" : {\n    optional: true,\n    type: Array\n    },\n  \"photo.$\" : {\n    optional: true,\n    type: AttachmentSchema \n    },\n\n  \"contact\" : {\n    optional: true,\n    type:  Array\n    },\n  \"contact.$\" : {\n    optional: true,\n    type:  Object \n    },    \n  \"contact.$.relationship\" : {\n    optional: true,\n    type: Array\n    },\n  \"contact.$.relationship.$\" : {\n    optional: true,\n    type: CodeableConceptSchema \n    },\n  \"contact.$.name\" : {\n    optional: true,\n    type: HumanNameSchema\n    },\n  \"contact.$.telecom\" : {\n    optional: true,\n    type: Array\n    },\n  \"contact.$.telecom.$\" : {\n    optional: true,\n    type: ContactPointSchema\n    },\n  \"contact.$.address\" : {\n    optional: true,\n    type: Array\n    },\n  \"contact.$.address.$\" : {\n    optional: true,\n    type: AddressSchema\n    },\n  \"contact.$.gender\" : {\n    optional: true,\n    allowedValues: ['male', 'female', 'other', 'unknown'],\n    type: Code\n    },\n  \"contact.$.organization\" : {\n    optional: true,\n    type: String\n    },\n  \"contact.$.period\" : {\n    optional: true,\n    type: PeriodSchema\n    },\n\n  \"animal\" : {\n    optional: true,\n    type: Object\n    },\n  \"animal.species\" : {\n    type: String\n    //type: CodeableConceptSchema\n    },\n  \"animal.breed\" : {\n    optional: true,\n    type: CodeableConceptSchema\n    },\n  \"animal.genderStatus\" : {\n    optional: true,\n    type: CodeableConceptSchema\n    },\n\n  \"communication\" : {\n    optional: true,\n    type:  Array\n    },\n  \"communication.$\" : {\n    optional: true,\n    type:  Object \n    },    \n  \"communication.$.language\" : {\n    type: CodeableConceptSchema\n    },\n  \"communication.$.preferred\" : {\n    optional: true,\n    type: Boolean\n    },\n  \"generalPractitioner\" : {\n    optional: true,\n    type: Array\n    },\n  \"generalPractitioner.$\" : {\n    optional: true,\n    type: ReferenceSchema\n    },\n  \"managingOrganization\" : {\n    optional: true,\n    type: ReferenceSchema\n    },\n\n  \"link\" : {\n    optional: true,\n    type:  Array\n    },\n  \"link.$\" : {\n    optional: true,\n    type:  Object \n    },   \n  \"link.$.other\" : {\n    type: ReferenceSchema\n    },\n  \"link.$.type\" : {\n    allowedValues: ['replacee', 'refer', 'seealso'],\n    type: Code\n    },\n  \"test\" : {\n    optional: true,\n    type: Boolean\n    }\n});\n\n\n\n\n\nPatientStu3 = new SimpleSchema({\n  \"resourceType\" : {\n    type: String,\n    defaultValue: \"Patient\"\n  },\n  \"identifier\" : {\n    optional: true,\n    type:  Array\n    },\n  \"identifier.$\" : {\n    optional: true,\n    type:  IdentifierSchema \n    },\n  \"active\" : {\n    type: Boolean,\n    optional: true,\n    defaultValue: true\n    },\n  \"name\" : {\n    optional: true,\n    type: Array\n    },\n  \"name.$\" : {\n    optional: true,\n    type: HumanNameSchema \n    },\n  \"telecom\" : {\n    optional: true,\n    type: Array\n    },\n  \"telecom.$\" : {\n    optional: true,\n    type: ContactPointSchema\n    },\n  \"gender\" : {\n    optional: true,\n    allowedValues: ['male', 'female', 'other', 'unknown'],\n    type: String\n    },\n  \"birthDate\" : {\n    optional: true,\n    type: String,\n  },\n  \"_birthDate\" : {\n      optional: true,\n      type: Date,\n      autoValue: function() {\n        var dateArray = [];\n        var date;\n        var value = this.field('birthDate').value;\n        if(typeof value === 'string'){\n          dateArray = value.split('-');\n          date = new Date(dateArray[0], dateArray[1] - 1, dateArray[2])\n        }\n        \n        if(date){\n          return date;\n        }\n      }\n    },\n  \"deceasedBoolean\" : {\n    optional: true,\n    type: Boolean\n    },\n  \"deceasedDateTime\" : {\n    optional: true,\n    type: Date\n    },\n  \"address\" : {\n    optional: true,\n    type: Array\n    },\n  \"address.$\" : {\n    optional: true,\n    type: AddressSchema \n    },\n  \"maritalStatus\" : {\n    optional: true,\n    type: CodeableConceptSchema\n    },\n  \"multipleBirthBoolean\" : {\n    optional: true,\n    type: Boolean\n    },\n  \"multipleBirthInteger\" : {\n    optional: true,\n    type: Number\n    },\n  \"photo\" : {\n    optional: true,\n    type: Array\n    },\n  \"photo.$\" : {\n    optional: true,\n    type: AttachmentSchema \n    },\n\n  \"contact\" : {\n    optional: true,\n    type:  Array\n    },\n  \"contact.$\" : {\n    optional: true,\n    type:  Object \n    },    \n  \"contact.$.relationship\" : {\n    optional: true,\n    type: Array\n    },\n  \"contact.$.relationship.$\" : {\n    optional: true,\n    type: CodeableConceptSchema \n    },\n  \"contact.$.name\" : {\n    optional: true,\n    type: HumanNameSchema\n    },\n  \"contact.$.telecom\" : {\n    optional: true,\n    type: Array\n    },\n  \"contact.$.telecom.$\" : {\n    optional: true,\n    type: ContactPointSchema\n    },\n  \"contact.$.address\" : {\n    optional: true,\n    type: Array\n    },\n  \"contact.$.address.$\" : {\n    optional: true,\n    type: AddressSchema\n    },\n  \"contact.$.gender\" : {\n    optional: true,\n    allowedValues: ['male', 'female', 'other', 'unknown'],\n    type: Code\n    },\n  \"contact.$.organization\" : {\n    optional: true,\n    type: String\n    },\n  \"contact.$.period\" : {\n    optional: true,\n    type: PeriodSchema\n    },\n\n  \"animal\" : {\n    optional: true,\n    type: Object\n    },\n  \"animal.species\" : {\n    type: String\n    //type: CodeableConceptSchema\n    },\n  \"animal.breed\" : {\n    optional: true,\n    type: CodeableConceptSchema\n    },\n  \"animal.genderStatus\" : {\n    optional: true,\n    type: CodeableConceptSchema\n    },\n\n  \"communication\" : {\n    optional: true,\n    type:  Array\n    },\n  \"communication.$\" : {\n    optional: true,\n    type:  Object \n    },    \n  \"communication.$.language\" : {\n    type: CodeableConceptSchema\n    },\n  \"communication.$.preferred\" : {\n    optional: true,\n    type: Boolean\n    },\n  \"generalPractitioner\" : {\n    optional: true,\n    type: Array\n    },\n  \"generalPractitioner.$\" : {\n    optional: true,\n    type: ReferenceSchema\n    },\n  \"managingOrganization\" : {\n    optional: true,\n    type: ReferenceSchema\n    },\n\n  \"link\" : {\n    optional: true,\n    type:  Array\n    },\n  \"link.$\" : {\n    optional: true,\n    type:  Object \n    },   \n  \"link.$.other\" : {\n    type: ReferenceSchema\n    },\n  \"link.$.type\" : {\n    allowedValues: ['replacee', 'refer', 'seealso'],\n    type: Code\n    },\n  \"test\" : {\n    optional: true,\n    type: Boolean\n    }\n});\n\n\n\n\nPatientSchema = PatientDstu2;\n\n// BaseSchema.extend(PatientSchema);\n// DomainResourceSchema.extend(PatientSchema);\n\nPatients.attachSchema(PatientSchema);\n\n\nPatient.prototype.toFhir = function(){\n  console.log('Patient.toFhir()');\n\n\n\n  return EJSON.stringify(this.name);\n}\n\n/**\n * @summary Search the Patients collection for a specific Meteor.userId().\n * @memberOf Patients\n * @name findUserId\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n *  let patients = Patients.findUserId(Meteor.userId());\n *  let patient = patients[0];\n * ```\n */\n\nPatients.findUserId = function (userId) {\n  process.env.TRACE && console.log(\"Patients.findUserId()\");\n  return Patients.find({'identifier.value': userId});\n};\n\n/**\n * @summary Search the Patients collection for a specific Meteor.userId().\n * @memberOf Patients\n * @name findOneUserId\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n *  let patient = Patients.findOneUserId(Meteor.userId());\n * ```\n */\n\nPatients.findOneUserId = function (userId) {\n  process.env.TRACE && console.log(\"Patients.findOneUserId()\");  \n  return Patients.findOne({'identifier.value': userId});\n};\n/**\n * @summary Search the Patients collection for a specific Meteor.userId().\n * @memberOf Patients\n * @name findMrn\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n *  let patients = Patients.findMrn('12345').fetch();\n * ```\n */\n\nPatients.findMrn = function (userId) {\n  process.env.TRACE && console.log(\"Patients.findMrn()\");  \n  return Patients.find({'identifier.value': userId});\n};\nPatients.findByMrn = function (userId) {\n  process.env.TRACE && console.log(\"Patients.findMrn()\");  \n  return Patients.find({'identifier.value': userId});\n};\n\n// Patient/pkdYagnHTR7vk2YZY\nPatients.findByReference = function(input){\n  let inputString = \"\";\n  let patientId = \"\";\n  if(typeof input === \"object\"){\n    inputString = get(input, 'reference')\n  }\n  if(typeof input === \"string\"){\n    inputString = input;\n  }\n  if(inputString.includes(\"/\")){\n    patientId = inputString.split(\"/\")[1];\n  } else {\n    patientId = inputString;\n  }        \n  let patient = Patients.findOne({_id: patientId});\n  return patient;\n}\n\n// we need to look up the patient's phone number\nPatients.findByPhone = function(input){\n  if(validator.isMobilePhone(input)){\n    return Patients.findOne({'telecom.value': input});  \n  } \n}\n\n\n\n\n/**\n * @summary Search the Patients collection for a specific Meteor.userId().\n * @memberOf Patients\n * @name findMrn\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n *  let patients = Patients.findMrn('12345').fetch();\n * ```\n */\n\nPatients.fetchBundle = function (query, parameters, callback) {\n  process.env.TRACE && console.log(\"Patients.fetchBundle()\");  \n  var patientArray = Patients.find(query, parameters, callback).map(function(patient){\n    patient.id = patient._id;\n    delete patient._document;\n    return patient;\n  });\n\n  // console.log(\"patientArray\", patientArray);\n\n  var result = Bundle.generate(patientArray);\n\n  // console.log(\"result\", result.entry[0]);\n\n  return result;\n};\n\n\n/**\n * @summary This function takes a FHIR resource and prepares it for storage in Mongo.\n * @memberOf Patients\n * @name toMongo\n * @version 1.6.0\n * @returns { Patient }\n * @example\n * ```js\n *  let patients = Patients.toMongo('12345').fetch();\n * ```\n */\n\nPatients.toMongo = function (originalPatient) {\n  var mongoRecord;\n  process.env.TRACE && console.log(\"Patients.toMongo()\");  \n\n  if (originalPatient.identifier) {\n    originalPatient.identifier.forEach(function(identifier){\n      if (identifier.period) {\n        if (identifier.period.start) {\n          var startArray = identifier.period.start.split('-');\n          identifier.period.start = new Date(startArray[0], startArray[1] - 1, startArray[2]);\n        }\n        if (identifier.period.end) {\n          var endArray = identifier.period.end.split('-');\n          identifier.period.end = new Date(startArray[0], startArray[1] - 1, startArray[2]);\n        }\n      }\n    });\n  }\n\n  return originalPatient;\n};\n\n\n\n/**\n * @summary This function takes a DTSU2 resource and returns it as STU3.  i.e. it converts from v1.0.2 to v3.0.0\n * @name toMongo\n * @version 3.0.0\n * @returns { Patient }\n * @example\n * ```js\n * ```\n */\nPatients.toStu3 = function(patientJson){\n  if(patientJson){\n\n    // quick cast from string to boolean\n    if(typeof patientJson.birthDate === \"string\"){\n      patientJson.birthDate = new Date(patientJson.birthDate);\n    }\n\n    // quick cast from string to boolean\n    if(patientJson.deceasedBoolean){\n      patientJson.deceasedBoolean = (patientJson.deceasedBoolean == \"true\") ? true : false;\n    }\n\n    // STU3 only has a single entry for family name; not an array\n    if(patientJson.name && patientJson.name[0] && patientJson.name[0].family && patientJson.name[0].family[0] ){\n      patientJson.name[0].family = patientJson.name[0].family[0];      \n    }\n\n    // make sure the full name is filled out\n    if(patientJson.name && patientJson.name[0] && patientJson.name[0].family && !patientJson.name[0].text ){\n      patientJson.name[0].text = patientJson.name[0].given[0] + ' ' + patientJson.name[0].family;      \n    }\n  }\n  return patientJson;\n}\n\n\n/**\n * @summary Similar to toMongo(), this function prepares a FHIR record for storage in the Mongo database.  The difference being, that this assumes there is already an existing record.\n * @memberOf Patients\n * @name prepForUpdate\n * @version 1.6.0\n * @returns { Object }\n * @example\n * ```js\n *  let patients = Patients.findMrn('12345').fetch();\n * ```\n */\n\nPatients.prepForUpdate = function (patient) {\n  process.env.TRACE && console.log(\"Patients.prepForUpdate()\");  \n\n  if (patient.name && patient.name[0]) {\n    //console.log(\"patient.name\", patient.name);\n\n    patient.name.forEach(function(name){\n      name.resourceType = \"HumanName\";\n    });\n  }\n\n  if (patient.telecom && patient.telecom[0]) {\n    //console.log(\"patient.telecom\", patient.telecom);\n    patient.telecom.forEach(function(telecom){\n      telecom.resourceType = \"ContactPoint\";\n    });\n  }\n\n  if (patient.address && patient.address[0]) {\n    //console.log(\"patient.address\", patient.address);\n    patient.address.forEach(function(address){\n      address.resourceType = \"Address\";\n    });\n  }\n\n  if (patient.contact && patient.contact[0]) {\n    //console.log(\"patient.contact\", patient.contact);\n\n    patient.contact.forEach(function(contact){\n      if (contact.name) {\n        contact.name.resourceType = \"HumanName\";\n      }\n\n      if (contact.telecom && contact.telecom[0]) {\n        contact.telecom.forEach(function(telecom){\n          telecom.resourceType = \"ContactPoint\";\n        });\n      }\n\n    });\n  }\n\n  return patient;\n};\n\n\n/**\n * @summary Scrubbing the patient; make sure it conforms to v1.6.0\n * @memberOf Patients\n * @name scrub\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n *  let patients = Patients.findMrn('12345').fetch();\n * ```\n */\n\nPatients.prepForFhirTransfer = function (patient) {\n  process.env.TRACE && console.log(\"Patients.prepForFhirTransfer()\");  \n\n\n  // FHIR has complicated and unusual rules about dates in order\n  // to support situations where a family member might report on a patient's\n  // date of birth, but not know the year of birth; and the other way around\n  if (patient.birthDate) {\n    patient.birthDate = moment(patient.birthDate).format(\"YYYY-MM-DD\");\n  }\n\n\n  if (patient.name && patient.name[0]) {\n    //console.log(\"patient.name\", patient.name);\n\n    patient.name.forEach(function(name){\n      delete name.resourceType;\n    });\n  }\n\n  if (patient.telecom && patient.telecom[0]) {\n    //console.log(\"patient.telecom\", patient.telecom);\n    patient.telecom.forEach(function(telecom){\n      delete telecom.resourceType;\n    });\n  }\n\n  if (patient.address && patient.address[0]) {\n    //console.log(\"patient.address\", patient.address);\n    patient.address.forEach(function(address){\n      delete address.resourceType;\n    });\n  }\n\n  if (patient.contact && patient.contact[0]) {\n    //console.log(\"patient.contact\", patient.contact);\n\n    patient.contact.forEach(function(contact){\n\n      console.log(\"contact\", contact);\n\n\n      if (contact.name && contact.name.resourceType) {\n        //console.log(\"patient.contact.name\", contact.name);\n        delete contact.name.resourceType;\n      }\n\n      if (contact.telecom && contact.telecom[0]) {\n        contact.telecom.forEach(function(telecom){\n          delete telecom.resourceType;\n        });\n      }\n\n    });\n  }\n\n  //console.log(\"Patients.prepForBundle()\", patient);\n\n  return patient;\n};\n\n/**\n * @summary The displayed name of the patient.\n * @memberOf Patient\n * @name displayName\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n * ```\n */\n\nPatient.prototype.display = Patient.prototype.displayName = function () {\n  process.env.TRACE && console.log(\"Patients.displayName()\");  \n\n  if(get(this, 'name[0].family[0]') && get(this, 'name[0].given[0]')){\n    return get(this, 'name[0].given[0]') + ' ' + get(this, 'name[0].family[0]');\n  } else if(get(this, 'name[0].family') && get(this, 'name[0].given[0]')){\n    return get(this, 'name[0].given[0]') + ' ' + get(this, 'name[0].family');\n  } else if(get(this, 'name[0].text')){\n    return get(this, 'name[0].text');\n  } \n};\nPatient.prototype.smartphone = function () {\n  process.env.TRACE && console.log(\"Patients.prototype.smartphone()\");  \n\n  let result = \"\";\n  if(this.telecom){\n    this.telecom.forEach(function(telco){\n      if([\"sms\", \"phone\", \"mobile\", \"smartphone\"].includes(telco.use)){\n        result = telco.value;\n      }\n    });\n  } \n  return result;\n};\n\n\nPatient.prototype.reference = function () {\n  process.env.TRACE && console.log(\"Patients.displayName()\");  \n\n  let result = {\n    display: this.display(),\n    reference: 'Patient/' + this.id\n  }\n  return result;\n};\n\n\n\n\n\n\n\n\n/**\n * @summary The displayed Meteor.userId() of the patient.\n * @memberOf Patient\n * @name userId\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n * ```\n */\n\nPatient.prototype.userId = function () {\n  process.env.TRACE && console.log(\"Patients.userId()\");  \n\n  var result = null;\n  if (this.extension) {\n    this.extension.forEach(function(extension){\n      if (extension.url === \"Meteor.userId()\") {\n        result = extension.valueString;\n      }\n    });\n  }\n  return result;\n};\n\n\n\n/**\n * @summary The displayed Meteor.userId() of the patient.\n * @memberOf Patient\n * @name userId\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n * ```\n */\n\n\n/**\n * @summary Anonymize the patient record\n * @memberOf Patient\n * @name removeProtectedInfo\n * @version 1.2.3\n * @returns {Object}\n * @example\n * ```js\n * ```\n */\n\nPatient.prototype.removeProtectedInfo = function (options) {\n  process.env.TRACE && console.log(\"Patients.anonymize()\", this);  \n\n  console.log(\"Patients.anonymize()\");  \n\n  // 1. Names\n  if(this.name && this.name[0]){\n    var anonymizedName = this.name[0];\n\n    if(this.name[0].family){\n      anonymizedName.family = '';\n    }\n    if(this.name[0].given && this.name[0].given[0]){\n      anonymizedName.given = [];          \n    }\n    if(this.name[0].text){\n      anonymizedName.text = '';\n    }\n\n    this.name = [];\n    this.name.push(anonymizedName);\n  }\n\n  // 3.  dates\n\n\n  // 4. Phone numbers\n  // 5.  Fax Numbers\n  // 6.  Identifiers\n  // 7.  Medical Record Nubers\n  // 17.  Photos\n\n  return this;\n}\n\n\n/**\n * @summary Anonymize the patient record\n * @memberOf Patient\n * @name anonymize\n * @version 1.2.3\n * @returns {Object}\n * @example\n * ```js\n * ```\n */\n\nPatient.prototype.anonymize = function () {\n  process.env.TRACE && console.log(\"Patients.hash()\", this);  \n\n  console.log(\"Patients.hash()\");  \n\n\n  if(this.name && this.name[0]){\n    var anonymizedName = this.name[0];\n\n    if(this.name[0].family){\n      anonymizedName.family = Anon.name(this.name[0].family);        \n    }\n    if(this.name[0].given && this.name[0].given[0]){\n      var secretGiven = Anon.name(this.name[0].given[0]);\n      anonymizedName.given = [];      \n      anonymizedName.given.push(secretGiven);\n    }\n    if(this.name[0].text){\n      anonymizedName.text = Anon.name(this.name[0].text);\n    }\n\n    this.name = [];\n    this.name.push(anonymizedName);\n  }\n\n  return this;\n}\n\n\nAnon = {\n  name: function(name){\n    var anonName = '';\n    for(var i = 0; i < name.length; i++){\n      if(name[i] === \" \"){\n        anonName = anonName + \" \";\n      } else {\n        anonName = anonName + \"*\";\n      }\n    }\n    return anonName;\n  },\n  phone: function(){\n    return \"NNN-NNN-NNNN\";\n  },\n  ssn: function(){\n    return \"###-##-####\"\n  }\n}\n\n\nexport { Patient, Patients, PatientSchema, PatientStu3, PatientDstu2 };\n","\n\n// import PatientDetail from './client/react/PatientDetail.js';\n// import PatientPickList from './client/react/PatientPickList.js';\n// import PatientsPage from './client/react/PatientsPage.js';\n// import PatientTable from './client/react/PatientTable.js';\n// import { insertPatient, removePatientById, updatePatient } from './lib/methods.js';\n\nimport PatientsPage from './client/react/PatientsPage';\nimport PatientTable from './client/react/PatientTable';\nimport {PatientTable as PatientsTable} from './client/react/PatientTable';\nimport PatientDetail from './client/react/PatientDetail';\nimport PatientCard from './client/react/PatientCard';\n\nimport { Patient, Patients, PatientSchema, PatientDstu2, PatientStu3 } from './lib/Patients';\n\nvar DynamicRoutes = [{\n  'name': 'PatientPage',\n  'path': '/patients',\n  'component': PatientsPage,\n  'requireAuth': true\n}];\n\n// var DynamicRoutes = [];\n\nvar SidebarElements = [{\n  'primaryText': 'Patients',\n  'to': '/patients',\n  'href': '/patients'\n}];\n\nexport { \n  SidebarElements, \n  DynamicRoutes, \n\n  PatientsPage,\n  PatientTable,\n  PatientsTable,\n  PatientDetail,\n  PatientCard,\n\n  Patient,\n  Patients,\n  PatientSchema,\n  PatientDstu2, \n  PatientStu3\n};\n\n\n","import React from 'react';\nimport ReactMixin from 'react-mixin';\n\nimport { ListItem } from 'material-ui/List';\nimport { GlassCard, Glass, DynamicSpacer } from 'meteor/clinical:glass-ui';\nimport { Card, CardActions, CardHeader, CardText, CardTitle } from 'material-ui/Card';\nimport { Col, Grid, Row } from 'react-bootstrap';\nimport TextField from 'material-ui/TextField';\nimport PropTypes from 'prop-types';\n\nimport { get } from 'lodash';\nimport moment from 'moment';\n\nconst style = {\n    avatar: {\n        position: 'absolute',\n        zIndex: 10,\n        transition: '1s',\n        left: '0px',\n        top: '0px',\n        width: '100%',\n        height: '100%'\n    }, \n    photo: {\n        position: 'absolute',\n        height: '160px',\n        width: '160px',\n        left: '-20px',\n        top: '-10px',       \n        zIndex: 10 \n    },\n    title: {\n        left: '160px'\n    },\n    synopsis: {\n        marginLeft: '160px',\n        position: 'relative',\n        top: '0px'\n    },\n    patientCard: {\n        position: 'relative'\n    }\n}\n\n\nexport class PatientCard extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n  render(){\n    // console.log('&&&&&&&&&&&&&&&&&&&')\n    console.log('PatientCard.render', this.props)\n\n    let { active, familyName, givenName, fullName, email, birthdate, gender, avatar, patient, zDepth, overflowY, ...otherProps } = this.props;\n\n    fullName = get(this, 'props.patient.name[0].text', '');\n    familyName = get(this, 'props.patient.name[0].family[0]', '');        \n    givenName = get(this, 'props.patient.name[0].given[0]', '');\n    email = get(this, 'props.patient.contact[0].value', '');\n    birthdate = get(this, 'props.patient.birthDate', '');\n    gender = get(this, 'props.patient.gender', '');\n    avatar = get(this, 'props.patient.photo[0].url', '');\n    // avatarImg = get(this, 'props.patient.photo[0].url', '/packages/clinical_hl7-resource-patient/assets/noAvatar.png');\n\n    return (\n      // <div className='patientCard' {...otherProps} style={style.patientCard} >\n      <div className='patientCard' style={style.patientCard} >\n        <Card zDepth={zDepth} style={ style.photo }>\n            <img id='avatarImage' className='avatarImage' ref='avatarImage' onError={this.imgError.bind(this)} src={ avatar } style={ style.avatar} />\n        </Card>\n        <GlassCard overflowY={overflowY} >\n            <CardTitle\n                title={ fullName }\n                subtitle={ email }\n                style={ style.title }\n              >\n              </CardTitle>\n            <CardText>\n                <div id='profileDemographicsPane' style={{position: 'relative'}}>\n                  <Row style={ style.synopsis} >\n                    <Col md={6}>\n                      <TextField\n                        id='givenNameInput'\n                        ref='given'\n                        name='given'\n                        type='text'\n                        floatingLabelText='given name'\n                        value={ givenName }\n                        onChange={ this.props.updateGivenName ? this.props.updateGivenName.bind(this) : null }\n                        fullWidth\n                        /><br/>\n                    </Col>\n                    <Col md={6}>\n                      <TextField\n                        id='familyNameInput'\n                        ref='family'\n                        name='family'\n                        type='text'\n                        floatingLabelText='family name'\n                        value={ familyName }\n                        onChange={ this.props.updateFamilyName ? this.props.updateFamilyName.bind(this) : null }\n                        fullWidth\n                        /><br/>\n                    </Col>\n                  </Row>\n                  <Row style={ style.synopsis }>\n                    <Col md={4}>\n                      <TextField\n                        id='birthdateInput'\n                        ref='birthdate'\n                        name='birthdate'\n                        type='date'\n                        floatingLabelText='date of birth'\n                        floatingLabelFixed={true}\n                        value={ moment(birthdate).format('YYYY-MM-DD') }                          \n                        onChange={ this.props.updateBirthdate ? this.props.updateBirthdate.bind(this) : null }\n                        fullWidth\n                        /><br/>\n                    </Col>\n                    <Col md={2}>\n                      <TextField\n                        id='genderInput'\n                        ref='gender'\n                        name='gender'\n                        type='text'\n                        floatingLabelText='gender'\n                        value={ gender }\n                        onChange={ this.props.updateGender ? this.props.updateGender.bind(this) : null }\n                        fullWidth\n                        /><br/>\n\n                    </Col>\n                    <Col md={6}>\n                      <TextField\n                        id='avatarInput'\n                        ref='avatar'\n                        name='avatar'\n                        type='text'\n                        floatingLabelText='avatar'\n                        value={ avatar }\n                        onChange={ this.props.updateAvatar ? this.props.updateAvatar.bind(this) : null }\n                        fullWidth\n                        /><br/>\n\n                    </Col>\n                  </Row>\n                </div>\n            </CardText>\n        </GlassCard>\n        <DynamicSpacer />\n\n        { this.props.children }\n      </div>\n    );\n  }\n  imgError() {\n    this.refs.avatarImage.src = Meteor.absoluteUrl() + 'packages/clinical_hl7-resource-patient/assets/noAvatar.png';\n  }\n}\n\n\nPatientCard.propTypes = {\n  multiline: PropTypes.bool,\n  fullName: PropTypes.string,\n  familyName: PropTypes.string,\n  givenName: PropTypes.string,\n  email: PropTypes.string,\n  birthdate: PropTypes.string,\n  gender: PropTypes.string,\n  avatar: PropTypes.string,\n  overflowY: PropTypes.string\n};\nexport default PatientCard ;","import { CardActions, CardText, DatePicker, Toggle, RaisedButton, TextField } from 'material-ui';\nimport { get, has, set } from 'lodash';\nimport { Row, Col } from 'react-bootstrap';\nimport moment from 'moment';\n\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\nimport PropTypes from 'prop-types';\n\nimport { Meteor } from 'meteor/meteor';\nimport { Session } from 'meteor/session';\n\n\nconst styles = {\n  block: {\n    maxWidth: 250,\n  },\n  toggle: {\n    marginTop: 16,\n  },\n  thumbOff: {\n    backgroundColor: '#ffcccc',\n  },\n  trackOff: {\n    backgroundColor: '#ff9d9d',\n  },\n  thumbSwitched: {\n    backgroundColor: 'red',\n  },\n  trackSwitched: {\n    backgroundColor: '#ff9d9d',\n  },\n  labelStyle: {\n    color: 'red',\n  },\n};\n\nexport class PatientDetail extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      patientId: false,\n      patient: {\n        resourceType : 'Patient',\n        name : [{\n          text : '',\n          prefix: [''],\n          family: [''],\n          given: [''],\n          suffix: [''],\n          resourceType : 'HumanName'\n        }],\n        active : true,\n        gender : \"\",\n        birthDate : '',\n        photo : [{\n          url: \"\"\n        }],\n        identifier: [{\n          use: 'usual',\n          type: {\n            coding: [\n              {\n                system: 'http://hl7.org/fhir/v2/0203',\n                code: 'MR'\n              }\n            ]\n          },\n          value: ''\n        }],\n        deceasedBoolean: false,\n        multipleBirthBoolean: false,\n        maritalStatus: {\n          text: ''\n        },\n        telecom: [{\n          use: \"phone\"\n        }],\n        contact: [],\n        animal: {\n          species: {\n            text: 'Human'\n          }\n        },\n        communication: [{\n          language: {\n            text: 'English'\n          }\n        }],\n        careProvider: [{\n          display: '',\n          reference: ''\n        }],\n        managingOrganization: {\n          reference: '',\n          display: ''\n        }\n      },\n      form: {\n        prefix: '',\n        family: '',\n        given: '',\n        suffix: '',\n        identifier: '',\n        deceased: false,\n        multipleBirth: false,\n        maritalStatus: '',\n        species: '',\n        language: ''\n      }\n    }\n  }\n  dehydrateFhirResource(patient) {\n    let formData = Object.assign({}, this.state.form);\n\n    formData.prefix = get(patient, 'name[0].prefix[0]')\n    formData.family = get(patient, 'name[0].family[0]')\n    formData.given = get(patient, 'name[0].given[0]')\n    formData.suffix = get(patient, 'name[0].suffix[0]')\n    formData.identifier = get(patient, 'identifier[0].value')\n    formData.deceased = get(patient, 'deceasedBoolean')\n    formData.gender = get(patient, 'gender')\n    formData.multipleBirth = get(patient, 'multipleBirthBoolean')\n    formData.maritalStatus = get(patient, 'maritalStatus.text')\n    formData.species = get(patient, 'animal.species.text')\n    formData.language = get(patient, 'communication[0].language.text')\n    formData.birthDate = moment(patient.birthDate).format(\"YYYY-MM-DD\")\n    formData.smartphone = get(patient, 'telecom[0].value')\n\n    return formData;\n  }\n  shouldComponentUpdate(nextProps){\n    process.env.NODE_ENV === \"test\" && console.log('PatientDetail.shouldComponentUpdate()', nextProps, this.state)\n    let shouldUpdate = true;\n\n    // both false; don't take any more updates\n    if(nextProps.patient === this.state.patient){\n      shouldUpdate = false;\n    }\n\n    // received an patient from the table; okay lets update again\n    if(nextProps.patientId !== this.state.patientId){\n      this.setState({patientId: nextProps.patientId})\n      \n      if(nextProps.patient){\n        this.setState({patient: nextProps.patient})     \n        this.setState({form: this.dehydrateFhirResource(nextProps.patient)})       \n      }\n      shouldUpdate = true;\n    }\n \n    return shouldUpdate;\n  }\n  getMeteorData() {\n    let data = {\n      patientId: this.props.patientId,\n      patient: false,\n      form: this.state.form\n    };\n\n    if(this.props.patient){\n      data.patient = this.props.patient;\n    }\n    if(this.props.displayBirthdate){\n      data.displayBirthdate = this.props.displayBirthdate;\n    }\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"PatientDetail[data]\", data);\n    return data;\n  }\n\n  render() {\n    if(process.env.NODE_ENV === \"test\") console.log('PatientDetail.render()', this.state)\n    let formData = this.state.form;\n\n    return (\n      <div id={this.props.id} className=\"patientDetail\">\n        <CardText>\n          <Row>\n            <Col md={4}>\n              <TextField\n                id='mrnInput'\n                ref='identifier'\n                name='identifier'\n                floatingLabelText='Identifier (Medical Record Number)'\n                value={ get(formData, 'identifier', '')}\n                onChange={ this.changeState.bind(this, 'identifier')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={3} mdOffset={5}>\n              <br />\n              <Toggle\n                label=\"Deceased\"\n                labelPosition=\"right\"\n                defaultToggled={false}\n                style={styles.toggle}\n              />\n            </Col>\n          </Row>\n          <Row>\n            <Col md={1}>\n              <TextField\n                id='prefixInput'\n                ref='prefix'\n                name='prefix'\n                floatingLabelText='Prefix'\n                value={ get(formData, 'prefix', '')}\n                onChange={ this.changeState.bind(this, 'prefix')}\n                hintText=''\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={5}>\n              <TextField\n                id='givenInput'\n                ref='given'\n                name='given'\n                floatingLabelText='Given Name'\n                hintText='Jane'\n                value={ get(formData, 'given', '')}\n                onChange={ this.changeState.bind(this, 'given')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={3}>\n              <TextField\n                id='familyInput'\n                ref='family'\n                name='family'\n                floatingLabelText='Family Name'\n                hintText='Doe'\n                value={ get(formData, 'family', '')}\n                onChange={ this.changeState.bind(this, 'family')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n\n            </Col>\n            <Col md={3}>\n              <TextField\n                id='suffixInput'\n                ref='suffix'\n                name='suffix'\n                floatingLabelText='Suffix / Maiden'\n                hintText=''\n                value={ get(formData, 'suffix', '')}\n                onChange={ this.changeState.bind(this, 'suffix')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n          </Row>\n          <Row>\n            <Col md={3}>\n              <TextField\n                id='maritalStatusInput'\n                ref='maritalStatus'\n                name='maritalStatus'\n                floatingLabelText='Marital Status'\n                hintText='single | maried | other'\n                value={ get(formData, 'maritalStatus', '')}\n                onChange={ this.changeState.bind(this, 'maritalStatus')}\n                floatingLabelFixed={false}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={3}>\n              <TextField\n                id='genderInput'\n                ref='gender'\n                name='gender'\n                floatingLabelText='Gender'\n                hintText='male | female | unknown'\n                value={ get(formData, 'gender', '')}\n                onChange={ this.changeState.bind(this, 'gender')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={3}>\n              {/* <br />\n              { this.renderDatePicker(true, get(formData, 'birthDate') ) } */}\n\n              <TextField\n                id='birthDateInput'\n                ref='birthDate'\n                name='birthDate'\n                type='date'\n                floatingLabelText='Birthdate'\n                // hintText='YYYY-MM-DD'\n                value={ get(formData, 'birthDate', '')}\n                onChange={ this.changeState.bind(this, 'birthDate')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={3} >\n              <br />\n              <Toggle\n                label=\"Multiple Birth\"\n                defaultToggled={false}\n                labelPosition=\"right\"\n                style={styles.toggle}\n              />              \n            </Col>\n          </Row>\n          <Row>\n            <Col md={6}>\n              <TextField\n                id='photoInput'\n                ref='photo'\n                name='photo'\n                floatingLabelText='Photo'\n                hintText='http://somewhere.com/image.jpg'\n                value={ get(formData, 'photo', '')}\n                onChange={ this.changeState.bind(this, 'photo')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={3}>\n              <TextField\n                id='speciesInput'\n                ref='species'\n                name='species'\n                floatingLabelText='Species'\n                value={ get(formData, 'species', '')}\n                hintText='Human'\n                onChange={ this.changeState.bind(this, 'species')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={3}>\n              <TextField\n                id='languageInput'\n                ref='language'\n                name='language'\n                floatingLabelText='Language'\n                value={ get(formData, 'language', '')}\n                onChange={ this.changeState.bind(this, 'language')}\n                hintText='English'\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n          </Row>\n          <Row>\n            <Col md={6}>\n              <TextField\n                id='smartphoneInput'\n                ref='smartphone'\n                name='smartphone'\n                floatingLabelText='Phone'\n                hintText='773-555-1234'\n                value={ get(formData, 'smartphone', '')}\n                onChange={ this.changeState.bind(this, 'smartphone')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n          </Row>\n\n\n        </CardText>\n        <CardActions>\n          { this.determineButtons(this.data.patientId) }\n        </CardActions>\n      </div>\n    );\n  }\n  renderDatePicker(displayDatePicker, birthDate){\n    if (displayDatePicker) {\n      console.log('renderDatePicker', displayDatePicker, birthDate, typeof birthDate)\n\n      let javascriptDate;\n      let momentDate;\n\n      if(typeof birthDate === \"string\"){\n        momentDate = moment(birthDate).toDate();\n      } else {\n        momentDate = birthDate;\n      }\n    \n      console.log('javascriptDate', javascriptDate)\n      console.log('momentDate', momentDate)\n\n      return (\n        <DatePicker \n          name='birthDate'\n          hintText=\"Birthdate\" \n          container=\"inline\" \n          mode=\"landscape\"\n          value={ momentDate ? momentDate : null}    \n          onChange={ this.changeState.bind(this, 'birthDate')}      \n          floatingLabelFixed={true}\n          fullWidth\n        />\n      );\n    }\n  }\n  determineButtons(patientId){\n    if (patientId) {\n      return (\n        <div>\n          <RaisedButton id='updatePatientButton' className='updatePatientButton' label=\"Save\" primary={true} onClick={this.handleSaveButton.bind(this)} style={{marginRight: '20px'}} />\n          <RaisedButton id='deletePatientButton' label=\"Delete\" onClick={this.handleDeleteButton.bind(this)} />\n        </div>\n      );\n    } else {\n      return(\n        <RaisedButton id='savePatientButton'  className='savePatientButton' label=\"Save\" primary={true} onClick={this.handleSaveButton.bind(this)} />\n      );\n    }\n  }\n\n  updateFormData(formData, field, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"PatientDetail.updateFormData\", formData, field, textValue);\n\n    switch (field) {\n      case \"prefix\":\n        set(formData, 'prefix', textValue)\n        break;\n      case \"family\":\n        set(formData, 'family', textValue)\n        break;\n      case \"given\":\n        set(formData, 'given', textValue)\n        break;        \n      case \"suffix\":\n        set(formData, 'suffix', textValue)\n        break;\n      case \"identifier\":\n        set(formData, 'identifier', textValue)\n        break;\n      case \"gender\":\n        set(formData, 'gender', textValue)\n        break;\n      case \"maritalStatus\":\n        set(formData, 'maritalStatus', textValue)\n        break;\n      case \"deceased\":\n        set(formData, 'deceased', textValue)\n        break;\n      case \"multipleBirth\":\n        set(formData, 'multipleBirth', textValue)\n        break;\n      case \"species\":\n        set(formData, 'species', textValue)\n        break;\n      case \"language\":\n        set(formData, 'language', textValue)\n        break;\n      case \"photo\":\n        set(formData, 'photo', textValue)\n        break;\n      case \"birthDate\":\n        set(formData, 'birthDate', textValue)\n        break;\n      case \"smartphone\":\n        set(formData, 'smartphone', textValue)\n        break;\n      default:\n    }\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"formData\", formData);\n    return formData;\n  }\n  updatePatient(patientData, field, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"PatientDetail.updatePatient\", patientData, field, textValue);\n\n    switch (field) {\n      case \"prefix\":\n        set(patientData, 'name[0].prefix[0]', textValue)\n        break;\n      case \"family\":\n        set(patientData, 'name[0].family[0]', textValue)\n        break;\n      case \"given\":\n        set(patientData, 'name[0].given[0]', textValue)\n        break;        \n      case \"suffix\":\n        set(patientData, 'name[0].suffix[0]', textValue)\n        break;\n      case \"identifier\":\n        set(patientData, 'identifier[0].value', textValue)\n        break;\n      case \"deceased\":\n        set(patientData, 'deceasedBoolean', textValue)\n        break;\n      case \"multipleBirth\":\n        set(patientData, 'multipleBirthBoolean', textValue)\n        break;\n      case \"gender\":\n        set(patientData, 'gender', textValue)\n        break;\n      case \"maritalStatus\":\n        set(patientData, 'maritalStatus.text', textValue)\n        break;\n      case \"species\":\n        set(patientData, 'animal.species.text', textValue)\n        break;\n      case \"language\":\n        set(patientData, 'communication[0].language.text', textValue)\n        break;  \n      case \"photo\":\n        set(patientData, 'photo[0].url', textValue)\n        break;\n      case \"smartphone\":\n        set(patientData, 'telecom[0].value', textValue)\n        break;\n      case \"birthDate\":\n        set(patientData, 'birthDate', textValue)\n        break;\n    }\n    return patientData;\n  }\n  changeState(field, event, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"   \");\n    if(process.env.NODE_ENV === \"test\") console.log(\"PatientDetail.changeState\", field, textValue);\n    if(process.env.NODE_ENV === \"test\") console.log(\"this.state\", this.state);\n\n    let formData = Object.assign({}, this.state.form);\n    let patientData = Object.assign({}, this.state.patient);\n\n    formData = this.updateFormData(formData, field, textValue);\n    patientData = this.updatePatient(patientData, field, textValue);\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"patientData\", patientData);\n    if(process.env.NODE_ENV === \"test\") console.log(\"formData\", formData);\n\n    this.setState({patient: patientData})\n    this.setState({form: formData})\n  }\n\n\n  // this could be a mixin\n  handleSaveButton(){\n    if(process.env.NODE_ENV === \"test\") console.log('^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&&')\n    console.log('Saving a new Patient...', this.state)\n\n    let self = this;\n    let fhirPatientData = Object.assign({}, this.state.patient);\n\n    if(process.env.NODE_ENV === \"test\") console.log('fhirPatientData', fhirPatientData);\n\n\n    let patientValidator = PatientSchema.newContext();\n    console.log('patientValidator', patientValidator)\n    patientValidator.validate(fhirPatientData)\n\n    console.log('IsValid: ', patientValidator.isValid())\n    // console.log('ValidationErrors: ', patientValidator.validationErrors());\n\n    if (this.state.patientId) {\n      if(process.env.NODE_ENV === \"test\") console.log(\"Updating patient...\");\n\n      delete fhirPatientData._id;\n\n      // not sure why we're having to respecify this; fix for a bug elsewhere\n      fhirPatientData.resourceType = 'Patient';\n\n      Patients._collection.update({_id: this.state.patientId}, {$set: fhirPatientData }, function(error, result){\n        if (error) {\n          if(process.env.NODE_ENV === \"test\") console.log(\"Patients.insert[error]\", error);\n          Bert.alert(error.reason, 'danger');\n        }\n        if (result) {\n          HipaaLogger.logEvent({eventType: \"update\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"Patients\", recordId: self.state.patientId});\n          Session.set('selectedPatientId', false);\n          Session.set('patientPageTabIndex', 1);\n          Bert.alert('Patient added!', 'success');\n        }\n      });\n    } else {\n      if(process.env.NODE_ENV === \"test\") console.log(\"Creating a new patient...\", fhirPatientData);\n\n      Patients._collection.insert(fhirPatientData, function(error, result) {\n        if (error) {\n          if(process.env.NODE_ENV === \"test\")  console.log('Patients.insert[error]', error);\n          Bert.alert(error.reason, 'danger');\n        }\n        if (result) {\n          HipaaLogger.logEvent({eventType: \"create\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"Patients\", recordId: self.state.patientId});\n          Session.set('patientPageTabIndex', 1);\n          Session.set('selectedPatientId', false);\n          Bert.alert('Patient added!', 'success');\n        }\n      });\n    }\n  }\n\n  handleCancelButton(){\n    Session.set('patientPageTabIndex', 1);\n  }\n\n  handleDeleteButton(){\n    let self = this;\n    Patients._collection.animalremove({_id: this.state.patientId}, function(error, result){\n      if (error) {\n        if(process.env.NODE_ENV === \"test\") console.log('Patients.insert[error]', error);\n        Bert.alert(error.reason, 'danger');\n      }\n      if (result) {\n        HipaaLogger.logEvent({eventType: \"delete\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"Patients\", recordId: self.state.patientId});\n        Session.set('patientPageTabIndex', 1);\n        Session.set('selectedPatientId', false);\n        Bert.alert('Patient removed!', 'success');\n      }\n    });\n  }\n}\n\nPatientDetail.propTypes = {\n  id: PropTypes.string,\n  fhirVersion: PropTypes.string,\n  patientId: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  patient: PropTypes.oneOfType([PropTypes.object, PropTypes.bool])\n};\nReactMixin(PatientDetail.prototype, ReactMeteorData);\nexport default PatientDetail;","import { Card, CardActions, CardMedia, CardText, CardTitle, Toggle } from 'material-ui';\n\nimport FlatButton from 'material-ui/FlatButton';\nimport { HTTP } from 'meteor/http';\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\nimport { Table } from 'react-bootstrap';\nimport { Session } from 'meteor/session';\nimport { has, get } from 'lodash';\nimport { TableNoData } from 'meteor/clinical:glass-ui'\nimport PropTypes from 'prop-types';\n\nimport { FaTags, FaCode, FaPuzzlePiece, FaLock  } from 'react-icons/fa';\nimport { GoTrashcan } from 'react-icons/go'\n\nflattenPatient = function(person){\n  let result = {\n    _id: person._id,\n    id: person.id,\n    active: true,\n    gender: get(person, 'gender'),\n    name: '',\n    mrn: '',\n    birthDate: '',\n    photo: \"/thumbnail-blank.png\",\n    initials: 'abc'\n  };\n\n  result.active = get(person, 'active', true).toString();\n\n  // there's an off-by-1 error between momment() and Date() that we want\n  // to account for when converting back to a string\n  result.birthDate = moment(person.birthDate).format(\"YYYY-MM-DD\")\n  result.photo = get(person, 'photo[0].url', '');\n  result.identifier = get(person, 'identifier[0].value', '');\n\n  result.maritalStatus = get(person, 'maritalStatus.text', '');\n  result.deceased = get(person, 'deceasedBoolean', '');\n  result.species = get(person, 'animal.species.text', '');\n  result.language = get(person, 'communication[0].language.text', '');\n\n  let nameText = get(person, 'name[0].text', '');\n  if(nameText.length > 0){\n    result.name = get(person, 'name[0].text', '');    \n  } else {\n    if(get(person, 'name[0].suffix[0]')){\n      result.name = get(person, 'name[0].suffix[0]')  + ' ';\n    }\n\n    result.name = result.name + get(person, 'name[0].given[0]') + ' ' + get(person, 'name[0].family[0]');\n    \n    if(get(person, 'name[0].suffix[0]')){\n      result.name = result.name + ' ' + get(person, 'name[0].suffix[0]');\n    }\n  }\n\n  return result;\n}\n\nexport class PatientTable extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n  getMeteorData() {\n    let data = {\n      style: {\n        hideOnPhone: {\n          visibility: 'visible',\n          display: 'table'\n        },\n        cellHideOnPhone: {\n          visibility: 'visible',\n          display: 'table',\n          paddingTop: '16px',\n          maxWidth: '120px'\n        },\n        cell: {\n          paddingTop: '16px'\n        },\n        avatar: {\n          // color: rgb(255, 255, 255);\n          backgroundColor: 'rgb(188, 188, 188)',\n          userSelect: 'none',\n          borderRadius: '2px',\n          height: '40px',\n          width: '40px'\n        }\n      },\n      selected: [],\n      patients: []\n    };\n\n    let query = {};\n    let options = {};\n\n    // number of items in the table should be set globally\n    if (get(Meteor, 'settings.public.defaults.paginationLimit')) {\n      options.limit = get(Meteor, 'settings.public.defaults.paginationLimit');\n    }\n    // but can be over-ridden by props being more explicit\n    if(this.props.limit){\n      options.limit = this.props.limit;      \n    }\n\n    if(this.props.data){\n      // console.log('this.props.data', this.props.data);\n\n      if(this.props.data.length > 0){              \n        this.props.data.forEach(function(patient){\n          data.patients.push(flattenPatient(patient));\n        });  \n      }\n    } else {\n      data.patients = Patients.find().map(function(patient){\n        return flattenPatient(patient);\n      });\n    }\n\n\n    if (Session.get('appWidth') < 768) {\n      data.style.hideOnPhone.visibility = 'hidden';\n      data.style.hideOnPhone.display = 'none';\n      data.style.cellHideOnPhone.visibility = 'hidden';\n      data.style.cellHideOnPhone.display = 'none';\n    } else {\n      data.style.hideOnPhone.visibility = 'visible';\n      data.style.hideOnPhone.display = 'table-cell';\n      data.style.cellHideOnPhone.visibility = 'visible';\n      data.style.cellHideOnPhone.display = 'table-cell';\n    }\n\n    console.log(\"PatientTable[data]\", data);\n    return data;\n  }\n  imgError(avatarId) {\n    this.refs[avatarId].src = Meteor.absoluteUrl() + 'noAvatar.png';\n  }\n  rowClick(id){\n    Session.set('patientsUpsert', false);\n    Session.set('selectedPatientId', id);\n    Session.set('patientPageTabIndex', 2);\n  }\n  renderRowAvatarHeader(){\n    if (get(Meteor, 'settings.public.defaults.avatars') && (this.props.showAvatars === true)) {\n      return (\n        <th className='avatar'>photo</th>\n      );\n    }\n  }\n  renderRowAvatar(patient, avatarStyle){\n    //console.log('renderRowAvatar', patient, avatarStyle)\n    \n    if (get(Meteor, 'settings.public.defaults.avatars') && (this.props.showAvatars === true)) {\n      return (\n        <td className='avatar'>\n          <img src={patient.photo} ref={patient._id} onError={ this.imgError.bind(this, patient._id) } style={avatarStyle}/>\n        </td>\n      );\n    }\n  }\n  renderSpeciesHeader(displaySpecies){\n    if(displaySpecies){\n      return (\n        <th className='species'>Species</th>\n      );\n    }\n  }\n  renderSpeciesRow(displaySpecies, patient){\n    if(displaySpecies){\n      return (\n        <td className='species' style={this.data.style.cellHideOnPhone}>\n          {patient.species}\n        </td>\n      );\n    }\n\n  }\n  renderSendButtonHeader(){\n    if (this.props.showSendButton === true) {\n      return (\n        <th className='sendButton' style={this.data.style.hideOnPhone}></th>\n      );\n    }\n  }\n  renderSendButton(patient, avatarStyle){\n    if (this.props.showSendButton === true) {\n      return (\n        <td className='sendButton' style={this.data.style.hideOnPhone}>\n          <FlatButton label=\"send\" onClick={this.onSend.bind('this', this.data.patients[i]._id)}/>\n        </td>\n      );\n    }\n  }\n  onSend(id){\n    let patient = Patients.findOne({_id: id});\n\n    console.log(\"PatientTable.onSend()\", patient);\n\n    var httpEndpoint = \"http://localhost:8080\";\n    if (get(Meteor, 'settings.public.interfaces.default.channel.endpoint')) {\n      httpEndpoint = get(Meteor, 'settings.public.interfaces.default.channel.endpoint');\n    }\n    HTTP.post(httpEndpoint + '/Patient', {\n      data: patient\n    }, function(error, result){\n      if (error) {\n        console.log(\"error\", error);\n      }\n      if (result) {\n        console.log(\"result\", result);\n      }\n    });\n  }\n  selectPatientRow(patientId, foo, bar){\n    console.log('Selecting a new Patient...');\n    console.log('patientId', patientId, foo, bar)\n    if(typeof this.props.onRowClick === \"function\"){\n      console.log('Apparently we received an onRowClick() as a prop')\n      this.props.onRowClick(patientId);\n    } else {\n      Session.set('selectedPatientId', patientId);\n      Session.set('selectedPatient', Patients.findOne(patientId));\n    }\n  }\n  renderToggleHeader(){\n    if (!this.props.hideToggle) {\n      return (\n        <th className=\"toggle\" style={{width: '60px'}} >Toggle</th>\n      );\n    }\n  }\n  renderToggle(){\n    if (!this.props.hideToggle) {\n      return (\n        <td className=\"toggle\" style={{width: '60px'}}>\n            <Toggle\n              defaultToggled={true}\n            />\n          </td>\n      );\n    }\n  }\n  renderActionIconsHeader(){\n    if (!this.props.hideActionIcons) {\n      return (\n        <th className='actionIcons' style={{minWidth: '120px'}}>Actions</th>\n      );\n    }\n  }\n  renderActionIcons(patient ){\n    if (!this.props.hideActionIcons) {\n      let iconStyle = {\n        marginLeft: '4px', \n        marginRight: '4px', \n        marginTop: '4px', \n        fontSize: '120%'\n      }\n\n      return (\n        <td className='actionIcons' style={{minWidth: '120px'}}>\n          <FaTags style={iconStyle} onClick={this.showSecurityDialog.bind(this, patient)} />\n          <GoTrashcan style={iconStyle} onClick={this.removeRecord.bind(this, patient._id)} />  \n        </td>\n      );\n    }\n  } \n\n  renderMaritalStatusHeader(){\n    if (!this.props.hideMaritalStatus) {\n      return (\n        <th className=\"maritalStatus\">Marital Status</th>\n      );\n    }\n  }\n  renderMaritalStatus(patient){\n    if (!this.props.hideMaritalStatus) {\n      return (\n        <td className='maritalStatus'>{patient.maritalStatus}</td>\n      );\n    }\n  }\n\n  renderLanguageHeader(){\n    if (!this.props.hideLanguage) {\n      return (\n        <th className=\"language\">Language</th>\n      );\n    }\n  }\n  renderLanguage(patient){\n    if (!this.props.hideLanguage) {\n      return (\n        <td className='language'>{patient.language}</td>\n      );\n    }\n  }\n  removeRecord(_id){\n    console.log('Remove patient ', _id)\n    Patients._collection.remove({_id: _id})\n  }\n  showSecurityDialog(patient){\n    console.log('showSecurityDialog', patient)\n\n    Session.set('securityDialogResourceJson', Patients.findOne(get(patient, '_id')));\n    Session.set('securityDialogResourceType', 'Patient');\n    Session.set('securityDialogResourceId', get(patient, '_id'));\n    Session.set('securityDialogOpen', true);\n  }\n  render () {\n    let tableRows = [];\n    let footer;\n\n    if(this.data.patients.length === 0){\n      footer = <TableNoData noDataPadding={ this.props.noDataMessagePadding } />\n    } else {\n      for (var i = 0; i < this.data.patients.length; i++) {\n\n        let rowStyle = {\n          cursor: 'pointer'\n        }\n        if(get(this.data.patients[i], 'modifierExtension[0]')){\n          rowStyle.color = \"orange\";\n        }\n\n        tableRows.push(\n          <tr key={i} className=\"patientRow\" style={rowStyle} onClick={this.selectPatientRow.bind(this, this.data.patients[i]._id )} >\n  \n            { this.renderToggle(this.data.patients[i]) }\n            { this.renderActionIcons(this.data.patients[i]) }\n\n            { this.renderRowAvatar(this.data.patients[i], this.data.style.avatar) }\n  \n            <td className='identifier' style={this.data.style.cellHideOnPhone}>{this.data.patients[i].identifier}</td>\n            <td className='name' onClick={ this.rowClick.bind('this', this.data.patients[i]._id)} style={this.data.style.cell}>{this.data.patients[i].name }</td>\n            <td className='gender' onClick={ this.rowClick.bind('this', this.data.patients[i]._id)} style={this.data.style.cell}>{this.data.patients[i].gender}</td>\n            <td className='birthDate' onClick={ this.rowClick.bind('this', this.data.patients[i]._id)} style={{minWidth: '100px', paddingTop: '16px'}}>{this.data.patients[i].birthDate }</td>\n\n            { this.renderMaritalStatus(this.data.patients[i]) }\n            { this.renderLanguage(this.data.patients[i]) }\n\n            {/* <td className='maritalStatus' style={this.data.style.cellHideOnPhone}>{this.data.patients[i].maritalStatus}</td> */}\n            {/* <td className='language' style={this.data.style.cellHideOnPhone}>{this.data.patients[i].language}</td> */}\n            <td className='isActive' onClick={ this.rowClick.bind('this', this.data.patients[i]._id)} style={this.data.style.cellHideOnPhone}>{this.data.patients[i].active}</td>\n\n              { this.renderSpeciesRow(this.props.displaySpecies, this.data.patients[i]) }\n              { this.renderSendButton(this.data.patients[i], this.data.style.avatar) }\n          </tr>\n        );\n      }\n    }\n    \n\n\n    return(\n      <div>\n        <Table id='patientsTable' hover >\n          <thead>\n            <tr>\n              { this.renderToggleHeader() }\n              { this.renderActionIconsHeader() }\n              { this.renderRowAvatarHeader() }\n  \n              <th className='identifier' style={this.data.style.hideOnPhone}>Identifier</th>\n              <th className='name'>Name</th>\n              <th className='gender'>Gender</th>\n              <th className='birthdate' style={{minWidth: '100px'}}>Birthdate</th>\n\n              { this.renderMaritalStatusHeader(this.data.patients[i]) }\n              { this.renderLanguageHeader(this.data.patients[i]) }\n\n              {/* <th className='maritalStatus' style={this.data.style.hideOnPhone}>Marital Status</th> */}\n              {/* <th className='language' style={this.data.style.hideOnPhone}>Language</th> */}\n              <th className='isActive' style={this.data.style.hideOnPhone}>Active</th>\n              \n              { this.renderSpeciesHeader(this.props.displaySpecies) }\n              { this.renderSendButtonHeader() }\n            </tr>\n          </thead>\n          <tbody>\n            { tableRows }\n          </tbody>\n        </Table>\n        { footer }\n      </div>\n    );\n  }\n}\n\nPatientTable.propTypes = {\n  id: PropTypes.string,\n  data: PropTypes.array,\n  fhirVersion: PropTypes.string,\n  showSendButton: PropTypes.bool,\n  displaySpecies: PropTypes.bool,\n  onRowClick: PropTypes.func,\n  hideToggle: PropTypes.bool,\n  hideActionIcons: PropTypes.bool,\n  hideMaritalStatus: PropTypes.bool,\n  hideLanguage: PropTypes.bool,\n  noDataMessagePadding: PropTypes.number  \n};\n\nReactMixin(PatientTable.prototype, ReactMeteorData);\nexport default PatientTable;","import { CardText, CardTitle } from 'material-ui/Card';\nimport { Tab, Tabs } from 'material-ui/Tabs';\nimport { Glass, GlassCard, VerticalCanvas, FullPageCanvas } from 'meteor/clinical:glass-ui';\n\nimport PatientDetail from './PatientDetail';\nimport PatientTable from './PatientTable';\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\nimport PropTypes from 'prop-types';\n\nimport { Meteor } from 'meteor/meteor';\nimport { Session } from 'meteor/session';\n\nlet defaultPatient = {\n  index: 2,\n  id: '',\n  username: '',\n  email: '',\n  given: '',\n  family: '',\n  gender: ''\n};\nSession.setDefault('patientFormData', defaultPatient);\nSession.setDefault('patientSearchFilter', '');\nSession.setDefault('selectedPatientId', false);\nSession.setDefault('fhirVersion', 'v1.0.2');\n\nexport class PatientsPage extends React.Component {\n  getMeteorData() {\n    let data = {\n      style: {\n        opacity: Session.get('globalOpacity'),\n        tab: {\n          borderBottom: '1px solid lightgray',\n          borderRight: 'none'\n        }\n      },\n      tabIndex: Session.get('patientPageTabIndex'),\n      patientSearchFilter: Session.get('patientSearchFilter'),\n      fhirVersion: Session.get('fhirVersion'),\n      selectedPatientId: Session.get(\"selectedPatientId\"),\n      selectedPatient: false\n    };\n\n    \n    if (Session.get('selectedPatientId')){\n      data.selectedPatient = Patients.findOne({_id: Session.get('selectedPatientId')});\n    } else {\n      data.selectedPatient = false;\n    }\n\n\n    data.style = Glass.blur(data.style);\n    data.style.appbar = Glass.darkroom(data.style.appbar);\n    data.style.tab = Glass.darkroom(data.style.tab);\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"PatientsPage[data]\", data);\n    return data;\n  }\n\n  handleTabChange(index){\n    Session.set('patientPageTabIndex', index);\n  }\n\n  onNewTab(){\n    Session.set('selectedPatientId', false);\n    Session.set('patientUpsert', false);\n  }\n\n  render() {\n    console.log('React.version: ' + React.version);\n    return (\n      <div id=\"patientsPage\">\n        <VerticalCanvas>\n          <GlassCard height=\"auto\">\n            <CardTitle\n              title=\"Patients\"\n            />\n            <CardText>\n              <Tabs id='patientsPageTabs' default value={this.data.tabIndex} onChange={this.handleTabChange} initialSelectedIndex={1}>\n                 <Tab className=\"newPatientTab\" label='New' style={this.data.style.tab} onActive={ this.onNewTab } value={0}>\n                   <PatientDetail \n                      fhirVersion={ this.data.fhirVersion }\n                      id='newPatient' />\n                 </Tab>\n                 <Tab className=\"patientListTab\" label='Patients' onActive={this.handleActive} style={this.data.style.tab} value={1}>\n                   <PatientTable \n                      noDataMessagePadding={100}\n                      />\n                 </Tab>\n                 <Tab className=\"patientDetailTab\" label='Detail' onActive={this.handleActive} style={this.data.style.tab} value={2}>\n                   <PatientDetail \n                      id='patientDetails' \n                      fhirVersion={ this.data.fhirVersion }\n                      patient={ this.data.selectedPatient }\n                      patientId={ this.data.selectedPatientId }\n                    />\n                 </Tab>\n             </Tabs>\n\n\n            </CardText>\n          </GlassCard>\n        </VerticalCanvas>\n      </div>\n    );\n  }\n}\n\n\n\nReactMixin(PatientsPage.prototype, ReactMeteorData);\n\nexport default PatientsPage;"]}