{"version":3,"sources":["meteor://ðŸ’»app/packages/clinical:hl7-resource-patient/lib/Patients.js","meteor://ðŸ’»app/packages/clinical:hl7-resource-patient/index.jsx","meteor://ðŸ’»app/packages/clinical:hl7-resource-patient/client/react/PatientCard.jsx","meteor://ðŸ’»app/packages/clinical:hl7-resource-patient/client/react/PatientDetail.jsx","meteor://ðŸ’»app/packages/clinical:hl7-resource-patient/client/react/PatientTable.jsx","meteor://ðŸ’»app/packages/clinical:hl7-resource-patient/client/react/PatientsPage.jsx"],"names":["module","export","Patient","Patients","PatientSchema","PatientStu3","PatientDstu2","BaseModel","link","v","Mongo","SimpleSchema","BaseSchema","DomainResourceSchema","HumanNameSchema","IdentifierSchema","ContactPointSchema","AddressSchema","Package","console","log","extend","prototype","_collection","Collection","connection","_transform","document","type","String","defaultValue","optional","Array","Boolean","allowedValues","Date","autoValue","dateArray","date","value","field","split","CodeableConceptSchema","Number","AttachmentSchema","Object","Code","PeriodSchema","ReferenceSchema","attachSchema","toFhir","EJSON","stringify","name","findUserId","userId","process","env","TRACE","find","findOneUserId","findOne","findMrn","fetchBundle","query","parameters","callback","patientArray","map","patient","id","_id","_document","result","Bundle","generate","toMongo","originalPatient","mongoRecord","identifier","forEach","period","start","startArray","end","endArray","toStu3","patientJson","birthDate","deceasedBoolean","family","text","given","prepForUpdate","resourceType","telecom","address","contact","prepForFhirTransfer","moment","format","displayName","extension","url","valueString","removeProtectedInfo","options","anonymizedName","push","anonymize","Anon","secretGiven","anonName","i","length","phone","ssn","SidebarElements","DynamicRoutes","PatientsPage","PatientTable","PatientDetail","PatientCard","React","ReactMixin","ListItem","GlassCard","Glass","DynamicSpacer","Card","CardActions","CardHeader","CardText","CardTitle","Col","Grid","Row","TextField","get","style","avatar","position","zIndex","transition","left","top","width","height","photo","title","synopsis","marginLeft","patientCard","props","render","active","familyName","givenName","fullName","email","birthdate","gender","zDepth","otherProps","imgError","bind","updateGivenName","updateFamilyName","updateBirthdate","updateGender","updateAvatar","children","refs","avatarImage","src","Meteor","absoluteUrl","Component","exportDefault","DatePicker","Toggle","RaisedButton","has","set","ReactMeteorData","PropTypes","Session","styles","block","maxWidth","toggle","marginTop","thumbOff","backgroundColor","trackOff","thumbSwitched","trackSwitched","labelStyle","color","state","patientId","prefix","suffix","use","coding","system","code","multipleBirthBoolean","maritalStatus","animal","species","communication","language","careProvider","display","reference","managingOrganization","form","deceased","multipleBirth","dehydrateFhirResource","formData","assign","shouldComponentUpdate","nextProps","NODE_ENV","shouldUpdate","setState","getMeteorData","data","displayBirthdate","changeState","determineButtons","renderDatePicker","displayDatePicker","javascriptDate","momentDate","toDate","handleSaveButton","marginRight","handleDeleteButton","updateFormData","textValue","updatePatient","patientData","event","self","fhirPatientData","patientValidator","newContext","validate","isValid","update","$set","error","Bert","alert","reason","HipaaLogger","logEvent","eventType","userName","user","collectionName","recordId","insert","handleCancelButton","animalremove","propTypes","string","fhirVersion","oneOfType","bool","object","Avatar","FlatButton","HTTP","Table","TableNoData","flattenPatient","person","mrn","initials","toString","nameText","hideOnPhone","visibility","cellHideOnPhone","paddingTop","cell","userSelect","borderRadius","selected","patients","limit","avatarId","rowClick","renderRowAvatarHeader","showAvatars","renderRowAvatar","avatarStyle","renderSpeciesHeader","displaySpecies","renderSpeciesRow","renderSendButtonHeader","showSendButton","renderSendButton","onSend","httpEndpoint","post","selectPatientRow","onRowClick","tableRows","footer","noDataMessagePadding","cursor","minWidth","number","Tab","Tabs","VerticalCanvas","FullPageCanvas","defaultPatient","index","username","setDefault","opacity","tab","borderBottom","borderRight","tabIndex","patientSearchFilter","selectedPatientId","selectedPatient","blur","appbar","darkroom","handleTabChange","onNewTab","version","handleActive"],"mappings":"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","file":"/packages/clinical_hl7-resource-patient.js","sourcesContent":["if(Package['clinical:autopublish']){\n  console.log(\"*****************************************************************************\")\n  console.log(\"HIPAA WARNING:  Your app has the 'clinical-autopublish' package installed.\");\n  console.log(\"Any protected health information (PHI) stored in this app should be audited.\"); \n  console.log(\"Please consider writing secure publish/subscribe functions and uninstalling.\");  \n  console.log(\"\");  \n  console.log(\"meteor remove clinical:autopublish\");  \n  console.log(\"\");  \n}\nif(Package['autopublish']){\n  console.log(\"*****************************************************************************\")\n  console.log(\"HIPAA WARNING:  DO NOT STORE PROTECTED HEALTH INFORMATION IN THIS APP. \");  \n  console.log(\"Your application has the 'autopublish' package installed.  Please uninstall.\");\n  console.log(\"\");  \n  console.log(\"meteor remove autopublish\");  \n  console.log(\"meteor add clinical:autopublish\");  \n  console.log(\"\");  \n}\n\n\nimport { BaseModel } from 'meteor/clinical:base-model';\nimport { Mongo } from 'meteor/mongo';\nimport SimpleSchema from 'simpl-schema';\nimport { BaseSchema, DomainResourceSchema, HumanNameSchema, IdentifierSchema, ContactPointSchema, AddressSchema } from 'meteor/clinical:hl7-resource-datatypes';\n\n\n\n// create the object using our BaseModel\nPatient = BaseModel.extend();\n\n\n//Assign a collection so the object knows how to perform CRUD operations\nPatient.prototype._collection = Patients;\n\n\n// // Create a persistent data store for addresses to be stored.\n// // HL7.Resources.Patients = new Mongo.Collection('HL7.Resources.Patients');\n\nif(typeof Patients === 'undefined'){\n  if(Package['clinical:autopublish']){\n    Patients = new Mongo.Collection('Patients');\n  } else if(Package['clinical:desktop-publish']){\n    Patients = new Mongo.Collection('Patients');\n  } else {\n    Patients = new Mongo.Collection('Patients', {connection: null});\n  }\n}\n\n\n//Add the transform to the collection since Meteor.users is pre-defined by the accounts package\nPatients._transform = function (document) {\n  return new Patient(document);\n};\n\n\n\n\nPatientDstu2 = new SimpleSchema({\n  \"resourceType\" : {\n    type: String,\n    defaultValue: \"Patient\"\n  },\n  \"identifier\" : {\n    optional: true,\n    type:  Array\n    },\n  \"identifier.$\" : {\n    optional: true,\n    type:  IdentifierSchema \n    },\n  \"active\" : {\n    type: Boolean,\n    optional: true,\n    defaultValue: true\n    },\n  \"name\" : {\n    optional: true,\n    type: Array\n    },\n  \"name.$\" : {\n    optional: true,\n    type: HumanNameSchema \n    },\n  \"telecom\" : {\n    optional: true,\n    type: Array\n    },\n  \"telecom.$\" : {\n    optional: true,\n    type: ContactPointSchema\n    },\n  \"gender\" : {\n    optional: true,\n    allowedValues: ['male', 'female', 'other', 'unknown'],\n    type: String\n    },\n  \"birthDate\" : {\n    optional: true,\n    type: String,\n  },\n  \"_birthDate\" : {\n      optional: true,\n      type: Date,\n      autoValue: function() {\n        var dateArray = [];\n        var date;\n        var value = this.field('birthDate').value;\n        if(typeof value === 'string'){\n          dateArray = value.split('-');\n          date = new Date(dateArray[0], dateArray[1] - 1, dateArray[2])\n        }\n        \n        if(date){\n          return date;\n        }\n      }\n    },\n  \"deceasedBoolean\" : {\n    optional: true,\n    type: Boolean\n    },\n  \"deceasedDateTime\" : {\n    optional: true,\n    type: Date\n    },\n  \"address\" : {\n    optional: true,\n    type: Array\n    },\n  \"address.$\" : {\n    optional: true,\n    type: AddressSchema \n    },\n  \"maritalStatus\" : {\n    optional: true,\n    type: CodeableConceptSchema\n    },\n  \"multipleBirthBoolean\" : {\n    optional: true,\n    type: Boolean\n    },\n  \"multipleBirthInteger\" : {\n    optional: true,\n    type: Number\n    },\n  \"photo\" : {\n    optional: true,\n    type: Array\n    },\n  \"photo.$\" : {\n    optional: true,\n    type: AttachmentSchema \n    },\n\n  \"contact\" : {\n    optional: true,\n    type:  Array\n    },\n  \"contact.$\" : {\n    optional: true,\n    type:  Object \n    },    \n  \"contact.$.relationship\" : {\n    optional: true,\n    type: Array\n    },\n  \"contact.$.relationship.$\" : {\n    optional: true,\n    type: CodeableConceptSchema \n    },\n  \"contact.$.name\" : {\n    optional: true,\n    type: HumanNameSchema\n    },\n  \"contact.$.telecom\" : {\n    optional: true,\n    type: Array\n    },\n  \"contact.$.telecom.$\" : {\n    optional: true,\n    type: ContactPointSchema\n    },\n  \"contact.$.address\" : {\n    optional: true,\n    type: Array\n    },\n  \"contact.$.address.$\" : {\n    optional: true,\n    type: AddressSchema\n    },\n  \"contact.$.gender\" : {\n    optional: true,\n    allowedValues: ['male', 'female', 'other', 'unknown'],\n    type: Code\n    },\n  \"contact.$.organization\" : {\n    optional: true,\n    type: String\n    },\n  \"contact.$.period\" : {\n    optional: true,\n    type: PeriodSchema\n    },\n\n  \"animal\" : {\n    optional: true,\n    type: Object\n    },\n  \"animal.species\" : {\n    type: String\n    //type: CodeableConceptSchema\n    },\n  \"animal.breed\" : {\n    optional: true,\n    type: CodeableConceptSchema\n    },\n  \"animal.genderStatus\" : {\n    optional: true,\n    type: CodeableConceptSchema\n    },\n\n  \"communication\" : {\n    optional: true,\n    type:  Array\n    },\n  \"communication.$\" : {\n    optional: true,\n    type:  Object \n    },    \n  \"communication.$.language\" : {\n    type: CodeableConceptSchema\n    },\n  \"communication.$.preferred\" : {\n    optional: true,\n    type: Boolean\n    },\n  \"generalPractitioner\" : {\n    optional: true,\n    type: Array\n    },\n  \"generalPractitioner.$\" : {\n    optional: true,\n    type: ReferenceSchema\n    },\n  \"managingOrganization\" : {\n    optional: true,\n    type: ReferenceSchema\n    },\n\n  \"link\" : {\n    optional: true,\n    type:  Array\n    },\n  \"link.$\" : {\n    optional: true,\n    type:  Object \n    },   \n  \"link.$.other\" : {\n    type: ReferenceSchema\n    },\n  \"link.$.type\" : {\n    allowedValues: ['replacee', 'refer', 'seealso'],\n    type: Code\n    },\n  \"test\" : {\n    optional: true,\n    type: Boolean\n    }\n});\n\n\n\n\n\nPatientStu3 = new SimpleSchema({\n  \"resourceType\" : {\n    type: String,\n    defaultValue: \"Patient\"\n  },\n  \"identifier\" : {\n    optional: true,\n    type:  Array\n    },\n  \"identifier.$\" : {\n    optional: true,\n    type:  IdentifierSchema \n    },\n  \"active\" : {\n    type: Boolean,\n    optional: true,\n    defaultValue: true\n    },\n  \"name\" : {\n    optional: true,\n    type: Array\n    },\n  \"name.$\" : {\n    optional: true,\n    type: HumanNameSchema \n    },\n  \"telecom\" : {\n    optional: true,\n    type: Array\n    },\n  \"telecom.$\" : {\n    optional: true,\n    type: ContactPointSchema\n    },\n  \"gender\" : {\n    optional: true,\n    allowedValues: ['male', 'female', 'other', 'unknown'],\n    type: String\n    },\n  \"birthDate\" : {\n    optional: true,\n    type: String,\n  },\n  \"_birthDate\" : {\n      optional: true,\n      type: Date,\n      autoValue: function() {\n        var dateArray = [];\n        var date;\n        var value = this.field('birthDate').value;\n        if(typeof value === 'string'){\n          dateArray = value.split('-');\n          date = new Date(dateArray[0], dateArray[1] - 1, dateArray[2])\n        }\n        \n        if(date){\n          return date;\n        }\n      }\n    },\n  \"deceasedBoolean\" : {\n    optional: true,\n    type: Boolean\n    },\n  \"deceasedDateTime\" : {\n    optional: true,\n    type: Date\n    },\n  \"address\" : {\n    optional: true,\n    type: Array\n    },\n  \"address.$\" : {\n    optional: true,\n    type: AddressSchema \n    },\n  \"maritalStatus\" : {\n    optional: true,\n    type: CodeableConceptSchema\n    },\n  \"multipleBirthBoolean\" : {\n    optional: true,\n    type: Boolean\n    },\n  \"multipleBirthInteger\" : {\n    optional: true,\n    type: Number\n    },\n  \"photo\" : {\n    optional: true,\n    type: Array\n    },\n  \"photo.$\" : {\n    optional: true,\n    type: AttachmentSchema \n    },\n\n  \"contact\" : {\n    optional: true,\n    type:  Array\n    },\n  \"contact.$\" : {\n    optional: true,\n    type:  Object \n    },    \n  \"contact.$.relationship\" : {\n    optional: true,\n    type: Array\n    },\n  \"contact.$.relationship.$\" : {\n    optional: true,\n    type: CodeableConceptSchema \n    },\n  \"contact.$.name\" : {\n    optional: true,\n    type: HumanNameSchema\n    },\n  \"contact.$.telecom\" : {\n    optional: true,\n    type: Array\n    },\n  \"contact.$.telecom.$\" : {\n    optional: true,\n    type: ContactPointSchema\n    },\n  \"contact.$.address\" : {\n    optional: true,\n    type: Array\n    },\n  \"contact.$.address.$\" : {\n    optional: true,\n    type: AddressSchema\n    },\n  \"contact.$.gender\" : {\n    optional: true,\n    allowedValues: ['male', 'female', 'other', 'unknown'],\n    type: Code\n    },\n  \"contact.$.organization\" : {\n    optional: true,\n    type: String\n    },\n  \"contact.$.period\" : {\n    optional: true,\n    type: PeriodSchema\n    },\n\n  \"animal\" : {\n    optional: true,\n    type: Object\n    },\n  \"animal.species\" : {\n    type: String\n    //type: CodeableConceptSchema\n    },\n  \"animal.breed\" : {\n    optional: true,\n    type: CodeableConceptSchema\n    },\n  \"animal.genderStatus\" : {\n    optional: true,\n    type: CodeableConceptSchema\n    },\n\n  \"communication\" : {\n    optional: true,\n    type:  Array\n    },\n  \"communication.$\" : {\n    optional: true,\n    type:  Object \n    },    \n  \"communication.$.language\" : {\n    type: CodeableConceptSchema\n    },\n  \"communication.$.preferred\" : {\n    optional: true,\n    type: Boolean\n    },\n  \"generalPractitioner\" : {\n    optional: true,\n    type: Array\n    },\n  \"generalPractitioner.$\" : {\n    optional: true,\n    type: ReferenceSchema\n    },\n  \"managingOrganization\" : {\n    optional: true,\n    type: ReferenceSchema\n    },\n\n  \"link\" : {\n    optional: true,\n    type:  Array\n    },\n  \"link.$\" : {\n    optional: true,\n    type:  Object \n    },   \n  \"link.$.other\" : {\n    type: ReferenceSchema\n    },\n  \"link.$.type\" : {\n    allowedValues: ['replacee', 'refer', 'seealso'],\n    type: Code\n    },\n  \"test\" : {\n    optional: true,\n    type: Boolean\n    }\n});\n\n\n\n\nPatientSchema = PatientDstu2;\n\n// BaseSchema.extend(PatientSchema);\n// DomainResourceSchema.extend(PatientSchema);\n\nPatients.attachSchema(PatientSchema);\n\n\nPatient.prototype.toFhir = function(){\n  console.log('Patient.toFhir()');\n\n\n\n  return EJSON.stringify(this.name);\n}\n\n/**\n * @summary Search the Patients collection for a specific Meteor.userId().\n * @memberOf Patients\n * @name findUserId\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n *  let patients = Patients.findUserId(Meteor.userId());\n *  let patient = patients[0];\n * ```\n */\n\nPatients.findUserId = function (userId) {\n  process.env.TRACE && console.log(\"Patients.findUserId()\");\n  return Patients.find({'identifier.value': userId});\n};\n\n/**\n * @summary Search the Patients collection for a specific Meteor.userId().\n * @memberOf Patients\n * @name findOneUserId\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n *  let patient = Patients.findOneUserId(Meteor.userId());\n * ```\n */\n\nPatients.findOneUserId = function (userId) {\n  process.env.TRACE && console.log(\"Patients.findOneUserId()\");  \n  return Patients.findOne({'identifier.value': userId});\n};\n/**\n * @summary Search the Patients collection for a specific Meteor.userId().\n * @memberOf Patients\n * @name findMrn\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n *  let patients = Patients.findMrn('12345').fetch();\n * ```\n */\n\nPatients.findMrn = function (userId) {\n  process.env.TRACE && console.log(\"Patients.findMrn()\");  \n  return Patients.find({'identifier.value': userId});\n};\n\n/**\n * @summary Search the Patients collection for a specific Meteor.userId().\n * @memberOf Patients\n * @name findMrn\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n *  let patients = Patients.findMrn('12345').fetch();\n * ```\n */\n\nPatients.fetchBundle = function (query, parameters, callback) {\n  process.env.TRACE && console.log(\"Patients.fetchBundle()\");  \n  var patientArray = Patients.find(query, parameters, callback).map(function(patient){\n    patient.id = patient._id;\n    delete patient._document;\n    return patient;\n  });\n\n  // console.log(\"patientArray\", patientArray);\n\n  var result = Bundle.generate(patientArray);\n\n  // console.log(\"result\", result.entry[0]);\n\n  return result;\n};\n\n\n/**\n * @summary This function takes a FHIR resource and prepares it for storage in Mongo.\n * @memberOf Patients\n * @name toMongo\n * @version 1.6.0\n * @returns { Patient }\n * @example\n * ```js\n *  let patients = Patients.toMongo('12345').fetch();\n * ```\n */\n\nPatients.toMongo = function (originalPatient) {\n  var mongoRecord;\n  process.env.TRACE && console.log(\"Patients.toMongo()\");  \n\n  if (originalPatient.identifier) {\n    originalPatient.identifier.forEach(function(identifier){\n      if (identifier.period) {\n        if (identifier.period.start) {\n          var startArray = identifier.period.start.split('-');\n          identifier.period.start = new Date(startArray[0], startArray[1] - 1, startArray[2]);\n        }\n        if (identifier.period.end) {\n          var endArray = identifier.period.end.split('-');\n          identifier.period.end = new Date(startArray[0], startArray[1] - 1, startArray[2]);\n        }\n      }\n    });\n  }\n\n  return originalPatient;\n};\n\n\n\n/**\n * @summary This function takes a DTSU2 resource and returns it as STU3.  i.e. it converts from v1.0.2 to v3.0.0\n * @name toMongo\n * @version 3.0.0\n * @returns { Patient }\n * @example\n * ```js\n * ```\n */\nPatients.toStu3 = function(patientJson){\n  if(patientJson){\n\n    // quick cast from string to boolean\n    if(typeof patientJson.birthDate === \"string\"){\n      patientJson.birthDate = new Date(patientJson.birthDate);\n    }\n\n    // quick cast from string to boolean\n    if(patientJson.deceasedBoolean){\n      patientJson.deceasedBoolean = (patientJson.deceasedBoolean == \"true\") ? true : false;\n    }\n\n    // STU3 only has a single entry for family name; not an array\n    if(patientJson.name && patientJson.name[0] && patientJson.name[0].family && patientJson.name[0].family[0] ){\n      patientJson.name[0].family = patientJson.name[0].family[0];      \n    }\n\n    // make sure the full name is filled out\n    if(patientJson.name && patientJson.name[0] && patientJson.name[0].family && !patientJson.name[0].text ){\n      patientJson.name[0].text = patientJson.name[0].given[0] + ' ' + patientJson.name[0].family;      \n    }\n  }\n  return patientJson;\n}\n\n\n/**\n * @summary Similar to toMongo(), this function prepares a FHIR record for storage in the Mongo database.  The difference being, that this assumes there is already an existing record.\n * @memberOf Patients\n * @name prepForUpdate\n * @version 1.6.0\n * @returns { Object }\n * @example\n * ```js\n *  let patients = Patients.findMrn('12345').fetch();\n * ```\n */\n\nPatients.prepForUpdate = function (patient) {\n  process.env.TRACE && console.log(\"Patients.prepForUpdate()\");  \n\n  if (patient.name && patient.name[0]) {\n    //console.log(\"patient.name\", patient.name);\n\n    patient.name.forEach(function(name){\n      name.resourceType = \"HumanName\";\n    });\n  }\n\n  if (patient.telecom && patient.telecom[0]) {\n    //console.log(\"patient.telecom\", patient.telecom);\n    patient.telecom.forEach(function(telecom){\n      telecom.resourceType = \"ContactPoint\";\n    });\n  }\n\n  if (patient.address && patient.address[0]) {\n    //console.log(\"patient.address\", patient.address);\n    patient.address.forEach(function(address){\n      address.resourceType = \"Address\";\n    });\n  }\n\n  if (patient.contact && patient.contact[0]) {\n    //console.log(\"patient.contact\", patient.contact);\n\n    patient.contact.forEach(function(contact){\n      if (contact.name) {\n        contact.name.resourceType = \"HumanName\";\n      }\n\n      if (contact.telecom && contact.telecom[0]) {\n        contact.telecom.forEach(function(telecom){\n          telecom.resourceType = \"ContactPoint\";\n        });\n      }\n\n    });\n  }\n\n  return patient;\n};\n\n\n/**\n * @summary Scrubbing the patient; make sure it conforms to v1.6.0\n * @memberOf Patients\n * @name scrub\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n *  let patients = Patients.findMrn('12345').fetch();\n * ```\n */\n\nPatients.prepForFhirTransfer = function (patient) {\n  process.env.TRACE && console.log(\"Patients.prepForFhirTransfer()\");  \n\n\n  // FHIR has complicated and unusual rules about dates in order\n  // to support situations where a family member might report on a patient's\n  // date of birth, but not know the year of birth; and the other way around\n  if (patient.birthDate) {\n    patient.birthDate = moment(patient.birthDate).format(\"YYYY-MM-DD\");\n  }\n\n\n  if (patient.name && patient.name[0]) {\n    //console.log(\"patient.name\", patient.name);\n\n    patient.name.forEach(function(name){\n      delete name.resourceType;\n    });\n  }\n\n  if (patient.telecom && patient.telecom[0]) {\n    //console.log(\"patient.telecom\", patient.telecom);\n    patient.telecom.forEach(function(telecom){\n      delete telecom.resourceType;\n    });\n  }\n\n  if (patient.address && patient.address[0]) {\n    //console.log(\"patient.address\", patient.address);\n    patient.address.forEach(function(address){\n      delete address.resourceType;\n    });\n  }\n\n  if (patient.contact && patient.contact[0]) {\n    //console.log(\"patient.contact\", patient.contact);\n\n    patient.contact.forEach(function(contact){\n\n      console.log(\"contact\", contact);\n\n\n      if (contact.name && contact.name.resourceType) {\n        //console.log(\"patient.contact.name\", contact.name);\n        delete contact.name.resourceType;\n      }\n\n      if (contact.telecom && contact.telecom[0]) {\n        contact.telecom.forEach(function(telecom){\n          delete telecom.resourceType;\n        });\n      }\n\n    });\n  }\n\n  //console.log(\"Patients.prepForBundle()\", patient);\n\n  return patient;\n};\n\n/**\n * @summary The displayed name of the patient.\n * @memberOf Patient\n * @name displayName\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n * ```\n */\n\nPatient.prototype.displayName = function () {\n  process.env.TRACE && console.log(\"Patients.displayName()\");  \n\n  if (this.name && this.name[0]) {\n    return this.name[0].text;\n  }\n};\n\n\n/**\n * @summary The displayed Meteor.userId() of the patient.\n * @memberOf Patient\n * @name userId\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n * ```\n */\n\nPatient.prototype.userId = function () {\n  process.env.TRACE && console.log(\"Patients.userId()\");  \n\n  var result = null;\n  if (this.extension) {\n    this.extension.forEach(function(extension){\n      if (extension.url === \"Meteor.userId()\") {\n        result = extension.valueString;\n      }\n    });\n  }\n  return result;\n};\n\n\n\n/**\n * @summary The displayed Meteor.userId() of the patient.\n * @memberOf Patient\n * @name userId\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n * ```\n */\n\n\n/**\n * @summary Anonymize the patient record\n * @memberOf Patient\n * @name removeProtectedInfo\n * @version 1.2.3\n * @returns {Object}\n * @example\n * ```js\n * ```\n */\n\nPatient.prototype.removeProtectedInfo = function (options) {\n  process.env.TRACE && console.log(\"Patients.anonymize()\", this);  \n\n  console.log(\"Patients.anonymize()\");  \n\n  // 1. Names\n  if(this.name && this.name[0]){\n    var anonymizedName = this.name[0];\n\n    if(this.name[0].family){\n      anonymizedName.family = '';\n    }\n    if(this.name[0].given && this.name[0].given[0]){\n      anonymizedName.given = [];          \n    }\n    if(this.name[0].text){\n      anonymizedName.text = '';\n    }\n\n    this.name = [];\n    this.name.push(anonymizedName);\n  }\n\n  // 3.  dates\n\n\n  // 4. Phone numbers\n  // 5.  Fax Numbers\n  // 6.  Identifiers\n  // 7.  Medical Record Nubers\n  // 17.  Photos\n\n  return this;\n}\n\n\n/**\n * @summary Anonymize the patient record\n * @memberOf Patient\n * @name anonymize\n * @version 1.2.3\n * @returns {Object}\n * @example\n * ```js\n * ```\n */\n\nPatient.prototype.anonymize = function () {\n  process.env.TRACE && console.log(\"Patients.hash()\", this);  \n\n  console.log(\"Patients.hash()\");  \n\n\n  if(this.name && this.name[0]){\n    var anonymizedName = this.name[0];\n\n    if(this.name[0].family){\n      anonymizedName.family = Anon.name(this.name[0].family);        \n    }\n    if(this.name[0].given && this.name[0].given[0]){\n      var secretGiven = Anon.name(this.name[0].given[0]);\n      anonymizedName.given = [];      \n      anonymizedName.given.push(secretGiven);\n    }\n    if(this.name[0].text){\n      anonymizedName.text = Anon.name(this.name[0].text);\n    }\n\n    this.name = [];\n    this.name.push(anonymizedName);\n  }\n\n  return this;\n}\n\n\nAnon = {\n  name: function(name){\n    var anonName = '';\n    for(var i = 0; i < name.length; i++){\n      if(name[i] === \" \"){\n        anonName = anonName + \" \";\n      } else {\n        anonName = anonName + \"*\";\n      }\n    }\n    return anonName;\n  },\n  phone: function(){\n    return \"NNN-NNN-NNNN\";\n  },\n  ssn: function(){\n    return \"###-##-####\"\n  }\n}\n\n\nexport { Patient, Patients, PatientSchema, PatientStu3, PatientDstu2 };\n","\n\n// import PatientDetail from './client/react/PatientDetail.js';\n// import PatientPickList from './client/react/PatientPickList.js';\n// import PatientsPage from './client/react/PatientsPage.js';\n// import PatientTable from './client/react/PatientTable.js';\n// import { insertPatient, removePatientById, updatePatient } from './lib/methods.js';\n\nimport PatientsPage from './client/react/PatientsPage';\nimport PatientTable from './client/react/PatientTable';\nimport PatientDetail from './client/react/PatientDetail';\nimport PatientCard from './client/react/PatientCard';\n\nimport { Patient, Patients, PatientSchema } from './lib/Patients';\n\nvar DynamicRoutes = [{\n  'name': 'PatientPage',\n  'path': '/patients',\n  'component': PatientsPage,\n  'requireAuth': true\n}];\n\n// var DynamicRoutes = [];\n\nvar SidebarElements = [{\n  'primaryText': 'Patients',\n  'to': '/patients',\n  'href': '/patients'\n}];\n\nexport { \n  SidebarElements, \n  DynamicRoutes, \n\n  PatientsPage,\n  PatientTable,\n  PatientDetail,\n  PatientCard,\n\n  Patient,\n  Patients,\n  PatientSchema\n};\n\n\n","import React from 'react';\nimport ReactMixin from 'react-mixin';\n\nimport { ListItem } from 'material-ui/List';\nimport { GlassCard, Glass, DynamicSpacer } from 'meteor/clinical:glass-ui';\nimport { Card, CardActions, CardHeader, CardText, CardTitle } from 'material-ui/Card';\nimport { Col, Grid, Row } from 'react-bootstrap';\nimport TextField from 'material-ui/TextField';\n\nimport { get } from 'lodash';\n\nconst style = {\n    avatar: {\n        position: 'absolute',\n        zIndex: 10,\n        transition: '1s',\n        left: '0px',\n        top: '0px',\n        width: '100%',\n        height: '100%'\n    }, \n    photo: {\n        position: 'absolute',\n        height: '160px',\n        width: '160px',\n        left: '-20px',\n        top: '-10px',       \n        zIndex: 10 \n    },\n    title: {\n        left: '160px'\n    },\n    synopsis: {\n        marginLeft: '160px',\n        position: 'relative',\n        top: '0px'\n    },\n    patientCard: {\n        position: 'relative'\n    }\n}\n\n\nexport class PatientCard extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n  render(){\n    console.log('&&&&&&&&&&&&&&&&&&&')\n    console.log('PatientCard', this.props)\n\n\n    let { active, familyName, givenName, fullName, email, birthdate, gender, avatar, patient, zDepth, ...otherProps } = this.props;\n\n    fullName = get(this, 'props.patient.name[0].text', '');\n    familyName = get(this, 'props.patient.name[0].family[0]', '');        \n    givenName = get(this, 'props.patient.name[0].given[0]', '');\n    email = get(this, 'props.patient.contact[0].value', '');\n    birthdate = get(this, 'props.patient.birthDate', '');\n    gender = get(this, 'props.patient.gender', '');\n    avatar = get(this, 'props.patient.photo[0].url', '');\n    // avatarImg = get(this, 'props.patient.photo[0].url', '/packages/clinical_hl7-resource-patient/assets/noAvatar.png');\n\n    return (\n      // <div className='patientCard' {...otherProps} style={style.patientCard} >\n      <div className='patientCard' style={style.patientCard} >\n        <Card zDepth={zDepth} style={ style.photo }>\n            <img id='avatarImage' className='avatarImage' ref='avatarImage' onError={this.imgError.bind(this)} src={ avatar } style={ style.avatar} />\n        </Card>\n        <GlassCard>\n            <CardTitle\n                title={ fullName }\n                subtitle={ email }\n                style={ style.title }\n              >\n              </CardTitle>\n            <CardText>\n                <div id='profileDemographicsPane' style={{position: 'relative'}}>\n                  <Row style={ style.synopsis} >\n                    <Col md={6}>\n                      <TextField\n                        id='givenNameInput'\n                        ref='given'\n                        name='given'\n                        type='text'\n                        floatingLabelText='given name'\n                        value={ givenName }\n                        onChange={ this.props.updateGivenName ? this.props.updateGivenName.bind(this) : null }\n                        fullWidth\n                        /><br/>\n                    </Col>\n                    <Col md={6}>\n                      <TextField\n                        id='familyNameInput'\n                        ref='family'\n                        name='family'\n                        type='text'\n                        floatingLabelText='family name'\n                        value={ familyName }\n                        onChange={ this.props.updateFamilyName ? this.props.updateFamilyName.bind(this) : null }\n                        fullWidth\n                        /><br/>\n                    </Col>\n                  </Row>\n                  <Row style={ style.synopsis }>\n                    <Col md={4}>\n                      <TextField\n                        id='birthdateInput'\n                        ref='birthdate'\n                        name='birthdate'\n                        type='date'\n                        floatingLabelText='date of birth'\n                        floatingLabelFixed={true}\n                        value={ birthdate }                          \n                        onChange={ this.props.updateBirthdate ? this.props.updateBirthdate.bind(this) : null }\n                        fullWidth\n                        /><br/>\n                    </Col>\n                    <Col md={2}>\n                      <TextField\n                        id='genderInput'\n                        ref='gender'\n                        name='gender'\n                        type='text'\n                        floatingLabelText='gender'\n                        value={ gender }\n                        onChange={ this.props.updateGender ? this.props.updateGender.bind(this) : null }\n                        fullWidth\n                        /><br/>\n\n                    </Col>\n                    <Col md={6}>\n                      <TextField\n                        id='avatarInput'\n                        ref='avatar'\n                        name='avatar'\n                        type='text'\n                        floatingLabelText='avatar'\n                        value={ avatar }\n                        onChange={ this.props.updateAvatar ? this.props.updateAvatar.bind(this) : null }\n                        fullWidth\n                        /><br/>\n\n                    </Col>\n                  </Row>\n                </div>\n            </CardText>\n        </GlassCard>\n        <DynamicSpacer />\n\n        { this.props.children }\n      </div>\n    );\n  }\n  imgError() {\n    this.refs.avatarImage.src = Meteor.absoluteUrl() + 'packages/clinical_hl7-resource-patient/assets/noAvatar.png';\n  }\n}\n\n\n\nexport default PatientCard ;","import { CardActions, CardText, DatePicker, Toggle, RaisedButton, TextField } from 'material-ui';\nimport { get, has, set } from 'lodash';\nimport { Row, Col } from 'react-bootstrap';\nimport moment from 'moment';\n\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\nimport PropTypes from 'prop-types';\n\nimport { Meteor } from 'meteor/meteor';\nimport { Session } from 'meteor/session';\n\n\nconst styles = {\n  block: {\n    maxWidth: 250,\n  },\n  toggle: {\n    marginTop: 16,\n  },\n  thumbOff: {\n    backgroundColor: '#ffcccc',\n  },\n  trackOff: {\n    backgroundColor: '#ff9d9d',\n  },\n  thumbSwitched: {\n    backgroundColor: 'red',\n  },\n  trackSwitched: {\n    backgroundColor: '#ff9d9d',\n  },\n  labelStyle: {\n    color: 'red',\n  },\n};\n\nexport class PatientDetail extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      patientId: false,\n      patient: {\n        resourceType : 'Patient',\n        name : [{\n          text : '',\n          prefix: [''],\n          family: [''],\n          given: [''],\n          suffix: [''],\n          resourceType : 'HumanName'\n        }],\n        active : true,\n        gender : \"\",\n        birthDate : '',\n        photo : [{\n          url: \"\"\n        }],\n        identifier: [{\n          use: 'usual',\n          type: {\n            coding: [\n              {\n                system: 'http://hl7.org/fhir/v2/0203',\n                code: 'MR'\n              }\n            ]\n          },\n          value: ''\n        }],\n        deceasedBoolean: false,\n        multipleBirthBoolean: false,\n        maritalStatus: {\n          text: ''\n        },\n        contact: [],\n        animal: {\n          species: {\n            text: 'Human'\n          }\n        },\n        communication: [{\n          language: {\n            text: 'English'\n          }\n        }],\n        careProvider: [{\n          display: '',\n          reference: ''\n        }],\n        managingOrganization: {\n          reference: '',\n          display: ''\n        }\n      },\n      form: {\n        prefix: '',\n        family: '',\n        given: '',\n        suffix: '',\n        identifier: '',\n        deceased: false,\n        multipleBirth: false,\n        maritalStatus: '',\n        species: '',\n        language: ''\n      }\n    }\n  }\n  dehydrateFhirResource(patient) {\n    let formData = Object.assign({}, this.state.form);\n\n    formData.prefix = get(patient, 'name[0].prefix[0]')\n    formData.family = get(patient, 'name[0].family[0]')\n    formData.given = get(patient, 'name[0].given[0]')\n    formData.suffix = get(patient, 'name[0].suffix[0]')\n    formData.identifier = get(patient, 'identifier[0].value')\n    formData.deceased = get(patient, 'deceasedBoolean')\n    formData.gender = get(patient, 'gender')\n    formData.multipleBirth = get(patient, 'multipleBirthBoolean')\n    formData.maritalStatus = get(patient, 'maritalStatus.text')\n    formData.species = get(patient, 'animal.species.text')\n    formData.language = get(patient, 'communication[0].language.text')\n    formData.birthDate = moment(patient.birthDate).format(\"YYYY-MM-DD\")\n\n    return formData;\n  }\n  shouldComponentUpdate(nextProps){\n    process.env.NODE_ENV === \"test\" && console.log('PatientDetail.shouldComponentUpdate()', nextProps, this.state)\n    let shouldUpdate = true;\n\n    // both false; don't take any more updates\n    if(nextProps.patient === this.state.patient){\n      shouldUpdate = false;\n    }\n\n    // received an patient from the table; okay lets update again\n    if(nextProps.patientId !== this.state.patientId){\n      this.setState({patientId: nextProps.patientId})\n      \n      if(nextProps.patient){\n        this.setState({patient: nextProps.patient})     \n        this.setState({form: this.dehydrateFhirResource(nextProps.patient)})       \n      }\n      shouldUpdate = true;\n    }\n \n    return shouldUpdate;\n  }\n  getMeteorData() {\n    let data = {\n      patientId: this.props.patientId,\n      patient: false,\n      form: this.state.form\n    };\n\n    if(this.props.patient){\n      data.patient = this.props.patient;\n    }\n    if(this.props.displayBirthdate){\n      data.displayBirthdate = this.props.displayBirthdate;\n    }\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"PatientDetail[data]\", data);\n    return data;\n  }\n\n  render() {\n    if(process.env.NODE_ENV === \"test\") console.log('PatientDetail.render()', this.state)\n    let formData = this.state.form;\n\n    return (\n      <div id={this.props.id} className=\"patientDetail\">\n        <CardText>\n          <Row>\n            <Col md={4}>\n              <TextField\n                id='mrnInput'\n                ref='identifier'\n                name='identifier'\n                floatingLabelText='Identifier (Medical Record Number)'\n                value={ get(formData, 'identifier', '')}\n                onChange={ this.changeState.bind(this, 'identifier')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={3} mdOffset={5}>\n              <br />\n              <Toggle\n                label=\"Deceased\"\n                labelPosition=\"right\"\n                defaultToggled={false}\n                style={styles.toggle}\n              />\n            </Col>\n          </Row>\n          <Row>\n            <Col md={1}>\n              <TextField\n                id='prefixInput'\n                ref='prefix'\n                name='prefix'\n                floatingLabelText='Prefix'\n                value={ get(formData, 'prefix', '')}\n                onChange={ this.changeState.bind(this, 'prefix')}\n                hintText=''\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={5}>\n              <TextField\n                id='givenInput'\n                ref='given'\n                name='given'\n                floatingLabelText='Given Name'\n                hintText='Jane'\n                value={ get(formData, 'given', '')}\n                onChange={ this.changeState.bind(this, 'given')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={3}>\n              <TextField\n                id='familyInput'\n                ref='family'\n                name='family'\n                floatingLabelText='Family Name'\n                hintText='Doe'\n                value={ get(formData, 'family', '')}\n                onChange={ this.changeState.bind(this, 'family')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n\n            </Col>\n            <Col md={3}>\n              <TextField\n                id='suffixInput'\n                ref='suffix'\n                name='suffix'\n                floatingLabelText='Suffix / Maiden'\n                hintText=''\n                value={ get(formData, 'suffix', '')}\n                onChange={ this.changeState.bind(this, 'suffix')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n          </Row>\n          <Row>\n            <Col md={3}>\n              <TextField\n                id='maritalStatusInput'\n                ref='maritalStatus'\n                name='maritalStatus'\n                floatingLabelText='Marital Status'\n                hintText='single | maried | other'\n                value={ get(formData, 'maritalStatus', '')}\n                onChange={ this.changeState.bind(this, 'maritalStatus')}\n                floatingLabelFixed={false}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={3}>\n              <TextField\n                id='genderInput'\n                ref='gender'\n                name='gender'\n                floatingLabelText='Gender'\n                hintText='male | female | unknown'\n                value={ get(formData, 'gender', '')}\n                onChange={ this.changeState.bind(this, 'gender')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={3}>\n              {/* <br />\n              { this.renderDatePicker(true, get(formData, 'birthDate') ) } */}\n\n              <TextField\n                id='birthDateInput'\n                ref='birthDate'\n                name='birthDate'\n                type='date'\n                floatingLabelText='Birthdate'\n                // hintText='YYYY-MM-DD'\n                value={ get(formData, 'birthDate', '')}\n                onChange={ this.changeState.bind(this, 'birthDate')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={3} >\n              <br />\n              <Toggle\n                label=\"Multiple Birth\"\n                defaultToggled={false}\n                labelPosition=\"right\"\n                style={styles.toggle}\n              />              \n            </Col>\n          </Row>\n          <Row>\n            <Col md={6}>\n              <TextField\n                id='photoInput'\n                ref='photo'\n                name='photo'\n                floatingLabelText='Photo'\n                hintText='http://somewhere.com/image.jpg'\n                value={ get(formData, 'photo', '')}\n                onChange={ this.changeState.bind(this, 'photo')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={3}>\n              <TextField\n                id='speciesInput'\n                ref='species'\n                name='species'\n                floatingLabelText='Species'\n                value={ get(formData, 'species', '')}\n                hintText='Human'\n                onChange={ this.changeState.bind(this, 'species')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n            <Col md={3}>\n              <TextField\n                id='languageInput'\n                ref='language'\n                name='language'\n                floatingLabelText='Language'\n                value={ get(formData, 'language', '')}\n                onChange={ this.changeState.bind(this, 'language')}\n                hintText='English'\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n            </Col>\n          </Row>\n\n\n        </CardText>\n        <CardActions>\n          { this.determineButtons(this.data.patientId) }\n        </CardActions>\n      </div>\n    );\n  }\n  renderDatePicker(displayDatePicker, birthDate){\n    if (displayDatePicker) {\n      console.log('renderDatePicker', displayDatePicker, birthDate, typeof birthDate)\n\n      let javascriptDate;\n      let momentDate;\n\n      if(typeof birthDate === \"string\"){\n        momentDate = moment(birthDate).toDate();\n      } else {\n        momentDate = birthDate;\n      }\n    \n      console.log('javascriptDate', javascriptDate)\n      console.log('momentDate', momentDate)\n\n      return (\n        <DatePicker \n          name='birthDate'\n          hintText=\"Birthdate\" \n          container=\"inline\" \n          mode=\"landscape\"\n          value={ momentDate ? momentDate : null}    \n          onChange={ this.changeState.bind(this, 'birthDate')}      \n          floatingLabelFixed={true}\n          fullWidth\n        />\n      );\n    }\n  }\n  determineButtons(patientId){\n    if (patientId) {\n      return (\n        <div>\n          <RaisedButton id='updatePatientButton' className='updatePatientButton' label=\"Save\" primary={true} onClick={this.handleSaveButton.bind(this)} style={{marginRight: '20px'}} />\n          <RaisedButton id='deletePatientButton' label=\"Delete\" onClick={this.handleDeleteButton.bind(this)} />\n        </div>\n      );\n    } else {\n      return(\n        <RaisedButton id='savePatientButton'  className='savePatientButton' label=\"Save\" primary={true} onClick={this.handleSaveButton.bind(this)} />\n      );\n    }\n  }\n\n  updateFormData(formData, field, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"PatientDetail.updateFormData\", formData, field, textValue);\n\n    switch (field) {\n      case \"prefix\":\n        set(formData, 'prefix', textValue)\n        break;\n      case \"family\":\n        set(formData, 'family', textValue)\n        break;\n      case \"given\":\n        set(formData, 'given', textValue)\n        break;        \n      case \"suffix\":\n        set(formData, 'suffix', textValue)\n        break;\n      case \"identifier\":\n        set(formData, 'identifier', textValue)\n        break;\n      case \"gender\":\n        set(formData, 'gender', textValue)\n        break;\n      case \"maritalStatus\":\n        set(formData, 'maritalStatus', textValue)\n        break;\n      case \"deceased\":\n        set(formData, 'deceased', textValue)\n        break;\n      case \"multipleBirth\":\n        set(formData, 'multipleBirth', textValue)\n        break;\n      case \"species\":\n        set(formData, 'species', textValue)\n        break;\n      case \"language\":\n        set(formData, 'language', textValue)\n        break;\n      case \"photo\":\n        set(formData, 'photo', textValue)\n        break;\n      case \"birthDate\":\n        set(formData, 'birthDate', textValue)\n        break;\n      default:\n    }\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"formData\", formData);\n    return formData;\n  }\n  updatePatient(patientData, field, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"PatientDetail.updatePatient\", patientData, field, textValue);\n\n    switch (field) {\n      case \"prefix\":\n        set(patientData, 'name[0].prefix[0]', textValue)\n        break;\n      case \"family\":\n        set(patientData, 'name[0].family[0]', textValue)\n        break;\n      case \"given\":\n        set(patientData, 'name[0].given[0]', textValue)\n        break;        \n      case \"suffix\":\n        set(patientData, 'name[0].suffix[0]', textValue)\n        break;\n      case \"identifier\":\n        set(patientData, 'identifier[0].value', textValue)\n        break;\n      case \"deceased\":\n        set(patientData, 'deceasedBoolean', textValue)\n        break;\n      case \"multipleBirth\":\n        set(patientData, 'multipleBirthBoolean', textValue)\n        break;\n      case \"gender\":\n        set(patientData, 'gender', textValue)\n        break;\n      case \"maritalStatus\":\n        set(patientData, 'maritalStatus.text', textValue)\n        break;\n      case \"species\":\n        set(patientData, 'animal.species.text', textValue)\n        break;\n      case \"language\":\n        set(patientData, 'communication[0].language.text', textValue)\n        break;  \n      case \"photo\":\n        set(patientData, 'photo[0].url', textValue)\n        break;\n      case \"birthDate\":\n        set(patientData, 'birthDate', textValue)\n        break;\n    }\n    return patientData;\n  }\n  changeState(field, event, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"   \");\n    if(process.env.NODE_ENV === \"test\") console.log(\"PatientDetail.changeState\", field, textValue);\n    if(process.env.NODE_ENV === \"test\") console.log(\"this.state\", this.state);\n\n    let formData = Object.assign({}, this.state.form);\n    let patientData = Object.assign({}, this.state.patient);\n\n    formData = this.updateFormData(formData, field, textValue);\n    patientData = this.updatePatient(patientData, field, textValue);\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"patientData\", patientData);\n    if(process.env.NODE_ENV === \"test\") console.log(\"formData\", formData);\n\n    this.setState({patient: patientData})\n    this.setState({form: formData})\n  }\n\n\n  // this could be a mixin\n  handleSaveButton(){\n    if(process.env.NODE_ENV === \"test\") console.log('^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&&')\n    console.log('Saving a new Patient...', this.state)\n\n    let self = this;\n    let fhirPatientData = Object.assign({}, this.state.patient);\n\n    if(process.env.NODE_ENV === \"test\") console.log('fhirPatientData', fhirPatientData);\n\n\n    let patientValidator = PatientSchema.newContext();\n    console.log('patientValidator', patientValidator)\n    patientValidator.validate(fhirPatientData)\n\n    console.log('IsValid: ', patientValidator.isValid())\n    // console.log('ValidationErrors: ', patientValidator.validationErrors());\n\n    if (this.state.patientId) {\n      if(process.env.NODE_ENV === \"test\") console.log(\"Updating patient...\");\n\n      delete fhirPatientData._id;\n\n      // not sure why we're having to respecify this; fix for a bug elsewhere\n      fhirPatientData.resourceType = 'Patient';\n\n      Patients._collection.update({_id: this.state.patientId}, {$set: fhirPatientData }, function(error, result){\n        if (error) {\n          if(process.env.NODE_ENV === \"test\") console.log(\"Patients.insert[error]\", error);\n          Bert.alert(error.reason, 'danger');\n        }\n        if (result) {\n          HipaaLogger.logEvent({eventType: \"update\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"Patients\", recordId: self.state.patientId});\n          Session.set('selectedPatientId', false);\n          Session.set('patientPageTabIndex', 1);\n          Bert.alert('Patient added!', 'success');\n        }\n      });\n    } else {\n      if(process.env.NODE_ENV === \"test\") console.log(\"Creating a new patient...\", fhirPatientData);\n\n      Patients._collection.insert(fhirPatientData, function(error, result) {\n        if (error) {\n          if(process.env.NODE_ENV === \"test\")  console.log('Patients.insert[error]', error);\n          Bert.alert(error.reason, 'danger');\n        }\n        if (result) {\n          HipaaLogger.logEvent({eventType: \"create\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"Patients\", recordId: self.state.patientId});\n          Session.set('patientPageTabIndex', 1);\n          Session.set('selectedPatientId', false);\n          Bert.alert('Patient added!', 'success');\n        }\n      });\n    }\n  }\n\n  handleCancelButton(){\n    Session.set('patientPageTabIndex', 1);\n  }\n\n  handleDeleteButton(){\n    let self = this;\n    Patients._collection.animalremove({_id: this.state.patientId}, function(error, result){\n      if (error) {\n        if(process.env.NODE_ENV === \"test\") console.log('Patients.insert[error]', error);\n        Bert.alert(error.reason, 'danger');\n      }\n      if (result) {\n        HipaaLogger.logEvent({eventType: \"delete\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"Patients\", recordId: self.state.patientId});\n        Session.set('patientPageTabIndex', 1);\n        Session.set('selectedPatientId', false);\n        Bert.alert('Patient removed!', 'success');\n      }\n    });\n  }\n}\n\nPatientDetail.propTypes = {\n  id: PropTypes.string,\n  fhirVersion: PropTypes.string,\n  patientId: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  patient: PropTypes.oneOfType([PropTypes.object, PropTypes.bool])\n};\nReactMixin(PatientDetail.prototype, ReactMeteorData);\nexport default PatientDetail;","import Avatar from 'material-ui/Avatar';\nimport FlatButton from 'material-ui/FlatButton';\nimport { HTTP } from 'meteor/http';\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\nimport { Table } from 'react-bootstrap';\nimport { Session } from 'meteor/session';\nimport { has, get } from 'lodash';\nimport { TableNoData } from 'meteor/clinical:glass-ui'\nimport PropTypes from 'prop-types';\n\nflattenPatient = function(person){\n  let result = {\n    _id: person._id,\n    id: person.id,\n    active: true,\n    gender: get(person, 'gender'),\n    name: '',\n    mrn: '',\n    birthDate: '',\n    photo: \"/thumbnail-blank.png\",\n    initials: 'abc'\n  };\n\n  result.active = get(person, 'active', true).toString();\n\n  // there's an off-by-1 error between momment() and Date() that we want\n  // to account for when converting back to a string\n  result.birthDate = moment(person.birthDate).format(\"YYYY-MM-DD\")\n  result.photo = get(person, 'photo[0].url', '');\n  result.identifier = get(person, 'identifier[0].value', '');\n\n  result.maritalStatus = get(person, 'maritalStatus.text', '');\n  result.deceased = get(person, 'deceasedBoolean', '');\n  result.species = get(person, 'animal.species.text', '');\n  result.language = get(person, 'communication[0].language.text', '');\n\n  let nameText = get(person, 'name[0].text', '');\n  if(nameText.length > 0){\n    result.name = get(person, 'name[0].text', '');    \n  } else {\n    if(get(person, 'name[0].suffix[0]')){\n      result.name = get(person, 'name[0].suffix[0]')  + ' ';\n    }\n\n    result.name = result.name + get(person, 'name[0].given[0]') + ' ' + get(person, 'name[0].family[0]');\n    \n    if(get(person, 'name[0].suffix[0]')){\n      result.name = result.name + ' ' + get(person, 'name[0].suffix[0]');\n    }\n  }\n\n  return result;\n}\n\nexport class PatientTable extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n  getMeteorData() {\n    let data = {\n      style: {\n        hideOnPhone: {\n          visibility: 'visible',\n          display: 'table'\n        },\n        cellHideOnPhone: {\n          visibility: 'visible',\n          display: 'table',\n          paddingTop: '16px',\n          maxWidth: '120px'\n        },\n        cell: {\n          paddingTop: '16px'\n        },\n        avatar: {\n          // color: rgb(255, 255, 255);\n          backgroundColor: 'rgb(188, 188, 188)',\n          userSelect: 'none',\n          borderRadius: '2px',\n          height: '40px',\n          width: '40px'\n        }\n      },\n      selected: [],\n      patients: []\n    };\n\n    let query = {};\n    let options = {};\n\n    // number of items in the table should be set globally\n    if (get(Meteor, 'settings.public.defaults.paginationLimit')) {\n      options.limit = get(Meteor, 'settings.public.defaults.paginationLimit');\n    }\n    // but can be over-ridden by props being more explicit\n    if(this.props.limit){\n      options.limit = this.props.limit;      \n    }\n\n    if(this.props.data){\n      // console.log('this.props.data', this.props.data);\n\n      if(this.props.data.length > 0){              \n        this.props.data.forEach(function(patient){\n          data.patients.push(flattenPatient(patient));\n        });  \n      }\n    } else {\n      data.patients = Patients.find().map(function(patient){\n        return flattenPatient(patient);\n      });\n    }\n\n\n    if (Session.get('appWidth') < 768) {\n      data.style.hideOnPhone.visibility = 'hidden';\n      data.style.hideOnPhone.display = 'none';\n      data.style.cellHideOnPhone.visibility = 'hidden';\n      data.style.cellHideOnPhone.display = 'none';\n    } else {\n      data.style.hideOnPhone.visibility = 'visible';\n      data.style.hideOnPhone.display = 'table-cell';\n      data.style.cellHideOnPhone.visibility = 'visible';\n      data.style.cellHideOnPhone.display = 'table-cell';\n    }\n\n    // console.log(\"PatientTable[data]\", data);\n    return data;\n  }\n  imgError(avatarId) {\n    this.refs[avatarId].src = Meteor.absoluteUrl() + 'noAvatar.png';\n  }\n  rowClick(id){\n    Session.set('patientsUpsert', false);\n    Session.set('selectedPatientId', id);\n    Session.set('patientPageTabIndex', 2);\n  }\n  renderRowAvatarHeader(){\n    if (get(Meteor, 'settings.public.defaults.avatars') && (this.props.showAvatars === true)) {\n      return (\n        <th className='avatar'>photo</th>\n      );\n    }\n  }\n  renderRowAvatar(patient, avatarStyle){\n    console.log('renderRowAvatar', patient, avatarStyle)\n    if (get(Meteor, 'settings.public.defaults.avatars') && (this.props.showAvatars === true)) {\n      return (\n        <td className='avatar'>\n          <img src={patient.photo} ref={patient._id} onError={ this.imgError.bind(this, patient._id) } style={avatarStyle}/>\n        </td>\n      );\n    }\n  }\n  renderSpeciesHeader(displaySpecies){\n    if(displaySpecies){\n      return (\n        <th className='species'>Species</th>\n      );\n    }\n  }\n  renderSpeciesRow(displaySpecies, patient){\n    if(displaySpecies){\n      return (\n        <td className='species' style={this.data.style.cellHideOnPhone}>\n          {patient.species}\n        </td>\n      );\n    }\n\n  }\n  renderSendButtonHeader(){\n    if (this.props.showSendButton === true) {\n      return (\n        <th className='sendButton' style={this.data.style.hideOnPhone}></th>\n      );\n    }\n  }\n  renderSendButton(patient, avatarStyle){\n    if (this.props.showSendButton === true) {\n      return (\n        <td className='sendButton' style={this.data.style.hideOnPhone}>\n          <FlatButton label=\"send\" onClick={this.onSend.bind('this', this.data.patients[i]._id)}/>\n        </td>\n      );\n    }\n  }\n  onSend(id){\n    let patient = Patients.findOne({_id: id});\n\n    console.log(\"PatientTable.onSend()\", patient);\n\n    var httpEndpoint = \"http://localhost:8080\";\n    if (get(Meteor, 'settings.public.interfaces.default.channel.endpoint')) {\n      httpEndpoint = get(Meteor, 'settings.public.interfaces.default.channel.endpoint');\n    }\n    HTTP.post(httpEndpoint + '/Patient', {\n      data: patient\n    }, function(error, result){\n      if (error) {\n        console.log(\"error\", error);\n      }\n      if (result) {\n        console.log(\"result\", result);\n      }\n    });\n  }\n  selectPatientRow(patientId){\n    if(typeof(this.props.onRowClick) === \"function\"){\n      this.props.onRowClick(patientId);\n    }\n  }\n  render () {\n    let tableRows = [];\n    let footer;\n\n    if(this.data.patients.length === 0){\n      footer = <TableNoData noDataPadding={ this.props.noDataMessagePadding } />\n    } else {\n      for (var i = 0; i < this.data.patients.length; i++) {\n        tableRows.push(\n          <tr key={i} className=\"patientRow\" style={{cursor: \"pointer\"}} onClick={this.selectPatientRow.bind(this, this.data.patients[i].id )} >\n  \n            { this.renderRowAvatar(this.data.patients[i], this.data.style.avatar) }\n  \n            <td className='identifier' style={this.data.style.cellHideOnPhone}>{this.data.patients[i].identifier}</td>\n            <td className='name' onClick={ this.rowClick.bind('this', this.data.patients[i]._id)} style={this.data.style.cell}>{this.data.patients[i].name }</td>\n            <td className='gender' onClick={ this.rowClick.bind('this', this.data.patients[i]._id)} style={this.data.style.cell}>{this.data.patients[i].gender}</td>\n            <td className='birthDate' onClick={ this.rowClick.bind('this', this.data.patients[i]._id)} style={{minWidth: '100px', paddingTop: '16px'}}>{this.data.patients[i].birthDate }</td>\n            <td className='maritalStatus' style={this.data.style.cellHideOnPhone}>{this.data.patients[i].maritalStatus}</td>\n            <td className='language' style={this.data.style.cellHideOnPhone}>{this.data.patients[i].language}</td>\n            <td className='isActive' onClick={ this.rowClick.bind('this', this.data.patients[i]._id)} style={this.data.style.cellHideOnPhone}>{this.data.patients[i].active}</td>\n\n              { this.renderSpeciesRow(this.props.displaySpecies, this.data.patients[i]) }\n              { this.renderSendButton(this.data.patients[i], this.data.style.avatar) }\n          </tr>\n        );\n      }\n    }\n    \n\n\n    return(\n      <div>\n        <Table id='patientsTable' hover >\n          <thead>\n            <tr>\n              { this.renderRowAvatarHeader() }\n\n              <th className='identifier' style={this.data.style.hideOnPhone}>Identifier</th>\n              <th className='name'>Name</th>\n              <th className='gender'>Gender</th>\n              <th className='birthdate' style={{minWidth: '100px'}}>Birthdate</th>\n              <th className='maritalStatus' style={this.data.style.hideOnPhone}>Marital Status</th>\n              <th className='language' style={this.data.style.hideOnPhone}>Language</th>\n              <th className='isActive' style={this.data.style.hideOnPhone}>Active</th>\n              \n              { this.renderSpeciesHeader(this.props.displaySpecies) }\n              { this.renderSendButtonHeader() }\n            </tr>\n          </thead>\n          <tbody>\n            { tableRows }\n          </tbody>\n        </Table>\n        { footer }\n      </div>\n    );\n  }\n}\n\nPatientTable.propTypes = {\n  id: PropTypes.string,\n  fhirVersion: PropTypes.string,\n  showSendButton: PropTypes.bool,\n  displaySpecies: PropTypes.bool,\n  noDataMessagePadding: PropTypes.number\n};\n\nReactMixin(PatientTable.prototype, ReactMeteorData);\nexport default PatientTable;","import { CardText, CardTitle } from 'material-ui/Card';\nimport { Tab, Tabs } from 'material-ui/Tabs';\nimport { Glass, GlassCard, VerticalCanvas, FullPageCanvas } from 'meteor/clinical:glass-ui';\n\nimport PatientDetail from './PatientDetail';\nimport PatientTable from './PatientTable';\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\nimport PropTypes from 'prop-types';\n\nimport { Meteor } from 'meteor/meteor';\nimport { Session } from 'meteor/session';\n\nlet defaultPatient = {\n  index: 2,\n  id: '',\n  username: '',\n  email: '',\n  given: '',\n  family: '',\n  gender: ''\n};\nSession.setDefault('patientFormData', defaultPatient);\nSession.setDefault('patientSearchFilter', '');\nSession.setDefault('selectedPatientId', false);\nSession.setDefault('fhirVersion', 'v1.0.2');\n\nexport class PatientsPage extends React.Component {\n  getMeteorData() {\n    let data = {\n      style: {\n        opacity: Session.get('globalOpacity'),\n        tab: {\n          borderBottom: '1px solid lightgray',\n          borderRight: 'none'\n        }\n      },\n      tabIndex: Session.get('patientPageTabIndex'),\n      patientSearchFilter: Session.get('patientSearchFilter'),\n      fhirVersion: Session.get('fhirVersion'),\n      selectedPatientId: Session.get(\"selectedPatientId\"),\n      selectedPatient: false\n    };\n\n    \n    if (Session.get('selectedPatientId')){\n      data.selectedPatient = Patients.findOne({_id: Session.get('selectedPatientId')});\n    } else {\n      data.selectedPatient = false;\n    }\n\n\n    data.style = Glass.blur(data.style);\n    data.style.appbar = Glass.darkroom(data.style.appbar);\n    data.style.tab = Glass.darkroom(data.style.tab);\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"PatientsPage[data]\", data);\n    return data;\n  }\n\n  handleTabChange(index){\n    Session.set('patientPageTabIndex', index);\n  }\n\n  onNewTab(){\n    Session.set('selectedPatientId', false);\n    Session.set('patientUpsert', false);\n  }\n\n  render() {\n    console.log('React.version: ' + React.version);\n    return (\n      <div id=\"patientsPage\">\n        <VerticalCanvas>\n          <GlassCard height=\"auto\">\n            <CardTitle\n              title=\"Patients\"\n            />\n            <CardText>\n              <Tabs id='patientsPageTabs' default value={this.data.tabIndex} onChange={this.handleTabChange} initialSelectedIndex={1}>\n                 <Tab className=\"newPatientTab\" label='New' style={this.data.style.tab} onActive={ this.onNewTab } value={0}>\n                   <PatientDetail \n                      fhirVersion={ this.data.fhirVersion }\n                      id='newPatient' />\n                 </Tab>\n                 <Tab className=\"patientListTab\" label='Patients' onActive={this.handleActive} style={this.data.style.tab} value={1}>\n                   <PatientTable \n                      showBarcodes={true} \n                      showAvatars={true} \n                      noDataMessagePadding={100}\n                      />\n                 </Tab>\n                 <Tab className=\"patientDetailTab\" label='Detail' onActive={this.handleActive} style={this.data.style.tab} value={2}>\n                   <PatientDetail \n                      id='patientDetails' \n                      fhirVersion={ this.data.fhirVersion }\n                      patient={ this.data.selectedPatient }\n                      patientId={ this.data.selectedPatientId }\n                    />\n                 </Tab>\n             </Tabs>\n\n\n            </CardText>\n          </GlassCard>\n        </VerticalCanvas>\n      </div>\n    );\n  }\n}\n\n\n\nReactMixin(PatientsPage.prototype, ReactMeteorData);\n\nexport default PatientsPage;"]}