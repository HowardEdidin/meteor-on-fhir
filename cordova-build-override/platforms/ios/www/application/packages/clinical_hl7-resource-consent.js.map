{"version":3,"sources":["meteor://💻app/packages/clinical:hl7-resource-consent/lib/Consents.js","meteor://💻app/packages/clinical:hl7-resource-consent/index.jsx","meteor://💻app/packages/clinical:hl7-resource-consent/client/ConsentDetail.jsx","meteor://💻app/packages/clinical:hl7-resource-consent/client/ConsentTable.jsx","meteor://💻app/packages/clinical:hl7-resource-consent/client/ConsentsPage.jsx"],"names":["module","export","Consent","Consents","ConsentSchema","SimpleSchema","link","v","BaseModel","Mongo","extend","prototype","_collection","Package","Collection","connection","_transform","document","type","String","defaultValue","optional","Array","IdentifierSchema","Code","CodeableConceptSchema","ReferenceSchema","blackbox","PeriodSchema","Date","Object","AttachmentSchema","CodingSchema","BaseSchema","DomainResourceSchema","attachSchema","toFhir","console","log","EJSON","stringify","name","fetchBundle","query","parameters","callback","process","env","TRACE","consentArray","find","map","consent","id","_id","_document","result","Bundle","generate","toMongo","originalConsent","mongoRecord","identifier","forEach","period","start","startArray","split","end","endArray","toStu3","consentJson","birthDate","deceasedBoolean","family","text","given","prepForUpdate","resourceType","telecom","address","contact","prepForFhirTransfer","moment","format","AdminSidebarElements","SidebarElements","DynamicRoutes","ConsentsPage","ConsentTable","ConsentDetail","CardActions","CardText","Checkbox","RaisedButton","SelectField","MenuItem","TextField","Col","Row","Table","React","ReactMeteorData","ReactMixin","PropTypes","Session","get","set","props","state","consentId","coding","system","code","value","status","category","patient","reference","display","dateTime","consentingParty","organization","except","version","form","patientDisplay","organizationDisplay","periodStart","periodEnd","selectedConsentCategory","dehydrateFhirResource","formData","assign","class","shouldComponentUpdate","nextProps","NODE_ENV","shouldUpdate","setState","getMeteorData","data","changeSelectedCategory","event","render","renderText","textAlign","cursor","width","paddingTop","minWidth","bind","changeState","determineButtons","handleSaveButton","marginRight","handleDeleteButton","updateFormData","field","textValue","updateConsent","consentData","self","fhirConsentData","consentValidator","newContext","validate","isValid","validationErrors","update","$set","Meteor","filter","removeEmptyStrings","error","Bert","alert","reason","HipaaLogger","logEvent","eventType","userId","userName","user","fullName","collectionName","recordId","insert","handleCancelButton","remove","Component","propTypes","string","fhirVersion","oneOfType","bool","object","exportDefault","FlatButton","Avatar","Tab","Tabs","HTTP","has","TableNoData","setDefault","style","hideOnPhone","visibility","cellHideOnPhone","cell","selected","consents","options","sort","limit","patientReference","policyRule","exceptType","exceptAction","exceptClass","sourceReference","exceptions","exception","rowClick","handleRevoke","renderSelected","hideSelected","renderSelectedHeader","renderId","hideId","onIdentifierClick","renderIdHeader","renderIdentifier","hideIdentifier","renderIdentifierHeader","identiferClassName","disableBarcodes","renderType","hideType","renderTypeHeader","renderClass","hideClass","renderClassHeader","renderCategory","hideCategory","renderCategoryHeader","renderDate","hideDateTime","renderDateHeader","renderPeriodStart","hidePeriodStart","renderPeriodStartHeader","renderPeriodEnd","hidePeriodEnd","renderPeriodEndHeader","renderSource","hideSourceReference","getDocumentReference","renderSourceHeader","marginLeft","renderRevoke","hideRevoke","renderRevokeHeader","onPatientClick","tableRows","footer","length","noDataMessage","noDataMessagePadding","i","push","hideVerify","number","selectedDocumentSource","func","CardTitle","Dialog","GlassCard","Glass","FullPageCanvas","defaultConsent","index","username","email","gender","searchForm","givenName","familyName","searchQuery","componentDidMount","opacity","tab","borderBottom","borderRight","tabIndex","consentSearchFilter","currentConsent","dialogOpen","selectedConsentId","selectedConsent","consentSearchQuery","findOne","blur","appbar","darkroom","handleTabChange","onNewTab","handleClose","handleSearch","actions","handleActive","updateSearch"],"mappings":"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","file":"/packages/clinical_hl7-resource-consent.js","sourcesContent":["import SimpleSchema from 'simpl-schema';\n\nimport { BaseModel } from 'meteor/clinical:base-model';\nimport { Mongo } from 'meteor/mongo';\n\n\n// Create the object using our BaseModel\nConsent = BaseModel.extend();\n\n\n// Assign a collection so the object knows how to perform CRUD operations\nConsent.prototype._collection = Consents;\n\n// We need to create server and client data cursors, based on which type of \n// publication strategy we're using\nif(typeof Consents === 'undefined'){\n  if(Package['clinical:autopublish']){\n    Consents = new Mongo.Collection('Consents');\n  } else if(Package['clinical:desktop-publish']){\n    Consents = new Mongo.Collection('Consents');\n  } else {\n    // A null connection disables DDP\n    Consents = new Mongo.Collection('Consents', {connection: null});\n  }\n}\n\n\n// Add the transform to the collection since Meteor.users is pre-defined by the accounts package\nConsents._transform = function (document) {\n  return new Consent(document);\n};\n\n\nConsentSchema = new SimpleSchema({\n  \"resourceType\" : {\n    type: String,\n    defaultValue: \"Consent\"\n  },\n  \"identifier\" : {\n    optional: true,\n    type:  Array\n    },\n  \"identifier.$\" : {\n    optional: true,\n    type:  IdentifierSchema \n    },\n  \"status\" : {\n    optional: true,\n    type: Code\n  }, \n  \"category\" : {\n    optional: true,\n    type: Array\n  }, \n  \"category.$\" : {\n    optional: true,\n    type: CodeableConceptSchema \n  }, \n  \"patient\" : { \n    optional: true,\n    type: ReferenceSchema\n  }, \n  \"period\" : { \n    optional: true,\n    blackbox: true,\n    type: PeriodSchema \n  }, \n  \"dateTime\" : {\n    optional: true,\n    type: Date\n  }, \n  \"consentingParty\" : {\n    optional: true,\n    type: Array\n  }, \n  \"consentingParty.$\" : {\n    optional: true,\n    type: ReferenceSchema \n  }, \n  \"actor\" : {\n    optional: true,\n    type: Array \n  }, \n  \"actor.$\" : {\n    optional: true,\n    type: Object \n  }, \n\n  \"actor.$.role\" : {\n    optional: true,\n    type: CodeableConceptSchema \n  }, \n  \"actor.$.reference\" : {\n    optional: true,\n    type: ReferenceSchema \n  },\n  \"action\" : {\n    optional: true,\n    type: Array\n  }, \n  \"action.$\" : {\n    optional: true,\n    type: CodeableConceptSchema \n  }, \n  \"organization\" : {\n    optional: true,\n    type: Array\n  },   \n  \"organization.$\" : {\n    optional: true,\n    type: ReferenceSchema\n  },   \n  \"sourceAttachment\" : {\n    optional: true,\n    type: AttachmentSchema \n  },\n  \"sourceIdentifier\" : {\n    optional: true,\n    type: IdentifierSchema \n  },\n  \"sourceReference\" : {\n    optional: true,\n    type: ReferenceSchema \n  },\n\n\n  \"policy\" : {\n    optional: true,\n    type: Array\n  }, \n  \"policy.$\" : {\n    optional: true,\n    type: Object\n  },   \n\n  \"policy.$.authority\" : {\n    optional: true,\n    type: String\n  }, \n  \"policy.$.uri\" : {\n    optional: true,\n    type: String\n  }, \n  \"policyRule\" : {\n    optional: true,\n    type: String\n  }, \n  \"securityLabel\" : {\n    optional: true,\n    type: Array\n  }, \n  \"securityLabel.$\" : {\n    optional: true,\n    type: CodingSchema\n  }, \n  \"purpose\" : {\n    optional: true,\n    type: Array\n  }, \n  \"purpose.$\" : {\n    optional: true,\n    type: CodingSchema\n  }, \n  \"dataPeriod\" : {\n    optional: true,\n    type: PeriodSchema \n  }, \n\n  \"data\" : {\n    optional: true,\n    type: Array\n  }, \n  \"data.$\" : {\n    optional: true,\n    type: Object\n  }, \n\n  \"data.$.meaning\" : {\n    optional: true,\n    type: Code\n  }, \n  \"data.$.reference\" : {\n    optional: true,\n    type: ReferenceSchema \n  },\n\n\n  \"except\" : {\n    optional: true,\n    type: Array\n  }, \n  \"except.$\" : {\n    optional: true,\n    type: Object\n  }, \n\n  \"except.$.type\" : {\n    optional: true,\n    type: Code\n  }, \n  \"except.$.period\" : {\n    optional: true,\n    type: PeriodSchema \n  }, \n\n\n  \"except.$.actor\" : {\n    optional: true,\n    type: Array \n  }, \n  \"except.$.actor.$\" : {\n    optional: true,\n    type: Object \n  }, \n\n  \"except.$.actor.$.role\" : {\n    optional: true,\n    type: CodeableConceptSchema \n  }, \n  \"except.$.actor.$.reference\" : {\n    optional: true,\n    type: ReferenceSchema \n  },\n  \"except.$.action\" : {\n    optional: true,\n    type: Array\n  }, \n  \"except.$.action.$\" : {\n    optional: true,\n    type:  CodeableConceptSchema \n  }, \n  \"except.$.securityLabel\" : {\n    optional: true,\n    type: Array\n  }, \n  \"except.$.securityLabel.$\" : {\n    optional: true,\n    type: CodingSchema\n  }, \n  \"except.$.purpose\" : {\n    optional: true,\n    type: Array\n  }, \n  \"except.$.purpose.$\" : {\n    optional: true,\n    type: CodingSchema\n  }, \n\n  \"except.$.class\" : {\n    optional: true,\n    type: Array\n  }, \n  \"except.$.class.$\" : {\n    optional: true,\n    type: CodingSchema \n  }, \n\n  \"except.$.code\" : {\n    optional: true,\n    type: Array\n  }, \n  \"except.$.code.$\" : {\n    optional: true,\n    type: CodingSchema\n  }, \n  \"except.$.dataPeriod\" : {\n    optional: true,\n    type: PeriodSchema \n  }, \n\n\n  \"except.$.data\" : {\n    optional: true,\n    type: Array\n  }, \n  \"except.$.data.$\" : {\n    optional: true,\n    type: Object\n  }, \n\n  \"except.$.data.$.meaning\" : {\n    optional: true,\n    type: Code\n  }, \n  \"except.$.data.$.reference\" : {\n    optional: true,\n    type: ReferenceSchema \n  }\n});\n\nBaseSchema.extend(ConsentSchema);\nDomainResourceSchema.extend(ConsentSchema);\n\nConsents.attachSchema(ConsentSchema);\n\n\nConsent.prototype.toFhir = function(){\n  console.log('Consent.toFhir()');\n\n\n\n  return EJSON.stringify(this.name);\n}\n\n\n\n/**\n * @summary Search the Consents collection for a specific Meteor.userId().\n * @memberOf Consents\n * @name findMrn\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n *  let consents = Consents.findMrn('12345').fetch();\n * ```\n */\n\nConsents.fetchBundle = function (query, parameters, callback) {\n  process.env.TRACE && console.log(\"Consents.fetchBundle()\");  \n  var consentArray = Consents.find(query, parameters, callback).map(function(consent){\n    consent.id = consent._id;\n    delete consent._document;\n    return consent;\n  });\n\n  // console.log(\"consentArray\", consentArray);\n\n  var result = Bundle.generate(consentArray);\n\n  // console.log(\"result\", result.entry[0]);\n\n  return result;\n};\n\n\n/**\n * @summary This function takes a FHIR resource and prepares it for storage in Mongo.\n * @memberOf Consents\n * @name toMongo\n * @version 1.6.0\n * @returns { Consent }\n * @example\n * ```js\n *  let consents = Consents.toMongo('12345').fetch();\n * ```\n */\n\nConsents.toMongo = function (originalConsent) {\n  var mongoRecord;\n  process.env.TRACE && console.log(\"Consents.toMongo()\");  \n\n  if (originalConsent.identifier) {\n    originalConsent.identifier.forEach(function(identifier){\n      if (identifier.period) {\n        if (identifier.period.start) {\n          var startArray = identifier.period.start.split('-');\n          identifier.period.start = new Date(startArray[0], startArray[1] - 1, startArray[2]);\n        }\n        if (identifier.period.end) {\n          var endArray = identifier.period.end.split('-');\n          identifier.period.end = new Date(startArray[0], startArray[1] - 1, startArray[2]);\n        }\n      }\n    });\n  }\n\n  return originalConsent;\n};\n\n\n\n/**\n * @summary This function takes a DTSU2 resource and returns it as STU3.  i.e. it converts from v1.0.2 to v3.0.0\n * @name toMongo\n * @version 3.0.0\n * @returns { Consent }\n * @example\n * ```js\n * ```\n */\nConsents.toStu3 = function(consentJson){\n  if(consentJson){\n\n    // quick cast from string to boolean\n    if(typeof consentJson.birthDate === \"string\"){\n      consentJson.birthDate = new Date(consentJson.birthDate);\n    }\n\n    // quick cast from string to boolean\n    if(consentJson.deceasedBoolean){\n      consentJson.deceasedBoolean = (consentJson.deceasedBoolean == \"true\") ? true : false;\n    }\n\n    // STU3 only has a single entry for family name; not an array\n    if(consentJson.name && consentJson.name[0] && consentJson.name[0].family && consentJson.name[0].family[0] ){\n      consentJson.name[0].family = consentJson.name[0].family[0];      \n    }\n\n    // make sure the full name is filled out\n    if(consentJson.name && consentJson.name[0] && consentJson.name[0].family && !consentJson.name[0].text ){\n      consentJson.name[0].text = consentJson.name[0].given[0] + ' ' + consentJson.name[0].family;      \n    }\n  }\n  return consentJson;\n}\n\n\n/**\n * @summary Similar to toMongo(), this function prepares a FHIR record for storage in the Mongo database.  The difference being, that this assumes there is already an existing record.\n * @memberOf Consents\n * @name prepForUpdate\n * @version 1.6.0\n * @returns { Object }\n * @example\n * ```js\n *  let consents = Consents.findMrn('12345').fetch();\n * ```\n */\n\nConsents.prepForUpdate = function (consent) {\n  process.env.TRACE && console.log(\"Consents.prepForUpdate()\");  \n\n  if (consent.name && consent.name[0]) {\n    //console.log(\"consent.name\", consent.name);\n\n    consent.name.forEach(function(name){\n      name.resourceType = \"HumanName\";\n    });\n  }\n\n  if (consent.telecom && consent.telecom[0]) {\n    //console.log(\"consent.telecom\", consent.telecom);\n    consent.telecom.forEach(function(telecom){\n      telecom.resourceType = \"ContactPoint\";\n    });\n  }\n\n  if (consent.address && consent.address[0]) {\n    //console.log(\"consent.address\", consent.address);\n    consent.address.forEach(function(address){\n      address.resourceType = \"Address\";\n    });\n  }\n\n  if (consent.contact && consent.contact[0]) {\n    //console.log(\"consent.contact\", consent.contact);\n\n    consent.contact.forEach(function(contact){\n      if (contact.name) {\n        contact.name.resourceType = \"HumanName\";\n      }\n\n      if (contact.telecom && contact.telecom[0]) {\n        contact.telecom.forEach(function(telecom){\n          telecom.resourceType = \"ContactPoint\";\n        });\n      }\n\n    });\n  }\n\n  return consent;\n};\n\n\n/**\n * @summary Scrubbing the consent; make sure it conforms to v1.6.0\n * @memberOf Consents\n * @name scrub\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n *  let consents = Consents.findMrn('12345').fetch();\n * ```\n */\n\nConsents.prepForFhirTransfer = function (consent) {\n  process.env.TRACE && console.log(\"Consents.prepForFhirTransfer()\");  \n\n\n  // FHIR has complicated and unusual rules about dates in order\n  // to support situations where a family member might report on a consent's\n  // date of birth, but not know the year of birth; and the other way around\n  if (consent.birthDate) {\n    consent.birthDate = moment(consent.birthDate).format(\"YYYY-MM-DD\");\n  }\n\n\n  if (consent.name && consent.name[0]) {\n    //console.log(\"consent.name\", consent.name);\n\n    consent.name.forEach(function(name){\n      delete name.resourceType;\n    });\n  }\n\n  if (consent.telecom && consent.telecom[0]) {\n    //console.log(\"consent.telecom\", consent.telecom);\n    consent.telecom.forEach(function(telecom){\n      delete telecom.resourceType;\n    });\n  }\n\n  if (consent.address && consent.address[0]) {\n    //console.log(\"consent.address\", consent.address);\n    consent.address.forEach(function(address){\n      delete address.resourceType;\n    });\n  }\n\n  if (consent.contact && consent.contact[0]) {\n    //console.log(\"consent.contact\", consent.contact);\n\n    consent.contact.forEach(function(contact){\n\n      console.log(\"contact\", contact);\n\n\n      if (contact.name && contact.name.resourceType) {\n        //console.log(\"consent.contact.name\", contact.name);\n        delete contact.name.resourceType;\n      }\n\n      if (contact.telecom && contact.telecom[0]) {\n        contact.telecom.forEach(function(telecom){\n          delete telecom.resourceType;\n        });\n      }\n\n    });\n  }\n\n  //console.log(\"Consents.prepForBundle()\", consent);\n\n  return consent;\n};\n\n\n\nexport { Consent, Consents, ConsentSchema };\n","\nimport ConsentsPage from './client/ConsentsPage';\nimport ConsentTable from './client/ConsentTable';\n// import ProvenancesTable from './client/ProvenancesTable';\n// import DocumentReferencesTable from './client/DocumentReferencesTable';\nimport { Consent, Consents, ConsentSchema } from './lib/Consents';\n\n// let consent = require('../data/consent-example-smartonfhir.json');\n// console.log('consent', consent)\n\nvar DynamicRoutes = [{\n  'name': 'ConsentIdPage',\n  'path': '/Consent/:consentId',\n  'component': ConsentsPage,\n  'requireAuth': true\n}, {\n  'name': 'ConsentPage',\n  'path': '/consents',\n  'component': ConsentsPage,\n  'requireAuth': true\n}];\n\n// var DynamicRoutes = [];\n\nvar SidebarElements = [{\n  'primaryText': 'Consents',\n  'to': '/consents',\n  'href': '/consents'\n}];\n\nvar AdminSidebarElements = [{\n  'primaryText': 'Consents',\n  'to': '/consents',\n  'href': '/consents'\n}];\n\nexport { \n  AdminSidebarElements,\n  SidebarElements, \n  DynamicRoutes, \n\n  ConsentsPage,\n  ConsentTable\n\n  // ProvenancesTable,\n  // DocumentReferencesTable\n};\n\n\n","import { CardActions, CardText, Checkbox, RaisedButton, SelectField, MenuItem, TextField } from 'material-ui';\nimport { Col, Row, Table } from 'react-bootstrap';\n\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\nimport PropTypes from 'prop-types';\n\nimport { Consents } from '../lib/Consents';\nimport { Session } from 'meteor/session';\n\nimport { get, set } from 'lodash';\n\n\nexport class ConsentDetail extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      consentId: false,\n      consent: {\n        resourceType : \"Consent\",\n        identifier: [{\n          type: {\n            coding: [\n              {\n                system: \"\",\n                code: \"\"\n              }\n            ],\n            text: \"Serial Number\"\n          },\n          value: \"\"\n        }],\n        status: 'active',\n        category: {\n          coding: [\n            {\n              system: \"\",\n              code: \"\"\n            }\n          ],\n          text: \"\"\n        },\n        patient: {\n          reference: '',\n          display: ''\n        },\n        dateTime: null,\n        period: {\n          start: null,\n          end: null\n        },\n        consentingParty: [{\n          reference: '',\n          display: ''\n        }],\n        organization: {\n          reference: '',\n          display: ''\n        },\n        except: [{\n          type: 'permit',\n          class: [{\n            version: '',\n            code: '',\n            display: ''\n          }]\n        }]\n      },\n      form: {\n        identifier: '',\n        dateTime: '',\n        status: '',\n        patientDisplay: '',\n        organizationDisplay: '',\n        consentingParty: '',\n        periodStart: '',\n        periodEnd: '',\n        type: '',\n        class: '',\n        category: ''\n      },\n      selectedConsentCategory: 0\n    }\n  }\n  dehydrateFhirResource(consent) {\n    let formData = Object.assign({}, this.state.form);\n\n      formData.identifier = get(consent, 'identifier[0].value')\n      formData.status = get(consent, 'status')\n      formData.dateTime = get(consent, 'dateTime')\n      formData.patientDisplay = get(consent, 'patient.display')    \n      formData.consentingParty = get(consent, 'consentingParty[0].display')\n      formData.organizationDisplay = get(consent, 'organization[0].display')\n      formData.periodStart = get(consent, 'period.start')\n      formData.periodEnd = get(consent, 'period.end')\n      formData.type = get(consent, 'except[0].type')\n      formData.class = get(consent, 'except[0].class')\n      formData.category = get(consent, 'category.text')\n\n    return formData;\n  }\n  shouldComponentUpdate(nextProps){\n    process.env.NODE_ENV === \"test\" && console.log('ConsentDetail.shouldComponentUpdate()', nextProps, this.state)\n    let shouldUpdate = true;\n\n    // both false; don't take any more updates\n    if(nextProps.consent === this.state.consent){\n      shouldUpdate = false;\n    }\n\n    // received an consent from the table; okay lets update again\n    if(nextProps.consentId !== this.state.consentId){\n      this.setState({consentId: nextProps.consentId})\n      \n      if(nextProps.consent){\n        this.setState({consent: nextProps.consent})     \n        this.setState({form: this.dehydrateFhirResource(nextProps.consent)})       \n      }\n      shouldUpdate = true;\n    }\n \n    return shouldUpdate;\n  }\n  getMeteorData() {\n    let data = {\n      consentId: this.props.consentId,\n      consent: false,\n      form: this.state.form\n    };\n\n    if(this.props.consent){\n      data.consent = this.props.consent;\n    }\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"ConsentDetail[data]\", data);\n    return data;\n  }\n  changeSelectedCategory(event, value){\n    console.log('changeSelectedCategory', event, value)\n    this.setState({selectedConsentCategory: value})\n  }\n  render() {\n    if(process.env.NODE_ENV === \"test\") console.log('ConsentDetail.render()', this.state)\n    let formData = this.state.form;\n    let renderText;\n\n    switch (this.state.selectedConsentCategory) {\n      case 0:\n        renderText = <div style={{textAlign: 'justify'}}>\n          <b>Authorization</b>\n          <p>I expressly authorize Duke University, Duke University Health System, Inc., the Private Diagnostic Clinic, PLLC and other members of the Duke Health Enterprise identified in its Notice of Privacy Practices (collectively “DHE”), any DHE member affiliates and subsidiaries, third party service providers, and any and all members faculty or medical staff members, employees, trainees, and students of any of the above (collectively “Duke”) to communicate with me by the methods checked below:</p>\n          <b>Text Messages</b>\n          <p>To text me at the following wireless phone number provided or any other number I may provide in the future.  I understand that message and data rates may apply based on the terms of my service provider contract.  I agree that methods of contact by Duke may include use of auto-generated text messages or an automatic dialing system.</p>\n          <p>I agree to indemnify Duke in full for all claims, expenses, and damages related to or caused in whole or in part by my failure to notify Duke if I change my wireless phone number, including but not limited to all claims, expenses, and damages related to or arising under the Telephone Consumer Protection Act.  I agree to notify Duke promptly by updating my demographic information as part of the appointment registration process if I change my wireless telephone number provided above.  I may revoke my consent to receive text messages by responding to a text message with STOP, notifying clinic front desk staff, selecting the un-enroll option in MyChart account, or in writing to appointmentcommunications@dm.duke.edu.  I understand this authorization cannot be revoked to the extent that action has already been taken in reliance on this authorization prior to the date Duke receives my written request to revoke authorization.  </p>\n          <b>Unencrypted Messages</b>\n          <p>I understand that the text message contents may include my protected health information concerning my health care including but not limited to appointment reminders or availability, payment, medication reminders or notices, wellness checkups, hospital pre-registration instructions, pre-operative instructions, lab results, post-discharge follow-up intended to prevent readmission, healthcare quality assessment surveys, or treatment recommendations.</p>\n          <p>I understand that a text is unencrypted and may be intercepted or visible to be read by third parties.  I understand that this authorization to receive text will apply to all future messages unless I request a change in writing.  I understand that there is no assurance of confidentiality of information communicated by an unencrypted text message.</p>\n          <p>I understand that I may refuse to sign this authorization.  I understand that my refusal to provide the consent described in this form will not affect, directly or indirectly, my right to receive healthcare services from Duke.</p>\n\n        </div>\n      break;\n      case 1:\n        renderText = <Table>\n          <thead>\n            <tr>\n              <th className='selected'>selected</th>\n              <th className='category' >category</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>Allergies</td>          \n            </tr>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>CarePlans</td>          \n            </tr>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>Conditions</td>          \n            </tr>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>Consents</td>          \n            </tr>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>Family Member Histories</td>          \n            </tr>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>Goals</td>          \n            </tr>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>Immunizations</td>          \n            </tr>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>Medication Statements</td>          \n            </tr>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>Observations</td>          \n            </tr>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>Patient Demographics</td>          \n            </tr>\n            <tr className=\"consentRow\" style={{cursor: \"pointer\"}}>\n              <td className='selected'  style={{width: '20px', paddingTop: '16px'}}><Checkbox /></td>\n              <td className='category' style={{minWidth: '100px', paddingTop: '16px'}}>Procedures</td>          \n            </tr>\n          </tbody>\n        </Table>\n        break;\n      case 2:\n          renderText = <div >\n              <p>I understand DNR means that if my heart stops beating or if I stop breathing, no medical procedure to restart breathing or heart functioning will be instituted.</p>\n              <p>I understand this decision will not prevent me from obtaining other emergency medical care by prehospital emergency medical care personnel and/or medical care directed by a physician prior to my death.</p>\n              <p>I understand I may revoke this directive at any time by destroying this form and removing any “DNR” medallions.</p>\n              <p>I give permission for this information to be given to the prehospital emergency care personnel, doctors, nurses or other health personnel as necessary to implement this directive.</p>\n              <p>I hereby agree to the “Do Not Resuscitate” (DNR) order.</p>\n            </div>\n        break;\n\n      default:\n        break;\n    }\n\n\n    return (\n      <div id={this.props.id} className=\"consentDetail\">\n        <CardText>\n          <Row>\n          <Col md={6}>\n              <SelectField\n                floatingLabelText=\"Category\"\n                value={0}\n                onChange={this.changeSelectedCategory.bind(this)}\n                fullWidth={true}\n              >\n              \n                <MenuItem value={0} primaryText=\"Patient Authorization for Text Communications\" />\n                <MenuItem value={1} primaryText=\"OAuth 2.0\" />\n                <MenuItem value={2} primaryText=\"Do Not Resuscitate\" />\n                <MenuItem value={3} disabled primaryText=\"Illinois Consent by Minors to Medical Procedures\" />\n                <MenuItem value={4} disabled primaryText=\"42 CFR Part 2 Form of Written Consent\" />\n                <MenuItem value={5} disabled primaryText=\"HIPAA Authorization\" />\n                <MenuItem value={6} disabled primaryText=\"HIPAA Notice of Privacy Practices\" />\n                <MenuItem value={7} disabled primaryText=\"HIPAA Restrictions\" />\n                <MenuItem value={8} disabled primaryText=\"HIPAA Research Authorization\" />\n                <MenuItem value={9} disabled primaryText=\"HIPAA Self-Pay Restriction\" />\n                <MenuItem value={10} disabled primaryText=\"Research Information Access\" />\n                <MenuItem value={11} disabled primaryText=\"Authorization to Disclose Information to the Social Security Administration\" />\n                <MenuItem value={12} disabled primaryText=\"Authorization and Consent to Release Information to the Department of Veterans Affairs (VA)\" />\n                <MenuItem value={13} disabled primaryText=\"Common rule informed consent\" />\n              </SelectField>\n              { renderText }\n            </Col>\n            <Col md={6}>\n              <TextField\n                id='identifierInput'\n                ref='identifier'\n                name='identifier'\n                className='barcode'\n                floatingLabelText='Identifier'\n                hintText='kpcykg8lifppmWmth'\n                value={ get(formData, 'identifier', '')}\n                onChange={ this.changeState.bind(this, 'mrn')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n              <TextField\n                id='patientDisplayInput'\n                ref='patientDisplay'\n                name='patientDisplay'\n                floatingLabelText='Patient Name'\n                hintText='Jane Doe'\n                value={ get(formData, 'patientDisplay', '')}\n                onChange={ this.changeState.bind(this, 'patientDisplay')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n              <TextField\n                id='consentingPartyInput'\n                ref='consentingParty'\n                name='consentingParty'\n                floatingLabelText='Consenting Party'\n                hintText='Jane Doe'\n                value={ get(formData, 'consentingParty', '')}\n                onChange={ this.changeState.bind(this, 'consentingParty')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>                \n              <TextField\n                id='organizationDisplayInput'\n                ref='organizationDisplay'\n                name='organizationDisplay'\n                floatingLabelText='Organization'\n                hintText='St. James Infirmiry'\n                value={ get(formData, 'organizationDisplay', '')}\n                onChange={ this.changeState.bind(this, 'organizationDisplay')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/>\n              {/* <TextField\n                id='statusInput'\n                ref='status'\n                name='status'\n                floatingLabelText='status'\n                hintText='draft | proposed | active | rejected | inactive | entered-in-error'\n                value={ get(formData, 'status', '')}\n                onChange={ this.changeState.bind(this, 'status')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/> */}\n              <TextField\n                id='dateTimeInput'\n                ref='dateTime'\n                name='dateTime'\n                type='date'\n                floatingLabelText='Signed On'\n                value={ moment(get(formData, 'dateTime', '')).format('YYYY-MM-DD') }\n                onChange={ this.changeState.bind(this, 'dateTime')}\n                floatingLabelFixed={true}\n                fullWidth\n                /><br/><br/>\n\n              { this.determineButtons(this.data.consentId) }\n            </Col>\n          </Row>\n        </CardText>\n        <CardActions>\n        </CardActions>\n      </div>\n    );\n  }\n  determineButtons(consentId){\n    if (consentId) {\n      return (\n        <div>\n          <RaisedButton id='updateConsentButton' className='saveConsentButton' label=\"Save\" primary={true} onClick={this.handleSaveButton.bind(this)} style={{marginRight: '20px'}} />\n          <RaisedButton label=\"Delete\" onClick={this.handleDeleteButton.bind(this)} />\n        </div>\n      );\n    } else {\n      return(\n        <RaisedButton id='saveConsentButton'  className='saveConsentButton' label=\"Save\" primary={true} onClick={this.handleSaveButton.bind(this)} />\n      );\n    }\n  }\n  updateFormData(formData, field, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"ConsentDetail.updateFormData\", formData, field, textValue);\n\n    switch (field) {\n      case \"identifier\":\n        set(formData, 'identifier', textValue)\n        break;\n      case \"dateTime\":\n        set(formData, 'dateTime', textValue)\n        break;        \n      case \"status\":\n        set(formData, 'status', textValue)\n        break;\n      case \"patientDisplay\":\n        set(formData, 'patientDisplay', textValue)\n        break;\n      case \"organizationDisplay\":\n        set(formData, 'organizationDisplay', textValue)\n        break;\n      case \"consentingParty\":\n        set(formData, 'consentingParty', textValue)\n        break;\n      case \"periodStart\":\n        set(formData, 'periodStart', textValue)\n        break;\n      case \"periodEnd\":\n        set(formData, 'periodEnd', textValue)\n        break;\n      case \"type\":\n        set(formData, 'type', textValue)\n        break;\n      case \"class\":\n        set(formData, 'class', textValue)\n        break;\n      case \"category\":\n        set(formData, 'category', textValue)\n        break;\n    }\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"formData\", formData);\n    return formData;\n  }\n  updateConsent(consentData, field, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"ConsentDetail.updateConsent\", consentData, field, textValue);\n\n    switch (field) {\n      case \"identifier\":\n        set(consentData, 'identifier[0].value', textValue)\n        break;\n      case \"dateTime\":\n        set(consentData, 'dateTime', textValue)\n        break;        \n      case \"status\":\n        set(consentData, 'status', textValue)\n        break;\n      case \"patientDisplay\":\n        set(consentData, 'patient.display', textValue)\n        break;\n      case \"organizationDisplay\":\n        set(consentData, 'organization.display', textValue)\n        break;\n      case \"consentingParty\":\n        set(consentData, 'consentingParty.display', textValue)\n        break;\n      case \"periodStart\":\n        set(consentData, 'period.start', textValue)\n        break;\n      case \"periodEnd\":\n        set(consentData, 'period.end', textValue)\n        break;\n      case \"type\":\n        set(consentData, 'except[0].type', textValue)\n        break;\n      case \"class\":\n        set(consentData, 'except[0].class', textValue)\n        break;\n      case \"category\":\n        set(consentData, 'category.text', textValue)\n        break;  \n    }\n    return consentData;\n  }\n  changeState(field, event, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"   \");\n    if(process.env.NODE_ENV === \"test\") console.log(\"ConsentDetail.changeState\", field, textValue);\n    if(process.env.NODE_ENV === \"test\") console.log(\"this.state\", this.state);\n\n    let formData = Object.assign({}, this.state.form);\n    let consentData = Object.assign({}, this.state.consent);\n\n    formData = this.updateFormData(formData, field, textValue);\n    consentData = this.updateConsent(consentData, field, textValue);\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"consentData\", consentData);\n    if(process.env.NODE_ENV === \"test\") console.log(\"formData\", formData);\n\n    this.setState({consent: consentData})\n    this.setState({form: formData})\n  }\n\n\n  handleSaveButton(){\n    if(process.env.NODE_ENV === \"test\") console.log('^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&&')\n    console.log('Saving a new Consent...', this.state)\n\n    let self = this;\n    let fhirConsentData = Object.assign({}, this.state.consent);\n\n    if(process.env.NODE_ENV === \"test\") console.log('fhirConsentData', fhirConsentData);\n\n\n    let consentValidator = ConsentSchema.newContext();\n    consentValidator.validate(fhirConsentData)\n\n    console.log('IsValid: ', consentValidator.isValid())\n    console.log('ValidationErrors: ', consentValidator.validationErrors());\n\n    if (this.state.consentId) {\n      if(process.env.NODE_ENV === \"test\") console.log(\"Updating consent...\");\n\n      delete fhirConsentData._id;\n\n      // not sure why we're having to respecify this; fix for a bug elsewhere\n      fhirConsentData.resourceType = 'Consent';\n\n      Consents.update({_id: this.state.consentId}, {$set: fhirConsentData }, {\n        validate: get(Meteor, 'settings.public.defaults.schemas.validate', false), \n        filter: get(Meteor, 'settings.public.defaults.schemas.filter', false), \n        removeEmptyStrings: get(Meteor, 'settings.public.defaults.schemas.removeEmptyStrings', false)\n      }, function(error, result){\n        if (error) {\n          if(process.env.NODE_ENV === \"test\") console.log(\"Consents.insert[error]\", error);\n          Bert.alert(error.reason, 'danger');\n        }\n        if (result) {\n          HipaaLogger.logEvent({eventType: \"update\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"Consents\", recordId: this.state.consentId});\n          Session.set('selectedConsent', false);\n          Session.set('consentPageTabIndex', 1);\n          Bert.alert('Consent added!', 'success');\n        }\n      });\n    } else {\n      if(process.env.NODE_ENV === \"test\") console.log(\"Creating a new consent...\", fhirConsentData);\n\n      Consents.insert(fhirConsentData, {\n        validate: get(Meteor, 'settings.public.defaults.schemas.validate', false), \n        filter: get(Meteor, 'settings.public.defaults.schemas.filter', false), \n        removeEmptyStrings: get(Meteor, 'settings.public.defaults.schemas.removeEmptyStrings', false)\n      }, function(error, result) {\n        if (error) {\n          if(process.env.NODE_ENV === \"test\")  console.log('Consents.insert[error]', error);\n          Bert.alert(error.reason, 'danger');\n        }\n        if (result) {\n          HipaaLogger.logEvent({eventType: \"create\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"Consents\", recordId: result});\n          Session.set('consentPageTabIndex', 1);\n          Session.set('selectedConsent', false);\n          Bert.alert('Consent added!', 'success');\n        }\n      });\n    }\n  }\n\n  handleCancelButton(){\n    Session.set('consentPageTabIndex', 1);\n  }\n\n  handleDeleteButton(){\n    let self = this;\n    Consents.remove({_id: this.state.consentId}, function(error, result){\n      if (error) {\n        if(process.env.NODE_ENV === \"test\") console.log('Consents.insert[error]', error);\n        Bert.alert(error.reason, 'danger');\n      }\n      if (result) {\n        HipaaLogger.logEvent({eventType: \"delete\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"Consents\", recordId: this.state.consentId});\n        Session.set('consentPageTabIndex', 1);\n        Session.set('selectedConsent', false);\n        Bert.alert('Consent removed!', 'success');\n      }\n    });\n  }\n}\nConsentDetail.propTypes = {\n  id: PropTypes.string,\n  fhirVersion: PropTypes.string,\n  consentId: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n  consent: PropTypes.oneOfType([PropTypes.object, PropTypes.bool])\n};\n\nReactMixin(ConsentDetail.prototype, ReactMeteorData);\nexport default ConsentDetail;","import { Checkbox, FlatButton, RaisedButton, Avatar, Tab, Tabs  } from 'material-ui';\nimport { HTTP } from 'meteor/http';\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\nimport { Table } from 'react-bootstrap';\nimport { Session } from 'meteor/session';\nimport { has, get } from 'lodash';\nimport { TableNoData } from 'meteor/clinical:glass-ui';\nimport PropTypes from 'prop-types';\n\nSession.setDefault('selectedDocumentSource', '');\n\nexport class ConsentTable extends React.Component {\n  getMeteorData() {\n    let data = {\n      style: {\n        hideOnPhone: {\n          visibility: 'visible',\n          display: 'table'\n        },\n        cellHideOnPhone: {\n          visibility: 'visible',\n          display: 'table',\n          paddingTop: '16px'\n        },\n        cell: {\n          paddingTop: '16px'\n        }\n      },\n      selected: [],\n      consents: []\n    };\n\n    let query = {};\n    if(this.props.patient){\n      query['patient.display'] = this.props.patient;\n    }\n\n    if(this.props.query){\n      query = this.props.query;\n    }\n\n    let options = {};\n\n    if(this.props.sort){\n\n      switch (this.props.sort) {\n        case \"date\":\n          options.sort = { dateTime: -1 }\n          break;\n        case \"periodStart\":\n          options.sort = { 'period.start': -1 }\n          break;      \n        default:\n          break;\n      }\n    }\n\n    // number of items in the table should be set globally\n    if (get(Meteor, 'settings.public.defaults.paginationLimit')) {\n      options.limit = get(Meteor, 'settings.public.defaults.paginationLimit');\n    }\n\n    // but can be over-ridden by props being more explicit\n    if(this.props.limit){\n      options.limit = this.props.limit;      \n    }\n\n    // data.consents = [];\n    data.consents = Consents.find(query, options).map(function(document){\n      let result = {\n        _id: document._id,\n        id: get(document, 'id', ''),\n        dateTime: moment(get(document, 'dateTime', null)).format(\"YYYY-MM-DD hh:mm:ss\"),\n        status: get(document, 'status', ''),\n        patientReference: get(document, 'patient.display', ''),\n        consentingParty: get(document, 'consentingParty[0].display', ''),\n        organization: get(document, 'organization[0].display', ''),\n        policyRule: get(document, 'policyRule', ''),\n        exceptType: get(document, 'except[0].type', ''),\n        exceptAction: get(document, 'except[0].action[0].text', ''),\n        exceptClass: get(document, 'except[0].class', ''),\n        start: moment(get(document, 'period.start', '')).format(\"YYYY-MM-DD hh:mm:ss\"),\n        end: moment(get(document, 'period.end', '')).format(\"YYYY-MM-DD hh:mm:ss\"),\n        sourceReference: get(document, 'sourceReference.reference', ''),\n        category: get(document, 'category[0].text', '')\n      };\n\n      if(result.patientReference === ''){\n        result.patientReference = get(document, 'patient.reference', '');\n      }\n\n      var exceptions;\n      if(get(document, 'except.0.class')){\n        result.exceptClass = \"\";\n        document.except[0].class.forEach(function(exception){   \n          if(result.exceptClass == ''){\n            result.exceptClass = exception.code;\n          }  else {\n            result.exceptClass = result.exceptClass + ' - ' + exception.code;\n          }      \n        });\n      }\n      return result;\n    });\n\n    if (Session.get('appWidth') < 768) {\n      data.style.hideOnPhone.visibility = 'hidden';\n      data.style.hideOnPhone.display = 'none';\n      data.style.cellHideOnPhone.visibility = 'hidden';\n      data.style.cellHideOnPhone.display = 'none';\n    } else {\n      data.style.hideOnPhone.visibility = 'visible';\n      data.style.hideOnPhone.display = 'table-cell';\n      data.style.cellHideOnPhone.visibility = 'visible';\n      data.style.cellHideOnPhone.display = 'table-cell';\n    }\n\n    // console.log(\"ConsentTable[data]\", data);\n    return data;\n  }\n  rowClick(id){\n    Session.set('consentsUpsert', false);\n    Session.set('selectedConsent', id);\n    Session.set('consentPageTabIndex', 2);\n  }\n  handleRevoke(id){\n    console.log('handleRevoke')\n  }\n  // handleVerify(id){\n  //   console.log('handleVerify')\n  //   alert('Verify this Consent... (not implemented yet)')\n  // }\n\n\n  renderSelected(exceptType){\n    if (!this.props.hideSelected) {\n      return (\n        <td className='selected'  style={{minWidth: '100px', paddingTop: '16px'}}><Checkbox /></td>\n      );\n    }\n  }\n  renderSelectedHeader(){\n    if (!this.props.hideSelected) {\n      return (\n        <th className='selected'>Selected</th>\n      );\n    }\n  }\n  renderId(id){\n    if (!this.props.hideId) {\n      return (\n        <td className=\"id hidden-on-phone\" onClick={ this.onIdentifierClick.bind(this, id)} >{ id }</td>\n      );\n    }\n  }\n  renderIdHeader(){\n    if (!this.props.hideId) {\n      return (\n        <th className=\"id\" >Id</th>\n      );\n    }\n  }\n  renderIdentifier(identifier){\n    if (!this.props.hideIdentifier) {\n      return (\n        <td className=\"identifier hidden-on-phone\">{ identifier }</td>\n      );\n    }\n  }\n  renderIdentifierHeader(){\n    if (!this.props.hideIdentifier) {\n      let identiferClassName;\n\n      if(this.props.disableBarcodes){\n        identiferClassName = \"identifier hidden-on-phone\"\n      } else {\n        identiferClassName = \"identifier barcode hidden-on-phone\"\n      }\n      return (\n        <th className={identiferClassName} >Identifier</th>\n      );\n    }\n  }\n\n  renderType(exceptType){\n    if (!this.props.hideType) {\n      return (\n        <td className='exceptType' style={this.data.style.cell} >{ exceptType }</td>\n      );\n    }\n  }\n  renderTypeHeader(){\n    if (!this.props.hideType) {\n      return (\n        <th className='type' >Type</th>\n      );\n    }\n  }\n  renderClass(exceptClass){\n    if (!this.props.hideClass) {\n      return (\n        <td className='exceptClass' style={this.data.style.cell} >{ exceptClass }</td>\n      );\n    }\n  }\n  renderClassHeader(){\n    if (!this.props.hideClass) {\n      return (\n        <th className='class' >Class</th>\n      );\n    }\n  }\n  renderCategory(category){\n    if (!this.props.hideCategory) {\n      return (\n        <td className='category' style={this.data.style.cell} >{ category }</td>\n      );\n    }\n  }\n  renderCategoryHeader(){\n    if (!this.props.hideCategory) {\n      return (\n        <th className='category' >Category</th>\n      );\n    }\n  }\n  renderDate(id, dateTime){\n    if (!this.props.hideDateTime) {\n      return (\n        <td className='date' onClick={ this.rowClick.bind('this', id)} style={{minWidth: '100px', paddingTop: '16px'}}>{ dateTime }</td>\n      );\n    }\n  }\n  renderDateHeader(){\n    if (!this.props.hideDateTime) {\n      return (\n        <th className='date' style={{minWidth: '100px'}}>Date</th>\n      );\n    }\n  }\n\n\n  renderPeriodStart(id, periodStart){\n    if (!this.props.hidePeriodStart) {\n      return (\n        <td className='start' onClick={ this.rowClick.bind('this', id)} style={{minWidth: '100px', paddingTop: '16px'}}>{ periodStart }</td>\n      );\n    }\n  }\n  renderPeriodStartHeader(){\n    if (!this.props.hidePeriodStart) {\n      return (\n        <th className='start' style={{minWidth: '100px'}}>Start</th>\n      );\n    }\n  }\n  renderPeriodEnd(id, periodEnd){\n    if (!this.props.hidePeriodEnd) {\n      return (\n        <td className='end' onClick={ this.rowClick.bind('this', id)} style={{minWidth: '100px', paddingTop: '16px'}}>{ periodEnd }</td>\n      );\n    }\n  }\n  renderPeriodEndHeader(){\n    if (!this.props.hidePeriodEnd) {\n      return (\n        <th className='end' style={{minWidth: '100px'}}>End</th>\n      );\n    }\n  }\n\n\n  renderSource(sourceReference ){\n    console.log('renderSource', sourceReference)\n    if (!this.props.hideSourceReference) {\n      return (\n        <td className='sourceReference' onClick={ this.getDocumentReference.bind(this, sourceReference) } style={{minWidth: '100px', paddingTop: '16px'}}>{ sourceReference }</td>\n      );\n    }\n  }\n  renderSourceHeader(){\n    if (!this.props.hideSourceReference) {\n      return (\n        <th className='sourceReference' style={{minWidth: '100px', marginLeft: '20px'}}> Source </th>\n      );\n    }\n  }\n\n\n\n  // renderVerify(){\n  //   if (!this.props.hideVerify) {\n  //     return (\n  //       <td className='revoke'>\n  //         <FlatButton label=\"Verify\" onClick={this.handleVerify.bind(this)} />\n  //       </td>\n  //     );\n  //   }\n  // }\n  // renderVerifyHeader(){\n  //   if (!this.props.hideVerify) {\n  //     return (\n  //       <th className='end' style={{minWidth: '100px', marginLeft: '20px'}}> Verify </th>\n  //     );\n  //   }\n  // }\n\n\n  renderRevoke(){\n    if (!this.props.hideRevoke) {\n      return (\n        <td className='revoke'>\n          <FlatButton label=\"Revoke\" onClick={this.handleRevoke.bind(this)} />\n        </td>\n      );\n    }\n  }\n  renderRevokeHeader(){\n    if (!this.props.hideRevoke) {\n      return (\n        <th className='end' style={{minWidth: '100px', marginLeft: '20px'}}> Revoke </th>\n      );\n    }\n  }\n  getDocumentReference(sourceReference){\n    console.log('getDocumentReference...', sourceReference)\n\n    Session.set('selectedDocumentSource', sourceReference);\n  }\n  onPatientClick(id){\n    if(this.props.onPatientClick){\n      this.props.onPatientClick(id);\n    } else {\n      Session.set('consentsUpsert', false);\n      Session.set('selectedConsent', id);\n      Session.set('consentPageTabIndex', 2);  \n    }\n  }\n  render () {\n    let tableRows = [];\n    let footer;\n\n    if(this.data.consents.length === 0){\n      // don't try to simplifiy the double negative in this expression\n      // it's handling a boolean property, and also serving up instructions/help/warning\n      // it's klunky to reason through; but it's not hurting anything\n      if(!(this.props.noDataMessage === false)){\n        footer = <TableNoData noDataPadding={ this.props.noDataMessagePadding } />\n      }\n    } else {\n      for (var i = 0; i < this.data.consents.length; i++) {\n        tableRows.push(\n          <tr key={i} className=\"consentRow\" style={{cursor: \"pointer\"}}>\n            {this.renderSelected()}\n            {this.renderId(get(this.data.consents[i], 'id'))}\n            {this.renderIdentifier(get(this.data.consents[i], 'identifier'))}\n            {this.renderDate(get(this.data.consents[i], '_id'), get(this.data.consents[i], 'date'))}\n            {this.renderPeriodStart(get(this.data.consents[i], '_id'), get(this.data.consents[i], 'start'))}\n            {this.renderPeriodEnd(get(this.data.consents[i], '_id'), get(this.data.consents[i], 'end'))}\n\n            <td className='status' onClick={ this.rowClick.bind(this, this.data.consents[i]._id)} style={this.data.style.cell}>{this.data.consents[i].status}</td>\n            <td className='patientReference' onClick={ this.onPatientClick.bind(this, this.data.consents[i]._id)} style={this.data.style.cell} >{this.data.consents[i].patientReference }</td>\n            <td className='organization' style={this.data.style.cell} >{this.data.consents[i].organization}</td>\n\n            {this.renderType( get(this.data.consents[i], 'exceptType')) }\n            {this.renderClass( get(this.data.consents[i], 'exceptClass')) }\n            {this.renderCategory( get(this.data.consents[i], 'category')) }\n            {this.renderSource(get(this.data.consents[i], 'sourceReference')) }\n            {this.renderRevoke() }\n\n          </tr>\n        );\n      }  \n    }\n\n    return(\n      <div>\n        <Table id='consentsTable' hover >\n          <thead>\n            <tr>\n              {this.renderSelectedHeader() }\n              {this.renderIdHeader() }\n              {this.renderIdentifierHeader() }\n              {this.renderDateHeader() }\n              {this.renderPeriodStartHeader() }\n              {this.renderPeriodEndHeader() }\n              <th className='status'>Status</th>\n              <th className='patientReference'>Patient</th>\n              <th className='organization' >Organization</th>\n              {this.renderTypeHeader() }\n              {this.renderClassHeader() }\n              {this.renderCategoryHeader() }\n              {this.renderSourceHeader() }\n              {this.renderRevokeHeader() }\n            </tr>\n          </thead>\n          <tbody>\n            { tableRows }\n          </tbody>\n        </Table>\n      { footer }\n      </div>\n    );\n  }\n  onIdentifierClick(id){\n    if(typeof this.props.onIdentifierClick === \"function\"){\n      this.props.onIdentifierClick(id);\n    } \n  }\n}\n\nConsentTable.propTypes = {\n  id: PropTypes.string,\n  fhirVersion: PropTypes.string,\n  hideIdentifier: PropTypes.bool,\n  hideDateTime: PropTypes.bool,\n  hidePeriodStart: PropTypes.bool,\n  hidePeriodEnd: PropTypes.bool,\n  hideType: PropTypes.bool,\n  hideClass: PropTypes.bool,\n  hideCategory: PropTypes.bool,\n  hideVerify: PropTypes.bool,\n  hideRevoke: PropTypes.bool,\n  sourceReference: PropTypes.bool,\n  disableBarcodes: PropTypes.bool,\n  limit: PropTypes.number,\n  query: PropTypes.object,\n  patient: PropTypes.string,\n  patientDisplay: PropTypes.string,\n  sort: PropTypes.string,\n  selectedDocumentSource: PropTypes.string,\n  onPatientClick: PropTypes.func\n};\n\nReactMixin(ConsentTable.prototype, ReactMeteorData);\nexport default ConsentTable;","import { FlatButton, CardText, CardTitle, Dialog, Tab, Tabs, TextField, SelectField, MenuItem } from 'material-ui';\nimport { GlassCard, Glass, FullPageCanvas } from 'meteor/clinical:glass-ui';\n\nimport ConsentDetail from './ConsentDetail';\nimport ConsentTable from './ConsentTable';\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\nimport { get, set } from 'lodash';\n\nimport { Session } from 'meteor/session';\nimport { Col, Row, Table } from 'react-bootstrap';\n\nlet defaultConsent = {\n  index: 2,\n  id: '',\n  username: '',\n  email: '',\n  given: '',\n  family: '',\n  gender: ''\n};\nSession.setDefault('consentFormData', defaultConsent);\nSession.setDefault('consentSearchFilter', '');\nSession.setDefault('consentSearchQuery', {});\nSession.setDefault('consentDialogOpen', false);\nSession.setDefault('selectedConsentId', false);\nSession.setDefault('fhirVersion', 'v1.0.2');\n\nexport class ConsentsPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      searchForm: {\n        givenName: '',\n        familyName: '',\n        category: 0\n      },\n      searchQuery: {}\n    }\n  }\n  componentDidMount() {\n    if(get(this, 'props.params.consentId')){\n      Session.set('selectedConsentId', get(this, 'props.params.consentId'))\n      Session.set('consentPageTabIndex', 2);\n    }\n  }\n  getMeteorData() {\n    let data = {\n      style: {\n        opacity: Session.get('globalOpacity'),\n        tab: {\n          borderBottom: '1px solid lightgray',\n          borderRight: 'none'\n        }\n      },\n      tabIndex: Session.get('consentPageTabIndex'),\n      consent: defaultConsent,\n      consentSearchFilter: '',\n      currentConsent: null,\n      dialogOpen: Session.get('consentDialogOpen'), \n      selectedConsentId: Session.get('selectedConsentId'),\n      selectedConsent: false\n    };\n\n    if (Session.get('consentFormData')) {\n      data.consent = Session.get('consentFormData');\n    }\n    if (Session.get('consentSearchFilter')) {\n      data.consentSearchFilter = Session.get('consentSearchFilter');\n    }\n    if (Session.get('consentSearchQuery')) {\n      data.consentSearchQuery = Session.get('consentSearchQuery');\n    }\n    if (Session.get(\"selectedConsent\")) {\n      data.currentConsent = Session.get(\"selectedConsent\");\n    }\n\n    if(get(this, 'props.params.consentId')){\n      data.selectedConsent = Consents.findOne({id: get(this, 'props.params.consentId')});\n      Session.set('consentPageTabIndex', 2);\n    } else if (Session.get('selectedConsentId')){\n      data.selectedConsent = Consents.findOne({_id: Session.get('selectedConsentId')});\n    } else {\n      data.selectedConsent = false;\n    }\n\n    data.style = Glass.blur(data.style);\n    data.style.appbar = Glass.darkroom(data.style.appbar);\n    data.style.tab = Glass.darkroom(data.style.tab);\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"ConsentsPage[data]\", data);\n    return data;\n  }\n\n  handleTabChange(index){\n    Session.set('consentPageTabIndex', index);\n  }\n\n  onNewTab(){\n    Session.set('selectedConsent', false);\n    Session.set('consentUpsert', false);\n  }\n  handleClose(){\n    Session.set('consentDialogOpen', false);\n  }\n  handleSearch(){\n    console.log('handleSearch', get(this, 'state.searchForm'));\n\n    Session.set('consentSearchQuery', {\n      \"$and\": [\n        {\"consentingParty.display\": {\"$regex\": get(this, 'state.searchForm.familyName')}}, \n        {\"consentingParty.display\": {\"$regex\": get(this, 'state.searchForm.givenName')}}\n      ]\n    });\n    this.handleClose();\n  }\n  render() {\n    console.log('React.version: ' + React.version);\n    console.log('ConsentsPage.this.props', this.props);\n\n    const actions = [\n      <FlatButton\n        label=\"Cancel\"\n        primary={true}\n        onClick={this.handleClose}\n      />,\n      <FlatButton\n        label=\"Search\"\n        primary={true}\n        keyboardFocused={true}\n        onClick={this.handleSearch.bind(this) }\n      />,\n    ];\n\n    \n    return (\n      <div id=\"consentsPage\">\n        <FullPageCanvas>\n          <GlassCard height=\"auto\">\n            <CardTitle\n              title=\"Consents\"\n            />\n            <CardText>\n              <Tabs id='consentsPageTabs' default value={this.data.tabIndex} onChange={this.handleTabChange} initialSelectedIndex={1}>\n                 <Tab className=\"newConsentTab\" label='New' style={this.data.style.tab} onActive={ this.onNewTab } value={0}>\n                   <ConsentDetail \n                   id='newConsent' \n                   fhirVersion={ this.data.fhirVersion }\n                   consent={ this.data.selectedConsent }\n                   consentId={ this.data.selectedConsentId } />       \n                 </Tab>\n                 <Tab className=\"consentListTab\" label='Consents' onActive={this.handleActive} style={this.data.style.tab} value={1}>\n                   <ConsentTable \n                    showBarcodes={true} \n                    noDataMessagePadding={100}\n                    hideIdentifier={true}\n                    patient={ this.data.consentSearchFilter }\n                    query={ this.data.consentSearchQuery }\n                    sort=\"periodStart\"\n                    />\n                 </Tab>\n                 <Tab className=\"consentDetailTab\" label='Detail' onActive={this.handleActive} style={this.data.style.tab} value={2}>\n                   <ConsentDetail \n                    id='consentDetails' \n                    fhirVersion={ this.data.fhirVersion }\n                    consent={ this.data.selectedConsent }\n                    consentId={ this.data.selectedConsentId } \n                    />   \n                 </Tab>\n             </Tabs>\n\n\n            </CardText>\n          </GlassCard>\n          <Dialog\n            title=\"Search Consent Records\"\n            actions={actions}\n            modal={false}\n            open={this.data.dialogOpen}\n            onRequestClose={this.handleClose}\n          >\n            <Row>\n              <Col md={6}>\n                <TextField\n                  id='givenNameInput'\n                  ref='givenName'\n                  name='givenName'\n                  floatingLabelText='Given Name'\n                  hintText='Jane'\n                  value={ get(this, 'state.searchForm.givenName', '')}\n                  onChange={ this.changeState.bind(this, 'givenName')}\n                  floatingLabelFixed={true}\n                  fullWidth\n                  /><br/>\n              </Col>\n              <Col md={6}>\n                <TextField\n                  id='familyNameInput'\n                  ref='familyName'\n                  name='familyName'\n                  floatingLabelText='Family Name'\n                  hintText='Doe'\n                  value={ get(this, 'state.searchForm.familyName', '')}\n                  onChange={ this.changeState.bind(this, 'familyName')}\n                  floatingLabelFixed={true}\n                  fullWidth\n                  /><br/>\n\n              </Col>\n            </Row>\n            <SelectField\n                floatingLabelText=\"Category\"\n                value={ this.state.searchForm.category }\n                onChange={this.changeSelectedCategory.bind(this)}\n                fullWidth={true}\n              >\n                <MenuItem value={0} primaryText=\"\" />\n                <MenuItem value={1} primaryText=\"Patient Authorization for Text Communications\" />\n                <MenuItem value={2} primaryText=\"OAuth 2.0\" />\n                <MenuItem value={3} primaryText=\"Do Not Resuscitate\" />\n                <MenuItem value={4} disabled primaryText=\"Illinois Consent by Minors to Medical Procedures\" />\n                <MenuItem value={5} disabled primaryText=\"42 CFR Part 2 Form of Written Consent\" />\n                <MenuItem value={6} disabled primaryText=\"Common rule informed consent\" />\n                <MenuItem value={7} disabled primaryText=\"HIPAA Authorization\" />\n                <MenuItem value={8} disabled primaryText=\"HIPAA Notice of Privacy Practices\" />\n                <MenuItem value={9} disabled primaryText=\"HIPAA Restrictions\" />\n                <MenuItem value={10} disabled primaryText=\"HIPAA Research Authorization\" />\n\n                {/* <MenuItem value={10} primaryText=\"HIPAA Self-Pay Restriction\" />\n                <MenuItem value={11} primaryText=\"Research Information Access\" />\n                <MenuItem value={12} primaryText=\"Authorization to Disclose Information to the Social Security Administration\" />\n                <MenuItem value={13} primaryText=\"Authorization and Consent to Release Information to the Department of Veterans Affairs (VA)\" /> */}\n                \n              </SelectField>\n        </Dialog>\n        </FullPageCanvas>\n      </div>\n    );\n  }\n  changeSelectedCategory(event, value){\n    console.log('changeSelectedCategory', event, value)\n\n    let searchForm = this.state.searchForm;\n    searchForm.category = value;\n\n    this.setState({searchForm: searchForm})\n  }\n  updateFormData(formData, field, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"ConsentDetail.updateFormData\", formData, field, textValue);\n\n    switch (field) {\n      case \"givenName\":\n        set(formData, 'givenName', textValue)\n        break;\n      case \"familyName\":\n        set(formData, 'familyName', textValue)\n        break;        \n      case \"category\":\n        set(formData, 'category', textValue)\n        break;\n    }\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"formData\", formData);\n    return formData;\n  }\n  updateSearch(consentData, field, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"ConsentDetail.updateConsent\", consentData, field, textValue);\n\n    // switch (field) {\n    //   case \"givenName\":\n    //     set(consentData, 'givenName', textValue)\n    //     break;\n    //   case \"familyName\":\n    //     set(consentData, 'familyName', textValue)\n    //     break;        \n    //   case \"category\":\n    //     set(consentData, 'category.text', textValue)\n    //     break;  \n    // }\n    return consentData;\n  }\n  changeState(field, event, textValue){\n    if(process.env.NODE_ENV === \"test\") console.log(\"   \");\n    if(process.env.NODE_ENV === \"test\") console.log(\"ConsentDetail.changeState\", field, textValue);\n    if(process.env.NODE_ENV === \"test\") console.log(\"this.state\", this.state);\n\n    let searchForm = Object.assign({}, this.state.searchForm);\n    let searchQuery = Object.assign({}, this.state.searchQuery);\n\n    searchForm = this.updateFormData(searchForm, field, textValue);\n    searchQuery = this.updateSearch(searchQuery, field, textValue);\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"searchQuery\", searchQuery);\n    if(process.env.NODE_ENV === \"test\") console.log(\"searchForm\", searchForm);\n\n    this.setState({searchQuery: searchQuery})\n    this.setState({searchForm: searchForm})\n  }\n\n}\n\n\n\n\n\n\n\nReactMixin(ConsentsPage.prototype, ReactMeteorData);\n\nexport default ConsentsPage;"]}