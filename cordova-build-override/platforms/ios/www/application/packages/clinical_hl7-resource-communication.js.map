{"version":3,"sources":["meteor://ðŸ’»app/packages/clinical:hl7-resource-communication/lib/Communications.js","meteor://ðŸ’»app/packages/clinical:hl7-resource-communication/index.jsx","meteor://ðŸ’»app/packages/clinical:hl7-resource-communication/client/CommunicationDetail.jsx","meteor://ðŸ’»app/packages/clinical:hl7-resource-communication/client/CommunicationTable.jsx","meteor://ðŸ’»app/packages/clinical:hl7-resource-communication/client/CommunicationsPage.jsx"],"names":["module","export","Communication","Communications","CommunicationSchema","SimpleSchema","link","v","Package","console","log","BaseModel","extend","prototype","_collection","Mongo","Collection","connection","_transform","document","type","String","defaultValue","optional","Array","IdentifierSchema","ReferenceSchema","Code","Boolean","CodeableConceptSchema","Date","Object","AttachmentSchema","AnnotationSchema","BaseSchema","DomainResourceSchema","attachSchema","toFhir","EJSON","stringify","name","findCommunicationsSentByUserId","userId","process","env","TRACE","find","findCommunicationsSentToUserId","findConversation","conversationId","sort","fetchBundle","query","parameters","callback","communicationArray","map","communication","id","_id","_document","result","Bundle","generate","SidebarElements","DynamicRoutes","CommunicationsPage","CommunicationTable","CommunicationDetail","get","Bert","React","ReactMeteorData","ReactMixin","CardActions","CardText","Card","TextField","RaisedButton","Grid","Row","Col","Table","Session","defaultCommunication","url","setDefault","getMeteorData","data","communicationId","selectedCommunication","findOne","birthDate","moment","add","format","NODE_ENV","render","props","paddingBottom","paddingTop","changeState","bind","padding","marginBottom","field","event","value","communicationUpdate","text","gender","toLowerCase","photo","identifier","set","handleSaveButton","resourceType","update","$set","error","alert","reason","HipaaLogger","logEvent","eventType","Meteor","userName","user","fullName","collectionName","recordId","insert","handleCancelButton","handleDeleteButton","remove","Component","Avatar","FlatButton","HTTP","style","hideOnPhone","visibility","display","cellHideOnPhone","cell","avatar","backgroundColor","userSelect","borderRadius","height","width","selected","communications","options","limit","subject","recipient","definition","sent","received","category","payload","rowClick","onSend","httpEndpoint","post","tableRows","i","length","push","cursor","minWidth","CardTitle","Tab","Tabs","Glass","GlassCard","FullPageCanvas","index","username","email","given","family","opacity","tab","borderBottom","borderRight","tabIndex","communicationSearchFilter","currentCommunication","blur","appbar","darkroom","handleTabChange","onNewTab","handleActive","exportDefault"],"mappings":"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/C,cAAc,CAACgD,WAAf,GAA6B,UAAUC,KAAV,EAAiBC,UAAjB,EAA6BC,QAA7B,EAAuC;AAClEX,SAAO,CAACC,GAAR,CAAYC,KAAZ,IAAqBpC,OAAO,CAACC,GAAR,CAAY,8BAAZ,CAArB;AACA,MAAI6C,kBAAkB,GAAGpD,cAAc,CAAC2C,IAAf,CAAoBM,KAApB,EAA2BC,UAA3B,EAAuCC,QAAvC,EAAiDE,GAAjD,CAAqD,UAASC,aAAT,EAAuB;AACnGA,iBAAa,CAACC,EAAd,GAAmBD,aAAa,CAACE,GAAjC;AACA,WAAOF,aAAa,CAACG,SAArB;AACA,WAAOH,aAAP;AACD,GAJwB,CAAzB,CAFkE,CAQlE;;AAEA,MAAII,MAAM,GAAGC,MAAM,CAACC,QAAP,CAAgBR,kBAAhB,CAAb,CAVkE,CAYlE;;AAEA,SAAOM,MAAP;AACD,CAfD,C,CAkBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AA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","file":"/packages/clinical_hl7-resource-communication.js","sourcesContent":["import SimpleSchema from 'simpl-schema';\n\nif(Package['clinical:autopublish']){\n  console.log(\"*****************************************************************************\")\n  console.log(\"HIPAA WARNING:  Your app has the 'clinical-autopublish' package installed.\");\n  console.log(\"Any protected health information (PHI) stored in this app should be audited.\"); \n  console.log(\"Please consider writing secure publish/subscribe functions and uninstalling.\");  \n  console.log(\"\");  \n  console.log(\"meteor remove clinical:autopublish\");  \n  console.log(\"\");  \n}\nif(Package['autopublish']){\n  console.log(\"*****************************************************************************\")\n  console.log(\"HIPAA WARNING:  DO NOT STORE PROTECTED HEALTH INFORMATION IN THIS APP. \");  \n  console.log(\"Your application has the 'autopublish' package installed.  Please uninstall.\");\n  console.log(\"\");  \n  console.log(\"meteor remove autopublish\");  \n  console.log(\"meteor add clinical:autopublish\");  \n  console.log(\"\");  \n}\n\n\n\n\n\n\n\n/**\n * @summary Represents a Communication; typically documented by a clinician.  A Clinical Impression can be self-assigned, in which case it may be considered a Status or ReportedCondition.\n * @class Communication\n * @param {Object} document An object representing an impression, ususally a Mongo document.\n * @example\nnewCommunication = new Communication({\n  name: {\n    given: \"Jane\",\n    family: \"Doe\"\n  },\n  gender: \"female\",\n  identifier: \"12345\"\n});\n\n\nnewCommunication.clean();\nnewCommunication.validate();\nnewCommunication.save();\n */\n\n\n// create the object using our BaseModel\nCommunication = BaseModel.extend();\n\n\n//Assign a collection so the object knows how to perform CRUD operations\nCommunication.prototype._collection = Communications;\n\n// Create a persistent data store for addresses to be stored.\n// HL7.Resources.Communications = new Mongo.Collection('HL7.Resources.Communications');\nif(typeof Communications === 'undefined'){\n  if(Package['clinical:autopublish']){\n    Communications = new Mongo.Collection('Communications');\n  } else if(Package['clinical:desktop-publish']){\n    Communications = new Mongo.Collection('Communications');\n  } else {\n    Communications = new Mongo.Collection('Communications', {connection: null});\n  }\n}\n\n//Add the transform to the collection since Meteor.users is pre-defined by the accounts package\nCommunications._transform = function (document) {\n  return new Communication(document);\n};\n\n\n\n\nCommunicationSchema = new SimpleSchema({\n  \"resourceType\" : {\n    type: String,\n    defaultValue: \"Communication\"\n  },\n  \"identifier\" : {\n    optional: true,\n    type:  Array\n    },\n  \"identifier.$\" : {\n    optional: true,\n    type:  IdentifierSchema \n    },\n  \"definition\" : {\n    optional: true,\n    type: Array\n  },\n  \"definition.$\" : {\n    optional: true,\n    type: ReferenceSchema \n  },  \n  \"basedOn\" : {\n    optional: true,\n    type: ReferenceSchema\n  }, \n  \"partOf\" : {\n    optional: true,\n    type: ReferenceSchema\n  }, // the conversation\n  \"status\" : {\n    optional: false,\n    type: Code\n  }, // R!  registered | partial | final | corrected | appended | cancelled | entered-in-error\n  \"notDone\" : {\n    type: Boolean,\n    optional: true,\n    defaultValue: false\n  },\n  \"notDoneReason\" : {\n    optional: true,\n    type: CodeableConceptSchema\n  },\n  \"category\" : {\n    optional: true,\n    type: Array\n  }, \n  \"category.$\" : {\n    optional: true,\n    type: CodeableConceptSchema \n  }, \n  \"medium\" : {\n    optional: true,\n    type: Array\n  },\n  \"medium.$\" : {\n    optional: true,\n    type: CodeableConceptSchema \n  },  \n  \"subject\" : {\n    optional: true,\n    type: ReferenceSchema\n  }, // R!  The subject of the communication\n  \"recipient\" : {\n    optional: true,\n    type: Array\n  }, \n  \"recipient.$\" : {\n    optional: true,\n    type: ReferenceSchema \n  },   \n  \"topic\" : {\n    optional: true,\n    type: Array\n  }, \n  \"topic.$\" : {\n    optional: true,\n    type: ReferenceSchema \n  },   \n  \"context\" : {\n    optional: true,\n    type: ReferenceSchema\n  }, \n  \"sent\" : {\n    optional: true,\n    type: Date\n  },\n  \"received\" : {\n    optional: true,\n    type: Date\n  },\n  \"sender\" : {\n    optional: true,\n    type: ReferenceSchema\n  },\n  \"reasonCode\" : {\n    optional: true,\n    type: Array\n  }, \n  \"reasonCode.$\" : {\n    optional: true,\n    type: CodeableConceptSchema \n  }, \n  \"reasonReference\" : {\n    optional: true,\n    type: Array\n  }, \n  \"reasonReference.$\" : {\n    optional: true,\n    type: ReferenceSchema \n  },   \n\n  \"payload\" : {\n    optional: true,\n    type: Array\n  },\n  \"payload.$\" : {\n    optional: true,\n    type: Object\n  },\n  \"payload.$.contentString\" : {\n      optional: true,\n      type: String\n  },\n  \"payload.$.contentAttachment\" : {\n    optional: true,\n    type: AttachmentSchema\n  },\n  \"payload.$.contentReference\" : {\n    optional: true,\n    type: ReferenceSchema\n  },\n  \"note\" : {\n    optional: true,\n    type: Array\n  },\n  \"note.$\" : {\n    optional: true,\n    type: AnnotationSchema \n  }\n});\n\nBaseSchema.extend(CommunicationSchema);\nDomainResourceSchema.extend(CommunicationSchema);\n\nCommunications.attachSchema(CommunicationSchema);\n\n\nCommunication.prototype.toFhir = function(){\n  console.log('Communication.toFhir()');\n\n  return EJSON.stringify(this.name);\n}\n\n/**\n * @summary Search the Communications collection for those sent by a specific userId.\n * @memberOf Communications\n * @name findCommunicationsSentByUserId\n * @version 1.2.3\n * @returns array of communications\n * @example\n * ```js\n *  let communications = Communications.findCommunicationsSentByUserId(Meteor.userId());\n *  let communication = communications[0];\n * ```\n */\n\nCommunications.findCommunicationsSentByUserId = function (userId) {\n  process.env.TRACE && console.log(\"Communications.findCommunicationsSentByUserId()\");\n  return Communications.find({'sender.value': userId});\n};\n\n/**\n * @summary Search the Communications collection for those sent by a specific userId.\n * @memberOf Communications\n * @name findCommunicationsSentToUserId\n * @version 1.2.3\n * @returns array of communications\n * @example\n * ```js\n *  let communications = Communications.findCommunicationsSentByUserId(Meteor.userId());\n *  let communication = communications[0];\n * ```\n */\nCommunications.findCommunicationsSentToUserId = function (userId) {\n  process.env.TRACE && console.log(\"Communications.findCommunicationsSentToUserId()\");\n  return Communications.find({'recipient.value': userId});\n};\n\n\n/**\n * @summary Search the Communications collection for a specific Meteor.userId().\n * @memberOf Communications\n * @name findMrn\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n *  let communications = Communications.findMrn('12345').fetch();\n * ```\n */\nCommunications.findConversation = function (conversationId, sort=1) {\n  process.env.TRACE && console.log(\"Communications.findMrn()\");  \n  return Communications.find(\n    { 'partOf.identifier.value': conversationId}, \n    { 'sort': { 'received': sort } });\n};\n\n/**\n * @summary Search the Communications collection for a specific query.\n * @memberOf Communications\n */\n\nCommunications.fetchBundle = function (query, parameters, callback) {\n  process.env.TRACE && console.log(\"Communications.fetchBundle()\");  \n  var communicationArray = Communications.find(query, parameters, callback).map(function(communication){\n    communication.id = communication._id;\n    delete communication._document;\n    return communication;\n  });\n\n  // console.log(\"communicationArray\", communicationArray);\n\n  var result = Bundle.generate(communicationArray);\n\n  // console.log(\"result\", result.entry[0]);\n\n  return result;\n};\n\n\n// /**\n//  * @summary This function takes a FHIR resource and prepares it for storage in Mongo.\n//  * @memberOf Communications\n//  * @name toMongo\n//  * @version 1.6.0\n//  * @returns { Communication }\n//  * @example\n//  * ```js\n//  *  let communications = Communications.toMongo('12345').fetch();\n//  * ```\n//  */\n\n// Communications.toMongo = function (originalCommunication) {\n//   var mongoRecord;\n//   process.env.TRACE && console.log(\"Communications.toMongo()\");  \n\n//   if (originalCommunication.identifier) {\n//     originalCommunication.identifier.forEach(function(identifier){\n//       if (identifier.period) {\n//         if (identifier.period.start) {\n//           var startArray = identifier.period.start.split('-');\n//           identifier.period.start = new Date(startArray[0], startArray[1] - 1, startArray[2]);\n//         }\n//         if (identifier.period.end) {\n//           var endArray = identifier.period.end.split('-');\n//           identifier.period.end = new Date(startArray[0], startArray[1] - 1, startArray[2]);\n//         }\n//       }\n//     });\n//   }\n\n//   return originalCommunication;\n// };\n\n\n\n// /**\n//  * @summary This function takes a DTSU2 resource and returns it as STU3.  i.e. it converts from v1.0.2 to v3.0.0\n//  * @name toMongo\n//  * @version 3.0.0\n//  * @returns { Communication }\n//  * @example\n//  * ```js\n//  * ```\n//  */\n// Communications.toStu3 = function(communicationJson){\n//   if(communicationJson){\n\n//     // quick cast from string to boolean\n//     if(typeof communicationJson.birthDate === \"string\"){\n//       communicationJson.birthDate = new Date(communicationJson.birthDate);\n//     }\n\n//     // quick cast from string to boolean\n//     if(communicationJson.deceasedBoolean){\n//       communicationJson.deceasedBoolean = (communicationJson.deceasedBoolean == \"true\") ? true : false;\n//     }\n\n//     // STU3 only has a single entry for family name; not an array\n//     if(communicationJson.name && communicationJson.name[0] && communicationJson.name[0].family && communicationJson.name[0].family[0] ){\n//       communicationJson.name[0].family = communicationJson.name[0].family[0];      \n//     }\n\n//     // make sure the full name is filled out\n//     if(communicationJson.name && communicationJson.name[0] && communicationJson.name[0].family && !communicationJson.name[0].text ){\n//       communicationJson.name[0].text = communicationJson.name[0].given[0] + ' ' + communicationJson.name[0].family;      \n//     }\n//   }\n//   return communicationJson;\n// }\n\n\n// /**\n//  * @summary Similar to toMongo(), this function prepares a FHIR record for storage in the Mongo database.  The difference being, that this assumes there is already an existing record.\n//  * @memberOf Communications\n//  * @name prepForUpdate\n//  * @version 1.6.0\n//  * @returns { Object }\n//  * @example\n//  * ```js\n//  *  let communications = Communications.findMrn('12345').fetch();\n//  * ```\n//  */\n\n// Communications.prepForUpdate = function (communication) {\n//   process.env.TRACE && console.log(\"Communications.prepForUpdate()\");  \n\n//   if (communication.name && communication.name[0]) {\n//     //console.log(\"communication.name\", communication.name);\n\n//     communication.name.forEach(function(name){\n//       name.resourceType = \"HumanName\";\n//     });\n//   }\n\n//   if (communication.telecom && communication.telecom[0]) {\n//     //console.log(\"communication.telecom\", communication.telecom);\n//     communication.telecom.forEach(function(telecom){\n//       telecom.resourceType = \"ContactPoint\";\n//     });\n//   }\n\n//   if (communication.address && communication.address[0]) {\n//     //console.log(\"communication.address\", communication.address);\n//     communication.address.forEach(function(address){\n//       address.resourceType = \"Address\";\n//     });\n//   }\n\n//   if (communication.contact && communication.contact[0]) {\n//     //console.log(\"communication.contact\", communication.contact);\n\n//     communication.contact.forEach(function(contact){\n//       if (contact.name) {\n//         contact.name.resourceType = \"HumanName\";\n//       }\n\n//       if (contact.telecom && contact.telecom[0]) {\n//         contact.telecom.forEach(function(telecom){\n//           telecom.resourceType = \"ContactPoint\";\n//         });\n//       }\n\n//     });\n//   }\n\n//   return communication;\n// };\n\n\n// /**\n//  * @summary Scrubbing the communication; make sure it conforms to v1.6.0\n//  * @memberOf Communications\n//  * @name scrub\n//  * @version 1.2.3\n//  * @returns {Boolean}\n//  * @example\n//  * ```js\n//  *  let communications = Communications.findMrn('12345').fetch();\n//  * ```\n//  */\n\n// Communications.prepForFhirTransfer = function (communication) {\n//   process.env.TRACE && console.log(\"Communications.prepForFhirTransfer()\");  \n\n\n//   // FHIR has complicated and unusual rules about dates in order\n//   // to support situations where a family member might report on a communication's\n//   // date of birth, but not know the year of birth; and the other way around\n//   if (communication.birthDate) {\n//     communication.birthDate = moment(communication.birthDate).format(\"YYYY-MM-DD\");\n//   }\n\n\n//   if (communication.name && communication.name[0]) {\n//     //console.log(\"communication.name\", communication.name);\n\n//     communication.name.forEach(function(name){\n//       delete name.resourceType;\n//     });\n//   }\n\n//   if (communication.telecom && communication.telecom[0]) {\n//     //console.log(\"communication.telecom\", communication.telecom);\n//     communication.telecom.forEach(function(telecom){\n//       delete telecom.resourceType;\n//     });\n//   }\n\n//   if (communication.address && communication.address[0]) {\n//     //console.log(\"communication.address\", communication.address);\n//     communication.address.forEach(function(address){\n//       delete address.resourceType;\n//     });\n//   }\n\n//   if (communication.contact && communication.contact[0]) {\n//     //console.log(\"communication.contact\", communication.contact);\n\n//     communication.contact.forEach(function(contact){\n\n//       console.log(\"contact\", contact);\n\n\n//       if (contact.name && contact.name.resourceType) {\n//         //console.log(\"communication.contact.name\", contact.name);\n//         delete contact.name.resourceType;\n//       }\n\n//       if (contact.telecom && contact.telecom[0]) {\n//         contact.telecom.forEach(function(telecom){\n//           delete telecom.resourceType;\n//         });\n//       }\n\n//     });\n//   }\n\n//   //console.log(\"Communications.prepForBundle()\", communication);\n\n//   return communication;\n// };\n\n// /**\n//  * @summary The displayed name of the communication.\n//  * @memberOf Communication\n//  * @name displayName\n//  * @version 1.2.3\n//  * @returns {Boolean}\n//  * @example\n//  * ```js\n//  * ```\n//  */\n\n// Communication.prototype.displayName = function () {\n//   process.env.TRACE && console.log(\"Communications.displayName()\");  \n\n//   if (this.name && this.name[0]) {\n//     return this.name[0].text;\n//   }\n// };\n\n\n// /**\n//  * @summary The displayed Meteor.userId() of the communication.\n//  * @memberOf Communication\n//  * @name userId\n//  * @version 1.2.3\n//  * @returns {Boolean}\n//  * @example\n//  * ```js\n//  * ```\n//  */\n\n// Communication.prototype.userId = function () {\n//   process.env.TRACE && console.log(\"Communications.userId()\");  \n\n//   var result = null;\n//   if (this.extension) {\n//     this.extension.forEach(function(extension){\n//       if (extension.url === \"Meteor.userId()\") {\n//         result = extension.valueString;\n//       }\n//     });\n//   }\n//   return result;\n// };\n\n\n\n/**\n * @summary The displayed Meteor.userId() of the communication.\n * @memberOf Communication\n * @name userId\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n * ```\n */\n\n\n/**\n * @summary Anonymize the communication record\n * @memberOf Communication\n * @name removeProtectedInfo\n * @version 1.2.3\n * @returns {Object}\n * @example\n * ```js\n * ```\n */\n\n// // Communication.prototype.removeProtectedInfo = function (options) {\n// //   process.env.TRACE && console.log(\"Communications.anonymize()\", this);  \n\n// //   console.log(\"Communications.anonymize()\");  \n\n// //   // 1. Names\n// //   if(this.name && this.name[0]){\n// //     var anonymizedName = this.name[0];\n\n// //     if(this.name[0].family){\n// //       anonymizedName.family = '';\n// //     }\n// //     if(this.name[0].given && this.name[0].given[0]){\n// //       anonymizedName.given = [];          \n// //     }\n// //     if(this.name[0].text){\n// //       anonymizedName.text = '';\n// //     }\n\n// //     this.name = [];\n// //     this.name.push(anonymizedName);\n// //   }\n\n//   // 3.  dates\n\n\n//   // 4. Phone numbers\n//   // 5.  Fax Numbers\n//   // 6.  Identifiers\n//   // 7.  Medical Record Nubers\n//   // 17.  Photos\n\n//   return this;\n// }\n\n\n/**\n * @summary Anonymize the communication record\n * @memberOf Communication\n * @name anonymize\n * @version 1.2.3\n * @returns {Object}\n * @example\n * ```js\n * ```\n */\n\n// Communication.prototype.anonymize = function () {\n//   process.env.TRACE && console.log(\"Communications.hash()\", this);  \n\n//   console.log(\"Communications.hash()\");  \n\n\n//   if(this.name && this.name[0]){\n//     var anonymizedName = this.name[0];\n\n//     if(this.name[0].family){\n//       anonymizedName.family = Anon.name(this.name[0].family);        \n//     }\n//     if(this.name[0].given && this.name[0].given[0]){\n//       var secretGiven = Anon.name(this.name[0].given[0]);\n//       anonymizedName.given = [];      \n//       anonymizedName.given.push(secretGiven);\n//     }\n//     if(this.name[0].text){\n//       anonymizedName.text = Anon.name(this.name[0].text);\n//     }\n\n//     this.name = [];\n//     this.name.push(anonymizedName);\n//   }\n\n//   return this;\n// }\n\n\n// Anon = {\n//   name: function(name){\n//     var anonName = '';\n//     for(var i = 0; i < name.length; i++){\n//       if(name[i] === \" \"){\n//         anonName = anonName + \" \";\n//       } else {\n//         anonName = anonName + \"*\";\n//       }\n//     }\n//     return anonName;\n//   },\n//   phone: function(){\n//     return \"NNN-NNN-NNNN\";\n//   },\n//   ssn: function(){\n//     return \"###-##-####\"\n//   }\n// }\n\n\nexport { Communication, Communications, CommunicationSchema };","\n\n\nimport CommunicationsPage from './client/CommunicationsPage';\nimport CommunicationTable from './client/CommunicationTable';\n\nvar DynamicRoutes = [{\n  'name': 'CommunicationPage',\n  'path': '/communications',\n  'component': CommunicationsPage,\n  'requireAuth': true\n}];\n\nvar SidebarElements = [{\n  'primaryText': 'Communications',\n  'to': '/communications',\n  'href': '/communications'\n}];\n\nexport { \n  SidebarElements, \n  DynamicRoutes, \n\n  CommunicationsPage,\n  CommunicationTable\n};\n\n\n","import { get } from 'lodash';\n\nimport { Bert } from 'meteor/clinical:alert';\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\nimport { CardActions, CardText, Card, TextField, RaisedButton } from 'material-ui';\nimport { Grid, Row, Col, Table } from 'react-bootstrap';\n\nimport { Session } from 'meteor/session';\n\n\nlet defaultCommunication = {\n  \"resourceType\" : \"Communication\",\n  \"name\" : [{\n    \"text\" : \"\",\n    \"resourceType\" : \"HumanName\"\n  }],\n  \"active\" : true,\n  \"gender\" : \"\",\n  \"birthDate\" : null,\n  \"photo\" : [{\n    url: \"\"\n  }],\n  \"identifier\": [{\n    \"use\": \"usual\",\n    \"type\": {\n      \"coding\": [\n        {\n          \"system\": \"http://hl7.org/fhir/v2/0203\",\n          \"code\": \"MR\"\n        }\n      ]\n    },\n    \"value\": \"\"\n  }],\n  \"test\" : false\n};\n\n\nSession.setDefault('communicationUpsert', false);\nSession.setDefault('selectedCommunication', false);\n\nexport default class CommunicationDetail extends React.Component {\n  getMeteorData() {\n    let data = {\n      communicationId: false,\n      communication: defaultCommunication\n    };\n\n    if (Session.get('communicationUpsert')) {\n      data.communication = Session.get('communicationUpsert');\n    } else {\n      if (Session.get('selectedCommunication')) {\n        data.communicationId = Session.get('selectedCommunication');\n        console.log(\"selectedCommunication\", Session.get('selectedCommunication'));\n\n        let selectedCommunication = Communications.findOne({_id: Session.get('selectedCommunication')});\n        console.log(\"selectedCommunication\", selectedCommunication);\n\n        if (selectedCommunication) {\n          data.communication = selectedCommunication;\n\n          if (typeof selectedCommunication.birthDate === \"object\") {\n            data.communication.birthDate = moment(selectedCommunication.birthDate).add(1, 'day').format(\"YYYY-MM-DD\");\n          }\n        }\n      } else {\n        data.communication = defaultCommunication;\n      }\n    }\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"CommunicationDetail[data]\", data);\n    return data;\n  }\n\n  render() {\n    return (\n      <div id={this.props.id} className=\"communicationDetail\">\n        <CardText>\n          <Grid>\n            <Row style={{paddingBottom: '20px', paddingTop: '40px'}}>\n              <Col md={2}>\n                <TextField\n                  id='categoryInput'\n                  name='category'\n                  floatingLabelText='category'\n                  value={ get(this, 'data.communication.category[0].text') }\n                  onChange={ this.changeState.bind(this, 'category')}\n                  fullWidth\n                  /><br/>\n              </Col>\n              <Col md={6}>\n                <TextField\n                  id='identifierInput'\n                  name='identifier'\n                  floatingLabelText='identifier'\n                  value={ get(this, 'data.communication.identifier[0].url') }\n                  onChange={ this.changeState.bind(this, 'photo')}\n                  floatingLabelFixed={false}\n                  fullWidth\n                  /><br/>\n              </Col>\n            </Row>\n            <Row>\n              <Col md={4}>\n                <Card zDepth={2} style={{padding: '20px', marginBottom: '20px'}}>\n                  <TextField\n                    id='subjectInput'\n                    name='subject'\n                    floatingLabelText='subject'\n                    value={ get(this, 'data.communication.subject.display', '') }\n                    onChange={ this.changeState.bind(this, 'name')}\n                    fullWidth\n                    /><br/>\n                  <TextField\n                    id='sentInput'\n                    name='sent'\n                    floatingLabelText='sent'\n                    value={ moment(get(this, 'data.communication.sent')).format('YYYY-MM-DD hh:mm:ss') }\n                    onChange={ this.changeState.bind(this, 'sent')}\n                    fullWidth\n                    /><br/>\n                </Card>\n              </Col>\n              <Col md={4}>\n                <Card zDepth={2} style={{padding: '20px', marginBottom: '20px'}}>\n                  <TextField\n                    id='definitionInput'\n                    name='definition'\n                    floatingLabelText='definition'\n                    value={ get(this, 'data.communication.definition[0].text') }\n                    onChange={ this.changeState.bind(this, 'definition')}\n                    fullWidth\n                    /><br/>\n                  <TextField\n                    id='payloadInput'\n                    name='payload'\n                    floatingLabelText='payload'\n                    value={ get(this, 'data.communication.payload[0].contentString') }\n                    onChange={ this.changeState.bind(this, 'payload')}\n                    fullWidth\n                    /><br/>\n                </Card>\n              \n              </Col>\n              <Col md={4}>\n                <Card zDepth={2} style={{padding: '20px', marginBottom: '20px'}}>\n                  <TextField\n                    id='recipientInput'\n                    name='recipient'\n                    floatingLabelText='recipient'\n                    onChange={ this.changeState.bind(this, 'recipient')}\n                    value={ get(this, 'data.communication.recipient.display', '') }\n                    fullWidth\n                    /><br/>\n                  <TextField\n                    id='receivedInput'\n                    name='received'\n                    floatingLabelText='received'\n                    value={ moment(get(this, 'data.communication.received')).format('YYYY-MM-DD hh:mm:ss') }\n                    onChange={ this.changeState.bind(this, 'received')}\n                    fullWidth\n                    /><br/>\n                </Card>\n                {/* { this.determineButtons(this.data.communicationId) }   */}\n              </Col>\n            </Row>\n          </Grid>\n\n        </CardText>\n      </div>\n    );\n  }\n  // determineButtons(communicationId){\n  //   if (communicationId) {\n  //     return (\n  //       <div>\n  //         <RaisedButton id='saveCommunicationButton' className='saveCommunicationButton' label=\"Save\" primary={true} onClick={this.handleSaveButton.bind(this)} style={{marginRight: '20px'}} />\n  //         <RaisedButton label=\"Delete\" onClick={this.handleDeleteButton.bind(this)} />\n  //       </div>\n  //     );\n  //   } else {\n  //     return(\n  //         <RaisedButton id='saveCommunicationButton'  className='saveCommunicationButton' label=\"Save\" primary={true} onClick={this.handleSaveButton.bind(this)} />\n  //     );\n  //   }\n  // }\n\n  changeState(field, event, value){\n    let communicationUpdate;\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"communicationDetail.changeState\", field, event, value);\n\n    // by default, assume there's no other data and we're creating a new communication\n    if (Session.get('communicationUpsert')) {\n      communicationUpdate = Session.get('communicationUpsert');\n    } else {\n      communicationUpdate = defaultCommunication;\n    }\n\n\n\n    // if there's an existing communication, use them\n    if (Session.get('selectedCommunication')) {\n      communicationUpdate = this.data.communication;\n    }\n\n    switch (field) {\n      case \"subject\":\n        communicationUpdate.name[0].text = value;\n        break;\n      case \"recipient\":\n        communicationUpdate.gender = value.toLowerCase();\n        break;\n      case \"sent\":\n        communicationUpdate.birthDate = value;\n        break;\n      case \"definition\":\n        communicationUpdate.photo[0].url = value;\n        break;\n      case \"identifier\":\n        communicationUpdate.identifier[0].value = value;\n        break;\n      case \"category\":\n        communicationUpdate.identifier[0].value = value;\n        break;\n        case \"payload\":\n        communicationUpdate.identifier[0].value = value;\n        break;\n      default:\n\n    }\n    // communicationUpdate[field] = value;\n    process.env.TRACE && console.log(\"communicationUpdate\", communicationUpdate);\n\n    Session.set('communicationUpsert', communicationUpdate);\n  }\n\n\n  // this could be a mixin\n  handleSaveButton(){\n    if(process.env.NODE_ENV === \"test\") console.log('handleSaveButton()');\n    let communicationUpdate = Session.get('communicationUpsert', communicationUpdate);\n\n\n    if (communicationUpdate.birthDate) {\n      communicationUpdate.birthDate = new Date(communicationUpdate.birthDate);\n    }\n    if(process.env.NODE_ENV === \"test\") console.log(\"communicationUpdate\", communicationUpdate);\n\n    if (Session.get('selectedCommunication')) {\n      if(process.env.NODE_ENV === \"test\") console.log(\"Updating communication...\");\n\n      delete communicationUpdate._id;\n\n      // not sure why we're having to respecify this; fix for a bug elsewhere\n      communicationUpdate.resourceType = 'Communication';\n\n      Communications.update({_id: Session.get('selectedCommunication')}, {$set: communicationUpdate }, function(error, result){\n        if (error) {\n          if(process.env.NODE_ENV === \"test\") console.log(\"Communications.insert[error]\", error);\n          Bert.alert(error.reason, 'danger');\n        }\n        if (result) {\n          HipaaLogger.logEvent({eventType: \"update\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"Communications\", recordId: Session.get('selectedCommunication')});\n          Session.set('communicationUpdate', defaultCommunication);\n          Session.set('communicationUpsert', defaultCommunication);\n          Session.set('communicationPageTabIndex', 1);\n          Bert.alert('Communication added!', 'success');\n        }\n      });\n    } else {\n      if(process.env.NODE_ENV === \"test\") console.log(\"Creating a new communication...\", communicationUpdate);\n\n      Communications.insert(communicationUpdate, function(error, result) {\n        if (error) {\n          if(process.env.NODE_ENV === \"test\")  console.log('Communications.insert[error]', error);\n          Bert.alert(error.reason, 'danger');\n        }\n        if (result) {\n          HipaaLogger.logEvent({eventType: \"create\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"Communications\", recordId: result});\n          Session.set('communicationPageTabIndex', 1);\n          Session.set('selectedCommunication', false);\n          Session.set('communicationUpsert', false);\n          Bert.alert('Communication added!', 'success');\n        }\n      });\n    }\n  }\n\n  handleCancelButton(){\n    Session.set('communicationPageTabIndex', 1);\n  }\n\n  handleDeleteButton(){\n    Communications.remove({_id: Session.get('selectedCommunication')}, function(error, result){\n      if (error) {\n        if(process.env.NODE_ENV === \"test\") console.log('Communications.insert[error]', error);\n        Bert.alert(error.reason, 'danger');\n      }\n      if (result) {\n        HipaaLogger.logEvent({eventType: \"delete\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"Communications\", recordId: Session.get('selectedCommunication')});\n        Session.set('communicationUpdate', defaultCommunication);\n        Session.set('communicationUpsert', defaultCommunication);\n        Session.set('communicationPageTabIndex', 1);\n        Bert.alert('Communication removed!', 'success');\n      }\n    });\n  }\n}\n\n\nReactMixin(CommunicationDetail.prototype, ReactMeteorData);\n\n","import Avatar from 'material-ui/Avatar';\nimport FlatButton from 'material-ui/FlatButton';\nimport { HTTP } from 'meteor/http';\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\nimport { Table } from 'react-bootstrap';\n\nimport { get } from 'lodash';\n\n\nexport default class CommunicationTable extends React.Component {\n  getMeteorData() {\n    let data = {\n      style: {\n        hideOnPhone: {\n          visibility: 'visible',\n          display: 'table'\n        },\n        cellHideOnPhone: {\n          visibility: 'visible',\n          display: 'table',\n          paddingTop: '16px'\n        },\n        cell: {\n          paddingTop: '16px'\n        },\n        avatar: {\n          backgroundColor: 'rgb(188, 188, 188)',\n          userSelect: 'none',\n          borderRadius: '2px',\n          height: '40px',\n          width: '40px'\n        }\n      },\n      selected: [],\n      communications: []\n    };\n\n    let query = {};\n    let options = {};\n\n    // number of items in the table should be set globally\n    if (get(Meteor, 'settings.public.defaults.paginationLimit')) {\n      options.limit = get(Meteor, 'settings.public.defaults.paginationLimit');\n    }\n\n    // but can be over-ridden by props being more explicit\n    if(this.props.limit){\n      options.limit = this.props.limit;      \n    }\n\n    data.communications = Communications.find(query, options).map(function(communication){\n      let result = {\n        _id: communication._id,\n        subject: '',\n        recipient: '',\n        identifier: '',\n        definition: '',\n        sent: '',\n        received: '',\n        category: '',\n        payload: ''\n      };\n\n      result.sent = moment(get(communication, 'sent')).add(1, 'days').format(\"YYYY-MM-DD\")\n      result.received = moment(get(communication, 'received')).add(1, 'days').format(\"YYYY-MM-DD\")\n      result.subject = get(communication, 'subject.display') ? get(communication, 'subject.display') : get(communication, 'subject.reference')\n      result.recipient = get(communication, 'recipient[0].display') ? get(communication, 'recipient[0].display') : get(communication, 'recipient[0].reference')\n      result.identifier = get(communication, 'identifier[0].type.text');\n      result.definition = get(communication, 'definition[0].display');\n      result.category = get(communication, 'category[0].text');\n      result.payload = get(communication, 'payload[0].contentString');\n\n      return result;\n    });\n\n    if (Session.get('appWidth') < 768) {\n      data.style.hideOnPhone.visibility = 'hidden';\n      data.style.hideOnPhone.display = 'none';\n      data.style.cellHideOnPhone.visibility = 'hidden';\n      data.style.cellHideOnPhone.display = 'none';\n    } else {\n      data.style.hideOnPhone.visibility = 'visible';\n      data.style.hideOnPhone.display = 'table-cell';\n      data.style.cellHideOnPhone.visibility = 'visible';\n      data.style.cellHideOnPhone.display = 'table-cell';\n    }\n\n    return data;\n  }\n  rowClick(id){\n    Session.set('communicationsUpsert', false);\n    Session.set('selectedCommunication', id);\n    Session.set('communicationPageTabIndex', 2);\n  }\n   onSend(id){\n      let communication = Communications.findOne({_id: id});\n\n      console.log(\"CommunicationTable.onSend()\", communication);\n\n      var httpEndpoint = \"http://localhost:8080\";\n      if (get(Meteor, 'settings.public.interfaces.default.channel.endpoint')) {\n        httpEndpoint = get(Meteor, 'settings.public.interfaces.default.channel.endpoint');\n      }\n      HTTP.post(httpEndpoint + '/Communication', {\n        data: communication\n      }, function(error, result){\n        if (error) {\n          console.log(\"error\", error);\n        }\n        if (result) {\n          console.log(\"result\", result);\n        }\n      });\n    }\n  render () {\n    let tableRows = [];\n    for (var i = 0; i < this.data.communications.length; i++) {\n      tableRows.push(\n        <tr key={i} className=\"communicationRow\" style={{cursor: \"pointer\"}}>\n          <td className='subject' onClick={ this.rowClick.bind('this', this.data.communications[i]._id)} style={this.data.style.cell}>{this.data.communications[i].subject }</td>\n          <td className='recipient' onClick={ this.rowClick.bind('this', this.data.communications[i]._id)} style={this.data.style.cell}>{this.data.communications[i].recipient }</td>\n          <td className='identifier' onClick={ this.rowClick.bind('this', this.data.communications[i]._id)} style={this.data.style.cell}>{this.data.communications[i].identifier }</td>\n          <td className='definition' onClick={ this.rowClick.bind('this', this.data.communications[i]._id)} style={this.data.style.cell}>{this.data.communications[i].definition }</td>\n          <td className='sent' onClick={ this.rowClick.bind('this', this.data.communications[i]._id)} style={this.data.style.cell}>{this.data.communications[i].sent }</td>\n          <td className='received' onClick={ this.rowClick.bind('this', this.data.communications[i]._id)} style={this.data.style.cell}>{this.data.communications[i].received }</td>\n          <td className='category' onClick={ this.rowClick.bind('this', this.data.communications[i]._id)} style={this.data.style.cell}>{this.data.communications[i].category }</td>\n          <td className='payload' onClick={ this.rowClick.bind('this', this.data.communications[i]._id)} style={this.data.style.cell}>{this.data.communications[i].payload }</td>\n        </tr>\n      );\n    }\n\n\n    return(\n      <Table id='communicationsTable' hover >\n        <thead>\n          <tr>\n            <th className='subject'>subject</th>\n            <th className='recipient'>recipient</th>\n            <th className='identifier'>identifier</th>\n            <th className='definition'>definition</th>\n            <th className='sent' style={{minWidth: '100px'}}>sent</th>\n            <th className='received' style={{minWidth: '100px'}}>received</th>\n            <th className='category' style={this.data.style.hideOnPhone}>category</th>\n            <th className='payload' style={this.data.style.hideOnPhone}>payload</th>\n          </tr>\n        </thead>\n        <tbody>\n          { tableRows }\n        </tbody>\n      </Table>\n\n    );\n  }\n}\n\n\nReactMixin(CommunicationTable.prototype, ReactMeteorData);\n","import { CardText, CardTitle } from 'material-ui/Card';\nimport { Tab, Tabs } from 'material-ui/Tabs';\n\nimport { Glass, GlassCard, FullPageCanvas } from 'meteor/clinical:glass-ui';\n\nimport CommunicationDetail from './CommunicationDetail';\nimport CommunicationTable from './CommunicationTable';\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\n\nimport { Session } from 'meteor/session';\n\n\nlet defaultCommunication = {\n  index: 2,\n  id: '',\n  username: '',\n  email: '',\n  given: '',\n  family: '',\n  gender: ''\n};\nSession.setDefault('communicationFormData', defaultCommunication);\nSession.setDefault('communicationSearchFilter', '');\n\nexport class CommunicationsPage extends React.Component {\n  getMeteorData() {\n    let data = {\n      style: {\n        opacity: Session.get('globalOpacity'),\n        tab: {\n          borderBottom: '1px solid lightgray',\n          borderRight: 'none'\n        }\n      },\n      tabIndex: Session.get('communicationPageTabIndex'),\n      communication: defaultCommunication,\n      communicationSearchFilter: '',\n      currentCommunication: null\n    };\n\n    if (Session.get('communicationFormData')) {\n      data.communication = Session.get('communicationFormData');\n    }\n    if (Session.get('communicationSearchFilter')) {\n      data.communicationSearchFilter = Session.get('communicationSearchFilter');\n    }\n    if (Session.get(\"selectedCommunication\")) {\n      data.currentCommunication = Session.get(\"selectedCommunication\");\n    }\n\n    data.style = Glass.blur(data.style);\n    data.style.appbar = Glass.darkroom(data.style.appbar);\n    data.style.tab = Glass.darkroom(data.style.tab);\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"CommunicationsPage[data]\", data);\n    return data;\n  }\n\n  handleTabChange(index){\n    Session.set('communicationPageTabIndex', index);\n  }\n\n  onNewTab(){\n    Session.set('selectedCommunication', false);\n    Session.set('communicationUpsert', false);\n  }\n\n  render() {\n    return (\n      <div id=\"communicationsPage\">\n        <FullPageCanvas>\n          <GlassCard height=\"auto\">\n            <CardTitle\n              title=\"Communications\"\n            />\n            <CardText>\n              <Tabs id='communicationsPageTabs' default value={this.data.tabIndex} onChange={this.handleTabChange} initialSelectedIndex={1}>\n                 <Tab className=\"newCommunicationTab\" label='New' style={this.data.style.tab} onActive={ this.onNewTab } value={0}>\n                   <CommunicationDetail id='newCommunication' />\n                 </Tab>\n                 <Tab className=\"communicationListTab\" label='Communications' onActive={this.handleActive} style={this.data.style.tab} value={1}>\n                   <CommunicationTable showBarcodes={true} />\n                 </Tab>\n                 <Tab className=\"communicationDetailTab\" label='Detail' onActive={this.handleActive} style={this.data.style.tab} value={2}>\n                   {/* <CommunicationDetail id='communicationDetails' currentCommunication={this.data.currentCommunication} /> */}\n                 </Tab>\n             </Tabs>\n\n\n            </CardText>\n          </GlassCard>\n        </FullPageCanvas>\n      </div>\n    );\n  }\n}\n\n\n\nReactMixin(CommunicationsPage.prototype, ReactMeteorData);\n\nexport default CommunicationsPage;"]}