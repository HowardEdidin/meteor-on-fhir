{"version":3,"sources":["meteor://ðŸ’»app/packages/symptomatic:smart-on-fhir-client/client/OAuth.js","meteor://ðŸ’»app/packages/symptomatic:smart-on-fhir-client/client/AdminConfigPage.jsx","meteor://ðŸ’»app/packages/symptomatic:smart-on-fhir-client/client/FastImportPage.jsx","meteor://ðŸ’»app/packages/symptomatic:smart-on-fhir-client/client/ImportChart.jsx","meteor://ðŸ’»app/packages/symptomatic:smart-on-fhir-client/client/OAuthClientPage.jsx","meteor://ðŸ’»app/packages/symptomatic:smart-on-fhir-client/lib/methods.js","meteor://ðŸ’»app/packages/symptomatic:smart-on-fhir-client/index.jsx"],"names":["get","module","link","v","OAuth","Session","setDefault","exportDefault","requestCredential","options","credentialRequestCompleteCallback","serviceName","console","log","Meteor","OAuth2","config","ServiceConfiguration","configurations","findOne","service","ConfigError","baseUrl","loginUrl","credentialToken","Random","secret","requiredScope","scope","_","union","loginStyle","_loginStyle","clientId","_redirectUri","_stateParam","loginOptions","loginService","popupOptions","height","width","launchLogin","export","AdminConfigPage","React","ReactMeteorData","ReactMixin","VerticalCanvas","GlassCard","DynamicSpacer","CardHeader","CardText","CardTitle","CardActions","TextField","Toggle","Paper","FlatButton","RaisedButton","Grid","Row","Col","Table","ReactiveVar","Promise","HTTP","PatientDetail","PatientTable","PatientCard","ObservationsTable","getUserIdResult","getUserData","getPatientData","formatSuffix","defaultOAuthState","conformance","fhirVersion","formData","secretKey","targetBaseUrl","targetLoginUrl","tokenUrl","autoscan","metadata","authorizeUrl","patientSearch","text","given","family","gender","birthdate","identifier","accessToken","patientData","patient","observations","patients","props","state","componentDidMount","setState","getMeteorData","data","style","services","find","fetch","length","userAccessToken","getUserAccessToken","userIdResult","userOAuth2Id","user","userData","EJSON","stringify","indent","render","absoluteUrl","path","oAuthPath","tableRows","signInWiths","i","push","cursor","minWidth","paddingTop","cell","removeEntry","bind","_id","j","signInWith","updateBaseUrl","overflowY","extractAutoconfigValues","editServiceName","textAlign","editclientId","editSecretKey","editTargetBaseUrl","editTargetLoginUrl","editloginStyle","saveConfiguration","resyncConfiguration","field","event","value","newFormData","fipopupeld","updateSearch","newState","changeState","self","metadataRoute","call","error","result","JSON","parse","content","parsedContent","capabilityStatement","resourceType","clearAutoscan","oauthExtension","forEach","object","url","valueUri","serviceConfig","Accounts","oauth","credentialRequestCompleteHandler","set","requestPermissions","serviceNames","credentialResult","check","String","confirm","Component","OAuth2Server","prototype","FastImportPage","TableBody","TableRow","TableRowColumn","browserHistory","patientId","minimongo","AllergyIntolerances","CarePlans","Conditions","Devices","DiagnosticReports","Goals","ImagingStudies","Immunizations","Locations","Medications","MedicationStatements","Observations","Patients","Persons","Practitioners","Procedures","RelatedPersons","Sequences","resourceTypes","Mongo","Collection","count","process","env","TRACE","marginLeft","systemSyncButtons","dataManagementButtons","runDiagnostics","simulateLaunchContext","marginBottom","fetchIdentity","searchChart","ccdResources","MedicationOrders","continuityOfCareCard","fontWeight","overflow","timelineVisualization","selectPatientCallback","loginSignature","fetchAccessToken","savePatientDemographicsToProfile","record","callback","launch","isUndefined","resetServiceConfiguration","err","fetchPatientData","fetchUrl","headers","userId","humanName","users","update","$set","newPatient","newName","name","Patiens","id","insert","addresses","address","use","clearLocalCache","_collection","remove","info","cacheObservations","observation","isOAuth2User","ImportChart","marginTop","color","patientSearchUrl","searchPatients","post","responseBundle","entry","newPatientSearchResults","resource","searchObservations","observationUrl","bundle","observationData","allergiesUrl","pointer","fullUrl","redirectResult","carePlansUrl","conditionUrl","deviceUrl","diagnosticResourceUrl","total","goalUrl","immunizationUrl","medicationUrl","medicationOrderUrl","procedureUrl","OAuthClientPage","paddingLeft","launchContext","methods","placeBundleIntoCollections","Object","fetchPatientFromEpic","DEBUG","fetchObservationsFromEpic","syncResourceFromEpic","connection","_mongo_livedata_collections","VERBOSE","includes","unregisterService","isServer","registerService","addAutopublishFields","forLoggedInUser","forOtherUsers","query","response","getTokenResponse","identity","getIdentity","serviceData","expiresAt","Date","expiresIn","serviceResult","profile","configureOauthService","autoscannedUrl","responseContent","oauthTokenUrl","httpResult","getTokenResponseResults","params","grant_type","code","client_id","redirect_uri","access_token","DynamicRoutes","SidebarElements","AdminSidebarElements"],"mappings":"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","file":"/packages/symptomatic_smart-on-fhir-client.js","sourcesContent":["import { get } from 'lodash';\nimport { OAuth } from 'meteor/clinical:oauth';\nimport { Session } from 'meteor/session';\n\nSession.setDefault('ehrLaunchContext', '');\nexport default OAuth.requestCredential = function (options, credentialRequestCompleteCallback, serviceName) {\n  console.log(\"********************************************\")\n  console.log('Yes, smart-on-fhir-client/client/OAuth.js is being run...')\n\n  if(get(Meteor, 'settings.public.logging') === \"debug\"){\n    console.log('OAuth.requestCredential ', options);\n  }  \n  if (!credentialRequestCompleteCallback && typeof options === 'function') {\n    credentialRequestCompleteCallback = options;\n    options = {};\n  }\n\n  if(get(Meteor, 'settings.public.logging') === \"debug\"){\n    console.log('OAuth.requestCredential().OAuth2', OAuth2);\n  }  \n\n  if(!serviceName){\n    serviceName = OAuth2.serviceName\n  }\n\n  if(get(Meteor, 'settings.public.logging') === \"debug\"){\n    console.log('OAuth.requestCredential().serviceName', serviceName);\n  }  \n\n  var config = ServiceConfiguration.configurations.findOne({\n    service: serviceName\n  });\n  if(get(Meteor, 'settings.public.logging') === \"debug\"){\n    console.log('Fetched the service configuration...', config);\n  }  \n\n  if (!config) {\n    credentialRequestCompleteCallback\n      && credentialRequestCompleteCallback(\n        ServiceConfiguration.ConfigError('Service not configured')\n      );\n  } else {\n    if (!config.baseUrl) {\n        credentialRequestCompleteCallback\n          && credentialRequestCompleteCallback(\n            ServiceConfiguration.ConfigError(\n              'Service found but it does not have a baseUrl configured.')\n          );\n      }\n    \n      if (!config.loginUrl) {\n        credentialRequestCompleteCallback\n          && credentialRequestCompleteCallback(\n            ServiceConfiguration.ConfigError(\n              'Service found but it does not have a loginUrl configured.')\n          );\n      }\n    \n      if(get(Meteor, 'settings.public.logging') === \"debug\"){\n        console.log(serviceName + ' found and is configured.  Creating credentialToken and scopes.');\n      }  \n      var credentialToken = Random.secret();\n      //var credentialToken = '2e80e475-5930-48f3-968e-de4429f09572';\n    \n      // always need this to get user id from service.\n      // TODO: if(serviceName === \"Epic\")\n      var requiredScope = [\n        'email', \n        'OBSERVATION.READ', \n        'OBSERVATION.SEARCH', \n        'PATIENT.READ', \n        'PATIENT.SEARCH', \n        'PRACTITIONER.READ', \n        'PRACTITIONER.SEARCH',\n        'patient/*.read',\n        'patient/*.search',\n        'openid'\n      ];\n      var scope = [\n        'OBSERVATION.READ', \n        'OBSERVATION.SEARCH', \n        'PATIENT.READ', \n        'PATIENT.SEARCH', \n        'PRACTITIONER.READ', \n        'PRACTITIONER.SEARCH',\n        'patient/*.read',\n        'patient/*.search',\n        'openid',\n        'email',\n        'profile',\n        'user/*.*',\n        'launch',\n        'online_access'\n      ];\n      if (options.scope) {\n        scope = options.scope;\n      }\n      \n      scope = _.union(scope, requiredScope);\n    \n      if(get(Meteor, 'settings.public.logging') === \"debug\"){\n        console.log('scope', scope);\n      }  \n\n      var loginStyle = OAuth._loginStyle(serviceName, config, options);\n    \n      var loginUrl = config.loginUrl +\n        '?response_type=code' +\n        '&client_id=' + config.clientId +\n        '&redirect_uri=' + OAuth._redirectUri(serviceName, config) +\n        '&state=' + OAuth._stateParam(loginStyle, credentialToken);\n\n      if(get(Meteor, 'settings.public.logging') === \"debug\"){\n        console.log('Creating specific loginUrls for popular EHRs...', serviceName);\n      }  \n\n        \n      if(serviceName === \"iHealthLocal\"){\n        loginUrl = loginUrl + '&APIName=OpenApiBP';\n      }\n        \n      // apparently some OAuth servers want a client to present scope and state at login\n      // could be Google, Facebook, Twitter, etc.  \n      // this code was present in the original oauth library\n      // however, as we implement Epic specific connectivity, we don't need it\n      // but we probablly want to keep this around for non-epic systems\n      // so parking it for now \n\n      if(serviceName === \"Omnibus\"){\n        console.log('Detected the Omnibus service...')\n        loginUrl = loginUrl + '&aud=patient%2FPatient%2*'  // ocp-fis; user/*; patient/Patient\n                            + '&launch=' + Session.get('ehrLaunchContext')\n                            + '&scope=user%2FPatient.read%20'\n                                   + 'user%2FEncounter.read%20'\n                                   + 'user%2FPerson.read%20'\n                                   + 'patient%2FPractitioner.read%20'\n                                   + 'launch%2Fpatient%20'\n                                   + 'online_access%20'\n                                   + 'openid%20'\n                                   + 'profile%20'\n                                   + 'user%2FPatient.read%20'\n                                   + 'patient%2FDocumentReference.read%20'\n                                   + 'user%2FObservation.write%20'\n                                   + 'lauch%2Forganization%20'\n                                   + 'user%2FObservation.read%20'\n                                   + 'patient%2FPatient.read%20'\n                                   + 'user%2FDocumentReference%20'\n                                   + 'patient%2FPerson%20'\n                                   + 'patient%2FObservation.read%20'\n                                   + 'patient%2FEncounter.read%20'\n                                   + 'patient%2FDocumentReference.write%20'\n                                   + 'user%2FDocumentReference.read%20'\n                                   + 'patient%2FObservation.write%20'\n\n      }\n      if(serviceName === \"CernerPatient\"){\n        console.log('Detected the CernerPatient service...')\n        loginUrl = loginUrl + '&aud=' + config.baseUrl \n                            + '&scope=user%2FPatient.read%20'\n                              + 'user%2FAllergyIntolerance.read%20'\n                              + 'user%2FCarePlan.read%20'\n                              + 'user%2FCondition.read%20'\n                              + 'user%2FDevice.read%20'\n                              + 'user%2FGoal.read%20'\n                              + 'user%2FImmunization.read%20'\n                              + 'user%2FMedication.read%20'\n                              + 'user%2FMedicationStatement.read%20'\n                              + 'user%2FPatient.read%20'\n                              + 'user%2FPractitioner.read%20'\n                              + 'user%2FProcedure.read%20'\n                              + 'user%2FOrganization.read%20'\n                              + 'user%2FObservation.read'\n      }\n\n      if(serviceName === \"CernerProvider\"){\n        console.log('Detected the CernerProvider service...')\n        loginUrl = loginUrl + '&aud=' + config.baseUrl \n                            + '&launch=' + Session.get('ehrLaunchContext')\n                            + '&scope=user%2FPatient.read%20'\n                              + 'user%2FAllergyIntolerance.read%20'\n                              + 'user%2FCarePlan.read%20'\n                              + 'user%2FCondition.read%20'\n                              + 'user%2FDevice.read%20'\n                              + 'user%2FGoal.read%20'\n                              + 'user%2FImmunization.read%20'\n                              + 'user%2FMedication.read%20'\n                              + 'user%2FMedicationStatement.read%20'\n                              + 'user%2FPatient.read%20'\n                              + 'user%2FPractitioner.read%20'\n                              + 'user%2FProcedure.read%20'\n                              + 'user%2FOrganization.read%20'\n                              + 'user%2FObservation.read'\n      }\n\n      if(serviceName === \"Allscripts\"){\n        console.log('Detected the AllScripts service...')\n        loginUrl = loginUrl + '&scope=launch%20openid%20profile%20patient%2F*.read%20'\n                            + '&acr_values=FhirApiID:6dc1c200-b14f-407f-9d98-4ea8c3f5627f'\n      }\n\n      if(serviceName === \"Touchworks\"){\n        console.log('Detected the AllScripts Touchworks service...')\n        loginUrl = loginUrl + '&scope=launch%20openid%20profile%20patient%2F*.read%20'\n                            + '&acr_values=FhirApiID:e9a5eab3-b766-4b86-a0d2-8634311fce2c'\n      }\n\n\n      if(get(Meteor, 'settings.public.logging') === \"debug\"){\n        console.log('OAuth.requestCredential().loginUrl', loginUrl);\n      }  \n    \n      var loginOptions = {\n        loginService: serviceName,\n        loginStyle: loginStyle,\n        loginUrl: loginUrl,\n        credentialRequestCompleteCallback: credentialRequestCompleteCallback,\n        credentialToken: credentialToken,\n        popupOptions: {\n          height: 600,\n          width: 480\n        }\n      }\n    \n      if(get(Meteor, 'settings.public.logging') === \"debug\"){\n        console.log('OAuth.requestCredential().loginOptions', loginOptions);\n      }  \n      \n      OAuth.launchLogin(loginOptions);\n  }\n};\n","// Here's the OAuth/protected FHIR server: https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut, \n// Its Conformance statement is here: https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut/metadata \n// And its authorize endpoint: https://open-ic.epic.com/FHIR/oauth2/authorize\n// ARGONAUT/ARGONAUT\n// https://guide.meteor.com/accounts.html#oauth-calling-api  \n\n\n//====================================\n// Client Config\n//\n// Epic\n// 2098c6e8-57c3-6b87-a5f2-8712d49365f9\n// https://open-ic.epic.com/argonaut/api/FHIR/Argonaut/\n// https://open-ic.epic.com/FHIR/oauth2/authorize\n\n\n// Not sure how functional the following sandbox is\n// https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut/\n\n// username:  fhirjson\n// password:  epicepic1\n\n// http://motorcycleguy.blogspot.com/2015/09/my-fhir-json-xml-converter-in.html\n// https://github.com/kwboone/FHIR-JSON-to-XML-Converter/blob/master/FHIR%20JSON%20to%20XML%20Converter/src/FHIRConverterBody.js\n\n\n\n\n\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\n\nimport { VerticalCanvas, GlassCard, DynamicSpacer } from 'meteor/clinical:glass-ui';\nimport { CardHeader, CardText, CardTitle, CardActions, TextField, Toggle, Paper, FlatButton, RaisedButton } from 'material-ui';\nimport { Grid, Row, Col, Table } from 'react-bootstrap';\nimport { ReactiveVar } from 'meteor/reactive-var';\n\nimport { Promise } from 'meteor/promise';\nimport { Meteor } from 'meteor/meteor';\nimport { Session } from 'meteor/session';\nimport { HTTP } from 'meteor/http';\n\nimport { PatientDetail, PatientTable, PatientCard } from 'meteor/clinical:hl7-resource-patient';\nimport { ObservationsTable } from 'meteor/clinical:hl7-resource-observation';\n\nimport { get } from 'lodash';\n\n\n\n\nvar getUserIdResult = new ReactiveVar(null);\nvar getUserData = new ReactiveVar(null);\nvar getPatientData = new ReactiveVar(null);\nlet formatSuffix = '?_format=application/json';\n\nSession.setDefault('patientSearchResults', [])\nSession.setDefault('oauthService', '')\n\nconst defaultOAuthState = {\n    conformance: {},\n    fhirVersion: '',\n    formData: {\n      serviceName: '',\n      clientId: '',\n      secretKey: '',\n      targetBaseUrl: '',\n      targetLoginUrl: '',\n      tokenUrl: '',\n      loginStyle: 'popup'\n    },\n    autoscan: '',\n    metadata: '',\n    baseUrl: 'https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut',\n    authorizeUrl: '',\n    tokenUrl: '',\n    patientSearch: {\n        text: '',\n        given: '', \n        family: '',\n        gender: '',\n        birthdate: '',\n        identifier: ''\n    },\n    accessToken: '',\n    patientData: '',\n    patient: {},\n    observations: [],\n    patients: []\n};\n\nexport class AdminConfigPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = defaultOAuthState;\n  }\n  componentDidMount() {\n      this.setState(defaultOAuthState);\n  }\n  getMeteorData() {\n\n    let data = {\n      style: {},\n      state: defaultOAuthState,\n      services: [],\n      patients: []\n    };\n\n    if(ServiceConfiguration){\n        data.services = ServiceConfiguration.configurations.find().fetch()\n    }   \n\n    if(Session.get('patientSearchResults').length > 0){\n        data.patients = Session.get('patientSearchResults');\n\n    }\n\n\n\n    // data.state.formData.clientId: get(Meteor, 'settings.private.oAuth.epic.clientId');\n    // data.state.formData.secretKey: get(Meteor, 'settings.private.oAuth.epic.secretKey');\n    // data.state.formData.clientId: get(Meteor, 'settings.private.oAuth.google.clientId');\n    // data.state.formData.secretKey: get(Meteor, 'settings.private.oAuth.google.secretKey');\n\n    data.state.userAccessToken = getUserAccessToken();\n    data.state.userIdResult = getUserIdResult.get();\n    data.state.userOAuth2Id = get(Meteor.user(), 'services.OAuth2Server.id');\n    data.state.userData = EJSON.stringify(getUserData.get(), {indent: 2});\n    data.state.patientData = EJSON.stringify(getPatientData.get(), {indent: 2});\n\n    return data;\n  }\n  render(){\n    let baseUrl = Meteor.absoluteUrl();\n    let path = \"_oauth/\" + this.state.formData.serviceName;\n    let oAuthPath = baseUrl + path;\n    let serviceName = this.state.formData.serviceName;\n    let accessToken = this.state.accessToken;\n    let tableRows = [];\n    let signInWiths = [];\n\n    for (var i = 0; i < this.data.services.length; i++) {\n        tableRows.push(\n            <tr key={i} className=\"servicesRow\" style={{cursor: \"pointer\"}}>\n\n              <td className='service' style={{minWidth: '100px', paddingTop: '16px'}}>{this.data.services[i].service }</td>\n              <td className='clientId' style={this.data.style.cell}>{this.data.services[i].clientId }</td>\n              <td className='secret' style={this.data.style.cell}>{this.data.services[i].secret}</td>\n              <td className='baseUrl' style={this.data.style.cell}>{this.data.services[i].baseUrl}<br/>{this.data.services[i].loginUrl}</td>\n              {/* <td className='pluginStyle' style={this.data.style.cell}>{this.data.services[i].pluginStyle}</td> */}\n              <td className='removeBtn' style={this.data.style.cell}><FlatButton \n                label=\"Remove\" \n                onClick={ this.removeEntry.bind(this, this.data.services[i]._id) }\n                />\n              </td>\n            </tr>\n            );\n    }\n    for (var j = 0; j < this.data.services.length; j++) {\n        signInWiths.push(\n            <div key={j}>\n              <RaisedButton \n                label={ 'Sign in with ' + this.data.services[j].service } \n                id={ this.data.services[j].service + \"Button\" }\n                primary={true}\n                onClick={ this.signInWith.bind(this, this.data.services[j].service) }\n                fullWidth\n                />    \n                <br />\n                <br />\n            </div>\n        );\n    }    \n\n    return(\n        \n      <div id=\"AdminConfigPage\">\n        <VerticalCanvas >\n\n\n            <GlassCard width='768px' zDepth={2} >\n                <CardTitle\n                    title='0.  Autoscan FHIR Server'\n                    subtitle='The following button will scan a FHIR Server and autodetect and configure the OAuth connection, based on the FHIR conformance statement located at <code>/metadata</code>' />\n                <CardText>\n                    <Grid>\n                        <Row>\n                            <Col md={6}>\n                                <TextField\n                                    type=\"text\"\n                                    ref=\"url\"\n                                    name=\"url\"\n                                    floatingLabelText=\"Base Url\"\n                                    hintText=\"https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut/\"\n                                    defaultValue={ this.state.baseUrl }\n                                    onChange={ this.updateBaseUrl.bind(this) }\n                                    fullWidth\n                                />      \n                           </Col>\n                        </Row>\n                        <Row>\n                            <Col md={12}>\n                                <pre style={{ overflowY: 'scroll', height: '250px' }}>\n                                    { this.state.metadata }\n                                </pre>\n                            </Col>\n                        </Row>\n                    </Grid>                    \n                </CardText>\n                <CardActions>\n                    <FlatButton \n                        label=\"Autoscan\" \n                        id=\"autoscanButton\" \n                        onClick={ this.autoscan.bind(this) }\n                        primary={false} />\n                </CardActions>\n            </GlassCard>\n            <DynamicSpacer />\n\n\n\n            <GlassCard width='768px' zDepth={2} >\n                <CardTitle\n                    title='1.  Autoconfig Values'\n                    subtitle='' />\n                <CardText>\n                    <Grid>\n                        <Row>\n                            <Col md={5}>\n                                <TextField\n                                    type=\"tokenUrl\"\n                                    ref=\"tokenUrl\"\n                                    name=\"tokenUrl\"\n                                    floatingLabelText=\"Token\"\n                                    hintText=\"https://open-ic.epic.com/Argonaut/oauth2/token\"\n                                    floatingLabelFixed={true}\n                                    value={ this.state.tokenUrl }\n                                    fullWidth\n                                />      \n                           </Col>\n                            <Col md={5}>\n                                <TextField\n                                    type=\"authorizeUrl\"\n                                    ref=\"authorizeUrl\"\n                                    name=\"authorizeUrl\"\n                                    floatingLabelText=\"Authorize\"\n                                    hintText=\"https://open-ic.epic.com/Argonaut/oauth2/authorize\"\n                                    floatingLabelFixed={true}\n                                    value={ this.state.authorizeUrl }\n                                    fullWidth\n                                />      \n                            </Col>\n                            <Col md={2}>\n                                <TextField\n                                    type=\"fhirVersion\"\n                                    ref=\"fhirVersion\"\n                                    name=\"fhirVersion\"\n                                    floatingLabelText=\"FhirVersion\"\n                                    hintText=\"1.0.2\"\n                                    floatingLabelFixed={true}\n                                    value={ this.state.fhirVersion }\n                                    fullWidth\n                                />      \n                            </Col>\n                        </Row>\n                    </Grid>\n                               \n                </CardText>\n                <CardActions>\n                    <FlatButton \n                        label=\"Autoconfig Values\" \n                        id=\"autoscanButton\" \n                        onClick={ this.extractAutoconfigValues.bind(this) }\n                        primary={false} />\n                    \n                </CardActions>\n            </GlassCard>\n            <DynamicSpacer />            \n\n\n\n           <GlassCard width='768px' zDepth={2} >\n                <CardTitle\n                    title='2.  Name this Service'\n                    subtitle='Who are you signing a Business Associate Agreement with?  Who operates this OAuth server?'\n                />\n                <CardText>\n                    <Grid>\n                        <Row>\n                            <Col md={6}>\n                                <TextField\n                                    type=\"service\"\n                                    ref=\"service\"\n                                    name=\"service\"\n                                    floatingLabelText=\"Service Name\"\n                                    hintText=\"epic, facebook, google, twitter, OAuth2Server, FhirVault, SmartOnFhir, etc\"\n                                    floatingLabelFixed={true}\n                                    onChange={ this.editServiceName.bind(this, 'serviceName')}\n                                    defaultValue='SmartOnFhir'\n                                    fullWidth\n                                />      \n                           </Col>\n                        </Row>\n                    </Grid>\n                </CardText>\n            </GlassCard>\n            <DynamicSpacer />\n\n\n          <GlassCard width='768px' zDepth={2}>\n\n            <CardTitle\n                title='3. Register This App With Resource Provider' />\n            <CardText>\n                <p>\n                    If you operate the AuthenticationServer, you can add a client by directly editing it's database.  In a production environment, this entry would be generated by an admin console or a client API KeyRequestPage. \n                </p>\n                <p>\n                If you do not operate the resource owner, then you must contact the service in some way to get the keys.  This step may require business agreements, online registration, agreement to terms and services, license or subscription fees, service level agreements, background checks, insurance policies, security audits, and other technical due diligence.  \n                </p>\n                <p>\n                   When ready, the AuthenticationServer will need the following Redirect URI.  This URI is environment specific.  If you deploy to staging, testing, production, etc. you will need to update this URI on the Authorization Server, or you will need to create a second app.   \n                </p>\n\n                <h3 style={{width: '100%', textAlign: 'center'}}>{oAuthPath}</h3>\n            </CardText>\n          </GlassCard>\n        <DynamicSpacer />\n\n\n          <GlassCard width='768px' zDepth={2} >\n            <CardTitle\n                title='4.  Configure This Application' \n                subtitle={<a href=\"https://github.com/meteor/meteor/wiki/OAuth-for-mobile-Meteor-clients#loginStyle-vepopuprsus-redirect-flow\">OAuth for mobile Meteor clients</a>}\n                />\n            <CardText>\n                    <Row>\n                        <Col md={6}>\n                            <TextField\n                                type=\"text\"\n                                ref=\"serviceName\"\n                                name=\"akyKey\"\n                                floatingLabelText=\"Service Name\"\n                                floatingLabelFixed={true}\n                                hintText=\"facebook, github, epic, etc.\"\n                                onChange={ this.editServiceName.bind(this, 'serviceName')}\n                                value={ this.state.formData.serviceName }\n                                fullWidth\n                            />       \n                            <TextField\n                                type=\"text\"\n                                ref=\"clientId\"\n                                name=\"akyKey\"\n                                floatingLabelText=\"API Key (ClientID)\"\n                                floatingLabelFixed={true}\n                                hintText=\"2dd874fc-94a4-45f3-9acb-b3d865f82b54\"\n                                onChange={ this.editclientId.bind(this, 'clientId')}\n                                fullWidth\n                            />       \n\n                            <TextField\n                                type=\"text\"\n                                ref=\"secretKey\"\n                                name=\"secretKey\"\n                                floatingLabelText=\"Secret Key\"\n                                floatingLabelFixed={true}\n                                hintText={ this.state.formData.secretKey }\n                                defaultValue={ this.state.formData.secretKey }\n                                onChange={ this.editSecretKey.bind(this, 'secretKey') }\n                                fullWidth\n                            />       \n                        </Col>\n                        <Col md={6}>\n                            <TextField\n                                type=\"text\"\n                                ref=\"targetBaseUrl\"\n                                name=\"targetBaseUrl\"\n                                floatingLabelText=\"Target Base URL\"\n                                floatingLabelFixed={true}\n                                hintText=\"http://localhost:3100\"\n                                onChange={ this.editTargetBaseUrl.bind(this, 'targetBaseUrl') }\n                                value={ this.state.formData.targetBaseUrl }\n                                fullWidth\n                            />       \n                            <TextField\n                                type=\"text\"\n                                ref=\"targetLoginUrl\"\n                                name=\"targetLoginUrl\"\n                                floatingLabelText=\"Target Login URL\"\n                                floatingLabelFixed={true}\n                                hintText=\"http://localhost:3100/oauth\"\n                                onChange={ this.editTargetLoginUrl.bind(this, 'targetLoginUrl') }\n                                value={ this.state.formData.targetLoginUrl }\n                                fullWidth\n                            />       \n                            <br />\n                            <br />\n                            <Toggle\n                                label=\"loginStyle\"\n                                ref=\"loginStyle\"\n                                name=\"loginStyle\"\n                                labelPosition=\"right\"\n                                defaultToggled={true}\n                                onChange={ this.editloginStyle.bind(this, 'loginStyle')}\n                                style={{float: 'right'}}\n                            />\n                        </Col>\n                    </Row>\n                </CardText>\n                <CardActions>\n                    <FlatButton \n                            label=\"Save Configuration\" \n                            id=\"saveConfigurationButton\" \n                            onClick={ this.saveConfiguration.bind(this) }\n                            primary={false} />\n                </CardActions>\n            </GlassCard>\n            <DynamicSpacer />\n\n\n\n            <GlassCard width='768px' zDepth={2} >\n                <CardTitle\n                    title='5.  Authorization Services'\n\n                />\n                <CardText>\n                    <Table>\n                        <thead>\n                            <tr>\n                                <th className='service' style={{minWidth: '100px'}}>service</th>\n                                <th className='clientId' style={{minWidth: '100px'}}>clientId</th>\n                                <th className='secret' style={{minWidth: '100px'}}>secret</th>\n                                <th className='baseUrl' style={{minWidth: '100px'}}>baseUrl</th>\n                                {/* <th className='style' style={{minWidth: '100px'}}>style</th> */}\n                                <th className='remove' style={{minWidth: '100px'}}>remove</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            { tableRows }\n                        </tbody>\n                    </Table>\n                </CardText>\n                <CardActions>\n                    <FlatButton \n                        label=\"Resync Configuration\" \n                        id=\"resyncConfiguration\" \n                        primary={false} \n                        onClick={ this.resyncConfiguration.bind(this) }\n                        style={{float: 'right'}}\n                        />\n\n                </CardActions>            \n              </GlassCard>\n            <DynamicSpacer />\n\n          <DynamicSpacer />\n        </VerticalCanvas>\n      </div>\n    );\n  }\n  \n  editServiceName(field, event, value){\n    //console.log('editclientId', value)\n    var newFormData = this.state.formData;\n    newFormData.serviceName = value;\n\n    this.setState({\n        'formData': newFormData\n    });\n  }\n  editclientId(field, event, value){\n    //console.log('editclientId', value)\n    var newFormData = this.state.formData;\n    newFormData.clientId = value;\n\n    this.setState({\n        'formData': newFormData\n    });\n  }\n  editSecretKey(field, event, value){\n    //console.log('editSecretKey', value)\n\n    var newFormData = this.state.formData;\n    newFormData.secretKey = value;\n    \n    this.setState({\n        'formData': newFormData\n    });\n  }\n  editTargetBaseUrl(field, event, value){\n    //console.log('editTargetBaseUrl', value)\n\n    var newFormData = this.state.formData;\n    newFormData.targetBaseUrl = value;\n    \n    this.setState({\n        'formData': newFormData\n    });\n  }\n  editTargetLoginUrl(field, event, value){\n    //console.log('editTargetLoginUrl', value)\n\n    var newFormData = this.state.formData;\n    newFormData.targetLoginUrl = value;\n    \n    this.setState({\n        'formData': newFormData\n    });\n  }\n  editloginStyle(fipopupeld, event, value){\n    //console.log('editloginStyle - ÃŸ', value)\n    \n    var newFormData = this.state.formData;\n    newFormData.loginStyle = value;\n    \n    this.setState({\n        'formData': newFormData\n    });\n  }\n  updateSearch(field, event, value){\n    const newState = this.state;\n\n    if(field == \"name\"){\n        newState.patientSearch.text = value;\n    }\n    if(field == \"given\"){\n        newState.patientSearch.given = value;\n    }\n    if(field == \"family\"){\n        newState.patientSearch.family = value;\n    }\n    if(field == \"gender\"){\n        newState.patientSearch.gender = value;\n    }\n    if(field == \"birthdate\"){\n        newState.patientSearch.birthdate = value;\n    }\n    if(field == \"identifier\"){\n        newState.patientSearch.identifier = value;\n    }\n    this.setState(newState);\n  }\n  changeState(field, event, value){\n    const formData = this.state.formData;\n    formData[field] = value;\n    this.setState({\n        formData: formData\n    });\n  }\n  updateBaseUrl(event, value){\n    console.log('updateBaseUrl', event, value)\n\n    var newState = this.state;\n    newState.baseUrl = value;\n\n    this.setState(newState);\n  }\n  \n\n//   autoscan(){\n//       console.log('autoscan')\n//       var self = this;\n\n//       var metadataRoute = this.state.baseUrl + '/metadata' + formatSuffix;\n//       console.log('metadata route', metadataRoute)\n\n//       HTTP.get(metadataRoute, function(error, result){\n//           if(error){\n//               console.log('error', error)\n//           }\n//           if(result){\n//               console.log(result.content);\n//               var conformanceStatement = JSON.parse(result.content);\n//               console.log('conformanceStatement', conformanceStatement)\n//               self.setState({\n//                   metadata: EJSON.stringify(conformanceStatement, {indent: 2}),\n//                   conformance: conformanceStatement\n//               })\n//         }\n//       })\n//   }\n  autoscan(){\n    console.log('autoscan')\n    var self = this;\n\n    var metadataRoute = this.state.baseUrl + '/metadata' + formatSuffix;\n    console.log('metadata route', metadataRoute)\n\n    //   HTTP.get(metadataRoute, { headers: {\n    //     'Accept': ['application/json', 'application/json+fhir']\n    //     }}, function(error, result){\n    //       if(error){\n    //           console.log('error', error)\n    //       }\n    //       if(result){\n    //           console.log(result.content);\n    //           var conformanceStatement = JSON.parse(result.content);\n    //           console.log('conformanceStatement', conformanceStatement)\n    //           self.setState({\n    //               metadata: EJSON.stringify(conformanceStatement, {indent: 2}),\n    //               conformance: conformanceStatement\n    //           })\n    //     }\n    //   })\n\n    Meteor.call('metadataAutoscan', this.state.baseUrl, function(error, result){\n      if(error){\n        console.log('error', error)\n      }\n      if(result){\n          \n          console.log('result.content', JSON.parse(result.content));\n          let parsedContent = JSON.parse(result.content);\n            \n          let capabilityStatement;\n\n          if(parsedContent.resourceType === \"Bundle\"){\n            capabilityStatement = get(parsedContent, 'entry.0.resource')\n          } \n          if(parsedContent.resourceType === \"CapabilityStatement\"){\n            capabilityStatement = parsedContent;\n          }\n          if(parsedContent.resourceType === \"ConformanceStatement\"){\n            capabilityStatement = parsedContent;\n          }\n          console.log('capabilityStatement', capabilityStatement)\n\n        self.setState({\n              metadata: EJSON.stringify(capabilityStatement, {indent: 2}),\n              conformance: capabilityStatement\n          })    \n      }\n    })\n  }\n  clearAutoscan(){\n    self.setState({\n        metadata: ''\n    })\n  }\n  extractAutoconfigValues(){\n      console.log('extractAutoconfigValues', this.state)\n\n      var newState = {\n        fhirVersion:  get(this, 'state.conformance.fhirVersion'),\n        authorizeUrl:  '',\n        tokenUrl: '',\n        formData: {\n            serviceName: this.state.formData.serviceName,\n            secretKey: this.state.formData.secretKey,\n            loginStyle: this.state.formData.loginStyle,\n            targetBaseUrl: this.state.baseUrl,\n            tokenUrl: this.state.formData.tokenUrl,\n            targetLoginUrl: ''\n        }\n      }\n\n    // json doesn't we don't actually know the ordering of \n    var oauthExtension = get(this, 'state.conformance.rest[0].security.extension[0].extension');\n\n    console.log('oauthExtension', oauthExtension);\n\n    oauthExtension.forEach(function(object){\n        console.log('object', object)\n        if(object.url == \"authorize\") {\n            newState.authorizeUrl = object.valueUri;\n            newState.formData.targetLoginUrl = object.valueUri;\n        }\n        if(object.url == \"token\"){\n            newState.tokenUrl = object.valueUri            \n            newState.formData.tokenUrl = object.valueUri;\n        }\n    });\n\n    console.log('newState', newState)\n    this.setState(newState)\n\n  }\n  saveConfiguration(){\n    console.log('saveConfiguration', this.state);\n\n    var serviceConfig = this.state.formData;\n\n    var credentialRequestCompleteCallback = Accounts.oauth.credentialRequestCompleteHandler(function(error, result){\n        console.log('foo?')\n        console.log('error', error)\n        console.log('result', result)\n        console.log('foo!')            \n    });\n\n    serviceConfig.credentialRequestCompleteCallback = credentialRequestCompleteCallback;\n\n    console.log('serviceConfig', serviceConfig)\n    Meteor.call('configureOauthService', serviceConfig, credentialRequestCompleteCallback);\n  }\n  signInWith(serviceName){\n    console.log('signInWith', serviceName)\n\n    Session.set('oauthService', serviceName);\n\n    var options = {\n          requestPermissions: [\n            'OBSERVATION.READ', \n            'OBSERVATION.SEARCH', \n            'PATIENT.READ', \n            'PATIENT.SEARCH', \n            'PRACTITIONER.READ', \n            'PRACTITIONER.SEARCH',\n            'patient/*.read',\n            'patient/*.search',\n            'openid',\n            'profile',\n            'user/*.*',\n            'launch',\n            'online_access'\n            \n          ]\n        }\n\n        console.log('Accounts.oauth.serviceNames', Accounts.oauth.serviceNames());\n\n        var credentialRequestCompleteCallback = Accounts.oauth.credentialRequestCompleteHandler(function(error, result){\n            console.log('foo?')\n            console.log('error', error)\n            console.log('result', result)\n            console.log('foo!')            \n        });\n        OAuth2.serviceName = serviceName;\n\n        var credentialResult = OAuth.requestCredential(options, credentialRequestCompleteCallback);\n        console.log('credentialResult', credentialResult)\n  }\n  resyncConfiguration(){\n    console.log('C2.  Resyncing Configuration')\n\n    Meteor.call('resyncConfiguration');\n  }\n  removeEntry(_id){\n    check(_id, String);\n    if(confirm('Remove configuration?')){\n        console.log('removing...', _id)\n\n        //ServiceConfiguration.configurations.remove({_id: _id});\n        Meteor.call('removeService', _id, function(error, result){\n            console.log('removeService[error]', error)\n            console.log('removeService[result]', result)\n        })\n    }\n  }\n}\n\n\n  \n/**\n * Get the user access token if it exists.\n * @returns {*}\n */\nfunction getUserAccessToken() {\n    var user = Meteor.user();\n\n    if (!get(user, 'services.OAuth2Server')) {\n        return;\n    }\n\n    return user.services.OAuth2Server.accessToken;\n}\n\n\nReactMixin(AdminConfigPage.prototype, ReactMeteorData);\nexport default AdminConfigPage;","// Here's the OAuth/protected FHIR server: https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut, \n// Its Conformance statement is here: https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut/metadata \n// And its authorize endpoint: https://open-ic.epic.com/FHIR/oauth2/authorize\n// ARGONAUT/ARGONAUT\n// https://guide.meteor.com/accounts.html#oauth-calling-api  \n\n\n//====================================\n// Client Config\n//\n// Epic\n// 2098c6e8-57c3-6b87-a5f2-8712d49365f9\n// https://open-ic.epic.com/argonaut/api/FHIR/Argonaut/\n// https://open-ic.epic.com/FHIR/oauth2/authorize\n\n\n// Not sure how functional the following sandbox is\n// https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut/\n\n// username:  fhirjson\n// password:  epicepic1\n\n// http://motorcycleguy.blogspot.com/2015/09/my-fhir-json-xml-converter-in.html\n// https://github.com/kwboone/FHIR-JSON-to-XML-Converter/blob/master/FHIR%20JSON%20to%20XML%20Converter/src/FHIRConverterBody.js\n\n\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\n\nimport { VerticalCanvas, GlassCard, DynamicSpacer } from 'meteor/clinical:glass-ui';\nimport { CardText, CardTitle, CardActions, TextField, FlatButton, RaisedButton } from 'material-ui';\nimport { Grid, Row, Col } from 'react-bootstrap';\nimport { ReactiveVar } from 'meteor/reactive-var';\n\nimport { Meteor } from 'meteor/meteor';\nimport { Session } from 'meteor/session';\nimport { HTTP } from 'meteor/http';\n\nimport { PatientTable, PatientCard } from 'meteor/clinical:hl7-resource-patient';\n\nimport { Table, TableBody, TableRow, TableRowColumn } from 'material-ui/Table';\n\nimport { browserHistory } from 'react-router';\nimport { get } from 'lodash';\n\nvar getUserIdResult = new ReactiveVar(null);\nvar getUserData = new ReactiveVar(null);\nvar getPatientData = new ReactiveVar(null);\nlet formatSuffix = '?_format=application/json';\n\nSession.setDefault('patientSearchResults', []);\nSession.setDefault('oauthService', '');\nSession.setDefault('accessToken', '');\nSession.setDefault('oauthBaseUrl', 'https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut');\nSession.setDefault('smartOnFhirIdentity', '385800201');\n\n\nconst defaultOAuthState = {\n    conformance: {},\n    fhirVersion: '',\n    formData: {\n      serviceName: 'SmartOnFhir',\n      clientId: '',\n      secretKey: '',\n      targetBaseUrl: '',\n      targetLoginUrl: '',\n      tokenUrl: '',\n      loginStyle: 'popup'\n    },\n    // autoscan: '',\n    metadata: '',\n    baseUrl: 'https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut',\n    authorizeUrl: '',\n    tokenUrl: '',\n    patientSearch: {\n        text: '',\n        given: '', \n        family: '',\n        gender: '',\n        birthdate: '',\n        identifier: ''\n    },\n    patientId: '',\n    accessToken: '',\n    patientData: '',\n    patient: {},\n    observations: [],\n    patients: []\n};\n\nexport class FastImportPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = defaultOAuthState;\n  }\n  componentDidMount() {\n      this.setState(defaultOAuthState);\n  }\n  getMeteorData() {\n\n    let data = {\n      style: {},\n      state: defaultOAuthState,\n      services: [],\n      patients: [],\n      minimongo: {\n        AllergyIntolerances: 0,\n        CarePlans: 0,\n        Conditions: 0,\n        Devices: 0,\n        DiagnosticReports: 0,\n        Goals: 0,\n        ImagingStudies: 0,\n        Immunizations: 0,\n        Locations: 0,\n        Medications: 0,\n        MedicationStatements: 0,\n        Observations: 0,\n        Patients: 0,\n        Persons: 0,\n        Practitioners: 0,\n        Procedures: 0,\n        RelatedPersons: 0,\n        Sequences: 0\n      }\n    };\n\n    if(ServiceConfiguration){\n        data.services = ServiceConfiguration.configurations.find().fetch()\n    }   \n\n    if(Session.get('patientSearchResults').length > 0){\n        data.patients = Session.get('patientSearchResults');\n    }\n\n    var resourceTypes = [\n        'AllergyIntolerances',\n        'CarePlans',\n        'Conditions',\n        'Devices',\n        'DiagnosticReports',\n        'Goals',\n        'Immunizations',\n        'Medications',\n        'MedicationOrders',\n        'Organizations',\n        'Observations',\n        'Practitioners',\n        'Procedures'\n    ];\n\n    resourceTypes.forEach(function(resourceType){\n      if(Mongo.Collection.get(resourceType)){\n        data.minimongo[resourceType] = Mongo.Collection.get(resourceType).find().count();\n      }\n    })\n\n\n\n    // data.state.formData.clientId: get(Meteor, 'settings.private.oAuth.epic.clientId');\n    // data.state.formData.secretKey: get(Meteor, 'settings.private.oAuth.epic.secretKey');\n    // data.state.formData.clientId: get(Meteor, 'settings.private.oAuth.google.clientId');\n    // data.state.formData.secretKey: get(Meteor, 'settings.private.oAuth.google.secretKey');\n\n    data.state.userAccessToken = getUserAccessToken();\n    data.state.userIdResult = getUserIdResult.get();\n    data.state.userOAuth2Id = get(Meteor.user(), 'services.OAuth2Server.id');\n    data.state.userData = EJSON.stringify(getUserData.get(), {indent: 2});\n    data.state.patientData = EJSON.stringify(getPatientData.get(), {indent: 2});\n\n    process.env.TRACE && console.log('FastImportPage.data', data)\n    // process.env.TRACE && console.log('FastImportPage.props')\n    // process.env.TRACE && console.log('FastImportPage.state')\n\n    return data;\n  }\n  render(){\n    let baseUrl = Meteor.absoluteUrl();\n    let path = \"_oauth/\" + this.state.formData.serviceName;\n    let oAuthPath = baseUrl + path;\n    let serviceName = this.state.formData.serviceName;\n    let accessToken = this.state.accessToken;\n    let tableRows = [];\n    let signInWiths = [];\n\n    for (var i = 0; i < this.data.services.length; i++) {\n        tableRows.push(\n            <tr key={i} className=\"servicesRow\" style={{cursor: \"pointer\"}}>\n\n              <td className='service' style={{minWidth: '100px', paddingTop: '16px'}}>{this.data.services[i].service }</td>\n              <td className='clientId' style={this.data.style.cell}>{this.data.services[i].clientId }</td>\n              <td className='secret' style={this.data.style.cell}>{this.data.services[i].secret}</td>\n              <td className='baseUrl' style={this.data.style.cell}>{this.data.services[i].baseUrl}<br/>{this.data.services[i].loginUrl}</td>\n              <td className='removeBtn' style={this.data.style.cell}><FlatButton \n                label=\"Remove\" \n                onClick={ this.removeEntry.bind(this, this.data.services[i]._id) }\n                />\n              </td>\n            </tr>\n            );\n    }\n    for (var j = 0; j < this.data.services.length; j++) {\n        signInWiths.push(\n            <div key={j}>\n              <FlatButton \n                label={ this.data.services[j].service } \n                id={ this.data.services[j].service + \"Button\" }\n                primary={true}\n                onClick={ this.signInWith.bind(this, this.data.services[j].service) }\n                style={{textAlign: 'left', marginLeft: '20px'}}\n                fullWidth\n                />    \n            </div>\n        );\n    }    \n\n    var systemSyncButtons = [];\n    var dataManagementButtons = [];\n\n    // systemSyncButtons.push(<FlatButton \n    //     label='Clear Local Cache' \n    //     key='clear'\n    //     onClick={this.clearLocalCache.bind(this)}\n    //     style={{textAlign: 'left', marginTop: '40px', marginBottom: '20px'}}\n    //     fullWidth\n    //     primary={false} \n    // />)\n    systemSyncButtons.push(<FlatButton \n        label='Diagnostics' \n        key='diag'\n        onClick={this.runDiagnostics.bind(this)}\n        style={{textAlign: 'left'}}\n        fullWidth\n        primary={false} \n    />)\n    systemSyncButtons.push(<FlatButton \n        label='Resync Configuration' \n        key='resync'\n        onClick={this.resyncConfiguration.bind(this)}\n        style={{textAlign: 'left'}}\n        fullWidth\n        primary={false} \n    />)\n    systemSyncButtons.push(<FlatButton \n        label=\"Simulate Launch Context\" \n        key='simulate'\n        id=\"simulateLaunchContext\" \n        onClick={this.simulateLaunchContext.bind(this)}\n        style={{textAlign: 'left', marginBottom: '20px'}}\n        fullWidth\n        primary={false} \n    />)\n\n\n    // dataManagementButtons.push(<FlatButton \n    //     key='token'\n    //     label=\"Fetch Access Token\" \n    //     id=\"fetchAccessToken\" \n    //     onClick={this.fetchAccessToken.bind(this)}\n    //     style={{textAlign: 'left'}}\n    //     fullWidth\n    //     primary={false} \n    // />)\n    dataManagementButtons.push(<FlatButton \n        key='identity'\n        label=\"Fetch Identity\" \n        id=\"fetchIdentity\" \n        onClick={this.fetchIdentity.bind(this)}\n        style={{textAlign: 'left'}}\n        fullWidth\n        primary={false} \n    />)\n    dataManagementButtons.push(<FlatButton \n        key='chart'\n        label=\"Fetch Chart\" \n        id=\"fetchChart\" \n        onClick={this.searchChart.bind(this)}\n        style={{textAlign: 'left'}}\n        fullWidth\n        primary={false} \n    />)\n\n    var ccdResources = [];\n\n    if(get(this, 'data.minimongo.AllergyIntolerances')){\n      ccdResources.push(<TableRow key=''>\n        <TableRowColumn>{this.data.minimongo.AllergyIntolerances}</TableRowColumn>\n        <TableRowColumn>Allergies</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.CarePlans')){\n      ccdResources.push(<TableRow key='CarePlans'>\n        <TableRowColumn>{this.data.minimongo.CarePlans}</TableRowColumn>\n        <TableRowColumn>CarePlans</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.Conditions')){\n      ccdResources.push(<TableRow key='Conditions'>\n        <TableRowColumn>{this.data.minimongo.Conditions}</TableRowColumn>\n        <TableRowColumn>Conditions</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.Devices')){\n      ccdResources.push(<TableRow key='Devices'>\n        <TableRowColumn>{this.data.minimongo.Devices}</TableRowColumn>\n        <TableRowColumn>Devices</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.DiagnosticReports')){\n      ccdResources.push(<TableRow key='DiagnosticReports'>\n        <TableRowColumn>{this.data.minimongo.DiagnosticReports}</TableRowColumn>\n        <TableRowColumn>DiagnosticReports</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.Goals')){\n      ccdResources.push(<TableRow key='Goals'>\n        <TableRowColumn>{this.data.minimongo.Goals}</TableRowColumn>\n        <TableRowColumn>Goals</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.ImagingStudies')){\n      ccdResources.push(<TableRow key='ImagingStudies'>\n        <TableRowColumn>{this.data.minimongo.ImagingStudies}</TableRowColumn>\n        <TableRowColumn>ImagingStudies</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.Immunizations')){\n      ccdResources.push(<TableRow key='Immunizations'>\n        <TableRowColumn>{this.data.minimongo.Immunizations}</TableRowColumn>\n        <TableRowColumn>Immunizations</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.Locations')){\n      ccdResources.push(<TableRow key='Locations'>\n        <TableRowColumn>{this.data.minimongo.Locations}</TableRowColumn>\n        <TableRowColumn>Locations</TableRowColumn>\n      </TableRow>);\n    }    \n    if(get(this, 'data.minimongo.Medications')){\n      ccdResources.push(<TableRow key='Medications'>\n        <TableRowColumn>{this.data.minimongo.Medications}</TableRowColumn>\n        <TableRowColumn>Medications</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.MedicationOrders')){\n        ccdResources.push(<TableRow key='MedicationOrders'>\n          <TableRowColumn>{this.data.minimongo.MedicationOrders}</TableRowColumn>\n          <TableRowColumn>Medication Orders</TableRowColumn>\n        </TableRow>);\n      }\n      if(get(this, 'data.minimongo.MedicationStatements')){\n      ccdResources.push(<TableRow key='MedicationStatements'>\n        <TableRowColumn>{this.data.minimongo.MedicationStatements}</TableRowColumn>\n        <TableRowColumn>MedicationStatements</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.Observations')){\n      ccdResources.push(<TableRow key='Observations'>\n        <TableRowColumn>{this.data.minimongo.Observations}</TableRowColumn>\n        <TableRowColumn>Observations</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.Patients')){\n      ccdResources.push(<TableRow key='Patients'>\n        <TableRowColumn>{this.data.minimongo.Patients}</TableRowColumn>\n        <TableRowColumn>Patients</TableRowColumn>\n      </TableRow>);\n    }\n  \n    if(get(this, 'data.minimongo.Persons')){\n      ccdResources.push(<TableRow key='Persons'>\n        <TableRowColumn>{this.data.minimongo.Persons}</TableRowColumn>\n        <TableRowColumn>Persons</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.Practitioners')){\n      ccdResources.push(<TableRow key='Practitioners'>\n        <TableRowColumn>{this.data.minimongo.Practitioners}</TableRowColumn>\n        <TableRowColumn>Practitioners</TableRowColumn>\n      </TableRow>);\n    }            \n    if(get(this, 'data.minimongo.Procedures')){\n      ccdResources.push(<TableRow key='Procedures'>\n        <TableRowColumn>{this.data.minimongo.Procedures}</TableRowColumn>\n        <TableRowColumn>Procedures</TableRowColumn>\n      </TableRow>);\n    }    \n    if(get(this, 'data.minimongo.RelatedPersons')){\n      ccdResources.push(<TableRow key='RelatedPersons'>\n        <TableRowColumn>{this.data.minimongo.RelatedPersons}</TableRowColumn>\n        <TableRowColumn>RelatedPersons</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.Sequences')){\n      ccdResources.push(<TableRow key='Sequences'>\n        <TableRowColumn>{this.data.minimongo.Sequences}</TableRowColumn>\n        <TableRowColumn>Sequences</TableRowColumn>\n      </TableRow>);\n    }    \n    let continuityOfCareCard = <div>\n        <GlassCard>\n          <CardTitle title=\"Continuity of Care\" subtitle='Healthcare data is attached to your profile via resources.' />\n          <CardText>\n            <Table  >\n              <TableBody displayRowCheckbox={false} showRowHover={false}>\n                <TableRow style={{fontWeight: 'bold'}}>\n                  <TableRowColumn style={{width: '20%'}}>Count</TableRowColumn>\n                  <TableRowColumn style={{width: '80%'}}>Resource</TableRowColumn>\n                </TableRow>\n                { ccdResources }      \n              </TableBody>\n            </Table>\n          </CardText>\n        </GlassCard>\n        <DynamicSpacer />\n      </div>\n\n    return(\n        \n      <div id=\"FastImportPage\">\n        <VerticalCanvas >\n            <Grid>\n                <Row>\n                    <Col md={3}>\n                    <DynamicSpacer />\n                    <GlassCard zDepth={2} >\n                        <CardText>\n                            { systemSyncButtons }\n                            <br />\n                            { signInWiths }                        \n                            <br />\n                            { dataManagementButtons }                        \n                            <br />\n                        </CardText>\n                    </GlassCard>\n                    <DynamicSpacer />\n                    <h3 className='barcode' style={{width: '100%', textAlign: 'center', overflow: 'hidden'}}>{ this.state.accessToken }</h3>\n                    </Col>\n                    <Col mdOffset={1} md={8}>\n                        <DynamicSpacer />\n                        {/* <GlassCard width='768px' zDepth={2} >\n                        <CardTitle\n                            title='1. Search Proxy Patients'                    \n                            subtitle={<span style={{color: 'rgb(38, 166, 154)'}}> { this.state.patientSearchUrl } </span>} />\n                        <CardText> \n                                <Row>\n                                    <Col md={6}>\n                                        <TextField\n                                            type=\"text\"\n                                            ref=\"given\"\n                                            name=\"given\"\n                                            floatingLabelText=\"Given\"\n                                            hintText=\"Jane\"\n                                            floatingLabelFixed={true}\n                                            onChange={ this.updateSearch.bind(this, 'given') } \n                                            fullWidth\n                                        />      \n                                    </Col>\n                                    <Col md={6}>\n                                        <TextField\n                                            type=\"text\"\n                                            ref=\"family\"\n                                            name=\"family\"\n                                            floatingLabelText=\"Family\"\n                                            hintText=\"Doe\"\n                                            floatingLabelFixed={true}\n                                            onChange={ this.updateSearch.bind(this, 'family') } \n                                            fullWidth\n                                        />      \n                                    </Col>                                \n                                </Row>                                \n                                <Row>\n                                    <Col md={4}>\n                                        <TextField\n                                                type=\"text\"\n                                                ref=\"birthdate\"\n                                                name=\"birthdate\"\n                                                floatingLabelText=\"Birthdate\"\n                                                hintText=\"1960-01-01\"\n                                                floatingLabelFixed={true}\n                                                onChange={ this.updateSearch.bind(this, 'birthdate') } \n                                                fullWidth\n                                            />    \n                                    </Col>                            \n                                    <Col md={4}>\n                                        <TextField\n                                            type=\"text\"\n                                            ref=\"gender\"\n                                            name=\"gender\"\n                                            floatingLabelText=\"Gender\"\n                                            hintText=\"female\"\n                                            floatingLabelFixed={true}\n                                            onChange={ this.updateSearch.bind(this, 'gender') } \n                                            fullWidth\n                                        />      \n                                    </Col>\n                                    <Col md={4}>\n                                        <TextField\n                                            type=\"text\"\n                                            ref=\"identifier\"\n                                            name=\"identifier\"\n                                            floatingLabelText=\"Identifier\"\n                                            hintText=\"12345\"\n                                            floatingLabelFixed={true}\n                                            onChange={ this.updateSearch.bind(this, 'identifier') } \n                                            fullWidth\n                                        />      \n                                    </Col>                              \n                                </Row>\n\n\n                        </CardText>\n                        <CardActions>\n                            <FlatButton \n                                label=\"Search\" \n                                id=\"searchPatients\" \n                                onClick={this.searchPatients.bind(this)}\n                                primary={false} />\n                        </CardActions>\n                    </GlassCard>\n                    <DynamicSpacer />\n\n\n                    <GlassCard width='768px' zDepth={2} >\n                        <CardTitle\n                            title='2.  Patient Search Results' \n                            subtitle={<span style={{color: 'rgb(38, 166, 154)'}}> { this.state.baseUrl + '/Patient/' + this.state.patientId } </span>} />\n                            />\n                        <CardText>\n                            <PatientTable\n                                data={ this.data.patients } \n                                showAvatars={false}\n                                showSendButton={false}\n                                onRowClick={ this.selectPatientCallback.bind(this) }\n                                noDataPadding={40}\n                                limit={10}\n                                />\n                        </CardText>\n                        <CardActions>\n                            <FlatButton \n                                label=\"Fetch Patient Data\" \n                                id=\"fetchPatientData\" \n                                onClick={this.fetchPatientData.bind(this)}\n                                style={{textAlign: 'left'}}\n                                primary={false} \n                                />      \n                            <FlatButton \n                                label=\"Save to Profile\" \n                                id=\"savePatientDemographicsToProfile\" \n                                onClick={this.savePatientDemographicsToProfile.bind(this)}\n                                style={{textAlign: 'left'}}\n                                primary={false} \n                            />\n                            <FlatButton \n                                label=\"Fetch Patient Chart\" \n                                id=\"searchObservations\" \n                                onClick={this.searchChart.bind(this)}\n                                style={{textAlign: 'left'}}\n                                primary={false} \n                            />\n                        </CardActions>\n                    </GlassCard>\n                    <DynamicSpacer /> */}\n\n\n\n\n                        <PatientCard\n                            patient={ this.state.patient }   \n                            zDepth={2}                 \n                            />\n                            \n                        { continuityOfCareCard }\n\n\n                        <GlassCard>\n                            <RaisedButton \n                                label=\"Timeline Visualization\" \n                                id=\"timelineVisualizationButton\" \n                                onClick={this.timelineVisualization.bind(this)}\n                                style={{textAlign: 'left'}}\n                                primary={true} \n                                fullWidth\n                                />      \n                        </GlassCard>\n                    </Col>\n                </Row>\n            </Grid>\n\n\n          <DynamicSpacer />\n        </VerticalCanvas>\n      </div>\n    );\n  }\n  timelineVisualization(){\n    browserHistory.push('/timeline-sidescroll')\n  }\n  selectPatientCallback(patientId){\n      // console.log('patientId:', patientId)\n      var newState = this.state;\n      newState.patientId = patientId;\n      this.setState(newState);\n  }\n  editServiceName(field, event, value){\n    //console.log('editclientId', value)\n    var newFormData = this.state.formData;\n    newFormData.serviceName = value;\n\n    this.setState({\n        'formData': newFormData\n    });\n  }\n  editclientId(field, event, value){\n    //console.log('editclientId', value)\n    var newFormData = this.state.formData;\n    newFormData.clientId = value;\n\n    this.setState({\n        'formData': newFormData\n    });\n  }\n  editSecretKey(field, event, value){\n    //console.log('editSecretKey', value)\n\n    var newFormData = this.state.formData;\n    newFormData.secretKey = value;\n    \n    this.setState({\n        'formData': newFormData\n    });\n  }\n  editTargetBaseUrl(field, event, value){\n    //console.log('editTargetBaseUrl', value)\n\n    var newFormData = this.state.formData;\n    newFormData.targetBaseUrl = value;\n    \n    this.setState({\n        'formData': newFormData\n    });\n  }\n  editTargetLoginUrl(field, event, value){\n    //console.log('editTargetLoginUrl', value)\n\n    var newFormData = this.state.formData;\n    newFormData.targetLoginUrl = value;\n    \n    this.setState({\n        'formData': newFormData\n    });\n  }\n  editloginStyle(fipopupeld, event, value){\n    //console.log('editloginStyle - ÃŸ', value)\n    \n    var newFormData = this.state.formData;\n    newFormData.loginStyle = value;\n    \n    this.setState({\n        'formData': newFormData\n    });\n  }\n\n  changeState(field, event, value){\n    const formData = this.state.formData;\n    formData[field] = value;\n    this.setState({\n        formData: formData\n    });\n  }\n  updateBaseUrl(event, value){\n    console.log('updateBaseUrl', event, value)\n\n    var newState = this.state;\n    newState.baseUrl = value;\n\n    this.setState(newState);\n  }\n  \n\n//   autoscan(){\n//       console.log('autoscan')\n//       var self = this;\n\n//       var metadataRoute = Session.get('oauthBaseUrl') + '/metadata' + formatSuffix;\n//       console.log('metadata route', metadataRoute)\n\n//     //   HTTP.get(metadataRoute, { headers: {\n//     //     'Accept': ['application/json', 'application/json+fhir'],\n//     //     'Access-Control-Allow-Origin': '*'\n//     //     }}, function(error, result){\n//     //       if(error){\n//     //           console.log('error', error)\n//     //       }\n//     //       if(result){\n//     //           console.log(result.content);\n//     //           var conformanceStatement = JSON.parse(result.content);\n//     //           console.log('conformanceStatement', conformanceStatement)\n//     //           self.setState({\n//     //               metadata: EJSON.stringify(conformanceStatement, {indent: 2}),\n//     //               conformance: conformanceStatement\n//     //           })\n//     //     }\n//     //   })\n\n//       Meteor.call('metadataAutoscan', Session.get('oauthBaseUrl'), function(error, result){\n//         if(result){\n//             self.setState({\n//                 metadata: EJSON.stringify(result, {indent: 2}),\n//                 conformance: result\n//             })    \n//         }\n//       })\n//   }\n//   clearAutoscan(){\n//     self.setState({\n//         metadata: ''\n//     })\n//   }\n  extractAutoconfigValues(){\n      console.log('extractAutoconfigValues', this.state)\n\n      var newState = {\n        fhirVersion:  get(this, 'state.conformance.fhirVersion'),\n        authorizeUrl:  '',\n        tokenUrl: '',\n        formData: {\n            serviceName: this.state.formData.serviceName,\n            secretKey: this.state.formData.secretKey,\n            loginStyle: this.state.formData.loginStyle,\n            targetBaseUrl: Session.get('oauthBaseUrl'),\n            tokenUrl: this.state.formData.tokenUrl,\n            targetLoginUrl: ''\n        }\n      }\n\n    // json doesn't we don't actually know the ordering of \n    var oauthExtension = get(this, 'state.conformance.rest[0].security.extension[0].extension');\n\n    console.log('oauthExtension', oauthExtension);\n\n    oauthExtension.forEach(function(object){\n        console.log('object', object)\n        if(object.url == \"authorize\") {\n            newState.authorizeUrl = object.valueUri;\n            newState.formData.targetLoginUrl = object.valueUri;\n        }\n        if(object.url == \"token\"){\n            newState.tokenUrl = object.valueUri            \n            newState.formData.tokenUrl = object.valueUri;\n        }\n    });\n\n    console.log('newState', newState)\n    this.setState(newState)\n\n  }\n  saveConfiguration(){\n    console.log('saveConfiguration', this.state);\n\n    var serviceConfig = this.state.formData;\n\n    var credentialRequestCompleteCallback = Accounts.oauth.credentialRequestCompleteHandler(function(error, result){\n        console.log('foo?')\n        console.log('error', error)\n        console.log('result', result)\n        console.log('saveConfiguration!')            \n    });\n\n    serviceConfig.credentialRequestCompleteCallback = credentialRequestCompleteCallback;\n\n    console.log('serviceConfig', serviceConfig)\n    Meteor.call('configureOauthService', serviceConfig, credentialRequestCompleteCallback);\n  }\n  signInWith(serviceName){\n    console.log('*********************************************')\n    console.log('C1.1    Signing in with the following OAuth service:  ', serviceName)\n\n    this.resyncConfiguration();\n\n    var self = this;\n\n    Session.set('oauthService', serviceName);\n\n    var services = ServiceConfiguration.configurations.find().fetch();\n    console.log('C1.2    Checking the existing service configurations in database: ', services);\n\n    services.forEach(function(service){\n        if(service.service === serviceName){\n            console.log('C1.3.1  Found the service configuration', service)\n\n            console.log('C1.3.2  Setting OAuth baseUrl...', service.baseUrl)\n\n            Session.set('oauthBaseUrl', service.baseUrl);\n        }\n    })\n\n    var options = {\n        requestPermissions: [\n            'OBSERVATION.READ', \n            'OBSERVATION.SEARCH', \n            'PATIENT.READ', \n            'PATIENT.SEARCH', \n            'PRACTITIONER.READ', \n            'PRACTITIONER.SEARCH',\n            'patient/*.read',\n            'patient/*.search',\n            'openid',\n            'profile',\n            'user/*.*',\n            'launch',\n            'online_access'            \n        ]\n    }\n\n    console.log('C1.3    Checking service names registered in active server memory', Accounts.oauth.serviceNames());\n\n    var loginSignature = 'loginWith' + serviceName;\n    console.log('C1.4    Building custom login signature required by accounts-oauth: ', loginSignature);\n\n    options.serviceName = serviceName;\n    console.log('C1.5    Building signin options (including custom scope requests): ', options);\n\n    console.log('C1.6    Calling custom login signature.');\n    Meteor[loginSignature].call(options, function(error, result){\n        console.log('C1.7.1  Received a response from our custom login signature.')\n        if(error){\n            console.log('C1.7.2.  error', error)\n        }\n        if(result){\n            console.log('C1.7.2.  result', result)\n        }\n        \n        self.fetchAccessToken(function(){\n            self.savePatientDemographicsToProfile(function(){\n                self.searchChart();    \n            });\n        });\n\n        console.log('C1.7.3. Completed running custom login signature callback.');         \n    });\n  }\n  resyncConfiguration(){\n    console.log('C2.1    Resyncing Configuration')\n    console.log('C2.2    Fetching service names in active server memory', Accounts.oauth.serviceNames());\n    var services = ServiceConfiguration.configurations.find().fetch();\n    console.log('C2.3    Fetching service configurations currently stored in the database', services);\n\n    services.forEach(function(record){\n        Meteor['loginWith' + record.service] = function (options, callback) {\n\n            console.log('C2.4    loginWith' + record.service);\n\n            if (!callback && typeof options === \"function\") {\n              callback = options;\n              options = {};\n\n              if(get(this, 'props.location.query.launch')){\n                  options.launch = get(this, 'props.location.query.launch');\n              }\n            }\n\n            if (_.isUndefined(OAuth2)) {\n              OAuth2 = {\n                  serviceName: ''\n              };\n            }\n\n            OAuth2.serviceName = record.service;        \n            console.log('C2.5    loginWith.OAuth2', OAuth2)\n        \n            var credentialRequestCompleteCallback = Accounts.oauth.credentialRequestCompleteHandler(callback);\n\n            OAuth.requestCredential(options, credentialRequestCompleteCallback);                  \n          };\n    })\n\n    return Meteor.call('resyncConfiguration');\n  }\n  removeEntry(_id){\n    check(_id, String);\n    if(confirm('Remove configuration?')){\n        console.log('removing...', _id)\n\n        //ServiceConfiguration.configurations.remove({_id: _id});\n        Meteor.call('removeService', _id, function(error, result){\n            console.log('removeService[error]', error)\n            console.log('removeService[result]', result)\n        })\n    }\n  }\n  resetServiceConfiguration(){\n    console.log('resetServiceConfiguration')\n  }\n  simulateLaunchContext(){\n    console.log('simulateLaunchContext')\n  }\n  fetchAccessToken(){\n    console.log('C11.1   Fetching access token')\n    var self = this;\n    Meteor.call('fetchAccessToken', Session.get('oauthService'), function(err, result){\n        if(result){\n            console.log('C11.2   Received access token.', result)\n            var newState = self.state;\n            newState.accessToken = result.accessToken;\n            if(result.accessToken){ \n                self.setState(newState)\n                Session.set('accessToken', result.accessToken)\n                self.fetchIdentity();    \n            } else {\n                console.log('No access token found.  Check implementation.')\n            }\n        }\n    })\n  }\n  fetchIdentity(){\n    console.log('C12.1   Fetching patient OAuth identifier.')\n    var self = this;\n    Meteor.call('fetchIdentity', Session.get('oauthService'), function(err, result){\n        if(result){\n            console.log('C12.1   Received patient OAuth identifier.', result)\n            if(result.patient){\n\n                var newState = self.state;\n                newState.patientId = result.patient;\n                self.setState(newState)\n\n                self.fetchPatientData();    \n            }\n        }\n    })      \n  }\n  fetchPatientData(){\n    console.log('C13.0 this.state', this.state)\n    var fetchUrl = Session.get('oauthBaseUrl') + '/Patient/' + this.state.patientId + formatSuffix;\n    console.log('C13.1   Constructing patient data fetch url', fetchUrl)\n    console.log('C13.2   Fetching patient data.')\n\n    var self = this    \n\n    HTTP.get(fetchUrl, {\n        // data: {\n        //   summaryLength: \"500\",\n        //   entryPoint: \"main\"\n        // },\n        headers: {\n            'Authorization': 'Bearer ' + Session.get('accessToken')\n        }\n      }, function(err, result){\n        if(result){\n            console.log('C13.3   Received patient data.',  result)\n\n            var patientData = {};\n            if(result.content){\n                patientData = JSON.parse(result.content);\n                console.log('C13.4   Received patient data.',   patientData)    \n            }\n\n            var newState = self.state;\n            newState.patientData = EJSON.stringify(patientData, {indent: 2});\n            newState.patient = patientData;\n\n            self.setState(newState);\n        }\n        if(err){\n            console.error(err)\n        }\n    })\n  }\n  savePatientDemographicsToProfile(){\n    console.log('savePatientDemographicsToProfile', this.state );\n\n    console.log('Meteor.userId()', Meteor.userId());\n\n    \n    if(get(this, 'state.patient.name[0]')){\n        var humanName = get(this, 'state.patient.name[0]');\n        if (!humanName.text ){\n            humanName.text = humanName.given[0] + '' + humanName.family[0];\n        }\n        Meteor.users.update({_id: Meteor.userId()}, {\n            $set: {\n                'profile.name': humanName\n            }\n        })    \n    }\n    if(get(this, 'state.patient.gender')){\n        var gender = get(this, 'state.patient.gender');\n        switch (gender) {\n            case 'male':          \n                Session.get('gender', 'BabyBlue')          \n                break;\n            case 'female':      \n                Session.get('gender', 'Pink')          \n                break;\n            default:\n                break;\n        }\n    }\n    if(get(this, 'state.patient')){\n\n        var newPatient = this.state.patient;\n\n        // STU3 HumanName mapping\n        var newName = get(newPatient, 'name[0]');\n        newName.family = newName.family[0];\n        newPatient.name = [ newName ]\n        console.log('newPatient', newPatient);\n\n        if(!Patiens.findOne({id: this.state.patient.id})){\n            Patients.insert(newPatient, function(error){\n                if(error) console.log('Patient.insert().error', error)\n            });    \n        }\n    }\n    if(get(this, 'state.patient.address')){\n        var addresses = get(this, 'state.patient.address');\n        addresses.forEach(function(address){\n            if(address.use === \"home\"){\n                Meteor.users.update({_id: Meteor.userId()}, {\n                    $set: {\n                        'profile.locations.home.address': address\n                    }\n                })            \n            }\n        })\n\n    }\n    \n  }\n//   updateSearch(field, event, value){\n//     const newState = this.state;\n\n//     if(field === \"name\"){\n//         newState.patientSearch.text = value;\n//     }\n//     if(field === \"given\"){\n//         newState.patientSearch.given = value;\n//     }\n//     if(field === \"family\"){\n//         newState.patientSearch.family = value;\n//     }\n//     if(field === \"gender\"){\n//         newState.patientSearch.gender = value;\n//     }\n//     if(field === \"birthdate\"){\n//         newState.patientSearch.birthdate = value;\n//     }\n//     if(field === \"identifier\"){\n//         newState.patientSearch.identifier = value;\n//     }\n//     newState.patientSearchUrl = Session.get('oauthBaseUrl') + '/Patient/_search?family=' + this.state.patientSearch.family + '&given=' + this.state.patientSearch.given + '&_format=application/json';\n\n//     //console.log('updateSearch.newState', newState)\n//     this.setState(newState);\n//   }\n//   searchPatients(){\n//     console.log('this.state.patientSearchUrl', this.state.patientSearchUrl)\n\n//     // var self = this;    \n//     // var patientId = 'Tbt3KuCY0B5PSrJvCu2j-PlK.aiHsu2xUjUM8bWpetXoB'\n//     // console.log('patientId', patientId)\n\n//     // var patientSearchUrl = Session.get('oauthBaseUrl') + '/Patient/_search?family=' + this.state.patientSearch.family + '&given=' + this.state.patientSearch.given + '&_format=application/json';\n//     // console.log('patientSearchUrl', patientSearchUrl)\n//     if(this.state.patientSearchUrl){\n//         HTTP.post(this.state.patientSearchUrl, {\n//             headers: {\n//                 'Authorization': 'Bearer ' + this.state.accessToken\n//             }\n//           }, function(error, result){\n//             if(result){\n//                 console.log('result', result);\n    \n                \n    \n//                 console.log(JSON.parse(result.content));\n    \n//                 var responseBundle = JSON.parse(result.content);\n//                 console.log('responseBundle', responseBundle)\n    \n//                 if(result.content){\n//                     var content = JSON.parse(result.content);\n//                     console.log('content', content)                    \n    \n//                     if(content.resourceType == \"Bundle\"){\n//                         if(content.entry){\n//                             var newPatientSearchResults = [];\n//                             content.entry.forEach(function(entry){\n//                                 if(entry.resource && (entry.resource.resourceType == \"Patient\")){\n//                                     newPatientSearchResults.push(entry.resource);\n//                                 }\n//                             })\n//                             Session.set('patientSearchResults', newPatientSearchResults);\n//                         }\n//                     }\n//                 }\n//             }\n//             if(error){\n//                 console.error(error)\n    \n//                 Session.set('patientSearchResults', []);\n//             }\n//         });\n//     } else {\n//         Session.set('patientSearchResults', []);        \n//     }\n//   }\n//   searchObservations(){\n//     var self = this    \n//     var observationUrl = Session.get('oauthBaseUrl') + '/Observation/_search?patient=' + this.state.patientId + '&category=vital-signs' + '&_format=application/json';\n\n//     console.log('observationUrl', observationUrl);\n\n//     HTTP.post(observationUrl, {\n//         headers: {\n//             'Authorization': 'Bearer ' + Session.get('accessToken')\n//         }\n//       }, function(err, result){\n//         if(result){\n//             //console.log('result', result)\n//             console.log(JSON.parse(result.content));\n\n//             var bundle = JSON.parse(result.content);\n//             console.log('bundle', bundle)\n\n//             var observationData = [];\n//             if(bundle && bundle.entry){\n//                 bundle.entry.forEach(function(resource){\n//                     observationData.push(resource.resource)\n//                 });    \n//             }\n\n//             console.log('observationData', observationData)\n//             var newState = self.state;\n\n//             //newState.observationData = EJSON.stringify(observationData, {indent: 2});\n//             newState.observations = observationData;\n\n//             console.log('newState', newState)\n\n//             self.setState(newState)\n//         }\n//         if (err){\n//             console.log('error', err)\n//         }\n//     });\n//   }\n  runDiagnostics(){\n    console.log('***********************************************************************')\n    console.log('Running diagnostics....');\n    console.log('')\n    console.log('FastImportPage.state', this.state);\n    console.log('Accounts.oauth.serviceNames', Accounts.oauth.serviceNames());\n    console.log('oauthBaseUrl', Session.get('oauthBaseUrl'))\n    console.log('accessToken', Session.get('accessToken'))\n    console.log('process.env.NODE_ENV', Session.get('accessToken'))\n    console.log('Meteor', Meteor);\n\n    var services = ServiceConfiguration.configurations.find().fetch();\n    console.log('ServiceConfiguration', services);\n\n    Meteor.call('runOAuthDiagnostics');\n\n    console.log('***********************************************************************')\n  }\n  clearLocalCache(){\n    if(confirm(\"Are you absolutely sure?\")){\n\n      var resourceTypes = [\n        'AllergyIntolerances',\n        'CarePlans',\n        'Conditions',\n        'Devices',\n        'DiagnosticReports',\n        'Goals',\n        'Immunizations',\n        'Medications',\n        'MedicationOrders',\n        'MedicationStatements',\n        'Organizations',\n        'Observations',\n        'Practitioners',\n        'Procedures',\n        'RiskAssessments'\n      ];\n\n      resourceTypes.forEach(function(resourceType){\n        if(Mongo.Collection.get(resourceType)){\n          Mongo.Collection.get(resourceType).find().forEach(function(record){\n            Mongo.Collection.get(resourceType)._collection.remove({_id: record._id})\n          })\n        }\n      })\n    }\n  }\n  searchChart(){\n    console.log('Asking server to fetch patient chart for us...')\n\n    Meteor.call('fetchPatientChart', \n        Session.get('oauthBaseUrl'), \n        Session.get('accessToken'), \n        Session.get('smartOnFhirIdentity'), \n        Session.get('oauthService'), \n        function(error, result){\n        if(error){\n            console.error('searchChart.error', error)\n        }\n        if(result){\n            console.info('searchChart.result', result)\n        }\n    })\n  }\n  cacheObservations(){\n    console.log('cacheObservations', this.state.observations);\n    \n    if(this.state.observations.length > 0){\n        this.state.observations.forEach(function(observation){\n            Observations._collection.insert(observation, function(error){\n                if(error) console.error(error)\n            });\n        })\n    }\n  }\n}\n\n/**\n * Determine if a user originates from an oauth2 login.\n * @param user\n * @returns {*}\n */\nfunction isOAuth2User(user) {\n    return get(user, 'services.OAuth2Server');\n}\n  \n/**\n * Get the user access token if it exists.\n * @returns {*}\n */\nfunction getUserAccessToken() {\n    var user = Meteor.user();\n\n    if (!isOAuth2User(user)) {\n        return;\n    }\n\n    return user.services.OAuth2Server.accessToken;\n}\n\n\nReactMixin(FastImportPage.prototype, ReactMeteorData);\nexport default FastImportPage;","// Here's the OAuth/protected FHIR server: https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut, \n// Its Conformance statement is here: https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut/metadata \n// And its authorize endpoint: https://open-ic.epic.com/FHIR/oauth2/authorize\n// ARGONAUT/ARGONAUT\n// https://guide.meteor.com/accounts.html#oauth-calling-api  \n\n\n//====================================\n// Client Config\n//\n// Epic\n// 2098c6e8-57c3-6b87-a5f2-8712d49365f9\n// https://open-ic.epic.com/argonaut/api/FHIR/Argonaut/\n// https://open-ic.epic.com/FHIR/oauth2/authorize\n\n\n// Not sure how functional the following sandbox is\n// https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut/\n\n// username:  fhirjson\n// password:  epicepic1\n\n// http://motorcycleguy.blogspot.com/2015/09/my-fhir-json-xml-converter-in.html\n// https://github.com/kwboone/FHIR-JSON-to-XML-Converter/blob/master/FHIR%20JSON%20to%20XML%20Converter/src/FHIRConverterBody.js\n\n\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\n\nimport { VerticalCanvas, GlassCard, DynamicSpacer } from 'meteor/clinical:glass-ui';\nimport { CardText, CardTitle, CardActions, TextField, FlatButton, RaisedButton } from 'material-ui';\nimport { Grid, Row, Col } from 'react-bootstrap';\nimport { ReactiveVar } from 'meteor/reactive-var';\n\nimport { Meteor } from 'meteor/meteor';\nimport { Session } from 'meteor/session';\nimport { HTTP } from 'meteor/http';\n\nimport { PatientTable, PatientCard } from 'meteor/clinical:hl7-resource-patient';\n\nimport { Table, TableBody, TableRow, TableRowColumn } from 'material-ui/Table';\n\nimport { browserHistory } from 'react-router';\nimport { get } from 'lodash';\n\nvar getUserIdResult = new ReactiveVar(null);\nvar getUserData = new ReactiveVar(null);\nvar getPatientData = new ReactiveVar(null);\nlet formatSuffix = '?_format=application/json';\n\nSession.setDefault('patientSearchResults', [])\nSession.setDefault('oauthService', '')\nSession.setDefault('accessToken', '')\nSession.setDefault('oauthBaseUrl', 'https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut')\n\n\nconst defaultOAuthState = {\n    conformance: {},\n    fhirVersion: '',\n    formData: {\n      serviceName: 'SmartOnFhir',\n      clientId: '',\n      secretKey: '',\n      targetBaseUrl: '',\n      targetLoginUrl: '',\n      tokenUrl: '',\n      loginStyle: 'popup'\n    },\n    // autoscan: '',\n    metadata: '',\n    baseUrl: 'https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut',\n    authorizeUrl: '',\n    tokenUrl: '',\n    patientSearch: {\n        text: '',\n        given: '', \n        family: '',\n        gender: '',\n        birthdate: '',\n        identifier: ''\n    },\n    patientId: '',\n    accessToken: '',\n    patientData: '',\n    patient: {},\n    observations: [],\n    patients: []\n};\n\nexport class ImportChart extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = defaultOAuthState;\n  }\n  componentDidMount() {\n      this.setState(defaultOAuthState);\n  }\n  getMeteorData() {\n\n    let data = {\n      style: {},\n      state: defaultOAuthState,\n      services: [],\n      patients: [],\n      minimongo: {\n        AllergyIntolerances: 0,\n        CarePlans: 0,\n        Conditions: 0,\n        Devices: 0,\n        DiagnosticReports: 0,\n        Goals: 0,\n        ImagingStudies: 0,\n        Immunizations: 0,\n        Locations: 0,\n        Medications: 0,\n        MedicationStatements: 0,\n        Observations: 0,\n        Patients: 0,\n        Persons: 0,\n        Practitioners: 0,\n        Procedures: 0,\n        RelatedPersons: 0,\n        Sequences: 0\n      }\n    };\n\n    if(ServiceConfiguration){\n        data.services = ServiceConfiguration.configurations.find().fetch()\n    }   \n\n    if(Session.get('patientSearchResults').length > 0){\n        data.patients = Session.get('patientSearchResults');\n    }\n\n    var resourceTypes = [\n        'AllergyIntolerances',\n        'CarePlans',\n        'Conditions',\n        'Devices',\n        'DiagnosticReports',\n        'Goals',\n        'Immunizations',\n        'Medications',\n        'MedicationOrders',\n        'Organizations',\n        'Observations',\n        'Practitioners',\n        'Procedures'\n    ];\n\n    resourceTypes.forEach(function(resourceType){\n      if(Mongo.Collection.get(resourceType)){\n        data.minimongo[resourceType] = Mongo.Collection.get(resourceType).find().count();\n      }\n    })\n\n\n\n    // data.state.formData.clientId: get(Meteor, 'settings.private.oAuth.epic.clientId');\n    // data.state.formData.secretKey: get(Meteor, 'settings.private.oAuth.epic.secretKey');\n    // data.state.formData.clientId: get(Meteor, 'settings.private.oAuth.google.clientId');\n    // data.state.formData.secretKey: get(Meteor, 'settings.private.oAuth.google.secretKey');\n\n    data.state.userAccessToken = getUserAccessToken();\n    data.state.userIdResult = getUserIdResult.get();\n    data.state.userOAuth2Id = get(Meteor.user(), 'services.OAuth2Server.id');\n    data.state.userData = EJSON.stringify(getUserData.get(), {indent: 2});\n    data.state.patientData = EJSON.stringify(getPatientData.get(), {indent: 2});\n\n    process.env.TRACE && console.log('ImportChart.data', data)\n    // process.env.TRACE && console.log('ImportChart.props')\n    // process.env.TRACE && console.log('ImportChart.state')\n\n    return data;\n  }\n  render(){\n    let baseUrl = Meteor.absoluteUrl();\n    let path = \"_oauth/\" + this.state.formData.serviceName;\n    let oAuthPath = baseUrl + path;\n    let serviceName = this.state.formData.serviceName;\n    let accessToken = this.state.accessToken;\n    let tableRows = [];\n    let signInWiths = [];\n\n    for (var i = 0; i < this.data.services.length; i++) {\n        tableRows.push(\n            <tr key={i} className=\"servicesRow\" style={{cursor: \"pointer\"}}>\n\n              <td className='service' style={{minWidth: '100px', paddingTop: '16px'}}>{this.data.services[i].service }</td>\n              <td className='clientId' style={this.data.style.cell}>{this.data.services[i].clientId }</td>\n              <td className='secret' style={this.data.style.cell}>{this.data.services[i].secret}</td>\n              <td className='baseUrl' style={this.data.style.cell}>{this.data.services[i].baseUrl}<br/>{this.data.services[i].loginUrl}</td>\n              <td className='removeBtn' style={this.data.style.cell}><FlatButton \n                label=\"Remove\" \n                onClick={ this.removeEntry.bind(this, this.data.services[i]._id) }\n                />\n              </td>\n            </tr>\n            );\n    }\n    for (var j = 0; j < this.data.services.length; j++) {\n        signInWiths.push(\n            <div key={j}>\n              <FlatButton \n                label={ this.data.services[j].service } \n                id={ this.data.services[j].service + \"Button\" }\n                primary={true}\n                onClick={ this.signInWith.bind(this, this.data.services[j].service) }\n                style={{textAlign: 'left', marginLeft: '20px'}}\n                fullWidth\n                />    \n            </div>\n        );\n    }    \n\n    var systemSyncButtons = [];\n    var dataManagementButtons = [];\n\n    systemSyncButtons.push(<FlatButton \n        label='Clear Local Cache' \n        key='clear'\n        onClick={this.clearLocalCache.bind(this)}\n        style={{textAlign: 'left', marginTop: '40px', marginBottom: '20px'}}\n        fullWidth\n        primary={false} \n    />)\n    systemSyncButtons.push(<FlatButton \n        label='Diagnostics' \n        key='diag'\n        onClick={this.runDiagnostics.bind(this)}\n        style={{textAlign: 'left'}}\n        fullWidth\n        primary={false} \n    />)\n    systemSyncButtons.push(<FlatButton \n        label='Resync Configuration' \n        key='resync'\n        onClick={this.resyncConfiguration.bind(this)}\n        style={{textAlign: 'left'}}\n        fullWidth\n        primary={false} \n    />)\n    systemSyncButtons.push(<FlatButton \n        label=\"Simulate Launch Context\" \n        key='simulate'\n        id=\"simulateLaunchContext\" \n        onClick={this.simulateLaunchContext.bind(this)}\n        style={{textAlign: 'left', marginBottom: '20px'}}\n        fullWidth\n        primary={false} \n    />)\n\n\n    dataManagementButtons.push(<FlatButton \n        key='token'\n        label=\"Fetch Access Token\" \n        id=\"fetchAccessToken\" \n        onClick={this.fetchAccessToken.bind(this)}\n        style={{textAlign: 'left'}}\n        fullWidth\n        primary={false} \n    />)\n    dataManagementButtons.push(<FlatButton \n        key='identity'\n        label=\"Fetch Identity\" \n        id=\"fetchIdentity\" \n        onClick={this.fetchIdentity.bind(this)}\n        style={{textAlign: 'left'}}\n        fullWidth\n        primary={false} \n    />)\n\n    var ccdResources = [];\n\n    if(get(this, 'data.minimongo.AllergyIntolerances')){\n      ccdResources.push(<TableRow key=''>\n        <TableRowColumn>{this.data.minimongo.AllergyIntolerances}</TableRowColumn>\n        <TableRowColumn>Allergies</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.CarePlans')){\n      ccdResources.push(<TableRow key='CarePlans'>\n        <TableRowColumn>{this.data.minimongo.CarePlans}</TableRowColumn>\n        <TableRowColumn>CarePlans</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.Conditions')){\n      ccdResources.push(<TableRow key='Conditions'>\n        <TableRowColumn>{this.data.minimongo.Conditions}</TableRowColumn>\n        <TableRowColumn>Conditions</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.Devices')){\n      ccdResources.push(<TableRow key='Devices'>\n        <TableRowColumn>{this.data.minimongo.Devices}</TableRowColumn>\n        <TableRowColumn>Devices</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.DiagnosticReports')){\n      ccdResources.push(<TableRow key='DiagnosticReports'>\n        <TableRowColumn>{this.data.minimongo.DiagnosticReports}</TableRowColumn>\n        <TableRowColumn>DiagnosticReports</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.Goals')){\n      ccdResources.push(<TableRow key='Goals'>\n        <TableRowColumn>{this.data.minimongo.Goals}</TableRowColumn>\n        <TableRowColumn>Goals</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.ImagingStudies')){\n      ccdResources.push(<TableRow key='ImagingStudies'>\n        <TableRowColumn>{this.data.minimongo.ImagingStudies}</TableRowColumn>\n        <TableRowColumn>ImagingStudies</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.Immunizations')){\n      ccdResources.push(<TableRow key='Immunizations'>\n        <TableRowColumn>{this.data.minimongo.Immunizations}</TableRowColumn>\n        <TableRowColumn>Immunizations</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.Locations')){\n      ccdResources.push(<TableRow key='Locations'>\n        <TableRowColumn>{this.data.minimongo.Locations}</TableRowColumn>\n        <TableRowColumn>Locations</TableRowColumn>\n      </TableRow>);\n    }    \n    if(get(this, 'data.minimongo.Medications')){\n      ccdResources.push(<TableRow key='Medications'>\n        <TableRowColumn>{this.data.minimongo.Medications}</TableRowColumn>\n        <TableRowColumn>Medications</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.MedicationOrders')){\n        ccdResources.push(<TableRow key='MedicationOrders'>\n          <TableRowColumn>{this.data.minimongo.MedicationOrders}</TableRowColumn>\n          <TableRowColumn>Medication Orders</TableRowColumn>\n        </TableRow>);\n      }\n      if(get(this, 'data.minimongo.MedicationStatements')){\n      ccdResources.push(<TableRow key='MedicationStatements'>\n        <TableRowColumn>{this.data.minimongo.MedicationStatements}</TableRowColumn>\n        <TableRowColumn>MedicationStatements</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.Observations')){\n      ccdResources.push(<TableRow key='Observations'>\n        <TableRowColumn>{this.data.minimongo.Observations}</TableRowColumn>\n        <TableRowColumn>Observations</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.Patients')){\n      ccdResources.push(<TableRow key='Patients'>\n        <TableRowColumn>{this.data.minimongo.Patients}</TableRowColumn>\n        <TableRowColumn>Patients</TableRowColumn>\n      </TableRow>);\n    }\n  \n    if(get(this, 'data.minimongo.Persons')){\n      ccdResources.push(<TableRow key='Persons'>\n        <TableRowColumn>{this.data.minimongo.Persons}</TableRowColumn>\n        <TableRowColumn>Persons</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.Practitioners')){\n      ccdResources.push(<TableRow key='Practitioners'>\n        <TableRowColumn>{this.data.minimongo.Practitioners}</TableRowColumn>\n        <TableRowColumn>Practitioners</TableRowColumn>\n      </TableRow>);\n    }            \n    if(get(this, 'data.minimongo.Procedures')){\n      ccdResources.push(<TableRow key='Procedures'>\n        <TableRowColumn>{this.data.minimongo.Procedures}</TableRowColumn>\n        <TableRowColumn>Procedures</TableRowColumn>\n      </TableRow>);\n    }    \n    if(get(this, 'data.minimongo.RelatedPersons')){\n      ccdResources.push(<TableRow key='RelatedPersons'>\n        <TableRowColumn>{this.data.minimongo.RelatedPersons}</TableRowColumn>\n        <TableRowColumn>RelatedPersons</TableRowColumn>\n      </TableRow>);\n    }\n    if(get(this, 'data.minimongo.Sequences')){\n      ccdResources.push(<TableRow key='Sequences'>\n        <TableRowColumn>{this.data.minimongo.Sequences}</TableRowColumn>\n        <TableRowColumn>Sequences</TableRowColumn>\n      </TableRow>);\n    }    \n    let continuityOfCareCard = <div>\n        <GlassCard>\n          <CardTitle title=\"Continuity of Care\" subtitle='Healthcare data is attached to your profile via resources.' />\n          <CardText>\n            <Table  >\n              <TableBody displayRowCheckbox={false} showRowHover={false}>\n                <TableRow style={{fontWeight: 'bold'}}>\n                  <TableRowColumn style={{width: '20%'}}>Count</TableRowColumn>\n                  <TableRowColumn style={{width: '80%'}}>Resource</TableRowColumn>\n                </TableRow>\n                { ccdResources }      \n              </TableBody>\n            </Table>\n          </CardText>\n        </GlassCard>\n        <DynamicSpacer />\n      </div>\n\n    return(\n        \n      <div id=\"ImportChart\">\n        <VerticalCanvas >\n            <Grid>\n                <Row>\n                    <Col md={3}>\n                    <DynamicSpacer />\n                    <GlassCard zDepth={2} >\n                        <CardText>\n                            { systemSyncButtons }\n                            <br />\n                            { signInWiths }                        \n                            <br />\n                            { dataManagementButtons }                        \n                            <br />\n                        </CardText>\n                    </GlassCard>\n                    <DynamicSpacer />\n                    <h3 className='barcode' style={{width: '100%', textAlign: 'center', overflow: 'hidden'}}>{ this.state.accessToken }</h3>\n                    </Col>\n                    <Col mdOffset={1} md={8}>\n                        <DynamicSpacer />\n                        <GlassCard width='768px' zDepth={2} >\n                        <CardTitle\n                            title='1. Search Proxy Patients'                    \n                            subtitle={<span style={{color: 'rgb(38, 166, 154)'}}> { this.state.patientSearchUrl } </span>} />\n                            {/* subtitle={<span style={{color: 'rgb(38, 166, 154)'}}> https://open-ic.epic.com/FHIR/api/FHIR/DSTU2/Patient/Tbt3KuCY0B5PSrJvCu2j-PlK.aiHsu2xUjUM8bWpetXoB </span>} /> */}\n                        <CardText> \n                                {/* <Row>\n                                    <Col md={12}>\n                                        <TextField\n                                            type=\"text\"\n                                            ref=\"name\"\n                                            name=\"name\"\n                                            floatingLabelText=\"Full Name\"\n                                            hintText=\"Jane Doe\"\n                                            floatingLabelFixed={true}\n                                            onChange={ this.updateSearch.bind(this, 'name') } \n                                            fullWidth\n                                        />      \n                                    </Col>\n                                </Row> */}\n                                <Row>\n                                    <Col md={6}>\n                                        <TextField\n                                            type=\"text\"\n                                            ref=\"given\"\n                                            name=\"given\"\n                                            floatingLabelText=\"Given\"\n                                            hintText=\"Jane\"\n                                            floatingLabelFixed={true}\n                                            onChange={ this.updateSearch.bind(this, 'given') } \n                                            fullWidth\n                                        />      \n                                    </Col>\n                                    <Col md={6}>\n                                        <TextField\n                                            type=\"text\"\n                                            ref=\"family\"\n                                            name=\"family\"\n                                            floatingLabelText=\"Family\"\n                                            hintText=\"Doe\"\n                                            floatingLabelFixed={true}\n                                            onChange={ this.updateSearch.bind(this, 'family') } \n                                            fullWidth\n                                        />      \n                                    </Col>                                \n                                </Row>                                \n                                <Row>\n                                    <Col md={4}>\n                                        <TextField\n                                                type=\"text\"\n                                                ref=\"birthdate\"\n                                                name=\"birthdate\"\n                                                floatingLabelText=\"Birthdate\"\n                                                hintText=\"1960-01-01\"\n                                                floatingLabelFixed={true}\n                                                onChange={ this.updateSearch.bind(this, 'birthdate') } \n                                                fullWidth\n                                            />    \n                                    </Col>                            \n                                    <Col md={4}>\n                                        <TextField\n                                            type=\"text\"\n                                            ref=\"gender\"\n                                            name=\"gender\"\n                                            floatingLabelText=\"Gender\"\n                                            hintText=\"female\"\n                                            floatingLabelFixed={true}\n                                            onChange={ this.updateSearch.bind(this, 'gender') } \n                                            fullWidth\n                                        />      \n                                    </Col>\n                                    <Col md={4}>\n                                        <TextField\n                                            type=\"text\"\n                                            ref=\"identifier\"\n                                            name=\"identifier\"\n                                            floatingLabelText=\"Identifier\"\n                                            hintText=\"12345\"\n                                            floatingLabelFixed={true}\n                                            onChange={ this.updateSearch.bind(this, 'identifier') } \n                                            fullWidth\n                                        />      \n                                    </Col>                              \n                                </Row>\n\n\n                        </CardText>\n                        <CardActions>\n                            <FlatButton \n                                label=\"Search\" \n                                id=\"searchPatients\" \n                                onClick={this.searchPatients.bind(this)}\n                                primary={false} />\n                        </CardActions>\n                    </GlassCard>\n                    <DynamicSpacer />\n\n\n                    <GlassCard width='768px' zDepth={2} >\n                        <CardTitle\n                            title='2.  Patient Search Results' \n                            subtitle={<span style={{color: 'rgb(38, 166, 154)'}}> { this.state.baseUrl + '/Patient/' + this.state.patientId } </span>} />\n                            />\n                        <CardText>\n                            <PatientTable\n                                data={ this.data.patients } \n                                showAvatars={false}\n                                showSendButton={false}\n                                onRowClick={ this.selectPatientCallback.bind(this) }\n                                noDataPadding={40}\n                                limit={10}\n                                />\n                        </CardText>\n                        <CardActions>\n                            <FlatButton \n                                label=\"Fetch Patient Data\" \n                                id=\"fetchPatientData\" \n                                onClick={this.fetchPatientData.bind(this)}\n                                style={{textAlign: 'left'}}\n                                primary={false} \n                                />      \n                            <FlatButton \n                                label=\"Save to Profile\" \n                                id=\"savePatientDemographicsToProfile\" \n                                onClick={this.savePatientDemographicsToProfile.bind(this)}\n                                style={{textAlign: 'left'}}\n                                primary={false} \n                            />\n                            <FlatButton \n                                label=\"Fetch Patient Chart\" \n                                id=\"searchObservations\" \n                                onClick={this.searchChart.bind(this)}\n                                style={{textAlign: 'left'}}\n                                primary={false} \n                            />\n                        </CardActions>\n                    </GlassCard>\n                    <DynamicSpacer />\n\n\n\n\n                        <PatientCard\n                            patient={ this.state.patient }   \n                            zDepth={2}                 \n                            />\n                            \n                        { continuityOfCareCard }\n\n\n                        <GlassCard>\n                            <RaisedButton \n                                label=\"Timeline Visualization\" \n                                id=\"timelineVisualizationButton\" \n                                onClick={this.timelineVisualization.bind(this)}\n                                style={{textAlign: 'left'}}\n                                primary={true} \n                                fullWidth\n                                />      \n                        </GlassCard>\n                    </Col>\n                </Row>\n            </Grid>\n\n\n          <DynamicSpacer />\n        </VerticalCanvas>\n      </div>\n    );\n  }\n  timelineVisualization(){\n    browserHistory.push('/timeline-sidescroll')\n  }\n  selectPatientCallback(patientId){\n      // console.log('patientId:', patientId)\n      var newState = this.state;\n      newState.patientId = patientId;\n      this.setState(newState);\n  }\n  editServiceName(field, event, value){\n    //console.log('editclientId', value)\n    var newFormData = this.state.formData;\n    newFormData.serviceName = value;\n\n    this.setState({\n        'formData': newFormData\n    });\n  }\n  editclientId(field, event, value){\n    //console.log('editclientId', value)\n    var newFormData = this.state.formData;\n    newFormData.clientId = value;\n\n    this.setState({\n        'formData': newFormData\n    });\n  }\n  editSecretKey(field, event, value){\n    //console.log('editSecretKey', value)\n\n    var newFormData = this.state.formData;\n    newFormData.secretKey = value;\n    \n    this.setState({\n        'formData': newFormData\n    });\n  }\n  editTargetBaseUrl(field, event, value){\n    //console.log('editTargetBaseUrl', value)\n\n    var newFormData = this.state.formData;\n    newFormData.targetBaseUrl = value;\n    \n    this.setState({\n        'formData': newFormData\n    });\n  }\n  editTargetLoginUrl(field, event, value){\n    //console.log('editTargetLoginUrl', value)\n\n    var newFormData = this.state.formData;\n    newFormData.targetLoginUrl = value;\n    \n    this.setState({\n        'formData': newFormData\n    });\n  }\n  editloginStyle(fipopupeld, event, value){\n    //console.log('editloginStyle - ÃŸ', value)\n    \n    var newFormData = this.state.formData;\n    newFormData.loginStyle = value;\n    \n    this.setState({\n        'formData': newFormData\n    });\n  }\n\n  changeState(field, event, value){\n    const formData = this.state.formData;\n    formData[field] = value;\n    this.setState({\n        formData: formData\n    });\n  }\n  updateBaseUrl(event, value){\n    console.log('updateBaseUrl', event, value)\n\n    var newState = this.state;\n    newState.baseUrl = value;\n\n    this.setState(newState);\n  }\n  \n\n//   autoscan(){\n//       console.log('autoscan')\n//       var self = this;\n\n//       var metadataRoute = Session.get('oauthBaseUrl') + '/metadata' + formatSuffix;\n//       console.log('metadata route', metadataRoute)\n\n//     //   HTTP.get(metadataRoute, { headers: {\n//     //     'Accept': ['application/json', 'application/json+fhir'],\n//     //     'Access-Control-Allow-Origin': '*'\n//     //     }}, function(error, result){\n//     //       if(error){\n//     //           console.log('error', error)\n//     //       }\n//     //       if(result){\n//     //           console.log(result.content);\n//     //           var conformanceStatement = JSON.parse(result.content);\n//     //           console.log('conformanceStatement', conformanceStatement)\n//     //           self.setState({\n//     //               metadata: EJSON.stringify(conformanceStatement, {indent: 2}),\n//     //               conformance: conformanceStatement\n//     //           })\n//     //     }\n//     //   })\n\n//       Meteor.call('metadataAutoscan', Session.get('oauthBaseUrl'), function(error, result){\n//         if(result){\n//             self.setState({\n//                 metadata: EJSON.stringify(result, {indent: 2}),\n//                 conformance: result\n//             })    \n//         }\n//       })\n//   }\n//   clearAutoscan(){\n//     self.setState({\n//         metadata: ''\n//     })\n//   }\n  extractAutoconfigValues(){\n      console.log('extractAutoconfigValues', this.state)\n\n      var newState = {\n        fhirVersion:  get(this, 'state.conformance.fhirVersion'),\n        authorizeUrl:  '',\n        tokenUrl: '',\n        formData: {\n            serviceName: this.state.formData.serviceName,\n            secretKey: this.state.formData.secretKey,\n            loginStyle: this.state.formData.loginStyle,\n            targetBaseUrl: Session.get('oauthBaseUrl'),\n            tokenUrl: this.state.formData.tokenUrl,\n            targetLoginUrl: ''\n        }\n      }\n\n    // json doesn't we don't actually know the ordering of \n    var oauthExtension = get(this, 'state.conformance.rest[0].security.extension[0].extension');\n\n    console.log('oauthExtension', oauthExtension);\n\n    oauthExtension.forEach(function(object){\n        console.log('object', object)\n        if(object.url == \"authorize\") {\n            newState.authorizeUrl = object.valueUri;\n            newState.formData.targetLoginUrl = object.valueUri;\n        }\n        if(object.url == \"token\"){\n            newState.tokenUrl = object.valueUri            \n            newState.formData.tokenUrl = object.valueUri;\n        }\n    });\n\n    console.log('newState', newState)\n    this.setState(newState)\n\n  }\n  saveConfiguration(){\n    console.log('saveConfiguration', this.state);\n\n    var serviceConfig = this.state.formData;\n\n    var credentialRequestCompleteCallback = Accounts.oauth.credentialRequestCompleteHandler(function(error, result){\n        console.log('foo?')\n        console.log('error', error)\n        console.log('result', result)\n        console.log('saveConfiguration!')            \n    });\n\n    serviceConfig.credentialRequestCompleteCallback = credentialRequestCompleteCallback;\n\n    console.log('serviceConfig', serviceConfig)\n    Meteor.call('configureOauthService', serviceConfig, credentialRequestCompleteCallback);\n  }\n  signInWith(serviceName){\n    console.log('*********************************************')\n    console.log('C1.1    Signing in with the following OAuth service:  ', serviceName)\n\n    this.resyncConfiguration();\n\n    var self = this;\n\n    Session.set('oauthService', serviceName);\n\n    var services = ServiceConfiguration.configurations.find().fetch();\n    console.log('C1.2    Checking the existing service configurations in database: ', services);\n\n    services.forEach(function(service){\n        if(service.service === serviceName){\n            console.log('C1.3.1  Found the service configuration', service)\n\n            console.log('C1.3.2  Setting OAuth baseUrl...', service.baseUrl)\n\n            Session.set('oauthBaseUrl', service.baseUrl);\n        }\n    })\n\n    var options = {\n        requestPermissions: [\n            'OBSERVATION.READ', \n            'OBSERVATION.SEARCH', \n            'PATIENT.READ', \n            'PATIENT.SEARCH', \n            'PRACTITIONER.READ', \n            'PRACTITIONER.SEARCH',\n            'patient/*.read',\n            'patient/*.search',\n            'openid',\n            'profile',\n            'user/*.*',\n            'launch',\n            'online_access'            \n        ]\n    }\n\n    console.log('C1.3    Checking service names registered in active server memory', Accounts.oauth.serviceNames());\n\n    var loginSignature = 'loginWith' + serviceName;\n    console.log('C1.4    Building custom login signature required by accounts-oauth: ', loginSignature);\n\n    options.serviceName = serviceName;\n    console.log('C1.5    Building signin options (including custom scope requests): ', options);\n\n    console.log('C1.6    Calling custom login signature.');\n    Meteor[loginSignature].call(options, function(error, result){\n        console.log('C1.7.1  Received a response from our custom login signature.')\n        if(error){\n            console.log('C1.7.2.  error', error)\n        }\n        if(result){\n            console.log('C1.7.2.  result', result)\n        }\n        \n        self.fetchAccessToken(function(){\n            self.savePatientDemographicsToProfile(function(){\n                self.searchChart();    \n            });\n        });\n\n        console.log('C1.7.3. Completed running custom login signature callback.');         \n    });\n  }\n  resyncConfiguration(){\n    console.log('C2.1    Resyncing Configuration')\n    console.log('C2.2    Fetching service names in active server memory', Accounts.oauth.serviceNames());\n    var services = ServiceConfiguration.configurations.find().fetch();\n    console.log('C2.3    Fetching service configurations currently stored in the database', services);\n\n    services.forEach(function(record){\n        Meteor['loginWith' + record.service] = function (options, callback) {\n\n            console.log('C2.4    loginWith' + record.service);\n\n            if (!callback && typeof options === \"function\") {\n              callback = options;\n              options = {};\n\n              if(get(this, 'props.location.query.launch')){\n                  options.launch = get(this, 'props.location.query.launch');\n              }\n            }\n\n            if (_.isUndefined(OAuth2)) {\n              OAuth2 = {\n                  serviceName: ''\n              };\n            }\n\n            OAuth2.serviceName = record.service;        \n            console.log('C2.5    loginWith.OAuth2', OAuth2)\n        \n            var credentialRequestCompleteCallback = Accounts.oauth.credentialRequestCompleteHandler(callback);\n\n            OAuth.requestCredential(options, credentialRequestCompleteCallback);                  \n          };\n    })\n\n    return Meteor.call('resyncConfiguration');\n  }\n  removeEntry(_id){\n    check(_id, String);\n    if(confirm('Remove configuration?')){\n        console.log('removing...', _id)\n\n        //ServiceConfiguration.configurations.remove({_id: _id});\n        Meteor.call('removeService', _id, function(error, result){\n            console.log('removeService[error]', error)\n            console.log('removeService[result]', result)\n        })\n    }\n  }\n  resetServiceConfiguration(){\n    console.log('resetServiceConfiguration')\n  }\n  simulateLaunchContext(){\n    console.log('simulateLaunchContext')\n  }\n  fetchAccessToken(){\n    console.log('C11.1   Fetching access token')\n    var self = this;\n    Meteor.call('fetchAccessToken', Session.get('oauthService'), function(err, result){\n        if(result){\n            console.log('C11.2   Received access token.', result)\n            var newState = self.state;\n            newState.accessToken = result.accessToken;\n            if(result.accessToken){ \n                self.setState(newState)\n                Session.set('accessToken', result.accessToken)\n                self.fetchIdentity();    \n            } else {\n                console.log('No access token found.  Check implementation.')\n            }\n        }\n    })\n  }\n  fetchIdentity(){\n    console.log('C12.1   Fetching patient OAuth identifier.')\n    var self = this;\n    Meteor.call('fetchIdentity', Session.get('oauthService'), function(err, result){\n        if(result){\n            console.log('C12.1   Received patient OAuth identifier.', result)\n            if(result.patient){\n\n                var newState = self.state;\n                newState.patientId = result.patient;\n                self.setState(newState)\n\n                self.fetchPatientData();    \n            }\n        }\n    })      \n  }\n  fetchPatientData(){\n    console.log('C13.0 this.state', this.state)\n    var fetchUrl = Session.get('oauthBaseUrl') + '/Patient/' + this.state.patientId + formatSuffix;\n    console.log('C13.1   Constructing patient data fetch url', fetchUrl)\n    console.log('C13.2   Fetching patient data.')\n\n    var self = this    \n\n    HTTP.get(fetchUrl, {\n        // data: {\n        //   summaryLength: \"500\",\n        //   entryPoint: \"main\"\n        // },\n        headers: {\n            'Authorization': 'Bearer ' + Session.get('accessToken')\n        }\n      }, function(err, result){\n        if(result){\n            console.log('C13.3   Received patient data.',  result)\n\n            var patientData = {};\n            if(result.content){\n                patientData = JSON.parse(result.content);\n                console.log('C13.4   Received patient data.',   patientData)    \n            }\n\n            var newState = self.state;\n            newState.patientData = EJSON.stringify(patientData, {indent: 2});\n            newState.patient = patientData;\n\n            self.setState(newState);\n        }\n        if(err){\n            console.error(err)\n        }\n    })\n  }\n  savePatientDemographicsToProfile(){\n    console.log('savePatientDemographicsToProfile', this.state );\n\n    console.log('Meteor.userId()', Meteor.userId());\n\n    \n    if(get(this, 'state.patient.name[0]')){\n        var humanName = get(this, 'state.patient.name[0]');\n        if (!humanName.text ){\n            humanName.text = humanName.given[0] + '' + humanName.family[0];\n        }\n        Meteor.users.update({_id: Meteor.userId()}, {\n            $set: {\n                'profile.name': humanName\n            }\n        })    \n    }\n    if(get(this, 'state.patient.gender')){\n        var gender = get(this, 'state.patient.gender');\n        switch (gender) {\n            case 'male':          \n                Session.get('gender', 'BabyBlue')          \n                break;\n            case 'female':      \n                Session.get('gender', 'Pink')          \n                break;\n            default:\n                break;\n        }\n    }\n    if(get(this, 'state.patient')){\n\n        var newPatient = this.state.patient;\n\n        // STU3 HumanName mapping\n        var newName = get(newPatient, 'name[0]');\n        newName.family = newName.family[0];\n        newPatient.name = [ newName ]\n        console.log('newPatient', newPatient);\n\n        if(!Patiens.findOne({id: this.state.patient.id})){\n            Patients.insert(newPatient, function(error){\n                if(error) console.log('Patient.insert().error', error)\n            });    \n        }\n    }\n    if(get(this, 'state.patient.address')){\n        var addresses = get(this, 'state.patient.address');\n        addresses.forEach(function(address){\n            if(address.use === \"home\"){\n                Meteor.users.update({_id: Meteor.userId()}, {\n                    $set: {\n                        'profile.locations.home.address': address\n                    }\n                })            \n            }\n        })\n\n    }\n    \n  }\n  updateSearch(field, event, value){\n    const newState = this.state;\n\n    if(field === \"name\"){\n        newState.patientSearch.text = value;\n    }\n    if(field === \"given\"){\n        newState.patientSearch.given = value;\n    }\n    if(field === \"family\"){\n        newState.patientSearch.family = value;\n    }\n    if(field === \"gender\"){\n        newState.patientSearch.gender = value;\n    }\n    if(field === \"birthdate\"){\n        newState.patientSearch.birthdate = value;\n    }\n    if(field === \"identifier\"){\n        newState.patientSearch.identifier = value;\n    }\n    newState.patientSearchUrl = Session.get('oauthBaseUrl') + '/Patient/_search?family=' + this.state.patientSearch.family + '&given=' + this.state.patientSearch.given + '&_format=application/json';\n\n    //console.log('updateSearch.newState', newState)\n    this.setState(newState);\n  }\n  searchPatients(){\n    console.log('this.state.patientSearchUrl', this.state.patientSearchUrl)\n\n    // var self = this;    \n    // var patientId = 'Tbt3KuCY0B5PSrJvCu2j-PlK.aiHsu2xUjUM8bWpetXoB'\n    // console.log('patientId', patientId)\n\n    // var patientSearchUrl = Session.get('oauthBaseUrl') + '/Patient/_search?family=' + this.state.patientSearch.family + '&given=' + this.state.patientSearch.given + '&_format=application/json';\n    // console.log('patientSearchUrl', patientSearchUrl)\n    if(this.state.patientSearchUrl){\n        HTTP.post(this.state.patientSearchUrl, {\n            headers: {\n                'Authorization': 'Bearer ' + this.state.accessToken\n            }\n          }, function(error, result){\n            if(result){\n                console.log('result', result);\n    \n                \n    \n                console.log(JSON.parse(result.content));\n    \n                var responseBundle = JSON.parse(result.content);\n                console.log('responseBundle', responseBundle)\n    \n                if(result.content){\n                    var content = JSON.parse(result.content);\n                    console.log('content', content)                    \n    \n                    if(content.resourceType == \"Bundle\"){\n                        if(content.entry){\n                            var newPatientSearchResults = [];\n                            content.entry.forEach(function(entry){\n                                if(entry.resource && (entry.resource.resourceType == \"Patient\")){\n                                    newPatientSearchResults.push(entry.resource);\n                                }\n                            })\n                            Session.set('patientSearchResults', newPatientSearchResults);\n                        }\n                    }\n                }\n            }\n            if(error){\n                console.error(error)\n    \n                Session.set('patientSearchResults', []);\n            }\n        });\n    } else {\n        Session.set('patientSearchResults', []);        \n    }\n  }\n  searchObservations(){\n    var self = this    \n    var observationUrl = Session.get('oauthBaseUrl') + '/Observation/_search?patient=' + this.state.patientId + '&category=vital-signs' + '&_format=application/json';\n\n    console.log('observationUrl', observationUrl);\n\n    HTTP.post(observationUrl, {\n        headers: {\n            'Authorization': 'Bearer ' + Session.get('accessToken')\n        }\n      }, function(err, result){\n        if(result){\n            //console.log('result', result)\n            console.log(JSON.parse(result.content));\n\n            var bundle = JSON.parse(result.content);\n            console.log('bundle', bundle)\n\n            var observationData = [];\n            if(bundle && bundle.entry){\n                bundle.entry.forEach(function(resource){\n                    observationData.push(resource.resource)\n                });    \n            }\n\n            console.log('observationData', observationData)\n            var newState = self.state;\n\n            //newState.observationData = EJSON.stringify(observationData, {indent: 2});\n            newState.observations = observationData;\n\n            console.log('newState', newState)\n\n            self.setState(newState)\n        }\n        if (err){\n            console.log('error', err)\n        }\n    });\n  }\n  runDiagnostics(){\n    console.log('***********************************************************************')\n    console.log('Running diagnostics....');\n    console.log('')\n    console.log('ImportChart.state', this.state);\n    console.log('Accounts.oauth.serviceNames', Accounts.oauth.serviceNames());\n    console.log('oauthBaseUrl', Session.get('oauthBaseUrl'))\n    console.log('accessToken', Session.get('accessToken'))\n    console.log('process.env.NODE_ENV', Session.get('accessToken'))\n    console.log('Meteor', Meteor);\n\n    var services = ServiceConfiguration.configurations.find().fetch();\n    console.log('ServiceConfiguration', services);\n\n    Meteor.call('runOAuthDiagnostics');\n\n    console.log('***********************************************************************')\n  }\n  clearLocalCache(){\n    if(confirm(\"Are you absolutely sure?\")){\n\n      var resourceTypes = [\n        'AllergyIntolerances',\n        'CarePlans',\n        'Conditions',\n        'Devices',\n        'DiagnosticReports',\n        'Goals',\n        'Immunizations',\n        'Medications',\n        'MedicationOrders',\n        'MedicationStatements',\n        'Organizations',\n        'Observations',\n        'Practitioners',\n        'Procedures',\n        'RiskAssessments'\n      ];\n\n      resourceTypes.forEach(function(resourceType){\n        if(Mongo.Collection.get(resourceType)){\n          Mongo.Collection.get(resourceType).find().forEach(function(record){\n            Mongo.Collection.get(resourceType)._collection.remove({_id: record._id})\n          })\n        }\n      })\n    }\n  }\n  searchChart(){\n    var self = this    \n    var patientId = this.state.patientId;\n\n    // Allergies\n    var allergiesUrl = Session.get('oauthBaseUrl') + '/AllergyIntolerance/_search?patient=' + patientId + '&_format=application/json';\n    console.log('allergiesUrl', allergiesUrl);\n    HTTP.post(allergiesUrl, { headers: {\n        'Authorization': 'Bearer ' + Session.get('accessToken')\n    }}, function(err, result){\n        if(result){\n            var bundle = JSON.parse(result.content);\n            if(bundle && bundle.entry){\n                bundle.entry.forEach(function(pointer){\n                    console.log('AllergyIntolerance', pointer)\n                    if(pointer.fullUrl){\n                        HTTP.get(pointer.fullUrl + '?_format=application/json', { headers: {\n                            'Authorization': 'Bearer ' + Session.get('accessToken')\n                        }}, function(err, redirectResult){\n                            if(redirectResult && redirectResult.content){\n                                console.log('AllergyIntolerance.redirectResult', redirectResult)\n                                var resource = JSON.parse(redirectResult.content);\n                                if (resource.resourceType === \"AllergyIntolerance\"){\n                                    AllergyIntolerances._collection.insert(resource, function(error, result){\n                                        if(error){\n                                            console.log('AllergyIntolerances.insert.error', error)\n                                        }\n                                        if(result){\n                                            console.log('AllergyIntolerances.insert.result', result)\n                                        }\n                                    })\n                                }\n                            } else {\n                                console.log(\"redirect didn't have content\")\n                            }\n                            if (err){ console.log('error', err) }\n                        });    \n                    }\n                });    \n            }\n        }\n        if (err){ console.log('error', err) }\n    });\n\n    // Observations\n    var observationUrl = Session.get('oauthBaseUrl') + '/Observation/_search?patient=' + patientId + '&category=vital-signs' + '&_format=application/json';\n    console.log('observationUrl', observationUrl);\n    HTTP.post(observationUrl, { headers: {\n        'Authorization': 'Bearer ' + Session.get('accessToken')\n    }}, function(err, result){\n        if(result){\n            var bundle = JSON.parse(result.content);\n            if(bundle && bundle.entry){\n                bundle.entry.forEach(function(pointer){\n                    console.log('Observation', pointer)\n                    if(pointer.fullUrl){\n                        HTTP.get(pointer.fullUrl + '?_format=application/json', { headers: {\n                            'Authorization': 'Bearer ' + Session.get('accessToken')\n                        }}, function(err, redirectResult){\n                            if(redirectResult && redirectResult.content){\n                                console.log('Observation.redirectResult', redirectResult)\n                                var resource = JSON.parse(redirectResult.content);\n                                if (resource.resourceType === \"Observation\"){\n                                    Observations._collection.insert(resource, function(error, result){\n                                        if(error){\n                                            console.log('Observations.insert.error', error)\n                                        }\n                                        if(result){\n                                            console.log('Observations.insert.result', result)\n                                        }\n                                    })\n                                }\n                            } else {\n                                console.log(\"redirect didn't have content\")\n                            }\n                            if (err){ console.log('error', err) }\n                        });    \n                    }\n                });    \n            }\n        }\n        if (err){ console.log('error', err) }\n    });\n\n\n    // CarePlans\n    var carePlansUrl = Session.get('oauthBaseUrl') + '/CarePlan/_search?patient=' + patientId + '&_format=application/json';\n    console.log('carePlansUrl', carePlansUrl);\n    HTTP.post(carePlansUrl, { headers: {\n        'Authorization': 'Bearer ' + Session.get('accessToken')\n    }}, function(err, result){\n        if(result){\n            var bundle = JSON.parse(result.content);\n            if(bundle && bundle.entry){\n                bundle.entry.forEach(function(pointer){\n                    console.log('CarePlan', pointer)\n                    if(pointer.fullUrl){\n                        HTTP.get(pointer.fullUrl + '?_format=application/json', { headers: {\n                            'Authorization': 'Bearer ' + Session.get('accessToken')\n                        }}, function(err, redirectResult){\n                            if(redirectResult && redirectResult.content){\n                                console.log('CarePlan.redirectResult', redirectResult)\n                                var resource = JSON.parse(redirectResult.content);\n                                if (resource.resourceType === \"CarePlan\"){\n                                    CarePlans._collection.insert(resource, function(error, result){\n                                        if(error){\n                                            console.log('CarePlans.insert.error', error)\n                                        }\n                                        if(result){\n                                            console.log('CarePlans.insert.result', result)\n                                        }\n                                    })\n                                }\n                            } else {\n                                console.log(\"redirect didn't have content\")\n                            }\n                            if (err){ console.log('error', err) }\n                        });    \n                    }\n                });    \n            }\n        }\n        if (err){ console.log('error', err) }\n    });\n\n\n    // Condition\n    var conditionUrl = Session.get('oauthBaseUrl') + '/Condition/_search?patient=' + patientId + '&_format=application/json';\n    console.log('conditionUrl', conditionUrl);\n    HTTP.post(conditionUrl, { headers: {\n        'Authorization': 'Bearer ' + Session.get('accessToken')\n    }}, function(err, result){\n        if(result){\n            var bundle = JSON.parse(result.content);\n            if(bundle && bundle.entry){\n                bundle.entry.forEach(function(pointer){\n                    console.log('Condition', pointer)\n                    if(pointer.fullUrl){\n                        HTTP.get(pointer.fullUrl + '?_format=application/json', { headers: {\n                            'Authorization': 'Bearer ' + Session.get('accessToken')\n                        }}, function(err, redirectResult){\n                            if(redirectResult && redirectResult.content){\n                                console.log('Condition.redirectResult', redirectResult)\n                                var resource = JSON.parse(redirectResult.content);\n                                if (resource.resourceType === \"Condition\"){\n                                    Conditions._collection.insert(resource, function(error, result){\n                                        if(error){\n                                            console.log('Conditions.insert.error', error)\n                                        }\n                                        if(result){\n                                            console.log('Conditions.insert.result', result)\n                                        }\n                                    })\n                                }\n                            } else {\n                                console.log(\"redirect didn't have content\")\n                            }\n                            if (err){ console.log('error', err) }\n                        });    \n                    }\n                });    \n            }\n        }\n        if (err){ console.log('error', err) }\n    });\n\n\n    // Device\n    var deviceUrl = Session.get('oauthBaseUrl') + '/Device/_search?patient=' + patientId + '&category=vital-signs' + '&_format=application/json';\n    console.log('deviceUrl', deviceUrl);\n    HTTP.post(deviceUrl, { headers: {\n        'Authorization': 'Bearer ' + Session.get('accessToken')\n    }}, function(err, result){\n        if(result){\n            var bundle = JSON.parse(result.content);\n            if(bundle && bundle.entry){\n                bundle.entry.forEach(function(pointer){\n                    console.log('Device', pointer)\n                    if(pointer.fullUrl){\n                        HTTP.get(pointer.fullUrl + '?_format=application/json', { headers: {\n                            'Authorization': 'Bearer ' + Session.get('accessToken')\n                        }}, function(err, redirectResult){\n                            if(redirectResult && redirectResult.content){\n                                console.log('Device.redirectResult', redirectResult)\n                                var resource = JSON.parse(redirectResult.content);\n                                if (resource.resourceType === \"Device\"){\n                                    Devices._collection.insert(resource, function(error, result){\n                                        if(error){\n                                            console.log('Devices.insert.error', error)\n                                        }\n                                        if(result){\n                                            console.log('Devices.insert.result', result)\n                                        }\n                                    })\n                                }\n                            } else {\n                                console.log(\"redirect didn't have content\")\n                            }\n                            if (err){ console.log('error', err) }\n                        });    \n                    }\n                });    \n            }\n        }\n        if (err){ console.log('error', err) }\n    });\n\n\n    // DiagnosticReport\n    var diagnosticResourceUrl = Session.get('oauthBaseUrl') + '/DiagnosticReport/_search?patient=' + patientId + '&_format=application/json';\n    console.log('diagnosticResourceUrl', diagnosticResourceUrl);\n    HTTP.post(diagnosticResourceUrl, { headers: {\n        'Authorization': 'Bearer ' + Session.get('accessToken')\n    }}, function(err, result){\n        if(result){\n            var bundle = JSON.parse(result.content);\n            // console.log('diagnosticResource.bundle', bundle)\n\n            if(bundle.total > 0){\n                if(bundle && bundle.entry){\n                    bundle.entry.forEach(function(resource){\n                        console.log('DiagnosticReport', resource.resource)\n                        Mongo.Collection.get('DiagnosticReports')._collection.insert(resource.resource);\n                    });    \n                }    \n            }\n\n        }\n        if (err){ console.log('error', err) }\n    });\n\n\n    // Goal\n    var goalUrl = Session.get('oauthBaseUrl') + '/Goal/_search?patient=' + patientId + '&_format=application/json';\n    console.log('goalUrl', goalUrl);\n    HTTP.post(goalUrl, { headers: {\n        'Authorization': 'Bearer ' + Session.get('accessToken')\n    }}, function(err, result){\n        if(result){\n            var bundle = JSON.parse(result.content);\n            if(bundle && bundle.entry){\n                bundle.entry.forEach(function(pointer){\n                    console.log('Goal', pointer)\n                    if(pointer.fullUrl){\n                        HTTP.get(pointer.fullUrl + '?_format=application/json', { headers: {\n                            'Authorization': 'Bearer ' + Session.get('accessToken')\n                        }}, function(err, redirectResult){\n                            if(redirectResult && redirectResult.content){\n                                console.log('Goal.redirectResult', redirectResult)\n                                var resource = JSON.parse(redirectResult.content);\n                                if (resource.resourceType === \"Goal\"){\n                                    Goals._collection.insert(resource, function(error, result){\n                                        if(error){\n                                            console.log('Goals.insert.error', error)\n                                        }\n                                        if(result){\n                                            console.log('Goals.insert.result', result)\n                                        }\n                                    })\n                                }\n                            } else {\n                                console.log(\"redirect didn't have content\")\n                            }\n                            if (err){ console.log('error', err) }\n                        });    \n                    }\n                });    \n            }\n        }\n        if (err){ console.log('error', err) }\n    });\n\n\n    // Immunization\n    var immunizationUrl = Session.get('oauthBaseUrl') + '/Immunization/_search?patient=' + patientId + '&_format=application/json';\n    console.log('immunizationUrl', immunizationUrl);\n    HTTP.post(immunizationUrl, { headers: {\n        'Authorization': 'Bearer ' + Session.get('accessToken')\n    }}, function(err, result){\n        if(result){\n            var bundle = JSON.parse(result.content);\n            if(bundle && bundle.entry){\n                bundle.entry.forEach(function(pointer){\n                    console.log('Immunization', pointer)\n                    if(pointer.fullUrl){\n                        HTTP.get(pointer.fullUrl + '?_format=application/json', { headers: {\n                            'Authorization': 'Bearer ' + Session.get('accessToken')\n                        }}, function(err, redirectResult){\n                            if(redirectResult && redirectResult.content){\n                                console.log('Immunization.redirectResult', redirectResult)\n                                var resource = JSON.parse(redirectResult.content);\n                                if (resource.resourceType === \"Immunization\"){\n                                    Immunizations._collection.insert(resource, function(error, result){\n                                        if(error){\n                                            console.log('Immunizations.insert.error', error)\n                                        }\n                                        if(result){\n                                            console.log('Immunizations.insert.result', result)\n                                        }\n                                    })\n                                }\n                            } else {\n                                console.log(\"redirect didn't have content\")\n                            }\n                            if (err){ console.log('error', err) }\n                        });    \n                    }\n                });    \n            }\n        }\n        if (err){ console.log('error', err) }\n    });\n\n\n    // Medication\n    var medicationUrl = Session.get('oauthBaseUrl') + '/Medication/_search?patient=' + patientId + '&_format=application/json';\n    console.log('medicationUrl', medicationUrl);\n    HTTP.post(medicationUrl, { headers: {\n        'Authorization': 'Bearer ' + Session.get('accessToken')\n    }}, function(err, result){\n        console.log('medication.result', result)\n        if(result){\n            var bundle = JSON.parse(result.content);\n            if(bundle && bundle.entry){\n                bundle.entry.forEach(function(resource){\n                    console.log('Medication', resource.resource)\n                    Mongo.Collection.get('Medications')._collection.insert(resource.resource);\n                });    \n            }\n        }\n        if (err){ console.log('error', err) }\n    });\n\n\n    // MedicationOrder\n    var medicationOrderUrl = Session.get('oauthBaseUrl') + '/MedicationOrder/_search?patient=' + patientId + '&category=vital-signs' + '&_format=application/json';\n    console.log('medicationOrderUrl', medicationOrderUrl);\n    HTTP.post(medicationOrderUrl, { headers: {\n        'Authorization': 'Bearer ' + Session.get('accessToken')\n    }}, function(err, result){\n        if(result){\n            var bundle = JSON.parse(result.content);\n            if(bundle && bundle.entry){\n                bundle.entry.forEach(function(pointer){\n                    console.log('MedicationOrder', pointer)\n                    if(pointer.fullUrl){\n                        HTTP.get(pointer.fullUrl + '?_format=application/json', { headers: {\n                            'Authorization': 'Bearer ' + Session.get('accessToken')\n                        }}, function(err, redirectResult){\n                            if(redirectResult && redirectResult.content){\n                                console.log('MedicationOrder.redirectResult', redirectResult)\n                                var resource = JSON.parse(redirectResult.content);\n                                if (resource.resourceType === \"MedicationOrder\"){\n                                    MedicationOrders._collection.insert(resource, function(error, result){\n                                        if(error){\n                                            console.log('MedicationOrders.insert.error', error)\n                                        }\n                                        if(result){\n                                            console.log('MedicationOrders.insert.result', result)\n                                        }\n                                    })\n                                }\n                            } else {\n                                console.log(\"redirect didn't have content\")\n                            }\n                            if (err){ console.log('error', err) }\n                        });    \n                    }\n                });    \n            }\n        }\n        if (err){ console.log('error', err) }\n    });\n\n\n    // // Organization\n    // var organizationUrl = Session.get('oauthBaseUrl') + '/Organization/_search?patient=' + patientId + '&_format=application/json';\n    // console.log('organizationUrl', organizationUrl);\n    // HTTP.post(organizationUrl, { headers: {\n    //     'Authorization': 'Bearer ' + Session.get('accessToken')\n    // }}, function(err, result){\n    //     if(result){\n    //         var bundle = JSON.parse(result.content);\n    //         if(bundle && bundle.entry){\n    //             bundle.entry.forEach(function(resource){\n    //                 console.log('Organization', resource.resource)\n    //                 Mongo.Collection.get('Organizations').insert(resource.resource);\n    //             });    \n    //         }\n    //     }\n    //     if (err){ console.log('error', err) }\n    // });\n\n\n    // // Practitioner\n    // var practitionerUrl = Session.get('oauthBaseUrl') + '/Practitioner/_search?patient=' + patientId + '&category=vital-signs' + '&_format=application/json';\n    // console.log('practitionerUrl', practitionerUrl);\n    // HTTP.post(practitionerUrl, { headers: {\n    //     'Authorization': 'Bearer ' + Session.get('accessToken')\n    // }}, function(err, result){\n    //     if(result){\n    //         var bundle = JSON.parse(result.content);\n    //         if(bundle && bundle.entry){\n    //             bundle.entry.forEach(function(resource){\n    //                 console.log('Practitioner', resource)\n    //                 Mongo.Collection.get('Practitioners').insert(resource);\n    //             });    \n    //         }\n    //     }\n    //     if (err){ console.log('error', err) }\n    // });\n\n\n    // Procedure\n    var procedureUrl = Session.get('oauthBaseUrl') + '/Procedure/_search?patient=' + patientId + '&category=vital-signs' + '&_format=application/json';\n    console.log('procedureUrl', procedureUrl);\n    HTTP.post(procedureUrl, { headers: {\n        'Authorization': 'Bearer ' + Session.get('accessToken')\n    }}, function(err, result){\n        if(result){\n            var bundle = JSON.parse(result.content);\n            if(bundle && bundle.entry){\n                bundle.entry.forEach(function(pointer){\n                    console.log('Procedure', pointer)\n                    if(pointer.fullUrl){\n                        HTTP.get(pointer.fullUrl + '?_format=application/json', { headers: {\n                            'Authorization': 'Bearer ' + Session.get('accessToken')\n                        }}, function(err, redirectResult){\n                            if(redirectResult && redirectResult.content){\n                                console.log('Procedure.redirectResult', redirectResult)\n                                var resource = JSON.parse(redirectResult.content);\n                                if (resource.resourceType === \"Procedure\"){\n                                    Procedures._collection.insert(resource, function(error, result){\n                                        if(error){\n                                            console.log('Procedures.insert.error', error)\n                                        }\n                                        if(result){\n                                            console.log('Procedures.insert.result', result)\n                                        }\n                                    })\n                                }\n                            } else {\n                                console.log(\"redirect didn't have content\")\n                            }\n                            if (err){ console.log('error', err) }\n                        });    \n                    }\n                });    \n            }\n        }\n        if (err){ console.log('error', err) }\n    });\n    \n  }\n  cacheObservations(){\n    console.log('cacheObservations', this.state.observations);\n    \n    if(this.state.observations.length > 0){\n        this.state.observations.forEach(function(observation){\n            Observations._collection.insert(observation, function(error){\n                if(error) console.error(error)\n            });\n        })\n    }\n  }\n}\n\n/**\n * Determine if a user originates from an oauth2 login.\n * @param user\n * @returns {*}\n */\nfunction isOAuth2User(user) {\n    return get(user, 'services.OAuth2Server');\n}\n  \n/**\n * Get the user access token if it exists.\n * @returns {*}\n */\nfunction getUserAccessToken() {\n    var user = Meteor.user();\n\n    if (!isOAuth2User(user)) {\n        return;\n    }\n\n    return user.services.OAuth2Server.accessToken;\n}\n\n\nReactMixin(ImportChart.prototype, ReactMeteorData);\nexport default ImportChart;","// Here's the OAuth/protected FHIR server: https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut, \n// Its Conformance statement is here: https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut/metadata \n// And its authorize endpoint: https://open-ic.epic.com/FHIR/oauth2/authorize\n// ARGONAUT/ARGONAUT\n// https://guide.meteor.com/accounts.html#oauth-calling-api  \n\n\n//====================================\n// Client Config\n//\n// Epic\n// 2098c6e8-57c3-6b87-a5f2-8712d49365f9\n// https://open-ic.epic.com/argonaut/api/FHIR/Argonaut/\n// https://open-ic.epic.com/FHIR/oauth2/authorize\n\n\n// Not sure how functional the following sandbox is\n// https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut/\n\n// username:  fhirjson\n// password:  epicepic1\n\n// http://motorcycleguy.blogspot.com/2015/09/my-fhir-json-xml-converter-in.html\n// https://github.com/kwboone/FHIR-JSON-to-XML-Converter/blob/master/FHIR%20JSON%20to%20XML%20Converter/src/FHIRConverterBody.js\n\n\n\n\n\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\n\nimport { VerticalCanvas, GlassCard, DynamicSpacer } from 'meteor/clinical:glass-ui';\nimport { CardHeader, CardText, CardTitle, CardActions, TextField, Toggle, Paper, FlatButton, RaisedButton } from 'material-ui';\nimport { Grid, Row, Col, Table } from 'react-bootstrap';\nimport { ReactiveVar } from 'meteor/reactive-var';\n\nimport { Promise } from 'meteor/promise';\nimport { Meteor } from 'meteor/meteor';\nimport { Session } from 'meteor/session';\nimport { HTTP } from 'meteor/http';\n\nimport { PatientDetail, PatientTable, PatientCard } from 'meteor/clinical:hl7-resource-patient';\nimport { ObservationsTable } from 'meteor/clinical:hl7-resource-observation';\n\nimport { get } from 'lodash';\n\n\n\n\nvar getUserIdResult = new ReactiveVar(null);\nvar getUserData = new ReactiveVar(null);\nvar getPatientData = new ReactiveVar(null);\nlet formatSuffix = '?_format=application/json';\n\nSession.setDefault('patientSearchResults', [])\nSession.setDefault('oauthService', '')\nSession.setDefault('accessToken', '')\n\nconst defaultOAuthState = {\n    conformance: {},\n    fhirVersion: '',\n    formData: {\n      serviceName: 'SmartOnFhir',\n      clientId: '',\n      secretKey: '',\n      targetBaseUrl: '',\n      targetLoginUrl: '',\n      tokenUrl: '',\n      loginStyle: 'popup'\n    },\n    autoscan: '',\n    metadata: '',\n    baseUrl: 'https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut',\n    authorizeUrl: '',\n    tokenUrl: '',\n    patientSearch: {\n        text: '',\n        given: '', \n        family: '',\n        gender: '',\n        birthdate: '',\n        identifier: ''\n    },\n    accessToken: '',\n    patientData: '',\n    patient: {},\n    observations: [],\n    patients: []\n};\n\nexport class OAuthClientPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = defaultOAuthState;\n  }\n  componentDidMount() {\n      this.setState(defaultOAuthState);\n  }\n  getMeteorData() {\n\n    let data = {\n      style: {},\n      state: defaultOAuthState,\n      services: [],\n      patients: []\n    };\n\n    if(ServiceConfiguration){\n        data.services = ServiceConfiguration.configurations.find().fetch()\n    }   \n\n    if(Session.get('patientSearchResults').length > 0){\n        data.patients = Session.get('patientSearchResults');\n\n    }\n\n\n\n    // data.state.formData.clientId: get(Meteor, 'settings.private.oAuth.epic.clientId');\n    // data.state.formData.secretKey: get(Meteor, 'settings.private.oAuth.epic.secretKey');\n    // data.state.formData.clientId: get(Meteor, 'settings.private.oAuth.google.clientId');\n    // data.state.formData.secretKey: get(Meteor, 'settings.private.oAuth.google.secretKey');\n\n    data.state.userAccessToken = getUserAccessToken();\n    data.state.userIdResult = getUserIdResult.get();\n    data.state.userOAuth2Id = get(Meteor.user(), 'services.OAuth2Server.id');\n    data.state.userData = EJSON.stringify(getUserData.get(), {indent: 2});\n    data.state.patientData = EJSON.stringify(getPatientData.get(), {indent: 2});\n\n    return data;\n  }\n  render(){\n    let baseUrl = Meteor.absoluteUrl();\n    let path = \"_oauth/\" + this.state.formData.serviceName;\n    let oAuthPath = baseUrl + path;\n    let serviceName = this.state.formData.serviceName;\n    let accessToken = this.state.accessToken;\n    let tableRows = [];\n    let signInWiths = [];\n\n    for (var i = 0; i < this.data.services.length; i++) {\n        tableRows.push(\n            <tr key={i} className=\"servicesRow\" style={{cursor: \"pointer\"}}>\n\n              <td className='service' style={{minWidth: '100px', paddingTop: '16px'}}>{this.data.services[i].service }</td>\n              <td className='clientId' style={this.data.style.cell}>{this.data.services[i].clientId }</td>\n              <td className='secret' style={this.data.style.cell}>{this.data.services[i].secret}</td>\n              <td className='baseUrl' style={this.data.style.cell}>{this.data.services[i].baseUrl}<br/>{this.data.services[i].loginUrl}</td>\n              {/* <td className='pluginStyle' style={this.data.style.cell}>{this.data.services[i].pluginStyle}</td> */}\n              <td className='removeBtn' style={this.data.style.cell}><FlatButton \n                label=\"Remove\" \n                onClick={ this.removeEntry.bind(this, this.data.services[i]._id) }\n                />\n              </td>\n            </tr>\n            );\n    }\n    for (var j = 0; j < this.data.services.length; j++) {\n        signInWiths.push(\n            <div key={j}>\n              <RaisedButton \n                label={ 'Sign in with ' + this.data.services[j].service } \n                id={ this.data.services[j].service + \"Button\" }\n                primary={true}\n                onClick={ this.signInWith.bind(this, this.data.services[j].service) }\n                fullWidth\n                />    \n                <br />\n                <br />\n            </div>\n        );\n    }    \n\n    return(\n        \n      <div id=\"OAuthClientPage\">\n        <VerticalCanvas >\n\n\n            <GlassCard width='768px' zDepth={2} >\n                <CardTitle\n                    title='0.  Autoscan FHIR Server'\n                    subtitle='The following button will scan a FHIR Server and autodetect and configure the OAuth connection, based on the FHIR conformance statement located at <code>/metadata</code>' />\n                <CardText>\n                    <Grid>\n                        <Row>\n                            <Col md={6}>\n                                <TextField\n                                    type=\"text\"\n                                    ref=\"url\"\n                                    name=\"url\"\n                                    floatingLabelText=\"Base Url\"\n                                    hintText=\"https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut/\"\n                                    defaultValue={ this.state.baseUrl }\n                                    onChange={ this.updateBaseUrl.bind(this) }\n                                    fullWidth\n                                />      \n                           </Col>\n                        </Row>\n                        <Row>\n                            <Col md={12}>\n                                <pre style={{ overflowY: 'scroll', height: '250px' }}>\n                                    { this.state.metadata }\n                                </pre>\n                            </Col>\n                        </Row>\n                    </Grid>                    \n                </CardText>\n                <CardActions>\n                    <FlatButton \n                        label=\"Autoscan\" \n                        id=\"autoscanButton\" \n                        onClick={ this.autoscan.bind(this) }\n                        primary={false} />\n                </CardActions>\n            </GlassCard>\n            <DynamicSpacer />\n\n\n\n            <GlassCard width='768px' zDepth={2} >\n                <CardTitle\n                    title='1.  Autoconfig Values'\n                    subtitle='' />\n                <CardText>\n                    <Grid>\n                        <Row>\n                            <Col md={5}>\n                                <TextField\n                                    type=\"tokenUrl\"\n                                    ref=\"tokenUrl\"\n                                    name=\"tokenUrl\"\n                                    floatingLabelText=\"Token\"\n                                    hintText=\"https://open-ic.epic.com/Argonaut/oauth2/token\"\n                                    floatingLabelFixed={true}\n                                    value={ this.state.tokenUrl }\n                                    fullWidth\n                                />      \n                           </Col>\n                            <Col md={5}>\n                                <TextField\n                                    type=\"authorizeUrl\"\n                                    ref=\"authorizeUrl\"\n                                    name=\"authorizeUrl\"\n                                    floatingLabelText=\"Authorize\"\n                                    hintText=\"https://open-ic.epic.com/Argonaut/oauth2/authorize\"\n                                    floatingLabelFixed={true}\n                                    value={ this.state.authorizeUrl }\n                                    fullWidth\n                                />      \n                            </Col>\n                            <Col md={2}>\n                                <TextField\n                                    type=\"fhirVersion\"\n                                    ref=\"fhirVersion\"\n                                    name=\"fhirVersion\"\n                                    floatingLabelText=\"FhirVersion\"\n                                    hintText=\"1.0.2\"\n                                    floatingLabelFixed={true}\n                                    value={ this.state.fhirVersion }\n                                    fullWidth\n                                />      \n                            </Col>\n                        </Row>\n                    </Grid>\n                               \n                </CardText>\n                <CardActions>\n                    <FlatButton \n                        label=\"Autoconfig Values\" \n                        id=\"autoscanButton\" \n                        onClick={ this.extractAutoconfigValues.bind(this) }\n                        primary={false} />\n                    \n                </CardActions>\n            </GlassCard>\n            <DynamicSpacer />            \n\n\n\n           <GlassCard width='768px' zDepth={2} >\n                <CardTitle\n                    title='2.  Name this Service'\n                    subtitle='Who are you signing a Business Associate Agreement with?  Who operates this OAuth server?'\n                />\n                <CardText>\n                    <Grid>\n                        <Row>\n                            <Col md={6}>\n                                <TextField\n                                    type=\"service\"\n                                    ref=\"service\"\n                                    name=\"service\"\n                                    floatingLabelText=\"Service Name\"\n                                    hintText=\"epic, facebook, google, twitter, OAuth2Server, FhirVault, SmartOnFhir, etc\"\n                                    floatingLabelFixed={true}\n                                    onChange={ this.editServiceName.bind(this, 'serviceName')}\n                                    defaultValue='SmartOnFhir'\n                                    fullWidth\n                                />      \n                           </Col>\n                        </Row>\n                    </Grid>\n                </CardText>\n            </GlassCard>\n            <DynamicSpacer />\n\n\n          <GlassCard width='768px' zDepth={2}>\n\n            <CardTitle\n                title='3. Register This App With Resource Provider' />\n            <CardText>\n                <p>\n                    If you operate the AuthenticationServer, you can add a client by directly editing it's database.  In a production environment, this entry would be generated by an admin console or a client API KeyRequestPage. \n                </p>\n                <p>\n                If you do not operate the resource owner, then you must contact the service in some way to get the keys.  This step may require business agreements, online registration, agreement to terms and services, license or subscription fees, service level agreements, background checks, insurance policies, security audits, and other technical due diligence.  \n                </p>\n                <p>\n                   When ready, the AuthenticationServer will need the following Redirect URI.  This URI is environment specific.  If you deploy to staging, testing, production, etc. you will need to update this URI on the Authorization Server, or you will need to create a second app.   \n                </p>\n\n                <h3 style={{width: '100%', textAlign: 'center'}}>{oAuthPath}</h3>\n            </CardText>\n          </GlassCard>\n        <DynamicSpacer />\n\n\n          <GlassCard width='768px' zDepth={2} >\n            <CardTitle\n                title='4.  Configure This Application' \n                subtitle={<a href=\"https://github.com/meteor/meteor/wiki/OAuth-for-mobile-Meteor-clients#loginStyle-vepopuprsus-redirect-flow\">OAuth for mobile Meteor clients</a>}\n                />\n            <CardText>\n                    <Row>\n                        <Col md={6}>\n                            <TextField\n                                type=\"text\"\n                                ref=\"serviceName\"\n                                name=\"akyKey\"\n                                floatingLabelText=\"Service Name\"\n                                floatingLabelFixed={true}\n                                hintText=\"facebook, github, epic, etc.\"\n                                onChange={ this.editServiceName.bind(this, 'serviceName')}\n                                value={ this.state.formData.serviceName }\n                                fullWidth\n                            />       \n                            <TextField\n                                type=\"text\"\n                                ref=\"clientId\"\n                                name=\"akyKey\"\n                                floatingLabelText=\"API Key (ClientID)\"\n                                floatingLabelFixed={true}\n                                hintText=\"2dd874fc-94a4-45f3-9acb-b3d865f82b54\"\n                                onChange={ this.editclientId.bind(this, 'clientId')}\n                                fullWidth\n                            />       \n\n                            <TextField\n                                type=\"text\"\n                                ref=\"secretKey\"\n                                name=\"secretKey\"\n                                floatingLabelText=\"Secret Key\"\n                                floatingLabelFixed={true}\n                                hintText={ this.state.formData.secretKey }\n                                defaultValue={ this.state.formData.secretKey }\n                                onChange={ this.editSecretKey.bind(this, 'secretKey') }\n                                fullWidth\n                            />       \n                        </Col>\n                        <Col md={6}>\n                            <TextField\n                                type=\"text\"\n                                ref=\"targetBaseUrl\"\n                                name=\"targetBaseUrl\"\n                                floatingLabelText=\"Target Base URL\"\n                                floatingLabelFixed={true}\n                                hintText=\"http://localhost:3100\"\n                                onChange={ this.editTargetBaseUrl.bind(this, 'targetBaseUrl') }\n                                value={ this.state.formData.targetBaseUrl }\n                                fullWidth\n                            />       \n                            <TextField\n                                type=\"text\"\n                                ref=\"targetLoginUrl\"\n                                name=\"targetLoginUrl\"\n                                floatingLabelText=\"Target Login URL\"\n                                floatingLabelFixed={true}\n                                hintText=\"http://localhost:3100/oauth\"\n                                onChange={ this.editTargetLoginUrl.bind(this, 'targetLoginUrl') }\n                                value={ this.state.formData.targetLoginUrl }\n                                fullWidth\n                            />       \n                            <br />\n                            <br />\n                            <Toggle\n                                label=\"loginStyle\"\n                                ref=\"loginStyle\"\n                                name=\"loginStyle\"\n                                labelPosition=\"right\"\n                                defaultToggled={true}\n                                onChange={ this.editloginStyle.bind(this, 'loginStyle')}\n                                style={{float: 'right'}}\n                            />\n                        </Col>\n                    </Row>\n                </CardText>\n                <CardActions>\n                    <FlatButton \n                            label=\"Save Configuration\" \n                            id=\"saveConfigurationButton\" \n                            onClick={ this.saveConfiguration.bind(this) }\n                            primary={false} />\n                </CardActions>\n            </GlassCard>\n            <DynamicSpacer />\n\n\n\n            <GlassCard width='768px' zDepth={2} >\n                <CardTitle\n                    title='5.  Authorization Services'\n\n                />\n                <CardText>\n                    <Table>\n                        <thead>\n                            <tr>\n                                <th className='service' style={{minWidth: '100px'}}>service</th>\n                                <th className='clientId' style={{minWidth: '100px'}}>clientId</th>\n                                <th className='secret' style={{minWidth: '100px'}}>secret</th>\n                                <th className='baseUrl' style={{minWidth: '100px'}}>baseUrl</th>\n                                {/* <th className='style' style={{minWidth: '100px'}}>style</th> */}\n                                <th className='remove' style={{minWidth: '100px'}}>remove</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            { tableRows }\n                        </tbody>\n                    </Table>\n                </CardText>\n                <CardActions>\n                    <FlatButton \n                        label=\"Resync Configuration\" \n                        id=\"resyncConfiguration\" \n                        primary={false} \n                        onClick={ this.resyncConfiguration.bind(this) }\n                        style={{float: 'right'}}\n                        />\n\n                </CardActions>            \n              </GlassCard>\n            <DynamicSpacer />\n\n\n\n\n            <GlassCard width='768px' zDepth={2} >\n                <CardTitle\n                    title='6.  Sign In'\n\n                />\n                <CardText>\n                    <Grid>\n                        <Row>\n                            <Col md={4}>\n                                <TextField\n                                    type=\"username\"\n                                    ref=\"username\"\n                                    name=\"username\"\n                                    floatingLabelText=\"Username\"\n                                    hintText=\"janedoe\"\n                                    floatingLabelFixed={true}\n                                    fullWidth\n                                />      \n                           </Col>\n                            <Col md={4}>\n                                <TextField\n                                    type=\"password\"\n                                    ref=\"password\"\n                                    name=\"password\"\n                                    floatingLabelText=\"Password\"\n                                    hintText=\"********\"\n                                    floatingLabelFixed={true}\n                                    fullWidth\n                                />      \n                            </Col>\n                            <Col md={4}>\n                                { signInWiths }\n                            </Col>\n                        </Row>\n                    </Grid>\n                </CardText>\n            </GlassCard>\n            <DynamicSpacer />\n\n\n            <div style={{paddingLeft: '40px'}}>\n                <GlassCard width='768px' zDepth={2} >\n                    <CardTitle\n                        title='7.  Access Token'\n                        subtitle='The following button will scan a FHIR Server and autodetect and configure the OAuth connection, based on the FHIR conformance statement located at <code>/metadata</code>' />\n                    <CardText style={{textAlign: 'center'}}>\n                        <h3 style={{width: '100%', textAlign: 'center'}}>{ this.state.accessToken }</h3>\n                    </CardText>\n                    <CardActions>\n                    <FlatButton \n                            label=\"Fetch Access Token\" \n                            id=\"fetchAccessToken\" \n                            onClick={this.fetchAccessToken.bind(this)}\n                            primary={false} />\n                    </CardActions>\n                </GlassCard>\n                <DynamicSpacer />\n\n\n\n                <GlassCard width='768px' zDepth={2} >\n                    <CardTitle\n                        title='8.  Patient Data!' \n                        subtitle={<span style={{color: 'rgb(38, 166, 154)'}}> { this.state.baseUrl + '/Patient/Tbt3KuCY0B5PSrJvCu2j-PlK.aiHsu2xUjUM8bWpetXoB' } </span>} />\n                        />\n                    <CardText>\n                        <Row>\n                            <Col md={12}>\n                                <pre style={{ overflowY: 'scroll', height: '250px' }}>\n                                    { this.state.patientData }\n                                </pre>\n                            </Col>\n                        </Row>\n                    </CardText>\n                    <CardActions>\n                        <FlatButton \n                            label=\"Fetch Patient Data\" \n                            id=\"fetchPatientData\" \n                            onClick={this.fetchPatientData.bind(this)}\n                            primary={false} />\n                        <FlatButton \n                            label=\"Save Data to Profile\" \n                            id=\"savePatientDemographicsToProfile\" \n                            onClick={this.savePatientDemographicsToProfile.bind(this)}\n                            primary={false} />\n                    </CardActions>\n                </GlassCard>\n                <DynamicSpacer />\n\n\n                <PatientCard\n                    patient={ this.state.patient }                    \n                    />\n\n\n                <GlassCard width='768px' zDepth={2} >\n                    <CardTitle\n                        title='10.  Observations' \n                        subtitle={<span style={{color: 'rgb(38, 166, 154)'}}> { this.state.baseUrl + '/Observation/' } </span>} />\n                        />\n                    <CardText>\n                        <ObservationsTable\n                                data={ this.state.observations } \n                                limit={10}\n                                />\n                    </CardText>\n                    <CardActions>\n                        <FlatButton \n                            label=\"Search Observations\" \n                            id=\"searchObservations\" \n                            onClick={this.searchObservations.bind(this)}\n                            primary={false} />\n                        <FlatButton \n                            label=\"Cache in Browser\" \n                            id=\"cacheObservations\" \n                            onClick={this.cacheObservations.bind(this)}\n                            primary={false} />\n                    </CardActions>\n                </GlassCard>\n                <DynamicSpacer />\n\n\n                <div style={{paddingLeft: '40px'}}>\n                    <GlassCard width='768px' zDepth={2} >\n                        <CardTitle\n                            title='11.  Launch Context'\n                            subtitle='When launching from an EHR, the iFrame responsible for rendering the page will provide a launch parameter in the URL.' />\n                        <CardText style={{textAlign: 'center'}}>\n                            <h3 style={{width: '100%', textAlign: 'center'}}>{ this.state.launchContext }</h3>\n                        </CardText>\n                        <CardActions>\n                        <FlatButton \n                                label=\"Simulate Launch Context\" \n                                id=\"simulateLaunchContext\" \n                                onClick={this.simulateLaunchContext.bind(this)}\n                                primary={false} />\n                        </CardActions>\n                    </GlassCard>\n                    <DynamicSpacer />\n\n                    <GlassCard width='768px' zDepth={2} >\n                        <CardTitle\n                            title='12.  Search Patients'                    \n                            subtitle={<span style={{color: 'rgb(38, 166, 154)'}}> { this.state.baseUrl + '/Patient/_search?given=Jason&family=Argonaut' } </span>} />\n                            {/* subtitle={<span style={{color: 'rgb(38, 166, 154)'}}> https://open-ic.epic.com/FHIR/api/FHIR/DSTU2/Patient/Tbt3KuCY0B5PSrJvCu2j-PlK.aiHsu2xUjUM8bWpetXoB </span>} /> */}\n                        <CardText> \n                            <Grid>\n                                <Row>\n                                    \n                                    <br />\n                                </Row>\n                                <Row>\n                                    <Col md={6}>\n                                        <TextField\n                                            type=\"text\"\n                                            ref=\"name\"\n                                            name=\"name\"\n                                            floatingLabelText=\"Full Name\"\n                                            hintText=\"Jane Doe\"\n                                            floatingLabelFixed={true}\n                                            onChange={ this.updateSearch.bind(this, 'name') } \n                                            fullWidth\n                                        />      \n                                    </Col>\n                                    <Col md={2}>\n                                    <TextField\n                                            type=\"text\"\n                                            ref=\"birthdate\"\n                                            name=\"birthdate\"\n                                            floatingLabelText=\"Birthdate\"\n                                            hintText=\"1960-01-01\"\n                                            floatingLabelFixed={true}\n                                            onChange={ this.updateSearch.bind(this, 'birthdate') } \n                                            fullWidth\n                                        />    \n                                    </Col>                            \n                                    <Col md={2}>\n                                        <TextField\n                                            type=\"text\"\n                                            ref=\"gender\"\n                                            name=\"gender\"\n                                            floatingLabelText=\"Gender\"\n                                            hintText=\"female\"\n                                            floatingLabelFixed={true}\n                                            onChange={ this.updateSearch.bind(this, 'gender') } \n                                            fullWidth\n                                        />      \n                                    </Col>\n                                    <Col md={2}>\n                                        <TextField\n                                            type=\"text\"\n                                            ref=\"identifier\"\n                                            name=\"identifier\"\n                                            floatingLabelText=\"Identifier\"\n                                            hintText=\"12345\"\n                                            floatingLabelFixed={true}\n                                            onChange={ this.updateSearch.bind(this, 'identifier') } \n                                            fullWidth\n                                        />      \n                                    </Col>                              \n                                </Row>\n                                <Row>\n                                    <Col md={3}>\n                                        <TextField\n                                            type=\"text\"\n                                            ref=\"given\"\n                                            name=\"given\"\n                                            floatingLabelText=\"Given\"\n                                            hintText=\"Jane\"\n                                            floatingLabelFixed={true}\n                                            onChange={ this.updateSearch.bind(this, 'given') } \n                                            fullWidth\n                                        />      \n                                    </Col>\n                                    <Col md={3}>\n                                        <TextField\n                                            type=\"text\"\n                                            ref=\"family\"\n                                            name=\"family\"\n                                            floatingLabelText=\"Family\"\n                                            hintText=\"Doe\"\n                                            floatingLabelFixed={true}\n                                            onChange={ this.updateSearch.bind(this, 'family') } \n                                            fullWidth\n                                        />      \n                                    </Col>\n                                \n                                </Row>\n                            </Grid>\n\n\n                        </CardText>\n                        <CardActions>\n                        <FlatButton \n                                label=\"Search\" \n                                id=\"searchPatients\" \n                                onClick={this.searchPatients.bind(this)}\n                                primary={false} />\n                        </CardActions>\n                    </GlassCard>\n                    <DynamicSpacer />\n\n\n\n                    <GlassCard width='768px' zDepth={2} >\n                        <CardTitle\n                            title='13.  Patient Table' \n                            subtitle={<span style={{color: 'rgb(38, 166, 154)'}}> { this.state.baseUrl + '/Patient/' } </span>} />\n                            />\n                        <CardText>\n                            <PatientTable\n                                data={ this.data.patients } \n                                limit={10}\n                                />\n                        </CardText>\n                    </GlassCard>\n                    <DynamicSpacer />\n                </div>\n\n            </div>\n\n          <DynamicSpacer />\n        </VerticalCanvas>\n      </div>\n    );\n  }\n  \n  editServiceName(field, event, value){\n    //console.log('editclientId', value)\n    var newFormData = this.state.formData;\n    newFormData.serviceName = value;\n\n    this.setState({\n        'formData': newFormData\n    });\n  }\n  editclientId(field, event, value){\n    //console.log('editclientId', value)\n    var newFormData = this.state.formData;\n    newFormData.clientId = value;\n\n    this.setState({\n        'formData': newFormData\n    });\n  }\n  editSecretKey(field, event, value){\n    //console.log('editSecretKey', value)\n\n    var newFormData = this.state.formData;\n    newFormData.secretKey = value;\n    \n    this.setState({\n        'formData': newFormData\n    });\n  }\n  editTargetBaseUrl(field, event, value){\n    //console.log('editTargetBaseUrl', value)\n\n    var newFormData = this.state.formData;\n    newFormData.targetBaseUrl = value;\n    \n    this.setState({\n        'formData': newFormData\n    });\n  }\n  editTargetLoginUrl(field, event, value){\n    //console.log('editTargetLoginUrl', value)\n\n    var newFormData = this.state.formData;\n    newFormData.targetLoginUrl = value;\n    \n    this.setState({\n        'formData': newFormData\n    });\n  }\n  editloginStyle(fipopupeld, event, value){\n    //console.log('editloginStyle - ÃŸ', value)\n    \n    var newFormData = this.state.formData;\n    newFormData.loginStyle = value;\n    \n    this.setState({\n        'formData': newFormData\n    });\n  }\n  updateSearch(field, event, value){\n    const newState = this.state;\n\n    if(field == \"name\"){\n        newState.patientSearch.text = value;\n    }\n    if(field == \"given\"){\n        newState.patientSearch.given = value;\n    }\n    if(field == \"family\"){\n        newState.patientSearch.family = value;\n    }\n    if(field == \"gender\"){\n        newState.patientSearch.gender = value;\n    }\n    if(field == \"birthdate\"){\n        newState.patientSearch.birthdate = value;\n    }\n    if(field == \"identifier\"){\n        newState.patientSearch.identifier = value;\n    }\n    this.setState(newState);\n  }\n  changeState(field, event, value){\n    const formData = this.state.formData;\n    formData[field] = value;\n    this.setState({\n        formData: formData\n    });\n  }\n  updateBaseUrl(event, value){\n    console.log('updateBaseUrl', event, value)\n\n    var newState = this.state;\n    newState.baseUrl = value;\n\n    this.setState(newState);\n  }\n  \n\n  autoscan(){\n    console.log('autoscan')\n    var self = this;\n\n    var metadataRoute = Session.get('oauthBaseUrl') + '/metadata' + formatSuffix;\n    console.log('metadata route', metadataRoute)\n\n    //   HTTP.get(metadataRoute, { headers: {\n    //     'Accept': ['application/json', 'application/json+fhir'],\n    //     'Access-Control-Allow-Origin': '*'\n    //     }}, function(error, result){\n    //       if(error){\n    //           console.log('error', error)\n    //       }\n    //       if(result){\n    //           console.log(result.content);\n    //           var conformanceStatement = JSON.parse(result.content);\n    //           console.log('conformanceStatement', conformanceStatement)\n    //           self.setState({\n    //               metadata: EJSON.stringify(conformanceStatement, {indent: 2}),\n    //               conformance: conformanceStatement\n    //           })\n    //     }\n    //   })\n\n    Meteor.call('metadataAutoscan', Session.get('oauthBaseUrl'), function(error, result){\n      if(result){\n          self.setState({\n              metadata: EJSON.stringify(result, {indent: 2}),\n              conformance: result\n          })    \n      }\n    })\n  }\n  clearAutoscan(){\n    self.setState({\n        metadata: ''\n    })\n  }\n  extractAutoconfigValues(){\n      console.log('extractAutoconfigValues', this.state)\n\n      var newState = {\n        fhirVersion:  get(this, 'state.conformance.fhirVersion'),\n        authorizeUrl:  '',\n        tokenUrl: '',\n        formData: {\n            serviceName: this.state.formData.serviceName,\n            secretKey: this.state.formData.secretKey,\n            loginStyle: this.state.formData.loginStyle,\n            targetBaseUrl: this.state.baseUrl,\n            tokenUrl: this.state.formData.tokenUrl,\n            targetLoginUrl: ''\n        }\n      }\n\n    // json doesn't we don't actually know the ordering of \n    var oauthExtension = get(this, 'state.conformance.rest[0].security.extension[0].extension');\n\n    console.log('oauthExtension', oauthExtension);\n\n    oauthExtension.forEach(function(object){\n        console.log('object', object)\n        if(object.url == \"authorize\") {\n            newState.authorizeUrl = object.valueUri;\n            newState.formData.targetLoginUrl = object.valueUri;\n        }\n        if(object.url == \"token\"){\n            newState.tokenUrl = object.valueUri            \n            newState.formData.tokenUrl = object.valueUri;\n        }\n    });\n\n    console.log('newState', newState)\n    this.setState(newState)\n\n  }\n  saveConfiguration(){\n    console.log('saveConfiguration', this.state);\n\n    var serviceConfig = this.state.formData;\n\n    var credentialRequestCompleteCallback = Accounts.oauth.credentialRequestCompleteHandler(function(error, result){\n        console.log('foo?')\n        console.log('error', error)\n        console.log('result', result)\n        console.log('saveConfiguration!')            \n    });\n\n    serviceConfig.credentialRequestCompleteCallback = credentialRequestCompleteCallback;\n\n    console.log('serviceConfig', serviceConfig)\n    Meteor.call('configureOauthService', serviceConfig, credentialRequestCompleteCallback);\n  }\n  signInWith(serviceName){\n    console.log('signInWith', serviceName)\n\n    Session.set('oauthService', serviceName);\n\n    var options = {\n          requestPermissions: [\n            'OBSERVATION.READ', \n            'OBSERVATION.SEARCH', \n            'PATIENT.READ', \n            'PATIENT.SEARCH', \n            'PRACTITIONER.READ', \n            'PRACTITIONER.SEARCH',\n            'patient/*.read',\n            'patient/*.search',\n            'openid',\n            'profile',\n            'user/*.*',\n            'launch',\n            'online_access'\n            \n          ]\n        }\n\n        console.log('Accounts.oauth.serviceNames', Accounts.oauth.serviceNames());\n\n        var credentialRequestCompleteCallback = Accounts.oauth.credentialRequestCompleteHandler(function(error, result){\n            console.log('foo?')\n            console.log('error', error)\n            console.log('result', result)\n            console.log('foo!')            \n        });\n        OAuth2.serviceName = serviceName;\n\n        var credentialResult = OAuth.requestCredential(options, credentialRequestCompleteCallback);\n        console.log('signInWith.credentialResult', credentialResult)\n  }\n  resyncConfiguration(){\n    console.log('C2.  Resyncing Configuration')\n\n    Meteor.call('resyncConfiguration');\n  }\n  removeEntry(_id){\n    check(_id, String);\n    if(confirm('Remove configuration?')){\n        console.log('removing...', _id)\n\n        //ServiceConfiguration.configurations.remove({_id: _id});\n        Meteor.call('removeService', _id, function(error, result){\n            console.log('removeService[error]', error)\n            console.log('removeService[result]', result)\n        })\n    }\n  }\n  resetServiceConfiguration(){\n    console.log('resetServiceConfiguration')\n  }\n  simulateLaunchContext(){\n    console.log('simulateLaunchContext')\n  }\n  fetchAccessToken(){\n    console.log('fetchAccessToken')\n    var self = this;\n    Meteor.call('fetchAccessToken', Session.get('oauthService'), function(err, result){\n        if(result){\n            console.log(result)\n            var newState = self.state;\n            newState.accessToken = result.accessToken\n            self.setState(newState)\n            Session.set('accessToken', result.accessToken)\n        }\n    })\n  }\n  fetchPatientData(){\n    var fetchUrl = this.state.baseUrl + '/Patient/Tbt3KuCY0B5PSrJvCu2j-PlK.aiHsu2xUjUM8bWpetXoB' + formatSuffix;\n    console.log('fetchPatientData', fetchUrl)\n\n    var self = this    \n\n    HTTP.get(fetchUrl, {\n        // data: {\n        //   summaryLength: \"500\",\n        //   entryPoint: \"main\"\n        // },\n        headers: {\n            'Authorization': 'Bearer ' + this.state.accessToken\n        }\n      }, function(err, result){\n        if(result){\n            console.log(JSON.parse(result.content));\n\n            var patientData = JSON.parse(result.content);\n            console.log('patientData', patientData)\n\n            var newState = self.state;\n            newState.patientData = EJSON.stringify(patientData, {indent: 2});\n            newState.patient = patientData;\n\n            self.setState(newState);\n        }\n        if(err){\n            console.error(err)\n        }\n    })\n  }\n  savePatientDemographicsToProfile(){\n    console.log('savePatientDemographicsToProfile', this.state );\n\n    console.log('Meteor.userId()', Meteor.userId());\n\n    if(get(this, 'state.patient.name[0]')){\n        var humanName = get(this, 'state.patient.name[0]');\n        if (!humanName.text ){\n            humanName.text = humanName.given[0] + '' + humanName.family[0];\n        }\n        Meteor.users.update({_id: Meteor.userId()}, {\n            $set: {\n                'profile.name': humanName\n            }\n        })    \n    }\n    if(get(this, 'state.patient.address')){\n        var addresses = get(this, 'state.patient.address');\n        addresses.forEach(function(address){\n            if(address.use === \"home\"){\n                Meteor.users.update({_id: Meteor.userId()}, {\n                    $set: {\n                        'profile.locations.home.address': address\n                    }\n                })            \n            }\n        })\n\n    }\n  }\n  searchPatients(){\n    console.log('searchPatients', this.state.patientSearch)\n\n    var self = this;    \n    var patientId = 'Tbt3KuCY0B5PSrJvCu2j-PlK.aiHsu2xUjUM8bWpetXoB'\n    var patientSearchUrl = this.state.baseUrl + '/Patient/_search?family=' + this.state.patientSearch.family + '&given=' + this.state.patientSearch.given + '&_format=application/json';\n    console.log('patientSearchUrl', patientSearchUrl)\n\n    HTTP.post(patientSearchUrl, {\n        headers: {\n            'Authorization': 'Bearer ' + this.state.accessToken\n        }\n      }, function(err, result){\n        if(result){\n            console.log('result', result);\n\n            console.log(JSON.parse(result.content));\n\n            var responseBundle = JSON.parse(result.content);\n            console.log('responseBundle', responseBundle)\n\n            if(result.content){\n                var content = JSON.parse(result.content);\n                console.log('content', content)                    \n\n                if(content.resourceType == \"Bundle\"){\n                    if(content.entry){\n                        var newPatientSearchResults = [];\n                        content.entry.forEach(function(entry){\n                            if(entry.resource && (entry.resource.resourceType == \"Patient\")){\n                                newPatientSearchResults.push(entry.resource);\n                            }\n                        })\n                        Session.set('patientSearchResults', newPatientSearchResults);\n                    }\n                }\n            }\n        }\n        if(err){\n            console.error(error)\n\n            Session.set('patientSearchResults', []);\n        }\n    });\n  }\n  searchObservations(){\n    var self = this    \n    var patientId = 'Tbt3KuCY0B5PSrJvCu2j-PlK.aiHsu2xUjUM8bWpetXoB'\n    var observationUrl = this.state.baseUrl + '/Observation/_search?patient=' + patientId + '&category=vital-signs' + '&_format=application/json';\n\n    console.log('observationUrl', observationUrl);\n\n    HTTP.post(observationUrl, {\n        headers: {\n            'Authorization': 'Bearer ' + this.state.accessToken\n        }\n      }, function(err, result){\n        if(result){\n            //console.log('result', result)\n            console.log(JSON.parse(result.content));\n\n            var bundle = JSON.parse(result.content);\n            console.log('bundle', bundle)\n\n            var observationData = [];\n            bundle.entry.forEach(function(resource){\n                observationData.push(resource.resource)\n            });\n\n            console.log('observationData', observationData)\n            var newState = self.state;\n\n            //newState.observationData = EJSON.stringify(observationData, {indent: 2});\n            newState.observations = observationData;\n\n            console.log('newState', newState)\n\n            self.setState(newState)\n        }\n        if (err){\n            console.log('error', err)\n        }\n    });\n  }\n  cacheObservations(){\n    console.log('cacheObservations', this.state.observations);\n    \n    if(this.state.observations.length > 0){\n        this.state.observations.forEach(function(observation){\n            Observations.insert(observation, function(error){\n                if(error) console.error(error)\n            });\n        })\n    }\n  }\n}\n\n/**\n * Determine if a user originates from an oauth2 login.\n * @param user\n * @returns {*}\n */\nfunction isOAuth2User(user) {\n    return get(user, 'services.OAuth2Server');\n}\n  \n/**\n * Get the user access token if it exists.\n * @returns {*}\n */\nfunction getUserAccessToken() {\n    var user = Meteor.user();\n\n    if (!isOAuth2User(user)) {\n        return;\n    }\n\n    return user.services.OAuth2Server.accessToken;\n}\n\n\nReactMixin(OAuthClientPage.prototype, ReactMeteorData);\nexport default OAuthClientPage;","import { get } from 'lodash';\nimport { OAuth } from 'meteor/clinical:oauth';\nimport { Meteor } from 'meteor/meteor';\n\n// We're still hardcoding the service name;  It would be really nice \n// if this were dynamic; but I've just not been able to figure out how \n// to change it at run time so that it consistently works.    \n\nif (_.isUndefined(OAuth2)) {\n  OAuth2 = {\n    serviceName: 'FhirTimelineSecure'\n  };\n}\n\nvar state = {\n    conformance: {},\n    fhirVersion: '',\n    formData: {\n      serviceName: 'FhirTimelineSecure',\n      clientId: '',\n      secretKey: '',\n      targetBaseUrl: '',\n      targetLoginUrl: '',\n      tokenUrl: '',\n      loginStyle: 'popup'\n    },\n    autoscan: '',\n    metadata: '',\n    baseUrl: 'https://open-ic.epic.com/Argonaut/api/FHIR/Argonaut',  //TODO: remove and query ServiceConfiguration\n    authorizeUrl: '',\n    tokenUrl: '',\n    patientSearch: {\n        text: '',\n        given: '', \n        family: '',\n        gender: '',\n        birthdate: '',\n        identifier: ''\n    },\n    accessToken: '',\n    patientData: '',\n    patient: {},\n    observations: [],\n    patients: []\n};\n\n\n\nMeteor.methods({\n    placeBundleIntoCollections(bundle){\n        check(bundle, Object);\n        console.log('Placing bundle into collections... ', bundle)\n\n        if(bundle && bundle.entry){\n            bundle.entry.forEach(function(pointer){\n                if(pointer.fullUrl){\n                    HTTP.get(pointer.fullUrl + '?_format=application/json', { headers: {\n                        'Authorization': 'Bearer ' + Session.get('accessToken')\n                    }}, function(err, redirectResult){\n                        if(redirectResult && redirectResult.content){\n                            console.log('redirectResult', redirectResult)\n                            var resource = JSON.parse(redirectResult.content);\n                            if (resource.resourceType === \"AllergyIntolerance\"){\n                                console.log('AllergyIntolerance')\n                                AllergyIntolerances._collection.insert(resource, function(error, result){\n                                    if(error){\n                                        console.log('AllergyIntolerances.insert.error', error)\n                                    }\n                                    if(result){\n                                        console.log('AllergyIntolerances.insert.result', result)\n                                    }\n                                })\n                            }\n                            if (resource.resourceType === \"CarePlan\"){\n                                CarePlans._collection.insert(resource, function(error, result){\n                                    if(error){\n                                        console.log('CarePlans.insert.error', error)\n                                    }\n                                    if(result){\n                                        console.log('CarePlans.insert.result', result)\n                                    }\n                                })\n                            }\n                            if (resource.resourceType === \"Condition\"){\n                                Conditions._collection.insert(resource, function(error, result){\n                                    if(error){\n                                        console.log('Conditions.insert.error', error)\n                                    }\n                                    if(result){\n                                        console.log('Conditions.insert.result', result)\n                                    }\n                                })\n                            }\n                            if (resource.resourceType === \"Device\"){\n                                Devices._collection.insert(resource, function(error, result){\n                                    if(error){\n                                        console.log('Devices.insert.error', error)\n                                    }\n                                    if(result){\n                                        console.log('Devices.insert.result', result)\n                                    }\n                                })\n                            }\n                            if (resource.resourceType === \"DiagnosticReport\"){\n                                DiagnosticReports._collection.insert(resource, function(error, result){\n                                    if(error){\n                                        console.log('DiagnosticReports.insert.error', error)\n                                    }\n                                    if(result){\n                                        console.log('DiagnosticReports.insert.result', result)\n                                    }\n                                })\n                            }\n                            if (resource.resourceType === \"Observation\"){\n                                Observations._collection.insert(resource, function(error, result){\n                                    if(error){\n                                        console.log('Observations.insert.error', error)\n                                    }\n                                    if(result){\n                                        console.log('Observations.insert.result', result)\n                                    }\n                                })\n                            }\n                            if (resource.resourceType === \"Goal\"){\n                                Goals._collection.insert(resource, function(error, result){\n                                    if(error){\n                                        console.log('Goals.insert.error', error)\n                                    }\n                                    if(result){\n                                        console.log('Goals.insert.result', result)\n                                    }\n                                })\n                            }\n                            if (resource.resourceType === \"Immunization\"){\n                                Immunizations._collection.insert(resource, function(error, result){\n                                    if(error){\n                                        console.log('Immunizations.insert.error', error)\n                                    }\n                                    if(result){\n                                        console.log('Immunizations.insert.result', result)\n                                    }\n                                })\n                            }\n                            if (resource.resourceType === \"Medication\"){\n                                Medications._collection.insert(resource, function(error, result){\n                                    if(error){\n                                        console.log('Medications.insert.error', error)\n                                    }\n                                    if(result){\n                                        console.log('Medications.insert.result', result)\n                                    }\n                                })\n                            }\n                            if (resource.resourceType === \"MedicationOrder\"){\n                                MedicationOrders._collection.insert(resource, function(error, result){\n                                    if(error){\n                                        console.log('MedicationOrders.insert.error', error)\n                                    }\n                                    if(result){\n                                        console.log('MedicationOrders.insert.result', result)\n                                    }\n                                })\n                            }\n                            if (resource.resourceType === \"Procedure\"){\n                                Procedures._collection.insert(resource, function(error, result){\n                                    if(error){\n                                        console.log('Procedures.insert.error', error)\n                                    }\n                                    if(result){\n                                        console.log('Procedures.insert.result', result)\n                                    }\n                                })\n                            }\n\n\n                        } else {\n                            console.log(\"redirect didn't have content\")\n                        }\n                        if (err){ console.log('error', err) }\n                    });    \n                }\n            });    \n        }\n\n    },\n    fetchPatientFromEpic(accessToken){\n        process.env.DEBUG && console.log('fetchPatientFromEpic', this.state.patientSearch)\n\n        check(accessToken, String);\n\n        var self = this;    \n        var patientId = 'Tbt3KuCY0B5PSrJvCu2j-PlK.aiHsu2xUjUM8bWpetXoB'\n        var patientSearchUrl = this.state.baseUrl + '/Patient/_search?family=' + this.state.patientSearch.family + '&given=' + this.state.patientSearch.given + '&_format=application/json';\n        process.env.DEBUG && console.log('patientSearchUrl', patientSearchUrl)\n\n        HTTP.post(patientSearchUrl, {\n            headers: {\n                'Authorization': 'Bearer ' + accessToken\n            }\n        }, function(err, result){\n            if(result){\n                process.env.DEBUG && console.log('Meteor.call(fetchPatientFromEpic()).result', result);\n\n                process.env.DEBUG && console.log(JSON.parse(result.content));\n\n                var responseBundle = JSON.parse(result.content);\n                process.env.DEBUG && console.log('responseBundle', responseBundle)\n\n                if(result.content){\n                    var content = JSON.parse(result.content);\n                    process.env.DEBUG && console.log('content', content)                    \n\n                    if(content.resourceType == \"Bundle\"){\n                        if(content.entry){\n                            var newPatientSearchResults = [];\n                            content.entry.forEach(function(entry){\n                                if(entry.resource && (entry.resource.resourceType == \"Patient\")){\n                                    newPatientSearchResults.push(entry.resource);\n                                }\n                            })\n                            Session.set('patientSearchResults', newPatientSearchResults);\n                        }\n                    }\n                }\n            }\n            if(err){\n                process.env.DEBUG && console.error(error)\n\n                Session.set('patientSearchResults', []);\n            }\n        });\n    },\n    fetchObservationsFromEpic(accessToken){\n        process.env.DEBUG && console.log('fetchObservationsFromEpic')\n\n        check(accessToken, String);\n\n        var self = this    \n        var patientId = 'Tbt3KuCY0B5PSrJvCu2j-PlK.aiHsu2xUjUM8bWpetXoB'\n        var observationUrl = state.baseUrl + '/Observation/_search?patient=' + patientId + '&category=vital-signs' + '&_format=application/json';\n\n        process.env.DEBUG && console.log('observationUrl', observationUrl);\n\n        HTTP.post(observationUrl, {\n            headers: {\n                'Authorization': 'Bearer ' + accessToken\n            }\n        }, function(err, result){\n            if(result){\n                //console.log('result', result)\n                process.env.DEBUG && console.log(JSON.parse(result.content));\n\n                var bundle = JSON.parse(result.content);\n                process.env.DEBUG && console.log('bundle', bundle)\n\n                var observationData = [];\n                bundle.entry.forEach(function(resource){\n                    observationData.push(resource.resource)\n                });\n\n                process.env.DEBUG && console.log('observationData', observationData)\n            }\n            if (err){\n                console.log('error', err)\n            }\n        });\n    },\n    syncResourceFromEpic(accessToken, resourceType){\n        process.env.DEBUG && console.log('syncResourceFromEpic', accessToken, resourceType)\n\n        check(accessToken, String);\n        check(resourceType, String);\n\n        var self = this    \n        var patientId = 'Tbt3KuCY0B5PSrJvCu2j-PlK.aiHsu2xUjUM8bWpetXoB';\n        var observationUrl = state.baseUrl + '/Observation/_search?patient=' + patientId + '&category=vital-signs&_format=application/json';\n\n        process.env.DEBUG && console.log('observationUrl', observationUrl);\n\n        HTTP.post(observationUrl, {\n            headers: {\n                'Authorization': 'Bearer ' + accessToken\n            }\n        }, function(err, result){\n            if(result){\n                console.log('Meteor.call(\"syncResourceFromEpic\").result', result)\n                process.env.DEBUG && console.log(JSON.parse(result.content));\n\n                var bundle = JSON.parse(result.content);\n                process.env.DEBUG && console.log('bundle', bundle)\n\n                var observationData = [];\n                bundle.entry.forEach(function(resource){\n                    observationData.push(resource.resource);\n                    if(Meteor.connection){\n                        Meteor.connection._mongo_livedata_collections[\"Observations\"].insert(resource.resource);\n                    }\n                });\n\n                process.env.DEBUG && console.log('observationData', observationData)\n            }\n            if (err){\n                console.log('error', err)\n            }\n        });\n    },    \n    cacheObservations(){\n        process.env.DEBUG && console.log('cacheObservations', this.state.observations);\n        \n        if(this.state.observations.length > 0){\n            this.state.observations.forEach(function(observation){\n                Observations.insert(observation, function(error){\n                    if(error) console.error(error)\n                });\n            })\n        }\n    },\n    resyncConfiguration(){\n        process.env.DEBUG && console.log('S1. Resyncing OAuth Configuration on Server')\n        process.env.DEBUG && console.log('S1.1 There are ' + Accounts.oauth.serviceNames().length + ' existing services currently configured in server memory.', )\n        process.env.VERBOSE && console.log(Accounts.oauth.serviceNames())\n\n\n        var services = ServiceConfiguration.configurations.find().fetch();\n        process.env.DEBUG && console.log('S1.2 There are ' + services.length + ' existing services currently configured in the database.', )\n        process.env.VERBOSE && console.log(services);\n\n        services.forEach(function(record){\n            if (Accounts.oauth.serviceNames().includes(record.service)){\n                process.env.DEBUG && console.log('S1.3. Found an old registration of ' + record.service + '.  Removing...')\n                \n                Accounts.oauth.unregisterService(record.service);\n                if(Meteor.isServer){\n                    OAuth.unregisterService(record.service);\n                }\n            }\n        \n            process.env.DEBUG && console.log('C4.1  Recreating service:  ', record.service)\n            Accounts.oauth.registerService(record.service);\n\n            if(Meteor.isServer){\n                Accounts.addAutopublishFields({\n                    forLoggedInUser: ['services.' + record.service],\n                    forOtherUsers: []\n                });\n                OAuth.registerService(record.service, 2, null, function(query) {\n                    process.env.DEBUG && console.log('S9. ', query);\n                \n                    var config = ServiceConfiguration.configurations.findOne({\n                        service: record.service\n                    });\n                    process.env.DEBUG && console.log('S10. config', config)\n                \n                    Accounts.addAutopublishFields({\n                        forLoggedInUser: ['services.' + record.service],\n                        forOtherUsers: []\n                      });\n                \n                \n                    var response = getTokenResponse(query, config);\n\n                    if(response){\n                        process.env.DEBUG && console.log(\"S11. getTokenResponseResponse\", response);\n                        \n                        var accessToken = response.accessToken;\n                        var identity = getIdentity(accessToken, config);\n                \n                        var serviceData = {\n                            id: '',\n                            accessToken: accessToken,\n                            expiresAt: (+new Date) + (1000 * response.expiresIn),\n                            identity: {}\n                        };\n                        if(response.patient){\n                          serviceData.identity = response.patient;\n                          serviceData.id = response.patient;\n                        } else {\n                            process.env.DEBUG && console.log(\"S11.E getIdentity() didnt appear to return a patient identifier\", response);\n                        }\n\n                        if(config.service === \"Allscripts\"){\n                            process.env.DEBUG && console.log(\"S11.E Hardcoding the Allscripts example patient\");\n                            serviceData.identity = \"385800201\";\n                            serviceData.id = \"385800201\";  \n                        }\n  \n                      var serviceResult = {\n                          serviceData: serviceData,\n                          options: {\n                            profile: {\n                              name: ''\n                            }\n                          }\n                        }\n                    \n                        process.env.DEBUG && console.log('S12. OAuth.registerService(' + record.service + ').serviceData', serviceData);                \n                        process.env.DEBUG && console.log('S12. OAuth.registerService(' + record.service + ').serviceResult', serviceResult);\n    \n                    }\n                \n                    return serviceResult;\n                });\n            }\n    \n        })\n\n        process.env.DEBUG && console.log('S6. Existing services (final):  ', Accounts.oauth.serviceNames());\n    },\n    configureOauthService(formData, callback){\n        check(formData, Object);\n  \n        var self = this;\n  \n        process.env.DEBUG && console.log('S7. configureOauthService', formData)\n  \n        process.env.DEBUG && console.log('S8. Existing services:  ', Accounts.oauth.serviceNames());\n  \n        \n  \n  \n        if (Accounts.oauth.serviceNames().includes(formData.serviceName)){\n          process.env.DEBUG && console.log('S9. Found an old registration of ' + formData.serviceName + '.  Removing...')\n          Accounts.oauth.unregisterService(formData.serviceName)\n        }\n  \n        process.env.DEBUG && console.log('S10.  Recreating service:  ', formData.serviceName)\n  \n        Accounts.oauth.registerService(formData.serviceName, function(error, result){\n          if(error) console.log('S10.1 error', error)\n        });\n  \n        process.env.DEBUG && console.log('S11. Upserting ServiceConfiguration...')\n        // // https://atmospherejs.com/meteor/service-configuration\n        // ServiceConfiguration.configurations.upsert(\n        //     { service: formData.serviceName },\n        //     { $set: { \n        //       service: formData.serviceName, \n        //       clientId: formData.clientId, \n        //       secret: formData.secretKey,\n        //       baseUrl: formData.targetBaseUrl,\n        //       loginUrl: formData.targetLoginUrl,\n        //       loginStyle: formData.loginStyle,\n        //       tokenUrl: formData.tokenUrl   \n        //      }}\n        // );\n  \n        if(ServiceConfiguration.configurations.findOne({ service: formData.serviceName })){\n          ServiceConfiguration.configurations.remove({ service: formData.serviceName });\n        } \n        ServiceConfiguration.configurations.insert(\n          { \n            service: formData.serviceName, \n            clientId: formData.clientId, \n            secret: formData.secretKey,\n            baseUrl: formData.targetBaseUrl,\n            loginUrl: formData.targetLoginUrl,\n            loginStyle: formData.loginStyle,\n            tokenUrl: formData.tokenUrl   \n          }\n        );\n  \n        if (Meteor.isServer) {\n          process.env.DEBUG && console.log('S12. Adding Accounts AutopublishFields...')\n          Accounts.addAutopublishFields({\n            forLoggedInUser: ['S12.1 services.' + OAuth2.serviceName],\n            forOtherUsers: []\n          });\n          \n\n          \n          // OAuth.registerService(formData.serviceName, 2, null, function(error, result){\n          //   console.log('Trying to perform an OAuth callback...')\n          //   console.log('error', error)\n          //   console.log('result', result)\n          //   console.log('bam!')   \n          // });\n        } \n    }\n})\n\n\n\n\n\n//-------------------------------------------------------------------------\n\n\nvar getTokenResponse = function(query, config, autoscannedUrl) {\n    if(get(Meteor, 'settings.public.logging') === \"debug\"){\n        console.log('S10.1 getTokenResponse()', query, config, autoscannedUrl);\n    }  \n\n    var responseContent;\n    var oauthTokenUrl;\n    var httpResult;\n    var accessToken;\n    var expiresIn;\n    var getTokenResponseResults = {\n        accessToken: '',\n        expiresIn: '',\n        patient: ''\n    }\n\n    var tokenUrl = '/oauth/token';\n    if (autoscannedUrl) {\n      tokenUrl = autoscannedUrl;\n    }\n\n    var params = {\n        grant_type: 'authorization_code',\n        code: query.code,\n        client_id: config.clientId,\n        //client_secret: OAuth.openSecret(config.secret),\n        redirect_uri: OAuth._redirectUri(config.service, config)\n    }\n    process.env.DEBUG && console.log('S10.2 params', params);\n\n    oauthTokenUrl = config.baseUrl + tokenUrl;\n    if (config.tokenUrl){\n        oauthTokenUrl = config.tokenUrl;\n    } else {\n        oauthTokenUrl = 'https://open-ic.epic.com/argonaut/oauth2/token';\n    }\n    if(get(Meteor, 'settings.public.logging') === \"debug\"){\n        console.log('S10.3 Token Url: ', oauthTokenUrl);\n    }  \n    \n    httpResult = HTTP.post(oauthTokenUrl, { params: params });\n    // HTTP.post(oauthTokenUrl, { params: params }, function(error, httpResult){\n    //     if(error) {\n    //         console.log('error in getTokenResponse()', error)\n    //     }\n    //     if(httpResult) {\n    //         console.log('httpResult', httpResult);\n    //         console.log('httpResult.data', httpResult.data);\n\n    //         if(httpResult.data){\n    //             getTokenResponseResults.accessToken = httpResult.data.access_token;\n    //             getTokenResponseResults.expiresIn = httpResult.data.expiresIn;\n    //         }\n        \n    //         console.log('getTokenResponseResults', getTokenResponseResults)\n        \n    //     }\n    // });\n\n    if(httpResult.data){\n        process.env.DEBUG && console.log('S10.4 httpResult');\n        process.env.DEBUG && console.log('S10.5 httpResult.data', httpResult);\n\n        getTokenResponseResults.accessToken = httpResult.data.access_token;\n\n        if(get(httpResult, 'data.expiresIn')){\n            getTokenResponseResults.expiresIn = get(httpResult, 'data.expiresIn');\n        }\n        if(get(httpResult, 'data.expires_in')){\n            getTokenResponseResults.expiresIn = get(httpResult, 'data.expires_in');\n        }\n\n        if(get(httpResult, 'data.patient')){\n            getTokenResponseResults.patient = get(httpResult, 'data.patient');\n        }\n\n        process.env.DEBUG && console.log('S10.6 getTokenResponseResults', getTokenResponseResults)\n    } else {\n        process.env.DEBUG && console.log('S10.4 httpResult.data does not exist?')\n    }\n\n    return getTokenResponseResults;\n};\n\nvar getIdentity = function(accessToken, config) {\n    var fetchUrl = config.baseUrl + '/oauth/getIdentity';\n    return HTTP.get(fetchUrl, { params: {\n      access_token: accessToken\n    }}, function(error, httpResult){\n        if(error) {\n            // console.log('getIdentity().error', error)\n        }\n        if(httpResult) {\n            process.env.DEBUG && console.log('S20. getIdentity().httpResult', httpResult);\n            process.env.DEBUG && console.log('S20. getIdentity().httpResult.data', httpResult.data);\n        }\n    });\n};\n\n\n","\nimport OAuthClientPage from './client/OAuthClientPage';\nimport ImportChart from './client/ImportChart';\nimport FastImportPage from './client/FastImportPage';\nimport AdminConfigPage from './client/AdminConfigPage';\nimport OAuth from './client/OAuth';\n\nvar DynamicRoutes = [{\n  'name': 'OAuthClientPage',\n  'path': '/oauth-client',\n  'component': OAuthClientPage,\n  'requireAuth': true\n}, {\n  'name': 'AdminConfigPage',\n  'path': '/oauth-config',\n  'component': AdminConfigPage,\n  'requireAuth': true,\n  'requireAdmin': true\n}, {\n  'name': 'ImportChart',\n  'path': '/import-chart',\n  'component': ImportChart,\n  'requireAuth': true\n}, , {\n  'name': 'FastImportPage',\n  'path': '/fast-import-chart',\n  'component': FastImportPage,\n  'requireAuth': true\n}];\n\nvar SidebarElements = [];\n// [{\n//   'primaryText': 'Import Patient Chart',\n//   'to': '/import-chart',\n//   'href': '/import-chart'\n// }];\nvar AdminSidebarElements = [{\n  'primaryText': 'OAuth Client Config',\n  'to': '/oauth-config',\n  'href': '/oauth-config'\n}];\n\nexport { \n  DynamicRoutes,\n  SidebarElements,\n  AdminSidebarElements,\n  OAuthClientPage,\n  AdminConfigPage,\n  FastImportPage,\n  OAuth\n};\n\n\n"]}