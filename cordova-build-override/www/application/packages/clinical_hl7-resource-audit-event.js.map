{"version":3,"sources":["meteor://ðŸ’»app/packages/clinical:hl7-resource-audit-event/lib/hl7-resource-audit-event.js","meteor://ðŸ’»app/packages/clinical:hl7-resource-audit-event/index.jsx","meteor://ðŸ’»app/packages/clinical:hl7-resource-audit-event/client/AuditEventDetail.js","meteor://ðŸ’»app/packages/clinical:hl7-resource-audit-event/client/AuditEventsPage.js","meteor://ðŸ’»app/packages/clinical:hl7-resource-audit-event/client/AuditEventsTable.js"],"names":["SimpleSchema","module","link","v","CodingSchema","CodeableConcept","ReferenceSchema","IdentifierSchema","AuditEvents","Mongo","Collection","AuditEvent","BaseModel","extend","prototype","_collection","_transform","document","AuditEventSchema","type","String","defaultValue","optional","Array","Date","Object","Boolean","CodeableConceptSchema","blackbox","BaseSchema","BinarySchema","DomainResourceSchema","attachSchema","toString","_document","toFhir","resourceType","result","Meteor","absoluteUrl","timestamp","recorded","newAgent","userName","name","userId","value","blockHash","altId","address","network","agent","push","pulseCheck","parseBlockchainResults","results","process","env","DEBUG","console","log","forEach","index","foo","fetchBundle","query","parameters","callback","auditEventArray","find","map","auditEvent","id","_id","Bundle","generate","toMongo","originalAuditEvent","mongoRecord","prepForUpdate","telecom","contact","prepForFhirTransfer","birthDate","moment","format","displayName","text","allow","update","insert","remove","exportDefault","export","SidebarElements","DynamicRoutes","AuditEventsPage","AuditEventsTable","CardText","CardTitle","Tab","Tabs","GlassCard","VerticalCanvas","FullPageCanvas","Glass","Session","AuditEventDetail","React","ReactMeteorData","ReactMixin","getMeteorData","data","style","opacity","get","tab","borderBottom","borderRight","tabIndex","auditEventSearchFilter","currentAuditEvent","blur","appbar","darkroom","handleTabChange","set","onNewTab","render","NODE_ENV","Component","Card","CardActions","CardMedia","Table","Toggle","selected","auditEvents","displayToggle","displayDates","props","displayToggles","count","fetch","displayOnMobile","width","includes","window","navigator","platform","display","renderTogglesHeader","renderToggles","patientId","renderDateHeader","renderDate","newDate","rowClick","tableRows","i","length","newRow","subtype","action","outcome","outcomeDesc","agentName","entityName","sourceSite","cursor","bind","performedDateTime"],"mappings":"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AEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AAGA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mC;;;;;;;;;;;;;;;ACzQA7F,MAAM,CAAC4F,MAAP,CAAc;AAACG,iBAAe,EAAC;AAAA,WAAIA,eAAJ;AAAA;AAAjB,CAAd;AAAqD,IAAIE,QAAJ,EAAaC,SAAb;AAAuBlG,MAAM,CAACC,IAAP,CAAY,kBAAZ,EAA+B;AAACgG,UAAD,YAAU/F,CAAV,EAAY;AAAC+F,YAAQ,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","file":"/packages/clinical_hl7-resource-audit-event.js","sourcesContent":["import SimpleSchema from 'simpl-schema';\n\nimport { CodingSchema, CodeableConcept, ReferenceSchema, IdentifierSchema } from 'meteor/clinical:hl7-resource-datatypes'\n\n// AuditEvents = new Mongo.Collection('AuditEvents', {connection: null});\n\n// if(Package['clinical:autopublish']){\n//   AuditEvents = new Mongo.Collection('AuditEvents');\n// }\n// if(Package['clinical:desktop-publish']){\n//   AuditEvents = new Mongo.Collection('AuditEvents');\n// }\n\nAuditEvents = new Mongo.Collection('AuditEvents');\n\n\n// create the object using our BaseModel\nAuditEvent = BaseModel.extend();\n\n//Assign a collection so the object knows how to perform CRUD operations\nAuditEvent.prototype._collection = AuditEvents;\n\n//Add the transform to the collection since Meteor.users is pre-defined by the accounts package\nAuditEvents._transform = function (document) {\n  return new AuditEvent(document);\n};\n\n\nAuditEventSchema = new SimpleSchema({\n  'resourceType' : {\n    type: String,\n    defaultValue: 'AuditEvent'\n  },\n  \"type\" : {\n    optional: true,\n    type: CodingSchema\n  },\n  \"subtype\" : {\n    optional: true,\n    type: Array\n  },\n  \"subtype.$\" : {\n    optional: true,\n    type: CodingSchema \n  },\n  \"action\" : {\n    optional: true,\n    type: String\n  },\n  \"recorded\" : {\n    optional: true,\n    type: Date\n  },\n  \"outcome\" : {\n    optional: true,\n    type: String\n  },\n  \"outcomeDesc\" : {\n    optional: true,\n    type: String\n  },\n  \"purposeOfEvent\" : {\n    optional: true,\n    type: Array\n  },\n  \"purposeOfEvent.$\" : {\n    optional: true,\n    type: CodeableConcept \n  },\n  \"agent\" : {\n    optional: true,\n    type: Array\n  },\n  \"agent.$\" : {\n    optional: true,\n    type: Object\n  },\n  \"agent.$.role\" : {\n    optional: true,\n    type: Array\n  },\n  \"agent.$.role.$\" : {\n    optional: true,\n    type: CodeableConcept \n  },\n  \"agent.$.reference\" : {\n    optional: true,\n    type: ReferenceSchema\n  },\n  \"agent.$.userId\" : {\n    optional: true,\n    type: IdentifierSchema\n  },\n  \"agent.$.altId\" : {\n    optional: true,\n    type: String\n  },\n  \"agent.$.name\" : {\n    optional: true,\n    type: String\n  },\n  \"agent.$.requestor\" : {\n    optional: true,\n    type: Boolean\n  },\n  \"agent.$.location\" : {\n    optional: true,\n    type: ReferenceSchema\n  },\n  \"agent.$.policy\" : {\n    optional: true,\n    type: Array\n  },\n  \"agent.$.policy.$\" : {\n    optional: true,\n    type: String \n  },\n  \"agent.$.media\" : {\n    optional: true,\n    type: CodingSchema\n  },\n  \"agent.$.network\" : {\n    optional: true,\n    type: Object\n  },\n  \"agent.$.network.address\" : {\n    optional: true,\n    type: String\n  },\n  \"agent.$.network.type\" : {\n    optional: true,\n    type: String\n  },\n  \"agent.$.purposeOfUse\" : {\n    optional: true,\n    type: Array\n  },\n  \"agent.$.purposeOfUse.$\" : {\n    optional: true,\n    type: CodeableConceptSchema\n  },  \n  \"source\" : {\n    optional: true,\n    type: Object\n  },\n  \"source.site\" : {\n    optional: true,\n    type: String\n  },\n  \"source.identifier\" : {\n    optional: true,\n    type: IdentifierSchema\n  },\n  \"source.type\" : {\n    optional: true,\n    type: Array\n  },\n  \"source.type.$\" : {\n    optional: true,\n    type: CodingSchema \n  },  \n  \"entity\" : {\n    optional: true,\n    type: Array\n  },\n  \"entity.$\" : {\n    optional: true,\n    type: Object\n  },\n  \"entity.$.identifier\" : {\n    optional: true,\n    type: IdentifierSchema\n  },\n  \"entity.$.reference\" : {\n    optional: true,\n    type: ReferenceSchema\n  },\n  \"entity.$.type\" : {\n    optional: true,\n    type: CodingSchema\n  },\n  \"entity.$.role\" : {\n    optional: true,\n    type: CodeableConcept\n  },\n  \"entity.$.lifecycle\" : {\n    optional: true,\n    type: CodingSchema\n  },\n  \"entity.$.securityLabel\" : {\n    optional: true,\n    type: Array\n  },\n  \"entity.$.securityLabel\" : {\n    optional: true,\n    type: CodeableConceptSchema\n  },  \n  \"entity.$.name\" : {\n    optional: true,\n    type: String\n  },\n  \"entity.$.description\" : {\n    optional: true,\n    type: String\n  },\n  \"entity.$.query\" : {\n    optional: true,\n    blackbox: true,\n    type: Object\n  },\n  \"entity.$.detail\" : {\n    optional: true,\n    type: Array\n  },\n  \"entity.$.detail.$\" : {\n    optional: true,\n    type: Object\n  },\n  \"entity.$.detail.$.type\" : {\n    optional: true,\n    type: String\n  },\n  \"entity.$.detail.$.value\" : {\n    optional: true,\n    blackbox: true,\n    type: Object\n  }\n});\n\n\nBaseSchema.extend(BinarySchema);\nDomainResourceSchema.extend(BinarySchema);\n\nAuditEvents.attachSchema(AuditEventSchema);\n\n\n\n\n\n\n\n\n//==============================================================================\n\n\n/**\n * @summary The displayed name of the auditEvent.\n * @memberOf AuditEvent\n * @name displayName\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n * ```\n */\n\nAuditEvent.prototype.toString = function () {\n  return this._document;\n};\nAuditEvent.prototype.toFhir = function () {\n  if(this._document.resourceType === \"AuditEvent\"){\n    return this._document;\n  } else {\n    this._document;\n\n// BlockChainEvent { address: '0x59d01dcbcc58224f21ddf5063a1070a37b29f6ec',\n//   topics: \n//   [ '0x5e2510585e36c769ee0aa8d684b60b5f6efca424bb7cd9b1bab30f76120789e0',\n//     '0x0000000000000000000000000c2b3a8a18a0c021e6b0b41933ab31e39e96903e' ],\n//   data: '0x',\n//   blockNumber: 3434,\n//   transactionIndex: 0,\n//   transactionHash: '0x5499113c83c8d4171af10caed59bf23ed906861bd073c4e8c9fb447b7b61891d',\n//   blockHash: '0x9bd754b1a7cefc8f1d4412ad962653137ea9e47e1be31841a71abbe6ec406428',\n//   logIndex: 0,\n//   removed: false,\n//   userName: 'Liddel, Alice',\n//   timestamp: Thu Apr 06 2017 00:21:54 GMT-0500 (CDT) }\n\n    // this._document.topics\n    // this._document.address\n    // this._document.data\n    // this._document.blockNumber\n    // this._document.transactionIndex\n    // this._document.transactionHash\n    // this._document.blockHash\n    // this._document.logIndex\n    // this._document.removed\n    // this._document.userName\n    // this._document.timestamp\n\n\n\n    var result = {\n      \"resourceType\": \"AuditEvent\",\n      \"type\": {\n        \"system\": \"http://hl7.org/fhir/audit-event-type\",\n        \"code\": \"rest\",\n        \"display\": \"Restful Operation\"\n      },\n      \"subtype\": [\n        {\n          \"system\": \"http://hl7.org/fhir/restful-interaction\",\n          \"code\": \"vread\",\n          \"display\": \"vread\"\n        }\n      ],\n      \"action\": \"R\",\n      \"recorded\": \"\",\n      \"outcome\": \"0\",\n      \"agent\": [],\n      \"source\": {\n        \"site\": \"Blockchain on FHIR\",\n        \"identifier\": {\n          \"value\": Meteor.absoluteUrl()\n        },\n        \"type\": [\n          {\n            \"system\": \"http://hl7.org/fhir/security-source-type\",\n            \"code\": \"3\",\n            \"display\": \"Web Server\"\n          }\n        ]\n      },\n      \"entity\": []\n    };\n\n    if(this._document.timestamp){\n      result.recorded = this._document.timestamp;\n    }\n    var newAgent = {\n      \"userId\": {\n        \"value\": \"\"\n      },\n      \"altId\": \"\",\n      \"name\": \"\",\n      \"requestor\": true,\n      \"role\": [\n        {\n          \"coding\": [\n            {\n              \"system\": \"http://dicom.nema.org/resources/ontology/DCM\",\n              \"code\": \"110153\",\n              \"display\": \"Source Role ID\"\n            }\n          ]\n        }\n      ],\n      \"network\": {\n        \"address\": \"\",\n        \"type\": \"\"\n      }\n    };\n\n    if(this._document.userName){\n      newAgent.name = this._document.userName\n    }\n    if(this._document.userId){\n      newAgent.userId.value = this._document.userId\n    }\n    if(this._document.blockHash){\n      newAgent.altId = this._document.blockHash\n    }\n    if(this._document.address){\n      newAgent.network.address = this._document.address;\n      newAgent.network.type = \"blockchain\";\n    }    \n    result.agent.push(newAgent);\n\n    return result;\n  }\n};\n\n\n\n\n\n//=================================================================\n\nAuditEvents.pulseCheck = function () {\n  return \"It's alive...\";\n};\nAuditEvents.parseBlockchainResults = function (results) {\n  process.env.DEBUG && console.log('results', results);\n\n  results.forEach(function(result, index){\n    console.log('~~~~~~~~~~~~~~~~~~~~~~~~')\n    var foo = new AuditEvent(result);\n    console.log('AuditEvent', foo.toFhir());\n  });\n  \n  return \"Parsing some blockchain results...\";\n};\n\nAuditEvents.fetchBundle = function (query, parameters, callback) {\n  var auditEventArray = AuditEvents.find(query, parameters, callback).map(function(auditEvent){\n    auditEvent.id = auditEvent._id;\n    delete auditEvent._document;\n    return auditEvent;\n  });\n\n  // console.log(\"auditEventArray\", auditEventArray);\n\n  var result = Bundle.generate(auditEventArray);\n\n  // console.log(\"result\", result.entry[0]);\n\n  return result;\n};\n\n\n/**\n * @summary This function takes a FHIR resource and prepares it for storage in Mongo.\n * @memberOf AuditEvents\n * @name toMongo\n * @version 1.6.0\n * @returns { AuditEvent }\n * @example\n * ```js\n *  let auditEvents = AuditEvents.toMongo('12345').fetch();\n * ```\n */\n\nAuditEvents.toMongo = function (originalAuditEvent) {\n  var mongoRecord;\n\n  // if (originalAuditEvent.identifier) {\n  //   originalAuditEvent.identifier.forEach(function(identifier){\n  //     if (identifier.period) {\n  //       if (identifier.period.start) {\n  //         var startArray = identifier.period.start.split('-');\n  //         identifier.period.start = new Date(startArray[0], startArray[1] - 1, startArray[2]);\n  //       }\n  //       if (identifier.period.end) {\n  //         var endArray = identifier.period.end.split('-');\n  //         identifier.period.end = new Date(startArray[0], startArray[1] - 1, startArray[2]);\n  //       }\n  //     }\n  //   });\n  // }\n\n  return originalAuditEvent;\n};\n\n\n/**\n * @summary Similar to toMongo(), this function prepares a FHIR record for storage in the Mongo database.  The difference being, that this assumes there is already an existing record.\n * @memberOf AuditEvents\n * @name prepForUpdate\n * @version 1.6.0\n * @returns { Object }\n * @example\n * ```js\n *  let auditEvents = AuditEvents.findMrn('12345').fetch();\n * ```\n */\n\nAuditEvents.prepForUpdate = function (auditEvent) {\n\n  if (auditEvent.name && auditEvent.name[0]) {\n    //console.log(\"auditEvent.name\", auditEvent.name);\n\n    auditEvent.name.forEach(function(name){\n      name.resourceType = \"HumanName\";\n    });\n  }\n\n  if (auditEvent.telecom && auditEvent.telecom[0]) {\n    //console.log(\"auditEvent.telecom\", auditEvent.telecom);\n    auditEvent.telecom.forEach(function(telecom){\n      telecom.resourceType = \"ContactPoint\";\n    });\n  }\n\n  if (auditEvent.address && auditEvent.address[0]) {\n    //console.log(\"auditEvent.address\", auditEvent.address);\n    auditEvent.address.forEach(function(address){\n      address.resourceType = \"Address\";\n    });\n  }\n\n  if (auditEvent.contact && auditEvent.contact[0]) {\n    //console.log(\"auditEvent.contact\", auditEvent.contact);\n\n    auditEvent.contact.forEach(function(contact){\n      if (contact.name) {\n        contact.name.resourceType = \"HumanName\";\n      }\n\n      if (contact.telecom && contact.telecom[0]) {\n        contact.telecom.forEach(function(telecom){\n          telecom.resourceType = \"ContactPoint\";\n        });\n      }\n\n    });\n  }\n\n  return auditEvent;\n};\n\n\n/**\n * @summary Scrubbing the auditEvent; make sure it conforms to v1.6.0\n * @memberOf AuditEvents\n * @name scrub\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n *  let auditEvents = AuditEvents.findMrn('12345').fetch();\n * ```\n */\n\nAuditEvents.prepForFhirTransfer = function (auditEvent) {\n  //console.log(\"AuditEvents.prepForBundle()\");\n\n\n  // FHIR has complicated and unusual rules about dates in order\n  // to support situations where a family member might report on a auditEvent's\n  // date of birth, but not know the year of birth; and the other way around\n  if (auditEvent.birthDate) {\n    auditEvent.birthDate = moment(auditEvent.birthDate).format(\"YYYY-MM-DD\");\n  }\n\n\n  if (auditEvent.name && auditEvent.name[0]) {\n    //console.log(\"auditEvent.name\", auditEvent.name);\n\n    auditEvent.name.forEach(function(name){\n      delete name.resourceType;\n    });\n  }\n\n  if (auditEvent.telecom && auditEvent.telecom[0]) {\n    //console.log(\"auditEvent.telecom\", auditEvent.telecom);\n    auditEvent.telecom.forEach(function(telecom){\n      delete telecom.resourceType;\n    });\n  }\n\n  if (auditEvent.address && auditEvent.address[0]) {\n    //console.log(\"auditEvent.address\", auditEvent.address);\n    auditEvent.address.forEach(function(address){\n      delete address.resourceType;\n    });\n  }\n\n  if (auditEvent.contact && auditEvent.contact[0]) {\n    //console.log(\"auditEvent.contact\", auditEvent.contact);\n\n    auditEvent.contact.forEach(function(contact){\n\n      console.log(\"contact\", contact);\n\n\n      if (contact.name && contact.name.resourceType) {\n        //console.log(\"auditEvent.contact.name\", contact.name);\n        delete contact.name.resourceType;\n      }\n\n      if (contact.telecom && contact.telecom[0]) {\n        contact.telecom.forEach(function(telecom){\n          delete telecom.resourceType;\n        });\n      }\n\n    });\n  }\n\n  //console.log(\"AuditEvents.prepForBundle()\", auditEvent);\n\n  return auditEvent;\n};\n\n/**\n * @summary The displayed name of the auditEvent.\n * @memberOf AuditEvent\n * @name displayName\n * @version 1.2.3\n * @returns {Boolean}\n * @example\n * ```js\n * ```\n */\n\nAuditEvent.prototype.displayName = function () {\n  if (this.name && this.name[0]) {\n    return this.name[0].text;\n  }\n};\n\n\n\n//=================================================================\n\nAuditEvents.allow({\n  update() { return true; },\n  insert() { return true; },\n  remove() { return true; }\n});\n\n//=================================================================\n\n\nexport default { AuditEvent, AuditEvents, AuditEventSchema };","\n\nimport AuditEventsPage from './client/AuditEventsPage';\nimport AuditEventsTable from './client/AuditEventsTable';\n\nvar DynamicRoutes = [{\n  'name': 'AuditEventsPage',\n  'path': '/audit-events',\n  'component': AuditEventsPage,\n  'requireAuth': true\n}];\n\nvar SidebarElements = [{\n  'primaryText': 'AuditEvents',\n  'to': '/audit-events',\n  'href': '/audit-events'\n}];\n\nexport { \n  SidebarElements, \n  DynamicRoutes, \n\n  AuditEventsPage,\n  AuditEventsTable\n};\n\n\n","// import { CardActions, CardText } from 'material-ui/Card';\n\n// import { Bert } from 'meteor/clinical:alert';\n// import DatePicker from 'material-ui/DatePicker';\n// import RaisedButton from 'material-ui/RaisedButton';\n// import React from 'react';\n// import { ReactMeteorData } from 'meteor/react-meteor-data';\n// import ReactMixin from 'react-mixin';\n// import TextField from 'material-ui/TextField';\n// import { browserHistory } from 'react-router';\n// import { get } from 'lodash';\n// import PropTypes from 'prop-types';\n\n// let defaultAuditEvent = {\n//   'resourceType': 'AuditEvent',\n//   'status': 'unknown',\n//   'identifier': [{\n//     'use': 'official',\n//     'value': ''\n//   }],\n//   'code': {\n//     'text': ''\n//   }\n// };\n\n\n// Session.setDefault('auditEventUpsert', false);\n// Session.setDefault('selectedAuditEvent', false);\n\n// export class AuditEventDetail extends React.Component {\n//   getMeteorData() {\n//     let data = {\n//       auditEventId: false,\n//       auditEvent: defaultAuditEvent,\n//       showDatePicker: false\n//     };\n\n//     if(this.props.showDatePicker){\n//       data.showDatePicker = this.props.showDatePicker\n//     }\n\n//     if (Session.get('auditEventUpsert')) {\n//       data.auditEvent = Session.get('auditEventUpsert');\n//     } else {\n//       // if (Session.get('selectedAuditEvent')) {\n//       //   data.auditEventId = Session.get('selectedAuditEvent');\n//         console.log(\"selectedAuditEvent\", Session.get('selectedAuditEvent'));\n\n//         let selectedAuditEvent = AuditEvents.findOne({_id: Session.get('selectedAuditEvent')});\n//         console.log(\"selectedAuditEvent\", selectedAuditEvent);\n\n//         if (selectedAuditEvent) {\n//           data.auditEvent = selectedAuditEvent;\n//         }\n//       // } else {\n//       //   data.auditEvent = defaultAuditEvent;\n//       // }\n//     }\n\n//     if (Session.get('selectedAuditEvent')) {\n//       data.auditEventId = Session.get('selectedAuditEvent');\n//     }      \n\n//     return data;\n//   }\n\n//   renderDatePicker(showDatePicker, datePickerValue){\n//     if (showDatePicker) {\n//       return (\n//         <DatePicker \n//           name='performedDateTime'\n//           hintText=\"Performed Date/Time\" \n//           container=\"inline\" \n//           mode=\"landscape\"\n//           value={ datePickerValue ? datePickerValue : ''}    \n//           onChange={ this.changeState.bind(this, 'performedDateTime')}      \n//           />\n//       );\n//     }\n//   }\n\n//   render() {\n//     return (\n//       <div id={this.props.id} className=\"auditEventDetail\">\n//         <CardText>\n//         <TextField\n//             id='identifierInput'\n//             ref='identifier'\n//             name='identifier'\n//             floatingLabelText='Identifier'\n//             value={ get(this, 'data.auditEvent.identifier[0].value') ? get(this, 'data.auditEvent.identifier[0].value') : ''}\n//             onChange={ this.changeState.bind(this, 'identifier')}\n//             fullWidth\n//             /><br/>\n//           <TextField\n//             id='codeInput'\n//             ref='code'\n//             name='code'\n//             floatingLabelText='Code'\n//             value={this.data.auditEvent.code ? this.data.auditEvent.code.text : ''}\n//             onChange={ this.changeState.bind(this, 'code')}\n//             fullWidth\n//             /><br/>\n//           <TextField\n//             id='statusInput'\n//             ref='status'\n//             name='status'\n//             floatingLabelText='Status'\n//             value={this.data.auditEvent.status ? this.data.auditEvent.status : ''}\n//             onChange={ this.changeState.bind(this, 'status')}\n//             fullWidth\n//             /><br/>\n\n\n//             <br/>\n//           { this.renderDatePicker(this.data.showDatePicker, get(this, 'data.auditEvent.performedDateTime') ) }\n//           <br/>\n\n//         </CardText>\n//         <CardActions>\n//           { this.determineButtons(this.data.auditEventId) }\n//         </CardActions>\n//       </div>\n//     );\n//   }\n\n\n//   determineButtons(auditEventId){\n//     if (auditEventId) {\n//       return (\n//         <div>\n//           <RaisedButton id=\"saveAuditEventButton\" label=\"Save\" primary={true} onClick={this.handleSaveButton.bind(this)} style={{marginRight: '20px'}}  />\n//           <RaisedButton id=\"deleteAuditEventButton\" label=\"Delete\" onClick={this.handleDeleteButton.bind(this)} />\n\n//         </div>\n//       );\n//     } else {\n//       return(\n//         <RaisedButton id=\"saveAuditEventButton\" label=\"Save\" primary={true} onClick={this.handleSaveButton.bind(this)} />\n//       );\n//     }\n//   }\n\n\n\n//   // this could be a mixin\n//   changeState(field, event, value){\n//     let auditEventUpdate;\n\n//     if(process.env.NODE_ENV === \"test\") console.log(\"AuditEventDetail.changeState\", field, event, value);\n\n//     // by default, assume there's no other data and we're creating a new auditEvent\n//     if (Session.get('auditEventUpsert')) {\n//       auditEventUpdate = Session.get('auditEventUpsert');\n//     } else {\n//       auditEventUpdate = defaultAuditEvent;\n//     }\n\n\n\n//     // if there's an existing auditEvent, use them\n//     if (Session.get('selectedAuditEvent')) {\n//       auditEventUpdate = this.data.auditEvent;\n//     }\n\n//     switch (field) {\n//       case \"identifier\":\n//         auditEventUpdate.identifier = [{\n//           use: 'official',\n//           value: value\n//         }];\n//         break;\n//       case \"code\":\n//         auditEventUpdate.code.text = value;\n//         break;\n//       case \"status\":\n//         auditEventUpdate.status = value;\n//         break;\n//       case \"performedDateTime\":\n//         auditEventUpdate.performedDateTime = value;\n//         break;\n\n//       default:\n//     }\n\n//     if(process.env.NODE_ENV === \"test\") console.log(\"auditEventUpdate\", auditEventUpdate);\n//     Session.set('auditEventUpsert', auditEventUpdate);\n//   }\n\n//   handleSaveButton(){\n//     let auditEventUpdate = Session.get('auditEventUpsert', auditEventUpdate);\n\n//     if(process.env.NODE_ENV === \"test\") console.log(\"auditEventUpdate\", auditEventUpdate);\n\n\n//     if (Session.get('selectedAuditEvent')) {\n//       if(process.env.NODE_ENV === \"test\") console.log(\"Updating auditEvent...\");\n//       delete auditEventUpdate._id;\n\n//       // not sure why we're having to respecify this; fix for a bug elsewhere\n//       auditEventUpdate.resourceType = 'AuditEvent';\n\n//       AuditEvents.update(\n//         {_id: Session.get('selectedAuditEvent')}, {$set: auditEventUpdate }, function(error, result) {\n//           if (error) {\n//             console.log(\"error\", error);\n\n//             Bert.alert(error.reason, 'danger');\n//           }\n//           if (result) {\n//             HipaaLogger.logEvent({eventType: \"update\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"AuditEvents\", recordId: Session.get('selectedAuditEvent')});\n//             Session.set('auditEventPageTabIndex', 1);\n//             Session.set('selectedAuditEvent', false);\n//             Session.set('auditEventUpsert', false);\n//             Bert.alert('AuditEvent updated!', 'success');\n//           }\n//         });\n//     } else {\n\n//       if(process.env.NODE_ENV === \"test\") console.log(\"create a new auditEvent\", auditEventUpdate);\n\n//       AuditEvents.insert(auditEventUpdate, function(error, result) {\n//         if (error) {\n//           console.log(\"error\", error);\n//           Bert.alert(error.reason, 'danger');\n//         }\n//         if (result) {\n//           HipaaLogger.logEvent({eventType: \"create\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"AuditEvents\", recordId: result});\n//           Session.set('auditEventPageTabIndex', 1);\n//           Session.set('selectedAuditEvent', false);\n//           Session.set('auditEventUpsert', false);\n//           Bert.alert('AuditEvent added!', 'success');\n//         }\n//       });\n//     }\n//   }\n\n//   handleCancelButton(){\n//     Session.set('auditEventPageTabIndex', 1);\n//   }\n\n//   handleDeleteButton(){\n//     AuditEvent.remove({_id: Session.get('selectedAuditEvent')}, function(error, result){\n//       if (error) {\n//         Bert.alert(error.reason, 'danger');\n//       }\n//       if (result) {\n//         HipaaLogger.logEvent({eventType: \"delete\", userId: Meteor.userId(), userName: Meteor.user().fullName(), collectionName: \"AuditEvents\", recordId: Session.get('selectedAuditEvent')});\n//         Session.set('auditEventPageTabIndex', 1);\n//         Session.set('selectedAuditEvent', false);\n//         Session.set('auditEventUpsert', false);\n//         Bert.alert('AuditEvent removed!', 'success');\n//       }\n//     });\n//   }\n// }\n\n\n// AuditEventDetail.propTypes = {\n//   id: PropTypes.string,\n//   fhirVersion: PropTypes.string,\n//   auditEventId: PropTypes.oneOfType([PropTypes.string, PropTypes.bool]),\n//   auditEvent: PropTypes.oneOfType([PropTypes.object, PropTypes.bool])\n// };\n// ReactMixin(AuditEventDetail.prototype, ReactMeteorData);\n// export default AuditEventDetail;","import { CardText, CardTitle } from 'material-ui/Card';\nimport {Tab, Tabs} from 'material-ui/Tabs';\nimport { GlassCard, VerticalCanvas, FullPageCanvas, Glass } from 'meteor/clinical:glass-ui';\n\nimport { Meteor } from 'meteor/meteor';\nimport { Session } from 'meteor/session';\n\nimport AuditEventDetail from './AuditEventDetail';\nimport AuditEventsTable from './AuditEventsTable';\n\nimport React  from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin  from 'react-mixin';\n\nexport class AuditEventsPage extends React.Component {\n  getMeteorData() {\n    let data = {\n      style: {\n        opacity: Session.get('globalOpacity'),\n        tab: {\n          borderBottom: '1px solid lightgray',\n          borderRight: 'none'\n        }\n      },\n      tabIndex: Session.get('auditEventPageTabIndex'),\n      auditEventSearchFilter: Session.get('auditEventSearchFilter'),\n      currentAuditEvent: Session.get('selectedAuditEvent')\n    };\n\n    data.style = Glass.blur(data.style);\n    data.style.appbar = Glass.darkroom(data.style.appbar);\n    data.style.tab = Glass.darkroom(data.style.tab);\n\n    return data;\n  }\n\n  handleTabChange(index){\n    Session.set('auditEventPageTabIndex', index);\n  }\n\n  onNewTab(){\n    Session.set('selectedAuditEvent', false);\n    Session.set('auditEventUpsert', false);\n  }\n\n  render() {\n    if(process.env.NODE_ENV === \"test\") console.log('In AuditEventsPage render');\n    return (\n      <div id='auditEventsPage'>\n        <FullPageCanvas>\n          <GlassCard height='auto'>\n            <CardTitle title='AuditEvents' />\n            <CardText>\n              <AuditEventsTable />\n\n              {/* <Tabs id=\"auditEventsPageTabs\" default value={this.data.tabIndex} onChange={this.handleTabChange} initialSelectedIndex={1}>\n               <Tab className='newAuditEventTab' label='New' style={this.data.style.tab} onActive={ this.onNewTab } value={0}>\n                 <AuditEventDetail id='newAuditEvent' />\n               </Tab>\n               <Tab className=\"auditEventListTab\" label='AuditEvents' onActive={this.handleActive} style={this.data.style.tab} value={1}>\n                <AuditEventsTable />\n               </Tab>\n               <Tab className=\"auditEventDetailsTab\" label='Detail' onActive={this.handleActive} style={this.data.style.tab} value={2}>\n                 <AuditEventDetail \n                  id='auditEventDetails'\n                  showDatePicker={true} \n                 />\n               </Tab>\n             </Tabs> */}\n            </CardText>\n          </GlassCard>\n        </FullPageCanvas>\n      </div>\n    );\n  }\n}\n\nReactMixin(AuditEventsPage.prototype, ReactMeteorData);\n\nexport default AuditEventsPage;","// https://www.hl7.org/fhir/auditevent.html  \n// STU3\n\n\n\nimport { Card, CardActions, CardMedia, CardText, CardTitle } from 'material-ui/Card';\n\nimport React from 'react';\nimport { ReactMeteorData } from 'meteor/react-meteor-data';\nimport ReactMixin from 'react-mixin';\nimport { Table } from 'react-bootstrap';\nimport Toggle from 'material-ui/Toggle';\nimport { get } from 'lodash';\n\nexport default class AuditEventsTable extends React.Component {\n\n  getMeteorData() {\n\n    // this should all be handled by props\n    // or a mixin!\n    let data = {\n      style: {\n        opacity: Session.get('globalOpacity')\n      },\n      selected: [],\n      auditEvents: [],\n      displayToggle: false,\n      displayDates: false\n    }\n\n    if(this.props.displayToggles){\n      data.displayToggle = this.props.displayToggles;\n    }\n    if(this.props.displayDates){\n      data.displayDates = this.props.displayDates;\n    }\n    if(this.props.data){\n      data.auditEvents = this.props.data;\n    } else {\n      if(AuditEvents.find().count() > 0){\n        data.auditEvents = AuditEvents.find().fetch();\n      }  \n    }\n\n    if(process.env.NODE_ENV === \"test\") console.log(\"AuditEventsTable[data]\", data);\n    return data;\n  };\n  displayOnMobile(width){\n    let style = {};\n    if(['iPhone'].includes(window.navigator.platform)){\n      style.display = \"none\";\n    }\n    if(width){\n      style.width = width;\n    }\n    return style;\n  }\n  renderTogglesHeader(displayToggle){\n    if (displayToggle) {\n      return (\n        <th className=\"toggle\">toggle</th>\n      );\n    }\n  }\n  renderToggles(displayToggle, patientId ){\n    if (displayToggle) {\n      return (\n        <td className=\"toggle\">\n            <Toggle\n              defaultToggled={true}\n              //style={styles.toggle}\n            />\n          </td>\n      );\n    }\n  }\n  renderDateHeader(displayDates){\n    if (displayDates) {\n      return (\n        <th className='date'>date</th>\n      );\n    }\n  }\n  renderDate(displayDates, newDate ){\n    if (displayDates) {\n      return (\n        <td className='date'>{ moment(newDate).format('YYYY-MM-DD') }</td>\n      );\n    }\n  }\n  rowClick(id){\n    Session.set('auditEventsUpsert', false);\n    Session.set('selectedAuditEvent', id);\n    Session.set('auditEventPageTabIndex', 2);\n  };\n  render () {\n    let tableRows = [];\n    let auditEvent;\n    for (var i = 0; i < this.data.auditEvents.length; i++) {\n      var newRow = {\n        type: '',\n        subtype: '',        \n        action: '',\n        outcome: '',\n        outcomeDesc: '',\n        agentName: '',\n        entityName: '',\n        sourceSite: ''\n      };\n      if (this.data.auditEvents[i]){\n        auditEvent = this.data.auditEvents[i];\n\n        if(get(auditEvent, 'type')){\n          if(get(auditEvent, 'type.display')){\n            newRow.type = get(auditEvent, 'type.display');\n          } else {\n            newRow.type = get(auditEvent, 'type.code');\n          }\n        }\n        newRow.subtype = get(auditEvent, 'subtype[0].display')\n        newRow.subtype = get(auditEvent, 'subtype[0].code')\n        newRow.action = get(auditEvent, 'action')\n        newRow.outcome = get(auditEvent, 'outcome')\n        // newRow.outcomeDesc = get(auditEvent, 'outcomeDesc')\n        newRow.agentName = get(auditEvent, 'agent[0].name')\n        newRow.entityName = get(auditEvent, 'entity[0].name')\n        newRow.sourceSite = get(auditEvent, 'source.site')\n      }\n\n      console.log('newRow', newRow)\n\n      tableRows.push(\n        <tr key={i} className=\"auditEventRow\" style={{cursor: \"pointer\"}} onClick={ this.rowClick.bind('this', this.data.auditEvents[i]._id)} >\n          { this.renderToggles(this.data.displayToggle, this.data.auditEvents[i]) }\n          <td className='type' style={this.displayOnMobile()} >{ newRow.type }</td>\n          {/* <td className='subtype'>{ newRow.subtype }</td> */}\n          <td className='action'>{ newRow.action }</td>\n          <td className='outcome'>{ newRow.outcome }</td>\n          {/* <td className='outcomeDesc'>{ newRow.outcomeDesc }</td> */}\n          <td className='agentName'>{ newRow.agentName }</td>\n          <td className='entityName' style={this.displayOnMobile()}  >{ newRow.entityName }</td>\n          <td className='sourceSite'>{ newRow.sourceSite }</td>\n          { this.renderDate(this.data.displayDates, this.data.auditEvents[i].performedDateTime) }\n        </tr>\n      )\n    }\n\n    return(\n      <Table id='auditEventsTable' hover >\n        <thead>\n          <tr>\n            { this.renderTogglesHeader(this.data.displayToggle) }\n            <th className='type' style={this.displayOnMobile()} >Type</th>\n            {/* <th className='subtype'>Subtype</th> */}\n            <th className='action'>Action</th>\n            <th className='outcome'>Outcome</th>\n            {/* <th className='outcomeDesc'>Outcome Description</th> */}\n            <th className='agentName'>Agent Name</th>\n            <th className='entityName' style={this.displayOnMobile()}  >Entity Name</th>\n            <th className='sourceSite'>Source</th>\n            { this.renderDateHeader(this.data.displayDates) }\n          </tr>\n        </thead>\n        <tbody>\n          { tableRows }\n        </tbody>\n      </Table>\n    );\n  }\n}\n\n\nReactMixin(AuditEventsTable.prototype, ReactMeteorData);"]}